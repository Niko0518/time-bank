var cloudbaseBundle=(()=>{var QU=Object.create;var Uu=Object.defineProperty;var XU=Object.getOwnPropertyDescriptor;var ZU=Object.getOwnPropertyNames;var e3=Object.getPrototypeOf,t3=Object.prototype.hasOwnProperty;var X=(t,e)=>()=>(t&&(e=t(t=0)),e);var K=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Pr=(t,e)=>{for(var r in e)Uu(t,r,{get:e[r],enumerable:!0})},Du=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of ZU(e))!t3.call(t,o)&&o!==r&&Uu(t,o,{get:()=>e[o],enumerable:!(n=XU(e,o))||n.enumerable});return t},Be=(t,e,r)=>(Du(t,e,"default"),r&&Du(r,e,"default")),st=(t,e,r)=>(r=t!=null?QU(e3(t)):{},Du(e||!t||!t.__esModule?Uu(r,"default",{value:t,enumerable:!0}):r,t)),r3=t=>Du(Uu({},"__esModule",{value:!0}),t);function n3(t){vy=t}function ei(){return vy}function i3(t){my=t}function bh(){return my}var vy,my,Eh,o3,Sh=X(()=>{vy="@cloudbase/js-sdk";my="https:";Eh=!1,o3="https://support.qq.com/products/148793"});var qn,gy=X(()=>{qn={INVALID_PARAMS:"INVALID_PARAMS",INVALID_SYNTAX:"INVALID_SYNTAX",INVALID_OPERATION:"INVALID_OPERATION",OPERATION_FAIL:"OPERATION_FAIL",NETWORK_ERROR:"NETWORK_ERROR",UNKOWN_ERROR:"UNKOWN_ERROR"}});var Ge={};Pr(Ge,{COMMUNITY_SITE_URL:()=>o3,ERRORS:()=>qn,IS_DEBUG_MODE:()=>Eh,OATUH_LOGINTYPE:()=>a3,getProtocol:()=>bh,getSdkName:()=>ei,setProtocol:()=>i3,setSdkName:()=>n3});var a3,ka=X(()=>{Sh();gy();a3="constants"});var yy=K(Po=>{"use strict";Object.defineProperty(Po,"__esModule",{value:!0});var s3;(function(t){t.local="local",t.none="none",t.session="session"})(s3=Po.StorageType||(Po.StorageType={}));var u3=(function(){function t(){}return t})();Po.AbstractSDKRequest=u3;var c3=(function(){function t(){}return t})();Po.AbstractStorage=c3});var _y=K(Ih=>{"use strict";Object.defineProperty(Ih,"__esModule",{value:!0});function l3(t,e,r){r===void 0&&(r={});var n=/\?/.test(e),o="";for(var i in r)o===""?!n&&(e+="?"):o+="&",o+=i+"="+encodeURIComponent(r[i]);return e+=o,/^http(s)?\:\/\//.test(e)?e:""+t+e}Ih.formatUrl=l3});var Ci=K(Bu=>{"use strict";function wy(t){for(var e in t)Bu.hasOwnProperty(e)||(Bu[e]=t[e])}Object.defineProperty(Bu,"__esModule",{value:!0});wy(yy());wy(_y())});var it={};Pr(it,{createPromiseCallback:()=>w3,execCallback:()=>b3,formatUrl:()=>Ch,genSeqId:()=>v3,generateRequestId:()=>m3,getHash:()=>y3,getQuery:()=>g3,isArray:()=>Th,isFormData:()=>Rh,isInstanceOf:()=>Ah,isNull:()=>p3,isPalinObject:()=>d3,isString:()=>Oh,isUndefined:()=>h3,parseCaptcha:()=>A3,parseQueryString:()=>by,printError:()=>E3,printGroupLog:()=>qu,printInfo:()=>S3,printWarn:()=>Pi,removeParam:()=>_3,sleep:()=>T3,throwError:()=>I3,toQueryString:()=>Ph,transformPhone:()=>O3});function Th(t){return Object.prototype.toString.call(t)==="[object Array]"}function Oh(t){return typeof t=="string"}function h3(t){return typeof t>"u"}function d3(t){return Object.prototype.toString.call(t)==="[object Object]"}function p3(t){return Object.prototype.toString.call(t)==="[object Null]"}function Ah(t,e){return t instanceof e}function Rh(t){return Object.prototype.toString.call(t)==="[object FormData]"}function v3(){return Math.random().toString(16).slice(2)}function m3(){var t=new Date().getTime(),e=Date?.now&&Date.now()*1e3||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var n=Math.random()*16;return t>0?(n=(t+n)%16|0,t=Math.floor(t/16)):(n=(e+n)%16|0,e=Math.floor(e/16)),(r==="x"?n:n&7|8).toString(16)})}function Ch(t,e,r){r===void 0&&(r={});var n=/\?/.test(e),o="";return Object.keys(r).forEach(function(i){o===""?!n&&(e+="?"):o+="&",o+="".concat(i,"=").concat(encodeURIComponent(r[i]))}),e+=o,/^http(s)?:\/\//.test(e)?e:"".concat(t).concat(e)}function Ph(t){t===void 0&&(t={});var e=[];return Object.keys(t).forEach(function(r){e.push("".concat(r,"=").concat(encodeURIComponent(t[r])))}),e.join("&")}function g3(t,e){if(typeof window>"u")return!1;var r=e||decodeURIComponent(window.location.search),n=new RegExp("(^|&)".concat(t,"=([^&]*)(&|$)")),o=r.substr(r.indexOf("?")+1).match(n);return o!=null?o[2]:""}function _3(t,e){var r=e.split("?")[0],n,o=[],i=e.indexOf("?")!==-1?e.split("?")[1]:"";if(i!==""){o=i.split("&");for(var s=o.length-1;s>=0;s-=1)n=o[s].split("=")[0],n===t&&o.splice(s,1);r="".concat(r,"?").concat(o.join("&"))}return r}function w3(){var t={};if(!Promise){t=function(){},t.promise={};var e=function(){throw new Error('Your Node runtime does support ES6 Promises. Set "global.Promise" to your preferred implementation of promises.')};return Object.defineProperty(t.promise,"then",{get:e}),Object.defineProperty(t.promise,"catch",{get:e}),t}var r=new Promise(function(n,o){t=function(i,s){return i?o(i):n(s)}});return t.promise=r,t}function b3(t,e,r){if(r===void 0&&(r=null),t&&typeof t=="function")return t(e,r);if(e)throw e;return r}function Pi(t,e){console.warn("[".concat(ei(),"][").concat(t,"]:").concat(e))}function E3(t,e){console.error({code:t,msg:"[".concat(ei(),"][").concat(t,"]:").concat(e)})}function S3(t,e){console.log("[".concat(ei(),"][").concat(t,"]:").concat(e))}function I3(t,e){throw new Error(JSON.stringify({code:t,msg:"[".concat(ei(),"][").concat(t,"]:").concat(e)}))}function qu(t){var e,r=t.title,n=t.subtitle,o=n===void 0?"":n,i=t.content,s=i===void 0?[]:i,u=t.printTrace,l=u===void 0?!1:u,a=t.collapsed,c=a===void 0?!1:a;c?(console.groupCollapsed||console.error)(r,o):(console.group||console.error)(r,o);for(var h=0,w=s;h<w.length;h++){var E=w[h],T=E.type,A=E.body;switch(T){case"info":console.log(A);break;case"warn":console.warn(A);break;case"error":console.error(A);break}}l&&(console.trace||console.log)("stack trace:"),(e=console.groupEnd)===null||e===void 0||e.call(console)}function O3(t){return"+86".concat(t)}function A3(t){var e={},r=t.match(/^(data:.*?)(\?[^#\s]*)?$/);if(r){t=r[1];var n=r[2];n&&(e=by(n))}var o=e.token,i=f3(e,["token"]);return/^data:/.test(t)&&!o?{error:"invalid_argument",error_description:"invalid captcha data: ".concat(t)}:o?{state:i.state,token:o,captchaData:t}:{error:"unimplemented",error_description:"need to impl captcha data"}}var f3,y3,T3,by,xi=X(()=>{ka();f3=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]]);return r};y3=function(t){if(typeof window>"u")return"";var e=window.location.hash.match(new RegExp("[#?&/]".concat(t,"=([^&#]*)")));return e?e[1]:""};T3=function(t){return t===void 0&&(t=0),new Promise(function(e){return setTimeout(e,t)})};by=function(t){t=t.replace(/^\?/,"");var e={},r=t.split("&");return r.forEach(function(n){var o=n.split("="),i=o[0],s=o[1];i=decodeURIComponent(i),s=decodeURIComponent(s),i&&(e[i]?Array.isArray(e[i])?e[i].push(s):e[i]=[e[i],s]:e[i]=s)}),e}});function Sy(){var t={type:"default",root:window,reqClass:C3,wsClass:WebSocket,localStorage};return t}var Ey,R3,Nt,xh,Nh,C3,Iy=X(()=>{Ey=st(Ci());xi();Sh();R3=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),Nt=function(){return Nt=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Nt.apply(this,arguments)},xh=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},Nh=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},C3=(function(t){R3(e,t);function e(r){var n=t.call(this)||this,o=r.timeout,i=r.timeoutMsg,s=r.restrictedMethods;return n.timeout=o||0,n.timeoutMsg=i||"\u8BF7\u6C42\u8D85\u65F6",n.restrictedMethods=s||["get","post","upload","download"],n}return e.prototype.get=function(r){return this.request(Nt(Nt({},r),{method:"get"}),this.restrictedMethods.includes("get"))},e.prototype.post=function(r){return this.request(Nt(Nt({},r),{method:"post"}),this.restrictedMethods.includes("post"))},e.prototype.put=function(r){return this.request(Nt(Nt({},r),{method:"put"}))},e.prototype.upload=function(r){var n=r.data,o=r.file,i=r.name,s=r.method,u=r.headers,l=u===void 0?{}:u,a={post:"post",put:"put"}[s?.toLowerCase()]||"put",c=new FormData;return a==="post"?(Object.keys(n).forEach(function(h){c.append(h,n[h])}),c.append("key",i),c.append("file",o),this.request(Nt(Nt({},r),{data:c,method:a}),this.restrictedMethods.includes("upload"))):this.request(Nt(Nt({},r),{method:"put",headers:l,body:o}),this.restrictedMethods.includes("upload"))},e.prototype.download=function(r){return xh(this,void 0,void 0,function(){var n,o,i,s,u;return Nh(this,function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),[4,this.get(Nt(Nt({},r),{headers:{},responseType:"blob"}))];case 1:return n=l.sent().data,o=window.URL.createObjectURL(new Blob([n])),i=decodeURIComponent(new URL(r.url).pathname.split("/").pop()||""),s=document.createElement("a"),s.href=o,s.setAttribute("download",i),s.style.display="none",document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(o),document.body.removeChild(s),[3,3];case 2:return u=l.sent(),[3,3];case 3:return[2,new Promise(function(a){a({statusCode:200,tempFilePath:r.url})})]}})})},e.prototype.fetch=function(r){var n;return xh(this,void 0,void 0,function(){var o,i,s,u,l,a,c,h,w,E,T,A,O,C=this;return Nh(this,function(P){switch(P.label){case 0:return o=new AbortController,i=r.url,s=r.enableAbort,u=s===void 0?!1:s,l=r.stream,a=l===void 0?!1:l,c=r.signal,h=r.timeout,w=r.shouldThrowOnError,E=w===void 0?!0:w,T=h??this.timeout,c&&(c.aborted&&o.abort(),c.addEventListener("abort",function(){return o.abort()})),A=null,u&&T&&(A=setTimeout(function(){console.warn(C.timeoutMsg),o.abort(new Error(C.timeoutMsg))},T)),[4,fetch(i,Nt(Nt({},r),{signal:o.signal})).then(function(q){return xh(C,void 0,void 0,function(){var U,k,W;return Nh(this,function(V){switch(V.label){case 0:return clearTimeout(A),E?q.ok?(U=q,[3,3]):[3,1]:[3,4];case 1:return W=(k=Promise).reject,[4,q.json()];case 2:U=W.apply(k,[V.sent()]),V.label=3;case 3:return[2,U];case 4:return[2,q]}})})}).catch(function(q){if(clearTimeout(A),E)return Promise.reject(q)})];case 1:return O=P.sent(),[2,{data:a?O.body:!((n=O.headers.get("content-type"))===null||n===void 0)&&n.includes("application/json")?O.json():O.text(),statusCode:O.status,header:O.headers}]}})})},e.prototype.request=function(r,n){var o=this;n===void 0&&(n=!1);var i=String(r.method).toLowerCase()||"get";return new Promise(function(s){var u=r.url,l=r.headers,a=l===void 0?{}:l,c=r.data,h=r.responseType,w=r.withCredentials,E=r.body,T=r.onUploadProgress,A=Ch(bh(),u,i==="get"?c:{}),O=new XMLHttpRequest;O.open(i,A),h&&(O.responseType=h),Object.keys(a).forEach(function(q){O.setRequestHeader(q,a[q])});var C;T&&O.upload.addEventListener("progress",T),O.onreadystatechange=function(){var q={};if(O.readyState===4){var U=O.getAllResponseHeaders(),k=U.trim().split(/[\r\n]+/),W={};k.forEach(function(V){var Y=V.split(": "),Z=Y.shift().toLowerCase(),ae=Y.join(": ");W[Z]=ae}),q.header=W,q.statusCode=O.status;try{q.data=h==="blob"?O.response:JSON.parse(O.responseText)}catch{q.data=h==="blob"?O.response:O.responseText}clearTimeout(C),s(q)}},n&&o.timeout&&(C=setTimeout(function(){console.warn(o.timeoutMsg),O.abort()},o.timeout));var P;Rh(c)?P=c:a["content-type"]==="application/x-www-form-urlencoded"?P=Ph(c):E?P=E:P=c?JSON.stringify(c):void 0,w&&(O.withCredentials=!0),O.send(P)})},e})(Ey.AbstractSDKRequest)});var $a={};Pr($a,{RUNTIME:()=>ju,useAdapters:()=>x3,useDefaultAdapter:()=>N3});function x3(t,e){for(var r=Th(t)?t:[t],n=0,o=r;n<o.length;n++){var i=o[n],s=i.isMatch,u=i.genAdapter,l=i.runtime;if(s())return{adapter:Fu({isMatch:s},u(e)),runtime:l}}}function N3(){return{adapter:Fu({},Sy()),runtime:ju.WEB}}var Fu,ju,Ty=X(()=>{Iy();xi();Fu=function(){return Fu=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Fu.apply(this,arguments)};(function(t){t.WEB="web",t.WX_MP="wx_mp"})(ju||(ju={}))});var Mu={};Pr(Mu,{CloudbaseCache:()=>U3});function D3(t,e){switch(t){case"local":return e.localStorage?e.localStorage:(Pi(qn.INVALID_PARAMS,"localStorage is not supported on current platform"),new Uh(e.root));case"none":return new Uh(e.root);default:return e.localStorage?e.localStorage:(Pi(qn.INVALID_PARAMS,"localStorage is not supported on current platform"),new Uh(e.root))}}var Oy,L3,Lh,Dh,Uh,U3,Ay=X(()=>{Oy=st(Ci());xi();ka();L3=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),Lh=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},Dh=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Uh=(function(t){L3(e,t);function e(r){var n=t.call(this)||this;return n.root=r,r.tcbCacheObject||(r.tcbCacheObject={}),n}return e.prototype.setItem=function(r,n){this.root.tcbCacheObject[r]=n},e.prototype.getItem=function(r){return this.root.tcbCacheObject[r]},e.prototype.removeItem=function(r){delete this.root.tcbCacheObject[r]},e.prototype.clear=function(){delete this.root.tcbCacheObject},e})(Oy.AbstractStorage);U3=(function(){function t(e){this.keys={};var r=e.persistence,n=e.platformInfo,o=n===void 0?{}:n,i=e.keys,s=i===void 0?{}:i;this.platformInfo=o,this.storage||(this.persistenceTag=this.platformInfo.adapter.primaryStorage||r,this.storage=D3(this.persistenceTag,this.platformInfo.adapter),this.keys=s)}return Object.defineProperty(t.prototype,"mode",{get:function(){return this.storage.mode||"sync"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"persistence",{get:function(){return this.persistenceTag},enumerable:!1,configurable:!0}),t.prototype.setStore=function(e,r,n){if(this.mode==="async"){Pi(qn.INVALID_OPERATION,"current platform's storage is asynchronous, please use setStoreAsync insteed");return}if(this.storage)try{var o={version:n||"localCachev1",content:r};this.storage.setItem(e,JSON.stringify(o))}catch(i){throw new Error(JSON.stringify({code:qn.OPERATION_FAIL,msg:"[".concat(ei(),"][").concat(qn.OPERATION_FAIL,"]setStore failed"),info:i}))}},t.prototype.setStoreAsync=function(e,r,n){return Lh(this,void 0,void 0,function(){var o,i;return Dh(this,function(s){switch(s.label){case 0:if(!this.storage)return[2];s.label=1;case 1:return s.trys.push([1,3,,4]),o={version:n||"localCachev1",content:r},[4,this.storage.setItem(e,JSON.stringify(o))];case 2:return s.sent(),[3,4];case 3:return i=s.sent(),[2];case 4:return[2]}})})},t.prototype.getStore=function(e,r){var n;if(this.mode==="async"){Pi(qn.INVALID_OPERATION,"current platform's storage is asynchronous, please use getStoreAsync insteed");return}try{if(typeof process<"u"&&(!((n=process.env)===null||n===void 0)&&n.tcb_token))return process.env.tcb_token;if(!this.storage)return""}catch{return""}r=r||"localCachev1";var o=this.storage.getItem(e);if(!o)return"";if(o.indexOf(r)>=0){var i=JSON.parse(o);return i.content}return""},t.prototype.getStoreAsync=function(e,r){var n;return Lh(this,void 0,void 0,function(){var o,i;return Dh(this,function(s){switch(s.label){case 0:try{if(typeof process<"u"&&(!((n=process.env)===null||n===void 0)&&n.tcb_token))return[2,process.env.tcb_token];if(!this.storage)return[2,""]}catch{return[2,""]}return r=r||"localCachev1",[4,this.storage.getItem(e)];case 1:return o=s.sent(),o?o.indexOf(r)>=0?(i=JSON.parse(o),[2,i.content]):[2,""]:[2,""]}})})},t.prototype.removeStore=function(e){if(this.mode==="async"){Pi(qn.INVALID_OPERATION,"current platform's storage is asynchronous, please use removeStoreAsync insteed");return}this.storage.removeItem(e)},t.prototype.removeStoreAsync=function(e){return Lh(this,void 0,void 0,function(){return Dh(this,function(r){switch(r.label){case 0:return[4,this.storage.removeItem(e)];case 1:return r.sent(),[2]}})})},t})()});var $u={};Pr($u,{CloudbaseEvent:()=>Bh,CloudbaseEventEmitter:()=>ku,IErrorEvent:()=>Ry,activateEvent:()=>k3,addEventListener:()=>M3,removeEventListener:()=>$3});function F3(t,e,r){r[t]=r[t]||[],r[t].push(e)}function j3(t,e,r){if(r?.[t]){var n=r[t].indexOf(e);n!==-1&&r[t].splice(n,1)}}function M3(t,e){qh.on(t,e)}function k3(t,e){e===void 0&&(e={}),qh.fire(t,e)}function $3(t,e){qh.off(t,e)}var B3,q3,Bh,Ry,ku,qh,Fh=X(()=>{xi();B3=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),q3=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,i;n<o;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))};Bh=(function(){function t(e,r){this.data=r||null,this.name=e}return t})(),Ry=(function(t){B3(e,t);function e(r,n){var o=t.call(this,"error",{error:r,data:n})||this;return o.error=r,o}return e})(Bh),ku=(function(){function t(){this.listeners={}}return t.prototype.on=function(e,r){return F3(e,r,this.listeners),this},t.prototype.off=function(e,r){return j3(e,r,this.listeners),this},t.prototype.fire=function(e,r){if(Ah(e,Ry))return console.error(e.error),this;var n=Oh(e)?new Bh(e,r||{}):e,o=n.name;if(this.listens(o)){n.target=this;for(var i=this.listeners[o]?q3([],this.listeners[o],!0):[],s=0,u=i;s<u.length;s++){var l=u[s];l.call(this,n)}}return this},t.prototype.listens=function(e){return this.listeners[e]&&this.listeners[e].length>0},t})(),qh=new ku});var Zt={};Pr(Zt,{LANG_CHANGE_EVENT:()=>H3,bus:()=>W3});var W3,H3,Cy=X(()=>{Fh();W3=new ku,H3="lang_change"});function K3(t){var e=t.mode,r=e===void 0?"async":e,n=t.customInfo,o=n===void 0?{}:n,i=t.title,s=t.messages,u=s===void 0?[]:s;return function(l,a,c){if(Eh){var h=o.className||l.constructor.name,w=o.methodName||a,E=c.value,T=Y3(new Error);r==="sync"?c.value=function(){for(var A=[],O=0;O<arguments.length;O++)A[O]=arguments[O];var C=Py({err:new Error,className:h,methodName:w,sourceLink:T});try{return E.apply(this,A)}catch(Y){var P=Y,q=Y.message,U=Y.error,k=Y.error_description,W={title:i||"".concat(h,".").concat(w," failed"),content:[{type:"error",body:Y}]};if(q&&/^\{.*\}$/.test(q)){var V=JSON.parse(q);W.subtitle=q,V.code&&(C?(C.code=V.code,C.msg=V.msg):(Y.code=V.code,Y.message=V.msg),P=C||Y,W.content=u.map(function(Z){return{type:"info",body:Z}}))}throw U&&k&&(W.subtitle=k,C?(C.code=U,C.msg=k):(Y.code=U,Y.message=k),P=C||Y,W.content=u.map(function(Z){return{type:"info",body:Z}})),qu(W),P}}:c.value=function(){for(var A=[],O=0;O<arguments.length;O++)A[O]=arguments[O];return G3(this,void 0,void 0,function(){var C,P,q,U,k,W,V,Y;return V3(this,function(Z){switch(Z.label){case 0:C=Py({err:new Error,className:h,methodName:w,sourceLink:T}),Z.label=1;case 1:return Z.trys.push([1,3,,4]),[4,E.apply(this,A)];case 2:return[2,Z.sent()];case 3:throw P=Z.sent(),q=P,U=P.message,k=P.error,W=P.error_description,V={title:i||"".concat(h,".").concat(w," failed"),content:[{type:"error",body:P}]},U&&/^\{.*\}$/.test(U)&&(Y=JSON.parse(U),V.subtitle=Y,Y.code&&(C?(C.code=Y.code,C.message=Y.msg):(P.code=Y.code,P.message=Y.msg),q=C||P,V.content=u.map(function(ae){return{type:"info",body:ae}}))),k&&W&&(V.subtitle=W,C?(C.code=k,C.msg=W):(P.code=k,P.message=W),q=C||P,V.content=u.map(function(ae){return{type:"info",body:ae}})),qu(V),q;case 4:return[2]}})})}}}}function Y3(t){var e="",r=t.stack.split(`
`),n=r.findIndex(function(i){return z3.test(i)});if(n!==-1){var o=xy.exec(r[n+1]||"");e=o?o[0]:""}return e}function Py(t){var e=t.err,r=t.className,n=t.methodName,o=t.sourceLink;if(!o)return null;var i=e.stack.split(`
`),s=Wa?/^catchErrorsDecorator\/<\/descriptor.value@.*\d$/:new RegExp("".concat(r,"\\.descriptor.value\\s*\\[as\\s").concat(n,"\\]\\s*\\(.*\\)$")),u=Wa?/^catchErrorsDecorator\/<\/descriptor.value/:new RegExp("".concat(r,"\\.descriptor.value\\s*\\[as\\s").concat(n,"\\]")),l=i.findIndex(function(h){return s.test(h)}),a;if(l!==-1){var c=i.filter(function(h,w){return w>l});c.unshift(i[l].replace(u,"".concat(r,".").concat(n)).replace(xy,o)),a=new Error,a.stack="".concat(Wa?"@debugger":"Error",`
`).concat(c.join(`
`))}return a}var G3,V3,Wa,z3,xy,Ny=X(()=>{xi();ka();G3=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},V3=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Wa=!1;typeof navigator<"u"&&navigator.userAgent&&(Wa=navigator.userAgent.indexOf("Firefox")!==-1);z3=Wa?/(\.js\/)?__decorate(\$\d+)?<@.*\d$/:/(\/\w+\.js\.)?__decorate(\$\d+)?\s*\(.*\)$/,xy=/https?:\/\/.+:\d*\/.*\.js:\d+:\d+/});var hn={};Pr(hn,{catchErrorsDecorator:()=>K3});var Ly=X(()=>{Ny()});var j7,Dy=X(()=>{j7=(function(){function t(){var e=this;this.listeners=[],this.signal={aborted:!1,addEventListener:function(r,n){r==="abort"&&e.listeners.push(n)}}}return t.prototype.abort=function(){this.signal.aborted||(this.signal.aborted=!0,this.listeners.forEach(function(e){return e()}))},t})()});function jh(t){this.message=t}function Uy(t){this.message=t}var k7,By=X(()=>{jh.prototype=new Error,jh.prototype.name="InvalidCharacterError";k7=typeof window<"u"&&window.atob&&window.atob.bind(window)||function(t){var e=String(t).replace(/=+$/,"");if(e.length%4==1)throw new jh("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,n,o=0,i=0,s="";n=e.charAt(i++);~n&&(r=o%4?64*r+n:n,o++%4)?s+=String.fromCharCode(255&r>>(-2*o&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return s};Uy.prototype=new Error,Uy.prototype.name="InvalidTokenError"});var Lt=X(()=>{ka();Ty();Ay();Fh();Cy();xi();Ly();Dy();By()});function Fy(t,e){var r=e.name,n=e.namespace,o=e.entity,i=e.injectEvents,s=e.IIFE,u=s===void 0?!1:s;if(qy[r]||n&&t[n])throw new Error(JSON.stringify({code:Hu.INVALID_OPERATION,msg:"Duplicate component ".concat(r)}));if(u){if(!o||typeof o!="function")throw new Error(JSON.stringify({code:Hu.INVALID_PARAMS,msg:"IIFE component's entity must be a function"}));o.call(t)}if(qy[r]=e,n?t.prototype[n]=o:jy(t.prototype,o),i){var l=i.bus,a=i.events;if(!l||!a||a.length===0)return;var c=t.prototype.fire||function(){};t.prototype.events||(t.prototype.events={});var h=t.prototype.events||{};h[r]?t.prototype.events[r].events=Wu(Wu([],t.prototype.events[r].events,!0),a,!0):t.prototype.events[r]={bus:l,events:a},t.prototype.fire=function(w,E){c(w,E);for(var T=Object.keys(this.events),A=0,O=T;A<O.length;A++){var C=O[A],P=this.events[C],q=P.bus,U=P.events;if(U.includes(w)){q.fire(w,E);break}}}}}function jy(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:{var r=e;return new Date(r.getTime())}case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(var n=Object.keys(e),o=0,i=n;o<i.length;o++){var s=i[o];Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=jy(t[s],e[s]))}return t}function My(t,e){var r=e.entity,n=e.target;if(Object.prototype.hasOwnProperty.call(t,n))throw new Error(JSON.stringify({code:Hu.INVALID_OPERATION,msg:"target:".concat(n," is not exist")}));var o=t.prototype[n];if(typeof o!="function")throw new Error(JSON.stringify({code:Hu.INVALID_OPERATION,msg:"target:".concat(n," is not a function which is the only type supports hook")}));t.prototype[n]=function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];return r.call.apply(r,Wu([this],i,!1)),o.call.apply(o,Wu([this],i,!1))}}var Wu,Hu,qy,ky=X(()=>{Lt();Wu=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,i;n<o;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))},Hu=Ge.ERRORS,qy={}});function Ya(){}function ct(t){return typeof t=="object"&&t!==null||typeof t=="function"}function De(t,e){try{Object.defineProperty(t,"name",{value:e,configurable:!0})}catch{}}function pt(t){return new id(t)}function Ue(t){return pt(e=>e(t))}function de(t){return X3(t)}function mn(t,e,r){return Q3.call(t,e,r)}function er(t,e,r){mn(mn(t,e,r),void 0,s_)}function Mh(t,e){er(t,e)}function Yh(t,e){er(t,void 0,e)}function Wn(t,e,r){return mn(t,e,r)}function Fo(t){mn(t,void 0,s_)}function Fi(t,e,r){if(typeof t!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(t,e,r)}function Gn(t,e,r){try{return Ue(Fi(t,e,r))}catch(n){return de(n)}}function l_(t,e){t._ownerReadableStream=e,e._reader=t,e._state==="readable"?Jh(t):e._state==="closed"?(function(r){Jh(r),h_(r)})(t):f_(t,e._storedError)}function ud(t,e){return Kr(t._ownerReadableStream,e)}function $n(t){let e=t._ownerReadableStream;e._state==="readable"?cd(t,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):(function(r,n){f_(r,n)})(t,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),e._readableStreamController[sd](),e._reader=void 0,t._ownerReadableStream=void 0}function ac(t){return new TypeError("Cannot "+t+" a stream using a released reader")}function Jh(t){t._closedPromise=pt((e,r)=>{t._closedPromise_resolve=e,t._closedPromise_reject=r})}function f_(t,e){Jh(t),cd(t,e)}function cd(t,e){t._closedPromise_reject!==void 0&&(Fo(t._closedPromise),t._closedPromise_reject(e),t._closedPromise_resolve=void 0,t._closedPromise_reject=void 0)}function h_(t){t._closedPromise_resolve!==void 0&&(t._closedPromise_resolve(void 0),t._closedPromise_resolve=void 0,t._closedPromise_reject=void 0)}function gn(t,e){if(t!==void 0&&typeof(r=t)!="object"&&typeof r!="function")throw new TypeError(`${e} is not an object.`);var r}function Nr(t,e){if(typeof t!="function")throw new TypeError(`${e} is not a function.`)}function d_(t,e){if(!(function(r){return typeof r=="object"&&r!==null||typeof r=="function"})(t))throw new TypeError(`${e} is not an object.`)}function Hn(t,e,r){if(t===void 0)throw new TypeError(`Parameter ${e} is required in '${r}'.`)}function Qh(t,e,r){if(t===void 0)throw new TypeError(`${e} is required in '${r}'.`)}function ld(t){return Number(t)}function Wy(t){return t===0?0:t}function fd(t,e){let r=Number.MAX_SAFE_INTEGER,n=Number(t);if(n=Wy(n),!$y(n))throw new TypeError(`${e} is not a finite number`);if(n=(function(o){return Wy(eB(o))})(n),n<0||n>r)throw new TypeError(`${e} is outside the accepted range of 0 to ${r}, inclusive`);return $y(n)&&n!==0?n:0}function hd(t,e){if(!ti(t))throw new TypeError(`${e} is not a ReadableStream.`)}function Lo(t){return new Fn(t)}function p_(t,e){t._reader._readRequests.push(e)}function dd(t,e,r){let n=t._reader._readRequests.shift();r?n._closeSteps():n._chunkSteps(e)}function pc(t){return t._reader._readRequests.length}function v_(t){let e=t._reader;return e!==void 0&&!!ri(e)}function ri(t){return!!ct(t)&&!!Object.prototype.hasOwnProperty.call(t,"_readRequests")&&t instanceof Fn}function Ja(t,e){let r=t._ownerReadableStream;r._disturbed=!0,r._state==="closed"?e._closeSteps():r._state==="errored"?e._errorSteps(r._storedError):r._readableStreamController[ad](e)}function m_(t,e){let r=t._readRequests;t._readRequests=new tr,r.forEach(n=>{n._errorSteps(e)})}function Gu(t){return new TypeError(`ReadableStreamDefaultReader.prototype.${t} can only be used on a ReadableStreamDefaultReader`)}function Ga(t){return t.slice()}function g_(t,e,r,n,o){new Uint8Array(t).set(new Uint8Array(r,n,o),e)}function y_(t,e,r){if(t.slice)return t.slice(e,r);let n=r-e,o=new ArrayBuffer(n);return g_(o,0,t,e,n),o}function Va(t,e){let r=t[e];if(r!=null){if(typeof r!="function")throw new TypeError(`${String(e)} is not a function`);return r}}function Hy(t){try{let e=t.done,r=t.value;return mn(Z3(r),n=>({done:e,value:n}))}catch(e){return de(e)}}function __(t,e="sync",r){if(r===void 0)if(e==="async"){if((r=Va(t,ns))===void 0)return(function(o){let i={next(){let s;try{s=w_(o)}catch(u){return de(u)}return Hy(s)},return(s){let u;try{let l=Va(o.iterator,"return");if(l===void 0)return Ue({done:!0,value:s});u=Fi(l,o.iterator,[s])}catch(l){return de(l)}return ct(u)?Hy(u):de(new TypeError("The iterator.return() method must return an object"))}};return{iterator:i,nextMethod:i.next,done:!1}})(__(t,"sync",Va(t,Symbol.iterator)))}else r=Va(t,Symbol.iterator);if(r===void 0)throw new TypeError("The object is not iterable");let n=Fi(r,t,[]);if(!ct(n))throw new TypeError("The iterator method must return an object");return{iterator:n,nextMethod:n.next,done:!1}}function w_(t){let e=Fi(t.nextMethod,t.iterator,[]);if(!ct(e))throw new TypeError("The iterator.next() method must return an object");return e}function Gy(t){if(!ct(t)||!Object.prototype.hasOwnProperty.call(t,"_asyncIteratorImpl"))return!1;try{return t._asyncIteratorImpl instanceof sc}catch{return!1}}function Vy(t){return new TypeError(`ReadableStreamAsyncIterator.${t} can only be used on a ReadableSteamAsyncIterator`)}function zy(t){let e=y_(t.buffer,t.byteOffset,t.byteOffset+t.byteLength);return new Uint8Array(e)}function Xh(t){let e=t._queue.shift();return t._queueTotalSize-=e.size,t._queueTotalSize<0&&(t._queueTotalSize=0),e.value}function pd(t,e,r){if(typeof(n=r)!="number"||E_(n)||n<0||r===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");var n;t._queue.push({value:e,size:r}),t._queueTotalSize+=r}function oi(t){t._queue=new tr,t._queueTotalSize=0}function S_(t){return t===DataView}function Ui(t){return!!ct(t)&&!!Object.prototype.hasOwnProperty.call(t,"_controlledReadableByteStream")&&t instanceof pn}function Hh(t){return!!ct(t)&&!!Object.prototype.hasOwnProperty.call(t,"_associatedReadableByteStreamController")&&t instanceof ni}function Hi(t){if((function(r){let n=r._controlledReadableByteStream;return n._state!=="readable"||r._closeRequested||!r._started?!1:!!(v_(n)&&pc(n)>0||md(n)&&q_(n)>0||D_(r)>0)})(t)){if(t._pulling)return void(t._pullAgain=!0);t._pulling=!0,er(t._pullAlgorithm(),()=>(t._pulling=!1,t._pullAgain&&(t._pullAgain=!1,Hi(t)),null),r=>(xr(t,r),null))}}function I_(t){vd(t),t._pendingPullIntos=new tr}function T_(t,e){let r=!1;t._state==="closed"&&(r=!0);let n=O_(e);e.readerType==="default"?dd(t,n,r):(function(o,i,s){let u=o._reader,l=u._readIntoRequests.shift();s?l._closeSteps(i):l._chunkSteps(i)})(t,n,r)}function Zu(t,e){for(let r=0;r<e.length;++r)T_(t,e[r])}function O_(t){let e=t.bytesFilled,r=t.elementSize;return new t.viewConstructor(t.buffer,t.byteOffset,e/r)}function ec(t,e,r,n){t._queue.push({buffer:e,byteOffset:r,byteLength:n}),t._queueTotalSize+=n}function A_(t,e,r,n){let o;try{o=y_(e,r,r+n)}catch(i){throw xr(t,i),i}ec(t,o,0,n)}function R_(t,e){e.bytesFilled>0&&A_(t,e.buffer,e.byteOffset,e.bytesFilled),Do(t)}function C_(t,e){let r=Math.min(t._queueTotalSize,e.byteLength-e.bytesFilled),n=e.bytesFilled+r,o=r,i=!1,s=n-n%e.elementSize;s>=e.minimumFill&&(o=s-e.bytesFilled,i=!0);let u=t._queue;for(;o>0;){let l=u.peek(),a=Math.min(o,l.byteLength),c=e.byteOffset+e.bytesFilled;g_(e.buffer,c,l.buffer,l.byteOffset,a),l.byteLength===a?u.shift():(l.byteOffset+=a,l.byteLength-=a),t._queueTotalSize-=a,P_(t,a,e),o-=a}return i}function P_(t,e,r){r.bytesFilled+=e}function x_(t){t._queueTotalSize===0&&t._closeRequested?(vc(t),is(t._controlledReadableByteStream)):Hi(t)}function vd(t){t._byobRequest!==null&&(t._byobRequest._associatedReadableByteStreamController=void 0,t._byobRequest._view=null,t._byobRequest=null)}function Zh(t){let e=[];for(;t._pendingPullIntos.length>0&&t._queueTotalSize!==0;){let r=t._pendingPullIntos.peek();C_(t,r)&&(Do(t),e.push(r))}return e}function tB(t,e,r,n){let o=t._controlledReadableByteStream,i=e.constructor,s=(function(w){return S_(w)?1:w.BYTES_PER_ELEMENT})(i),{byteOffset:u,byteLength:l}=e,a=r*s,c;try{c=ji(e.buffer)}catch(w){return void n._errorSteps(w)}let h={buffer:c,bufferByteLength:c.byteLength,byteOffset:u,byteLength:l,bytesFilled:0,minimumFill:a,elementSize:s,viewConstructor:i,readerType:"byob"};if(t._pendingPullIntos.length>0)return t._pendingPullIntos.push(h),void Ky(o,n);if(o._state==="closed"){let w=new i(h.buffer,h.byteOffset,0);return void n._closeSteps(w)}if(t._queueTotalSize>0){if(C_(t,h)){let w=O_(h);return x_(t),void n._chunkSteps(w)}if(t._closeRequested){let w=new TypeError("Insufficient bytes to fill elements in the given buffer");return xr(t,w),void n._errorSteps(w)}}t._pendingPullIntos.push(h),Ky(o,n),Hi(t)}function N_(t,e){let r=t._pendingPullIntos.peek();vd(t),t._controlledReadableByteStream._state==="closed"?(function(n,o){o.readerType==="none"&&Do(n);let i=n._controlledReadableByteStream;if(md(i)){let s=[];for(;s.length<q_(i);)s.push(Do(n));Zu(i,s)}})(t,r):(function(n,o,i){if(P_(0,o,i),i.readerType==="none"){R_(n,i);let l=Zh(n);return void Zu(n._controlledReadableByteStream,l)}if(i.bytesFilled<i.minimumFill)return;Do(n);let s=i.bytesFilled%i.elementSize;if(s>0){let l=i.byteOffset+i.bytesFilled;A_(n,i.buffer,l-s,s)}i.bytesFilled-=s;let u=Zh(n);T_(n._controlledReadableByteStream,i),Zu(n._controlledReadableByteStream,u)})(t,e,r),Hi(t)}function Do(t){return t._pendingPullIntos.shift()}function vc(t){t._pullAlgorithm=void 0,t._cancelAlgorithm=void 0}function za(t){let e=t._controlledReadableByteStream;if(!t._closeRequested&&e._state==="readable")if(t._queueTotalSize>0)t._closeRequested=!0;else{if(t._pendingPullIntos.length>0){let r=t._pendingPullIntos.peek();if(r.bytesFilled%r.elementSize!==0){let n=new TypeError("Insufficient bytes to fill elements in the given buffer");throw xr(t,n),n}}vc(t),is(e)}}function tc(t,e){let r=t._controlledReadableByteStream;if(t._closeRequested||r._state!=="readable")return;let{buffer:n,byteOffset:o,byteLength:i}=e;if(Mi(n))throw new TypeError("chunk's buffer is detached and so cannot be enqueued");let s=ji(n);if(t._pendingPullIntos.length>0){let u=t._pendingPullIntos.peek();if(Mi(u.buffer))throw new TypeError("The BYOB request's buffer has been detached and so cannot be filled with an enqueued chunk");vd(t),u.buffer=ji(u.buffer),u.readerType==="none"&&R_(t,u)}v_(r)?((function(u){let l=u._controlledReadableByteStream._reader;for(;l._readRequests.length>0;){if(u._queueTotalSize===0)return;L_(u,l._readRequests.shift())}})(t),pc(r)===0?ec(t,s,o,i):(t._pendingPullIntos.length>0&&Do(t),dd(r,new Uint8Array(s,o,i),!1))):md(r)?(ec(t,s,o,i),Zu(r,Zh(t))):ec(t,s,o,i),Hi(t)}function xr(t,e){let r=t._controlledReadableByteStream;r._state==="readable"&&(I_(t),oi(t),vc(t),nw(r,e))}function L_(t,e){let r=t._queue.shift();t._queueTotalSize-=r.byteLength,x_(t);let n=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);e._chunkSteps(n)}function ed(t){if(t._byobRequest===null&&t._pendingPullIntos.length>0){let e=t._pendingPullIntos.peek(),r=new Uint8Array(e.buffer,e.byteOffset+e.bytesFilled,e.byteLength-e.bytesFilled),n=Object.create(ni.prototype);(function(o,i,s){o._associatedReadableByteStreamController=i,o._view=s})(n,t,r),t._byobRequest=n}return t._byobRequest}function D_(t){let e=t._controlledReadableByteStream._state;return e==="errored"?null:e==="closed"?0:t._strategyHWM-t._queueTotalSize}function rc(t,e){let r=t._pendingPullIntos.peek();if(t._controlledReadableByteStream._state==="closed"){if(e!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(e===0)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(r.bytesFilled+e>r.byteLength)throw new RangeError("bytesWritten out of range")}r.buffer=ji(r.buffer),N_(t,e)}function nc(t,e){let r=t._pendingPullIntos.peek();if(t._controlledReadableByteStream._state==="closed"){if(e.byteLength!==0)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(e.byteLength===0)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(r.byteOffset+r.bytesFilled!==e.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(r.bufferByteLength!==e.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(r.bytesFilled+e.byteLength>r.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");let n=e.byteLength;r.buffer=ji(e.buffer),N_(t,n)}function U_(t,e,r,n,o,i,s){e._controlledReadableByteStream=t,e._pullAgain=!1,e._pulling=!1,e._byobRequest=null,e._queue=e._queueTotalSize=void 0,oi(e),e._closeRequested=!1,e._started=!1,e._strategyHWM=i,e._pullAlgorithm=n,e._cancelAlgorithm=o,e._autoAllocateChunkSize=s,e._pendingPullIntos=new tr,t._readableStreamController=e,er(Ue(r()),()=>(e._started=!0,Hi(e),null),u=>(xr(e,u),null))}function Gh(t){return new TypeError(`ReadableStreamBYOBRequest.prototype.${t} can only be used on a ReadableStreamBYOBRequest`)}function Ha(t){return new TypeError(`ReadableByteStreamController.prototype.${t} can only be used on a ReadableByteStreamController`)}function rB(t,e){if((t=`${t}`)!="byob")throw new TypeError(`${e} '${t}' is not a valid enumeration value for ReadableStreamReaderMode`);return t}function B_(t){return new jn(t)}function Ky(t,e){t._reader._readIntoRequests.push(e)}function q_(t){return t._reader._readIntoRequests.length}function md(t){let e=t._reader;return e!==void 0&&!!Bi(e)}function Bi(t){return!!ct(t)&&!!Object.prototype.hasOwnProperty.call(t,"_readIntoRequests")&&t instanceof jn}function F_(t,e,r,n){let o=t._ownerReadableStream;o._disturbed=!0,o._state==="errored"?n._errorSteps(o._storedError):tB(o._readableStreamController,e,r,n)}function j_(t,e){let r=t._readIntoRequests;t._readIntoRequests=new tr,r.forEach(n=>{n._errorSteps(e)})}function Vu(t){return new TypeError(`ReadableStreamBYOBReader.prototype.${t} can only be used on a ReadableStreamBYOBReader`)}function Qa(t,e){let{highWaterMark:r}=t;if(r===void 0)return e;if(E_(r)||r<0)throw new RangeError("Invalid highWaterMark");return r}function uc(t){let{size:e}=t;return e||(()=>1)}function cc(t,e){gn(t,e);let r=t?.highWaterMark,n=t?.size;return{highWaterMark:r===void 0?void 0:ld(r),size:n===void 0?void 0:nB(n,`${e} has member 'size' that`)}}function nB(t,e){return Nr(t,e),r=>ld(t(r))}function iB(t,e,r){return Nr(t,r),n=>Gn(t,e,[n])}function oB(t,e,r){return Nr(t,r),()=>Gn(t,e,[])}function aB(t,e,r){return Nr(t,r),n=>Fi(t,e,[n])}function sB(t,e,r){return Nr(t,r),(n,o)=>Gn(t,e,[n,o])}function M_(t,e){if(!No(t))throw new TypeError(`${e} is not a WritableStream.`)}function k_(t){return new dn(t)}function $_(t){t._state="writable",t._storedError=void 0,t._writer=void 0,t._writableStreamController=void 0,t._writeRequests=new tr,t._inFlightWriteRequest=void 0,t._closeRequest=void 0,t._inFlightCloseRequest=void 0,t._pendingAbortRequest=void 0,t._backpressure=!1}function No(t){return!!ct(t)&&!!Object.prototype.hasOwnProperty.call(t,"_writableStreamController")&&t instanceof Mn}function Uo(t){return t._writer!==void 0}function lc(t,e){var r;if(t._state==="closed"||t._state==="errored")return Ue(void 0);t._writableStreamController._abortReason=e,(r=t._writableStreamController._abortController)===null||r===void 0||r.abort(e);let n=t._state;if(n==="closed"||n==="errored")return Ue(void 0);if(t._pendingAbortRequest!==void 0)return t._pendingAbortRequest._promise;let o=!1;n==="erroring"&&(o=!0,e=void 0);let i=pt((s,u)=>{t._pendingAbortRequest={_promise:void 0,_resolve:s,_reject:u,_reason:e,_wasAlreadyErroring:o}});return t._pendingAbortRequest._promise=i,o||gd(t,e),i}function W_(t){let e=t._state;if(e==="closed"||e==="errored")return de(new TypeError(`The stream (in ${e} state) is not in the writable state and cannot be closed`));let r=pt((i,s)=>{let u={_resolve:i,_reject:s};t._closeRequest=u}),n=t._writer;var o;return n!==void 0&&t._backpressure&&e==="writable"&&Ed(n),pd(o=t._writableStreamController,K_,0),mc(o),r}function td(t,e){t._state!=="writable"?yd(t):gd(t,e)}function gd(t,e){let r=t._writableStreamController;t._state="erroring",t._storedError=e;let n=t._writer;n!==void 0&&G_(n,e),!(function(o){return!(o._inFlightWriteRequest===void 0&&o._inFlightCloseRequest===void 0)})(t)&&r._started&&yd(t)}function yd(t){t._state="errored",t._writableStreamController[c_]();let e=t._storedError;if(t._writeRequests.forEach(n=>{n._reject(e)}),t._writeRequests=new tr,t._pendingAbortRequest===void 0)return void zu(t);let r=t._pendingAbortRequest;if(t._pendingAbortRequest=void 0,r._wasAlreadyErroring)return r._reject(e),void zu(t);er(t._writableStreamController[u_](r._reason),()=>(r._resolve(),zu(t),null),n=>(r._reject(n),zu(t),null))}function yn(t){return t._closeRequest!==void 0||t._inFlightCloseRequest!==void 0}function zu(t){t._closeRequest!==void 0&&(t._closeRequest._reject(t._storedError),t._closeRequest=void 0);let e=t._writer;e!==void 0&&bd(e,t._storedError)}function _d(t,e){let r=t._writer;r!==void 0&&e!==t._backpressure&&(e?(function(n){gc(n)})(r):Ed(r)),t._backpressure=e}function Ni(t){return!!ct(t)&&!!Object.prototype.hasOwnProperty.call(t,"_ownerWritableStream")&&t instanceof dn}function H_(t){return W_(t._ownerWritableStream)}function uB(t,e){t._closedPromiseState==="pending"?bd(t,e):(function(r,n){X_(r,n)})(t,e)}function G_(t,e){t._readyPromiseState==="pending"?ew(t,e):(function(r,n){rd(r,n)})(t,e)}function V_(t){let e=t._ownerWritableStream,r=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");G_(t,r),uB(t,r),e._writer=void 0,t._ownerWritableStream=void 0}function z_(t,e){let r=t._ownerWritableStream,n=r._writableStreamController,o=(function(u,l){if(u._strategySizeAlgorithm===void 0)return 1;try{return u._strategySizeAlgorithm(l)}catch(a){return Xa(u,a),1}})(n,e);if(r!==t._ownerWritableStream)return de(Ka("write to"));let i=r._state;if(i==="errored")return de(r._storedError);if(yn(r)||i==="closed")return de(new TypeError("The stream is closing or closed and cannot be written to"));if(i==="erroring")return de(r._storedError);let s=(function(u){return pt((l,a)=>{let c={_resolve:l,_reject:a};u._writeRequests.push(c)})})(r);return(function(u,l,a){try{pd(u,l,a)}catch(h){return void Xa(u,h)}let c=u._controlledWritableStream;!yn(c)&&c._state==="writable"&&_d(c,wd(u)),mc(u)})(n,e,o),s}function Vh(t){return!!ct(t)&&!!Object.prototype.hasOwnProperty.call(t,"_controlledWritableStream")&&t instanceof ki}function Y_(t,e,r,n,o,i,s,u){e._controlledWritableStream=t,t._writableStreamController=e,e._queue=void 0,e._queueTotalSize=void 0,oi(e),e._abortReason=void 0,e._abortController=(function(){if(typeof AbortController=="function")return new AbortController})(),e._started=!1,e._strategySizeAlgorithm=u,e._strategyHWM=s,e._writeAlgorithm=n,e._closeAlgorithm=o,e._abortAlgorithm=i;let l=wd(e);_d(t,l),er(Ue(r()),()=>(e._started=!0,mc(e),null),a=>(e._started=!0,td(t,a),null))}function fc(t){t._writeAlgorithm=void 0,t._closeAlgorithm=void 0,t._abortAlgorithm=void 0,t._strategySizeAlgorithm=void 0}function J_(t){return t._strategyHWM-t._queueTotalSize}function mc(t){let e=t._controlledWritableStream;if(!t._started||e._inFlightWriteRequest!==void 0)return;if(e._state==="erroring")return void yd(e);if(t._queue.length===0)return;let r=t._queue.peek().value;r===K_?(function(n){let o=n._controlledWritableStream;(function(s){s._inFlightCloseRequest=s._closeRequest,s._closeRequest=void 0})(o),Xh(n);let i=n._closeAlgorithm();fc(n),er(i,()=>((function(s){s._inFlightCloseRequest._resolve(void 0),s._inFlightCloseRequest=void 0,s._state==="erroring"&&(s._storedError=void 0,s._pendingAbortRequest!==void 0&&(s._pendingAbortRequest._resolve(),s._pendingAbortRequest=void 0)),s._state="closed";let u=s._writer;u!==void 0&&Z_(u)})(o),null),s=>((function(u,l){u._inFlightCloseRequest._reject(l),u._inFlightCloseRequest=void 0,u._pendingAbortRequest!==void 0&&(u._pendingAbortRequest._reject(l),u._pendingAbortRequest=void 0),td(u,l)})(o,s),null))})(t):(function(n,o){let i=n._controlledWritableStream;(function(u){u._inFlightWriteRequest=u._writeRequests.shift()})(i);let s=n._writeAlgorithm(o);er(s,()=>{(function(l){l._inFlightWriteRequest._resolve(void 0),l._inFlightWriteRequest=void 0})(i);let u=i._state;if(Xh(n),!yn(i)&&u==="writable"){let l=wd(n);_d(i,l)}return mc(n),null},u=>(i._state==="writable"&&fc(n),(function(l,a){l._inFlightWriteRequest._reject(a),l._inFlightWriteRequest=void 0,td(l,a)})(i,u),null))})(t,r)}function Xa(t,e){t._controlledWritableStream._state==="writable"&&Q_(t,e)}function wd(t){return J_(t)<=0}function Q_(t,e){let r=t._controlledWritableStream;fc(t),gd(r,e)}function Ku(t){return new TypeError(`WritableStream.prototype.${t} can only be used on a WritableStream`)}function zh(t){return new TypeError(`WritableStreamDefaultController.prototype.${t} can only be used on a WritableStreamDefaultController`)}function Li(t){return new TypeError(`WritableStreamDefaultWriter.prototype.${t} can only be used on a WritableStreamDefaultWriter`)}function Ka(t){return new TypeError("Cannot "+t+" a stream using a released writer")}function ic(t){t._closedPromise=pt((e,r)=>{t._closedPromise_resolve=e,t._closedPromise_reject=r,t._closedPromiseState="pending"})}function X_(t,e){ic(t),bd(t,e)}function bd(t,e){t._closedPromise_reject!==void 0&&(Fo(t._closedPromise),t._closedPromise_reject(e),t._closedPromise_resolve=void 0,t._closedPromise_reject=void 0,t._closedPromiseState="rejected")}function Z_(t){t._closedPromise_resolve!==void 0&&(t._closedPromise_resolve(void 0),t._closedPromise_resolve=void 0,t._closedPromise_reject=void 0,t._closedPromiseState="resolved")}function gc(t){t._readyPromise=pt((e,r)=>{t._readyPromise_resolve=e,t._readyPromise_reject=r}),t._readyPromiseState="pending"}function rd(t,e){gc(t),ew(t,e)}function Yy(t){gc(t),Ed(t)}function ew(t,e){t._readyPromise_reject!==void 0&&(Fo(t._readyPromise),t._readyPromise_reject(e),t._readyPromise_resolve=void 0,t._readyPromise_reject=void 0,t._readyPromiseState="rejected")}function Ed(t){t._readyPromise_resolve!==void 0&&(t._readyPromise_resolve(void 0),t._readyPromise_resolve=void 0,t._readyPromise_reject=void 0,t._readyPromiseState="fulfilled")}function Qy(t,e,r,n,o,i){let s=Lo(t),u=k_(e);t._disturbed=!0;let l=!1,a=Ue(void 0);return pt((c,h)=>{let w;if(i!==void 0){if(w=()=>{let k=i.reason!==void 0?i.reason:new cB("Aborted","AbortError"),W=[];n||W.push(()=>e._state==="writable"?lc(e,k):Ue(void 0)),o||W.push(()=>t._state==="readable"?Kr(t,k):Ue(void 0)),P(()=>Promise.all(W.map(V=>V())),!0,k)},i.aborted)return void w();i.addEventListener("abort",w)}var E,T,A;if(C(t,s._closedPromise,k=>(n?q(!0,k):P(()=>lc(e,k),!0,k),null)),C(e,u._closedPromise,k=>(o?q(!0,k):P(()=>Kr(t,k),!0,k),null)),E=t,T=s._closedPromise,A=()=>(r?q():P(()=>(function(k){let W=k._ownerWritableStream,V=W._state;return yn(W)||V==="closed"?Ue(void 0):V==="errored"?de(W._storedError):H_(k)})(u)),null),E._state==="closed"?A():Mh(T,A),yn(e)||e._state==="closed"){let k=new TypeError("the destination writable stream closed before all data could be piped to it");o?q(!0,k):P(()=>Kr(t,k),!0,k)}function O(){let k=a;return mn(a,()=>k!==a?O():void 0)}function C(k,W,V){k._state==="errored"?V(k._storedError):Yh(W,V)}function P(k,W,V){function Y(){return er(k(),()=>U(W,V),Z=>U(!0,Z)),null}l||(l=!0,e._state!=="writable"||yn(e)?Y():Mh(O(),Y))}function q(k,W){l||(l=!0,e._state!=="writable"||yn(e)?U(k,W):Mh(O(),()=>U(k,W)))}function U(k,W){return V_(u),$n(s),i!==void 0&&i.removeEventListener("abort",w),k?h(W):c(void 0),null}Fo(pt((k,W)=>{(function V(Y){Y?k():mn(l?Ue(!0):mn(u._readyPromise,()=>pt((Z,ae)=>{Ja(s,{_chunkSteps:ie=>{a=mn(z_(u,ie),void 0,Ya),Z(!1)},_closeSteps:()=>Z(!0),_errorSteps:ae})})),V,W)})(!1)}))})}function Yu(t){return!!ct(t)&&!!Object.prototype.hasOwnProperty.call(t,"_controlledReadableStream")&&t instanceof vn}function Za(t){if(tw(t)){if(t._pulling)return void(t._pullAgain=!0);t._pulling=!0,er(t._pullAlgorithm(),()=>(t._pulling=!1,t._pullAgain&&(t._pullAgain=!1,Za(t)),null),e=>(Yr(t,e),null))}}function tw(t){let e=t._controlledReadableStream;return!qo(t)||!t._started?!1:ii(e)&&pc(e)>0?!0:Sd(t)>0}function hc(t){t._pullAlgorithm=void 0,t._cancelAlgorithm=void 0,t._strategySizeAlgorithm=void 0}function $i(t){if(!qo(t))return;let e=t._controlledReadableStream;t._closeRequested=!0,t._queue.length===0&&(hc(t),is(e))}function Bo(t,e){if(!qo(t))return;let r=t._controlledReadableStream;if(ii(r)&&pc(r)>0)dd(r,e,!1);else{let n;try{n=t._strategySizeAlgorithm(e)}catch(o){throw Yr(t,o),o}try{pd(t,e,n)}catch(o){throw Yr(t,o),o}}Za(t)}function Yr(t,e){let r=t._controlledReadableStream;r._state==="readable"&&(oi(t),hc(t),nw(r,e))}function Sd(t){let e=t._controlledReadableStream._state;return e==="errored"?null:e==="closed"?0:t._strategyHWM-t._queueTotalSize}function qo(t){let e=t._controlledReadableStream._state;return!t._closeRequested&&e==="readable"}function rw(t,e,r,n,o,i,s){e._controlledReadableStream=t,e._queue=void 0,e._queueTotalSize=void 0,oi(e),e._started=!1,e._closeRequested=!1,e._pullAgain=!1,e._pulling=!1,e._strategySizeAlgorithm=s,e._strategyHWM=i,e._pullAlgorithm=n,e._cancelAlgorithm=o,t._readableStreamController=e,er(Ue(r()),()=>(e._started=!0,Za(e),null),u=>(Yr(e,u),null))}function Ju(t){return new TypeError(`ReadableStreamDefaultController.prototype.${t} can only be used on a ReadableStreamDefaultController`)}function lB(t,e){return Ui(t._readableStreamController)?(function(r){let n,o,i,s,u,l=Lo(r),a=!1,c=!1,h=!1,w=!1,E=!1,T=pt(V=>{u=V});function A(V){Yh(V._closedPromise,Y=>(V!==l||(xr(i._readableStreamController,Y),xr(s._readableStreamController,Y),w&&E||u(void 0)),null))}function O(){Bi(l)&&($n(l),l=Lo(r),A(l)),Ja(l,{_chunkSteps:V=>{qi(()=>{c=!1,h=!1;let Y=V,Z=V;if(!w&&!E)try{Z=zy(V)}catch(ae){return xr(i._readableStreamController,ae),xr(s._readableStreamController,ae),void u(Kr(r,ae))}w||tc(i._readableStreamController,Y),E||tc(s._readableStreamController,Z),a=!1,c?P():h&&q()})},_closeSteps:()=>{a=!1,w||za(i._readableStreamController),E||za(s._readableStreamController),i._readableStreamController._pendingPullIntos.length>0&&rc(i._readableStreamController,0),s._readableStreamController._pendingPullIntos.length>0&&rc(s._readableStreamController,0),w&&E||u(void 0)},_errorSteps:()=>{a=!1}})}function C(V,Y){ri(l)&&($n(l),l=B_(r),A(l));let Z=Y?s:i,ae=Y?i:s;F_(l,V,1,{_chunkSteps:ie=>{qi(()=>{c=!1,h=!1;let ue=Y?E:w;if(Y?w:E)ue||nc(Z._readableStreamController,ie);else{let be;try{be=zy(ie)}catch(me){return xr(Z._readableStreamController,me),xr(ae._readableStreamController,me),void u(Kr(r,me))}ue||nc(Z._readableStreamController,ie),tc(ae._readableStreamController,be)}a=!1,c?P():h&&q()})},_closeSteps:ie=>{a=!1;let ue=Y?E:w,be=Y?w:E;ue||za(Z._readableStreamController),be||za(ae._readableStreamController),ie!==void 0&&(ue||nc(Z._readableStreamController,ie),!be&&ae._readableStreamController._pendingPullIntos.length>0&&rc(ae._readableStreamController,0)),ue&&be||u(void 0)},_errorSteps:()=>{a=!1}})}function P(){if(a)return c=!0,Ue(void 0);a=!0;let V=ed(i._readableStreamController);return V===null?O():C(V._view,!1),Ue(void 0)}function q(){if(a)return h=!0,Ue(void 0);a=!0;let V=ed(s._readableStreamController);return V===null?O():C(V._view,!0),Ue(void 0)}function U(V){if(w=!0,n=V,E){let Y=Ga([n,o]),Z=Kr(r,Y);u(Z)}return T}function k(V){if(E=!0,o=V,w){let Y=Ga([n,o]),Z=Kr(r,Y);u(Z)}return T}function W(){}return i=Zy(W,P,U),s=Zy(W,q,k),A(l),[i,s]})(t):(function(r){let n=Lo(r),o,i,s,u,l,a=!1,c=!1,h=!1,w=!1,E=pt(P=>{l=P});function T(){return a?(c=!0,Ue(void 0)):(a=!0,Ja(n,{_chunkSteps:P=>{qi(()=>{c=!1;let q=P,U=P;h||Bo(s._readableStreamController,q),w||Bo(u._readableStreamController,U),a=!1,c&&T()})},_closeSteps:()=>{a=!1,h||$i(s._readableStreamController),w||$i(u._readableStreamController),h&&w||l(void 0)},_errorSteps:()=>{a=!1}}),Ue(void 0))}function A(P){if(h=!0,o=P,w){let q=Ga([o,i]),U=Kr(r,q);l(U)}return E}function O(P){if(w=!0,i=P,h){let q=Ga([o,i]),U=Kr(r,q);l(U)}return E}function C(){}return s=es(C,T,A),u=es(C,T,O),Yh(n._closedPromise,P=>(Yr(s._readableStreamController,P),Yr(u._readableStreamController,P),h&&w||l(void 0),null)),[s,u]})(t)}function fB(t){return ct(e=t)&&e.getReader!==void 0?(function(r){let n;function o(){let s;try{s=r.read()}catch(u){return de(u)}return Wn(s,u=>{if(!ct(u))throw new TypeError("The promise returned by the reader.read() method must fulfill with an object");if(u.done)$i(n._readableStreamController);else{let l=u.value;Bo(n._readableStreamController,l)}})}function i(s){try{return Ue(r.cancel(s))}catch(u){return de(u)}}return n=es(Ya,o,i,0),n})(t.getReader()):(function(r){let n,o=__(r,"async");function i(){let u;try{u=w_(o)}catch(l){return de(l)}return Wn(Ue(u),l=>{if(!ct(l))throw new TypeError("The promise returned by the iterator.next() method must fulfill with an object");if(l.done)$i(n._readableStreamController);else{let a=l.value;Bo(n._readableStreamController,a)}})}function s(u){let l=o.iterator,a;try{a=Va(l,"return")}catch(c){return de(c)}return a===void 0?Ue(void 0):Wn(Gn(a,l,[u]),c=>{if(!ct(c))throw new TypeError("The promise returned by the iterator.return() method must fulfill with an object")})}return n=es(Ya,i,s,0),n})(t);var e}function hB(t,e,r){return Nr(t,r),n=>Gn(t,e,[n])}function dB(t,e,r){return Nr(t,r),n=>Gn(t,e,[n])}function pB(t,e,r){return Nr(t,r),n=>Fi(t,e,[n])}function vB(t,e){if((t=`${t}`)!="bytes")throw new TypeError(`${e} '${t}' is not a valid enumeration value for ReadableStreamType`);return t}function Xy(t,e){gn(t,e);let r=t?.preventAbort,n=t?.preventCancel,o=t?.preventClose,i=t?.signal;return i!==void 0&&(function(s,u){if(!(function(l){if(typeof l!="object"||l===null)return!1;try{return typeof l.aborted=="boolean"}catch{return!1}})(s))throw new TypeError(`${u} is not an AbortSignal.`)})(i,`${e} has member 'signal' that`),{preventAbort:!!r,preventCancel:!!n,preventClose:!!o,signal:i}}function es(t,e,r,n=1,o=()=>1){let i=Object.create(ut.prototype);return Id(i),rw(i,Object.create(vn.prototype),t,e,r,n,o),i}function Zy(t,e,r){let n=Object.create(ut.prototype);return Id(n),U_(n,Object.create(pn.prototype),t,e,r,0,void 0),n}function Id(t){t._state="readable",t._reader=void 0,t._storedError=void 0,t._disturbed=!1}function ti(t){return!!ct(t)&&!!Object.prototype.hasOwnProperty.call(t,"_readableStreamController")&&t instanceof ut}function ii(t){return t._reader!==void 0}function Kr(t,e){if(t._disturbed=!0,t._state==="closed")return Ue(void 0);if(t._state==="errored")return de(t._storedError);is(t);let r=t._reader;if(r!==void 0&&Bi(r)){let n=r._readIntoRequests;r._readIntoRequests=new tr,n.forEach(o=>{o._closeSteps(void 0)})}return Wn(t._readableStreamController[od](e),Ya)}function is(t){t._state="closed";let e=t._reader;if(e!==void 0&&(h_(e),ri(e))){let r=e._readRequests;e._readRequests=new tr,r.forEach(n=>{n._closeSteps()})}}function nw(t,e){t._state="errored",t._storedError=e;let r=t._reader;r!==void 0&&(cd(r,e),ri(r)?m_(r,e):j_(r,e))}function Di(t){return new TypeError(`ReadableStream.prototype.${t} can only be used on a ReadableStream`)}function iw(t,e){gn(t,e);let r=t?.highWaterMark;return Qh(r,"highWaterMark","QueuingStrategyInit"),{highWaterMark:ld(r)}}function e_(t){return new TypeError(`ByteLengthQueuingStrategy.prototype.${t} can only be used on a ByteLengthQueuingStrategy`)}function t_(t){return!!ct(t)&&!!Object.prototype.hasOwnProperty.call(t,"_byteLengthQueuingStrategyHighWaterMark")&&t instanceof ts}function r_(t){return new TypeError(`CountQueuingStrategy.prototype.${t} can only be used on a CountQueuingStrategy`)}function n_(t){return!!ct(t)&&!!Object.prototype.hasOwnProperty.call(t,"_countQueuingStrategyHighWaterMark")&&t instanceof rs}function mB(t,e,r){return Nr(t,r),n=>Gn(t,e,[n])}function gB(t,e,r){return Nr(t,r),n=>Fi(t,e,[n])}function yB(t,e,r){return Nr(t,r),(n,o)=>Gn(t,e,[n,o])}function _B(t,e,r){return Nr(t,r),n=>Gn(t,e,[n])}function i_(t){return!!ct(t)&&!!Object.prototype.hasOwnProperty.call(t,"_transformStreamController")&&t instanceof Wi}function sw(t,e){Yr(t._readable._readableStreamController,e),Td(t,e)}function Td(t,e){oc(t._transformStreamController),Xa(t._writable._writableStreamController,e),nd(t)}function nd(t){t._backpressure&&dc(t,!1)}function dc(t,e){t._backpressureChangePromise!==void 0&&t._backpressureChangePromise_resolve(),t._backpressureChangePromise=pt(r=>{t._backpressureChangePromise_resolve=r}),t._backpressure=e}function Qu(t){return!!ct(t)&&!!Object.prototype.hasOwnProperty.call(t,"_controlledTransformStream")&&t instanceof kn}function oc(t){t._transformAlgorithm=void 0,t._flushAlgorithm=void 0,t._cancelAlgorithm=void 0}function uw(t,e){let r=t._controlledTransformStream,n=r._readable._readableStreamController;if(!qo(n))throw new TypeError("Readable side is not in a state that permits enqueue");try{Bo(n,e)}catch(i){throw Td(r,i),r._readable._storedError}(function(i){return!tw(i)})(n)!==r._backpressure&&dc(r,!0)}function o_(t,e){return Wn(t._transformAlgorithm(e),void 0,r=>{throw sw(t._controlledTransformStream,r),r})}function Xu(t){return new TypeError(`TransformStreamDefaultController.prototype.${t} can only be used on a TransformStreamDefaultController`)}function Kh(t){t._finishPromise_resolve!==void 0&&(t._finishPromise_resolve(),t._finishPromise_resolve=void 0,t._finishPromise_reject=void 0)}function xo(t,e){t._finishPromise_reject!==void 0&&(Fo(t._finishPromise),t._finishPromise_reject(e),t._finishPromise_resolve=void 0,t._finishPromise_reject=void 0)}function a_(t){return new TypeError(`TransformStream.prototype.${t} can only be used on a TransformStream`)}var s_,id,J3,Q3,X3,Z3,qi,tr,u_,c_,od,ad,sd,$y,eB,Fn,kh,$h,Wh,ji,Mi,ns,sc,b_,E_,ni,pn,jn,Mn,dn,K_,ki,Jy,cB,vn,ut,ow,ts,aw,rs,Wi,kn,Od=X(()=>{s_=Ya;id=Promise,J3=Promise.resolve.bind(id),Q3=Promise.prototype.then,X3=Promise.reject.bind(id),Z3=J3;qi=t=>{if(typeof queueMicrotask=="function")qi=queueMicrotask;else{let e=Ue(void 0);qi=r=>mn(e,r)}return qi(t)};tr=class{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(e){let r=this._back,n=r;r._elements.length===16383&&(n={_elements:[],_next:void 0}),r._elements.push(e),n!==r&&(this._back=n,r._next=n),++this._size}shift(){let e=this._front,r=e,n=this._cursor,o=n+1,i=e._elements,s=i[n];return o===16384&&(r=e._next,o=0),--this._size,this._cursor=o,e!==r&&(this._front=r),i[n]=void 0,s}forEach(e){let r=this._cursor,n=this._front,o=n._elements;for(;!(r===o.length&&n._next===void 0||r===o.length&&(n=n._next,o=n._elements,r=0,o.length===0));)e(o[r]),++r}peek(){let e=this._front,r=this._cursor;return e._elements[r]}},u_=Symbol("[[AbortSteps]]"),c_=Symbol("[[ErrorSteps]]"),od=Symbol("[[CancelSteps]]"),ad=Symbol("[[PullSteps]]"),sd=Symbol("[[ReleaseSteps]]");$y=Number.isFinite||function(t){return typeof t=="number"&&isFinite(t)},eB=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)};Fn=class{constructor(e){if(Hn(e,1,"ReadableStreamDefaultReader"),hd(e,"First parameter"),ii(e))throw new TypeError("This stream has already been locked for exclusive reading by another reader");l_(this,e),this._readRequests=new tr}get closed(){return ri(this)?this._closedPromise:de(Gu("closed"))}cancel(e=void 0){return ri(this)?this._ownerReadableStream===void 0?de(ac("cancel")):ud(this,e):de(Gu("cancel"))}read(){if(!ri(this))return de(Gu("read"));if(this._ownerReadableStream===void 0)return de(ac("read from"));let e,r,n=pt((o,i)=>{e=o,r=i});return Ja(this,{_chunkSteps:o=>e({value:o,done:!1}),_closeSteps:()=>e({value:void 0,done:!0}),_errorSteps:o=>r(o)}),n}releaseLock(){if(!ri(this))throw Gu("releaseLock");this._ownerReadableStream!==void 0&&(function(e){$n(e);let r=new TypeError("Reader was released");m_(e,r)})(this)}};Object.defineProperties(Fn.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),De(Fn.prototype.cancel,"cancel"),De(Fn.prototype.read,"read"),De(Fn.prototype.releaseLock,"releaseLock"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Fn.prototype,Symbol.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});ji=t=>(ji=typeof t.transfer=="function"?e=>e.transfer():typeof structuredClone=="function"?e=>structuredClone(e,{transfer:[e]}):e=>e,ji(t)),Mi=t=>(Mi=typeof t.detached=="boolean"?e=>e.detached:e=>e.byteLength===0,Mi(t));ns=(Wh=(kh=Symbol.asyncIterator)!==null&&kh!==void 0?kh:($h=Symbol.for)===null||$h===void 0?void 0:$h.call(Symbol,"Symbol.asyncIterator"))!==null&&Wh!==void 0?Wh:"@@asyncIterator";sc=class{constructor(e,r){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=e,this._preventCancel=r}next(){let e=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?Wn(this._ongoingPromise,e,e):e(),this._ongoingPromise}return(e){let r=()=>this._returnSteps(e);return this._ongoingPromise=this._ongoingPromise?Wn(this._ongoingPromise,r,r):r(),this._ongoingPromise}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});let e=this._reader,r,n,o=pt((i,s)=>{r=i,n=s});return Ja(e,{_chunkSteps:i=>{this._ongoingPromise=void 0,qi(()=>r({value:i,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,$n(e),r({value:void 0,done:!0})},_errorSteps:i=>{this._ongoingPromise=void 0,this._isFinished=!0,$n(e),n(i)}}),o}_returnSteps(e){if(this._isFinished)return Promise.resolve({value:e,done:!0});this._isFinished=!0;let r=this._reader;if(!this._preventCancel){let n=ud(r,e);return $n(r),Wn(n,()=>({value:e,done:!0}))}return $n(r),Ue({value:e,done:!0})}},b_={next(){return Gy(this)?this._asyncIteratorImpl.next():de(Vy("next"))},return(t){return Gy(this)?this._asyncIteratorImpl.return(t):de(Vy("return"))},[ns](){return this}};Object.defineProperty(b_,ns,{enumerable:!1});E_=Number.isNaN||function(t){return t!=t};ni=class{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!Hh(this))throw Gh("view");return this._view}respond(e){if(!Hh(this))throw Gh("respond");if(Hn(e,1,"respond"),e=fd(e,"First parameter"),this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");if(Mi(this._view.buffer))throw new TypeError("The BYOB request's buffer has been detached and so cannot be used as a response");rc(this._associatedReadableByteStreamController,e)}respondWithNewView(e){if(!Hh(this))throw Gh("respondWithNewView");if(Hn(e,1,"respondWithNewView"),!ArrayBuffer.isView(e))throw new TypeError("You can only respond with array buffer views");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");if(Mi(e.buffer))throw new TypeError("The given view's buffer has been detached and so cannot be used as a response");nc(this._associatedReadableByteStreamController,e)}};Object.defineProperties(ni.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),De(ni.prototype.respond,"respond"),De(ni.prototype.respondWithNewView,"respondWithNewView"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(ni.prototype,Symbol.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});pn=class{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!Ui(this))throw Ha("byobRequest");return ed(this)}get desiredSize(){if(!Ui(this))throw Ha("desiredSize");return D_(this)}close(){if(!Ui(this))throw Ha("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");let e=this._controlledReadableByteStream._state;if(e!=="readable")throw new TypeError(`The stream (in ${e} state) is not in the readable state and cannot be closed`);za(this)}enqueue(e){if(!Ui(this))throw Ha("enqueue");if(Hn(e,1,"enqueue"),!ArrayBuffer.isView(e))throw new TypeError("chunk must be an array buffer view");if(e.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(e.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");let r=this._controlledReadableByteStream._state;if(r!=="readable")throw new TypeError(`The stream (in ${r} state) is not in the readable state and cannot be enqueued to`);tc(this,e)}error(e=void 0){if(!Ui(this))throw Ha("error");xr(this,e)}[od](e){I_(this),oi(this);let r=this._cancelAlgorithm(e);return vc(this),r}[ad](e){let r=this._controlledReadableByteStream;if(this._queueTotalSize>0)return void L_(this,e);let n=this._autoAllocateChunkSize;if(n!==void 0){let o;try{o=new ArrayBuffer(n)}catch(s){return void e._errorSteps(s)}let i={buffer:o,bufferByteLength:n,byteOffset:0,byteLength:n,bytesFilled:0,minimumFill:1,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(i)}p_(r,e),Hi(this)}[sd](){if(this._pendingPullIntos.length>0){let e=this._pendingPullIntos.peek();e.readerType="none",this._pendingPullIntos=new tr,this._pendingPullIntos.push(e)}}};Object.defineProperties(pn.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),De(pn.prototype.close,"close"),De(pn.prototype.enqueue,"enqueue"),De(pn.prototype.error,"error"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(pn.prototype,Symbol.toStringTag,{value:"ReadableByteStreamController",configurable:!0});jn=class{constructor(e){if(Hn(e,1,"ReadableStreamBYOBReader"),hd(e,"First parameter"),ii(e))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!Ui(e._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");l_(this,e),this._readIntoRequests=new tr}get closed(){return Bi(this)?this._closedPromise:de(Vu("closed"))}cancel(e=void 0){return Bi(this)?this._ownerReadableStream===void 0?de(ac("cancel")):ud(this,e):de(Vu("cancel"))}read(e,r={}){if(!Bi(this))return de(Vu("read"));if(!ArrayBuffer.isView(e))return de(new TypeError("view must be an array buffer view"));if(e.byteLength===0)return de(new TypeError("view must have non-zero byteLength"));if(e.buffer.byteLength===0)return de(new TypeError("view's buffer must have non-zero byteLength"));if(Mi(e.buffer))return de(new TypeError("view's buffer has been detached"));let n;try{n=(function(l,a){var c;return gn(l,a),{min:fd((c=l?.min)!==null&&c!==void 0?c:1,`${a} has member 'min' that`)}})(r,"options")}catch(l){return de(l)}let o=n.min;if(o===0)return de(new TypeError("options.min must be greater than 0"));if((function(l){return S_(l.constructor)})(e)){if(o>e.byteLength)return de(new RangeError("options.min must be less than or equal to view's byteLength"))}else if(o>e.length)return de(new RangeError("options.min must be less than or equal to view's length"));if(this._ownerReadableStream===void 0)return de(ac("read from"));let i,s,u=pt((l,a)=>{i=l,s=a});return F_(this,e,o,{_chunkSteps:l=>i({value:l,done:!1}),_closeSteps:l=>i({value:l,done:!0}),_errorSteps:l=>s(l)}),u}releaseLock(){if(!Bi(this))throw Vu("releaseLock");this._ownerReadableStream!==void 0&&(function(e){$n(e);let r=new TypeError("Reader was released");j_(e,r)})(this)}};Object.defineProperties(jn.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),De(jn.prototype.cancel,"cancel"),De(jn.prototype.read,"read"),De(jn.prototype.releaseLock,"releaseLock"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(jn.prototype,Symbol.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});Mn=class{constructor(e={},r={}){e===void 0?e=null:d_(e,"First parameter");let n=cc(r,"Second parameter"),o=(function(s,u){gn(s,u);let l=s?.abort,a=s?.close,c=s?.start,h=s?.type,w=s?.write;return{abort:l===void 0?void 0:iB(l,s,`${u} has member 'abort' that`),close:a===void 0?void 0:oB(a,s,`${u} has member 'close' that`),start:c===void 0?void 0:aB(c,s,`${u} has member 'start' that`),write:w===void 0?void 0:sB(w,s,`${u} has member 'write' that`),type:h}})(e,"First parameter");if($_(this),o.type!==void 0)throw new RangeError("Invalid type is specified");let i=uc(n);(function(s,u,l,a){let c=Object.create(ki.prototype),h,w,E,T;h=u.start!==void 0?()=>u.start(c):()=>{},w=u.write!==void 0?A=>u.write(A,c):()=>Ue(void 0),E=u.close!==void 0?()=>u.close():()=>Ue(void 0),T=u.abort!==void 0?A=>u.abort(A):()=>Ue(void 0),Y_(s,c,h,w,E,T,l,a)})(this,o,Qa(n,1),i)}get locked(){if(!No(this))throw Ku("locked");return Uo(this)}abort(e=void 0){return No(this)?Uo(this)?de(new TypeError("Cannot abort a stream that already has a writer")):lc(this,e):de(Ku("abort"))}close(){return No(this)?Uo(this)?de(new TypeError("Cannot close a stream that already has a writer")):yn(this)?de(new TypeError("Cannot close an already-closing stream")):W_(this):de(Ku("close"))}getWriter(){if(!No(this))throw Ku("getWriter");return k_(this)}};Object.defineProperties(Mn.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),De(Mn.prototype.abort,"abort"),De(Mn.prototype.close,"close"),De(Mn.prototype.getWriter,"getWriter"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Mn.prototype,Symbol.toStringTag,{value:"WritableStream",configurable:!0});dn=class{constructor(e){if(Hn(e,1,"WritableStreamDefaultWriter"),M_(e,"First parameter"),Uo(e))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=e,e._writer=this;let r=e._state;if(r==="writable")!yn(e)&&e._backpressure?gc(this):Yy(this),ic(this);else if(r==="erroring")rd(this,e._storedError),ic(this);else if(r==="closed")Yy(this),ic(n=this),Z_(n);else{let o=e._storedError;rd(this,o),X_(this,o)}var n}get closed(){return Ni(this)?this._closedPromise:de(Li("closed"))}get desiredSize(){if(!Ni(this))throw Li("desiredSize");if(this._ownerWritableStream===void 0)throw Ka("desiredSize");return(function(e){let r=e._ownerWritableStream,n=r._state;return n==="errored"||n==="erroring"?null:n==="closed"?0:J_(r._writableStreamController)})(this)}get ready(){return Ni(this)?this._readyPromise:de(Li("ready"))}abort(e=void 0){return Ni(this)?this._ownerWritableStream===void 0?de(Ka("abort")):(function(r,n){return lc(r._ownerWritableStream,n)})(this,e):de(Li("abort"))}close(){if(!Ni(this))return de(Li("close"));let e=this._ownerWritableStream;return e===void 0?de(Ka("close")):yn(e)?de(new TypeError("Cannot close an already-closing stream")):H_(this)}releaseLock(){if(!Ni(this))throw Li("releaseLock");this._ownerWritableStream!==void 0&&V_(this)}write(e=void 0){return Ni(this)?this._ownerWritableStream===void 0?de(Ka("write to")):z_(this,e):de(Li("write"))}};Object.defineProperties(dn.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),De(dn.prototype.abort,"abort"),De(dn.prototype.close,"close"),De(dn.prototype.releaseLock,"releaseLock"),De(dn.prototype.write,"write"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(dn.prototype,Symbol.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});K_={},ki=class{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!Vh(this))throw zh("abortReason");return this._abortReason}get signal(){if(!Vh(this))throw zh("signal");if(this._abortController===void 0)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(e=void 0){if(!Vh(this))throw zh("error");this._controlledWritableStream._state==="writable"&&Q_(this,e)}[u_](e){let r=this._abortAlgorithm(e);return fc(this),r}[c_](){oi(this)}};Object.defineProperties(ki.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(ki.prototype,Symbol.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});Jy=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof global<"u"?global:void 0,cB=(function(){let t=Jy?.DOMException;return(function(e){if(typeof e!="function"&&typeof e!="object"||e.name!=="DOMException")return!1;try{return new e,!0}catch{return!1}})(t)?t:void 0})()||(function(){let t=function(e,r){this.message=e||"",this.name=r||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return De(t,"DOMException"),t.prototype=Object.create(Error.prototype),Object.defineProperty(t.prototype,"constructor",{value:t,writable:!0,configurable:!0}),t})();vn=class{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Yu(this))throw Ju("desiredSize");return Sd(this)}close(){if(!Yu(this))throw Ju("close");if(!qo(this))throw new TypeError("The stream is not in a state that permits close");$i(this)}enqueue(e=void 0){if(!Yu(this))throw Ju("enqueue");if(!qo(this))throw new TypeError("The stream is not in a state that permits enqueue");return Bo(this,e)}error(e=void 0){if(!Yu(this))throw Ju("error");Yr(this,e)}[od](e){oi(this);let r=this._cancelAlgorithm(e);return hc(this),r}[ad](e){let r=this._controlledReadableStream;if(this._queue.length>0){let n=Xh(this);this._closeRequested&&this._queue.length===0?(hc(this),is(r)):Za(this),e._chunkSteps(n)}else p_(r,e),Za(this)}[sd](){}};Object.defineProperties(vn.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),De(vn.prototype.close,"close"),De(vn.prototype.enqueue,"enqueue"),De(vn.prototype.error,"error"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(vn.prototype,Symbol.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});ut=class{constructor(e={},r={}){e===void 0?e=null:d_(e,"First parameter");let n=cc(r,"Second parameter"),o=(function(i,s){gn(i,s);let u=i,l=u?.autoAllocateChunkSize,a=u?.cancel,c=u?.pull,h=u?.start,w=u?.type;return{autoAllocateChunkSize:l===void 0?void 0:fd(l,`${s} has member 'autoAllocateChunkSize' that`),cancel:a===void 0?void 0:hB(a,u,`${s} has member 'cancel' that`),pull:c===void 0?void 0:dB(c,u,`${s} has member 'pull' that`),start:h===void 0?void 0:pB(h,u,`${s} has member 'start' that`),type:w===void 0?void 0:vB(w,`${s} has member 'type' that`)}})(e,"First parameter");if(Id(this),o.type==="bytes"){if(n.size!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");(function(i,s,u){let l=Object.create(pn.prototype),a,c,h;a=s.start!==void 0?()=>s.start(l):()=>{},c=s.pull!==void 0?()=>s.pull(l):()=>Ue(void 0),h=s.cancel!==void 0?E=>s.cancel(E):()=>Ue(void 0);let w=s.autoAllocateChunkSize;if(w===0)throw new TypeError("autoAllocateChunkSize must be greater than 0");U_(i,l,a,c,h,u,w)})(this,o,Qa(n,0))}else{let i=uc(n);(function(s,u,l,a){let c=Object.create(vn.prototype),h,w,E;h=u.start!==void 0?()=>u.start(c):()=>{},w=u.pull!==void 0?()=>u.pull(c):()=>Ue(void 0),E=u.cancel!==void 0?T=>u.cancel(T):()=>Ue(void 0),rw(s,c,h,w,E,l,a)})(this,o,Qa(n,1),i)}}get locked(){if(!ti(this))throw Di("locked");return ii(this)}cancel(e=void 0){return ti(this)?ii(this)?de(new TypeError("Cannot cancel a stream that already has a reader")):Kr(this,e):de(Di("cancel"))}getReader(e=void 0){if(!ti(this))throw Di("getReader");return(function(r,n){gn(r,n);let o=r?.mode;return{mode:o===void 0?void 0:rB(o,`${n} has member 'mode' that`)}})(e,"First parameter").mode===void 0?Lo(this):B_(this)}pipeThrough(e,r={}){if(!ti(this))throw Di("pipeThrough");Hn(e,1,"pipeThrough");let n=(function(i,s){gn(i,s);let u=i?.readable;Qh(u,"readable","ReadableWritablePair"),hd(u,`${s} has member 'readable' that`);let l=i?.writable;return Qh(l,"writable","ReadableWritablePair"),M_(l,`${s} has member 'writable' that`),{readable:u,writable:l}})(e,"First parameter"),o=Xy(r,"Second parameter");if(ii(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(Uo(n.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");return Fo(Qy(this,n.writable,o.preventClose,o.preventAbort,o.preventCancel,o.signal)),n.readable}pipeTo(e,r={}){if(!ti(this))return de(Di("pipeTo"));if(e===void 0)return de("Parameter 1 is required in 'pipeTo'.");if(!No(e))return de(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let n;try{n=Xy(r,"Second parameter")}catch(o){return de(o)}return ii(this)?de(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):Uo(e)?de(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):Qy(this,e,n.preventClose,n.preventAbort,n.preventCancel,n.signal)}tee(){if(!ti(this))throw Di("tee");return Ga(lB(this))}values(e=void 0){if(!ti(this))throw Di("values");return(function(r,n){let o=Lo(r),i=new sc(o,n),s=Object.create(b_);return s._asyncIteratorImpl=i,s})(this,(function(r,n){return gn(r,n),{preventCancel:!!r?.preventCancel}})(e,"First parameter").preventCancel)}[ns](e){return this.values(e)}static from(e){return fB(e)}};Object.defineProperties(ut,{from:{enumerable:!0}}),Object.defineProperties(ut.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),De(ut.from,"from"),De(ut.prototype.cancel,"cancel"),De(ut.prototype.getReader,"getReader"),De(ut.prototype.pipeThrough,"pipeThrough"),De(ut.prototype.pipeTo,"pipeTo"),De(ut.prototype.tee,"tee"),De(ut.prototype.values,"values"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(ut.prototype,Symbol.toStringTag,{value:"ReadableStream",configurable:!0}),Object.defineProperty(ut.prototype,ns,{value:ut.prototype.values,writable:!0,configurable:!0});ow=t=>t.byteLength;De(ow,"size");ts=class{constructor(e){Hn(e,1,"ByteLengthQueuingStrategy"),e=iw(e,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=e.highWaterMark}get highWaterMark(){if(!t_(this))throw e_("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!t_(this))throw e_("size");return ow}};Object.defineProperties(ts.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(ts.prototype,Symbol.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});aw=()=>1;De(aw,"size");rs=class{constructor(e){Hn(e,1,"CountQueuingStrategy"),e=iw(e,"First parameter"),this._countQueuingStrategyHighWaterMark=e.highWaterMark}get highWaterMark(){if(!n_(this))throw r_("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!n_(this))throw r_("size");return aw}};Object.defineProperties(rs.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(rs.prototype,Symbol.toStringTag,{value:"CountQueuingStrategy",configurable:!0});Wi=class{constructor(e={},r={},n={}){e===void 0&&(e=null);let o=cc(r,"Second parameter"),i=cc(n,"Third parameter"),s=(function(w,E){gn(w,E);let T=w?.cancel,A=w?.flush,O=w?.readableType,C=w?.start,P=w?.transform,q=w?.writableType;return{cancel:T===void 0?void 0:_B(T,w,`${E} has member 'cancel' that`),flush:A===void 0?void 0:mB(A,w,`${E} has member 'flush' that`),readableType:O,start:C===void 0?void 0:gB(C,w,`${E} has member 'start' that`),transform:P===void 0?void 0:yB(P,w,`${E} has member 'transform' that`),writableType:q}})(e,"First parameter");if(s.readableType!==void 0)throw new RangeError("Invalid readableType specified");if(s.writableType!==void 0)throw new RangeError("Invalid writableType specified");let u=Qa(i,0),l=uc(i),a=Qa(o,1),c=uc(o),h;(function(w,E,T,A,O,C){function P(){return E}function q(Y){return(function(Z,ae){let ie=Z._transformStreamController;return Z._backpressure?Wn(Z._backpressureChangePromise,()=>{let ue=Z._writable;if(ue._state==="erroring")throw ue._storedError;return o_(ie,ae)}):o_(ie,ae)})(w,Y)}function U(Y){return(function(Z,ae){let ie=Z._transformStreamController;if(ie._finishPromise!==void 0)return ie._finishPromise;let ue=Z._readable;ie._finishPromise=pt((me,Ot)=>{ie._finishPromise_resolve=me,ie._finishPromise_reject=Ot});let be=ie._cancelAlgorithm(ae);return oc(ie),er(be,()=>(ue._state==="errored"?xo(ie,ue._storedError):(Yr(ue._readableStreamController,ae),Kh(ie)),null),me=>(Yr(ue._readableStreamController,me),xo(ie,me),null)),ie._finishPromise})(w,Y)}function k(){return(function(Y){let Z=Y._transformStreamController;if(Z._finishPromise!==void 0)return Z._finishPromise;let ae=Y._readable;Z._finishPromise=pt((ue,be)=>{Z._finishPromise_resolve=ue,Z._finishPromise_reject=be});let ie=Z._flushAlgorithm();return oc(Z),er(ie,()=>(ae._state==="errored"?xo(Z,ae._storedError):($i(ae._readableStreamController),Kh(Z)),null),ue=>(Yr(ae._readableStreamController,ue),xo(Z,ue),null)),Z._finishPromise})(w)}function W(){return(function(Y){return dc(Y,!1),Y._backpressureChangePromise})(w)}function V(Y){return(function(Z,ae){let ie=Z._transformStreamController;if(ie._finishPromise!==void 0)return ie._finishPromise;let ue=Z._writable;ie._finishPromise=pt((me,Ot)=>{ie._finishPromise_resolve=me,ie._finishPromise_reject=Ot});let be=ie._cancelAlgorithm(ae);return oc(ie),er(be,()=>(ue._state==="errored"?xo(ie,ue._storedError):(Xa(ue._writableStreamController,ae),nd(Z),Kh(ie)),null),me=>(Xa(ue._writableStreamController,me),nd(Z),xo(ie,me),null)),ie._finishPromise})(w,Y)}w._writable=(function(Y,Z,ae,ie,ue=1,be=()=>1){let me=Object.create(Mn.prototype);return $_(me),Y_(me,Object.create(ki.prototype),Y,Z,ae,ie,ue,be),me})(P,q,k,U,T,A),w._readable=es(P,W,V,O,C),w._backpressure=void 0,w._backpressureChangePromise=void 0,w._backpressureChangePromise_resolve=void 0,dc(w,!0),w._transformStreamController=void 0})(this,pt(w=>{h=w}),a,c,u,l),(function(w,E){let T=Object.create(kn.prototype),A,O,C;A=E.transform!==void 0?P=>E.transform(P,T):P=>{try{return uw(T,P),Ue(void 0)}catch(q){return de(q)}},O=E.flush!==void 0?()=>E.flush(T):()=>Ue(void 0),C=E.cancel!==void 0?P=>E.cancel(P):()=>Ue(void 0),(function(P,q,U,k,W){q._controlledTransformStream=P,P._transformStreamController=q,q._transformAlgorithm=U,q._flushAlgorithm=k,q._cancelAlgorithm=W,q._finishPromise=void 0,q._finishPromise_resolve=void 0,q._finishPromise_reject=void 0})(w,T,A,O,C)})(this,s),s.start!==void 0?h(s.start(this._transformStreamController)):h(void 0)}get readable(){if(!i_(this))throw a_("readable");return this._readable}get writable(){if(!i_(this))throw a_("writable");return this._writable}};Object.defineProperties(Wi.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Wi.prototype,Symbol.toStringTag,{value:"TransformStream",configurable:!0});kn=class{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Qu(this))throw Xu("desiredSize");return Sd(this._controlledTransformStream._readable._readableStreamController)}enqueue(e=void 0){if(!Qu(this))throw Xu("enqueue");uw(this,e)}error(e=void 0){if(!Qu(this))throw Xu("error");var r;r=e,sw(this._controlledTransformStream,r)}terminate(){if(!Qu(this))throw Xu("terminate");(function(e){let r=e._controlledTransformStream;$i(r._readable._readableStreamController);let n=new TypeError("TransformStream terminated");Td(r,n)})(this)}};Object.defineProperties(kn.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),De(kn.prototype.enqueue,"enqueue"),De(kn.prototype.error,"error"),De(kn.prototype.terminate,"terminate"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(kn.prototype,Symbol.toStringTag,{value:"TransformStreamDefaultController",configurable:!0})});function IB(){if(typeof wx>"u"||typeof Page>"u"||!wx.getSystemInfoSync||!wx.getStorageSync||!wx.setStorageSync||!wx.connectSocket||!wx.request)return!1;try{if(!wx.getSystemInfoSync()||wx.getSystemInfoSync().AppPlatform==="qq")return!1}catch{return!1}return!0}function TB(){return typeof App>"u"&&typeof getApp>"u"&&!wx.onAppHide&&!wx.offAppHide&&!wx.onAppShow&&!wx.offAppShow}function Pd(t){var e={},r=t.replace(/^[?#]/,"");if(!r)return e;var n=r.split("&");return n.forEach(function(o){var i=o.split("="),s=i[0],u=i[1];s=decodeURIComponent(s),u=decodeURIComponent(u),s&&(e[s]?Array.isArray(e[s])?e[s].push(u):e[s]=[e[s],u]:e[s]=u)}),e}function OB(t){var e={root:{globalThis:{}},reqClass:yc,wsClass:Cd,captchaOptions:{openURIWithCallback:function(r){var n=t.EventBus,o={},i=r;console.log("openURIWithCallback",r);var s=r.match(/^(data:.*?)(\?[^#\s]*)?$/);if(s){i=s[1],console.log("openURIWithCallback url",i);var u=s[2];u&&(o=Pd(u))}console.log("openURIWithCallback queryObj",o);var l=o.token,a=SB(o,["token"]);return/^data:/.test(i)&&!l?Promise.reject({error:"invalid_argument",error_description:"invalie captcha data: "+r}):l?new Promise(function(c){console.log("wait for captcha..."),n.$emit("CAPTCHA_DATA_CHANGE",jo(jo({},a),{token:l,url:i})),n.$once("RESOLVE_CAPTCHA_DATA",function(h){c(h)})}):Promise.reject({error:"unimplemented",error_description:"need to impl captcha data"})}},localStorage:Rd,primaryStorage:Vn.StorageType.local,getAppSign:function(){var r=wx.getAccountInfoSync();return TB()?r&&r.plugin?r.plugin.appId:"":r&&r.miniProgram?r.miniProgram.appId:""}};return e}var Vn,wB,jo,bB,EB,SB,Ad,yc,Rd,Cd,AB,Vt,xd=X(()=>{Vn=st(Ci());Od();wB=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)o.hasOwnProperty(i)&&(n[i]=o[i])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),jo=function(){return jo=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},jo.apply(this,arguments)},bB=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},EB=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},SB=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]]);return r};Ad="Error when aborting requestTask",yc=(function(t){wB(e,t);function e(r){r===void 0&&(r={});var n=t.call(this)||this,o=r.timeout,i=r.timeoutMsg,s=r.restrictedMethods;return n._timeout=o||0,n._timeoutMsg=i||"\u8BF7\u6C42\u8D85\u65F6",n._restrictedMethods=s||["get","post","upload","download"],n}return e.prototype.post=function(r){var n=this;return new Promise(function(o,i){var s=r.url,u=r.data,l=r.headers,a=wx.request({url:(0,Vn.formatUrl)("https:",s),data:u,timeout:n._timeout,method:"POST",header:l,success:function(c){c.statusCode>=200&&c.statusCode<300?o({statusCode:c.statusCode,status:c.statusCode,data:c.data}):i(c)},fail:function(c){i(c)},complete:function(c){if(!(!c||!c.errMsg)&&!(!n._timeout||n._restrictedMethods.indexOf("post")===-1)){var h=c.errMsg;if(h==="request:fail timeout"){console.warn(n._timeoutMsg);try{a.abort()}catch{}}}}})})},e.prototype.get=function(r){var n=this;return new Promise(function(o,i){var s=r.url,u=r.body,l=r.headers,a=(0,Vn.formatUrl)("https:",s),c=wx.request({url:a,data:u,timeout:n._timeout,method:"GET",header:l,success:function(h){h.statusCode>=200&&h.statusCode<300?o({statusCode:h.statusCode,status:h.statusCode,data:h.data}):i(h)},fail:function(h){i(h)},complete:function(h){if(!(!h||!h.errMsg)&&!(!n._timeout||n._restrictedMethods.indexOf("get")===-1)){var w=h.errMsg;if(w.includes("timeout")){console.warn(n._timeoutMsg);try{c.abort()}catch(E){console.warn(Ad,E)}}}}})})},e.prototype.upload=function(r){var n=this,o=this;return new Promise(function(i){return bB(n,void 0,void 0,function(){var s,u,l,a,c,h;return EB(this,function(w){return s=r.url,u=r.file,l=r.data,a=r.headers,c=r.onUploadProgress,h=wx.uploadFile({url:s,filePath:u,name:"file",formData:jo({},l),header:a,timeout:this._timeout,success:function(E){var T={statusCode:E.statusCode,data:E.data||{}};E.statusCode===200&&l.success_action_status&&(T.statusCode=parseInt(l.success_action_status,10)),i(T)},fail:function(E){i(E)},complete:function(E){if(!(!E||!E.errMsg)&&!(!o._timeout||o._restrictedMethods.indexOf("upload")===-1)){var T=E.errMsg;if(T==="request:fail timeout"){console.warn(o._timeoutMsg);try{h.abort()}catch{}}}}}),c&&h.onProgressUpdate(function(E){c(E)}),[2]})})})},e.prototype.download=function(r){var n=this,o=this;return new Promise(function(i,s){var u=r.url,l=r.headers,a=wx.downloadFile({url:(0,Vn.formatUrl)("https:",u),header:l,timeout:n._timeout,success:function(c){c.statusCode===200&&c.tempFilePath?i({statusCode:200,tempFilePath:c.tempFilePath}):i(c)},fail:function(c){s(c)},complete:function(c){if(!(!c||!c.errMsg)&&!(!o._timeout||o._restrictedMethods.indexOf("download")===-1)){var h=c.errMsg;if(h==="request:fail timeout"){console.warn(o._timeoutMsg);try{a.abort()}catch{}}}}})})},e.prototype.fetch=function(r){var n=r.url,o=r.body,i=r.enableAbort,s=r.headers,u=r.method,l=r.stream,a=l===void 0?!1:l,c=r.signal,h=r.timeout,w=this,E=h??this._timeout,T=null,A=new ut({start:function(O){T=O},cancel:function(){T=null}});return new Promise(function(O,C){a&&O({data:A});var P=wx.request({url:(0,Vn.formatUrl)("https:",n),data:o,timeout:E,method:u.toUpperCase(),header:s,success:function(U){var k;(k=T)===null||k===void 0||k.close(),!a&&O(U)},fail:function(U){var k;if((k=T)===null||k===void 0||k.close(),C(U),a)throw U},complete:function(U){if(!(!U||!U.errMsg)&&!(!E||w._restrictedMethods.indexOf("post")===-1||!i)){var k=U.errMsg;if(k==="request:fail timeout"){console.warn(w._timeoutMsg);try{P.abort()}catch(W){console.warn(Ad,W)}}}},enableChunked:a});if(P.onChunkReceived(function(U){var k;(k=T)===null||k===void 0||k.enqueue(new Uint8Array(U.data))}),c){var q=function(){try{P.abort()}catch(U){console.warn(Ad,U)}};c.aborted?q():c.addEventListener("abort",function(){return q()})}})},e})(Vn.AbstractSDKRequest),Rd={setItem:function(t,e){wx.setStorageSync(t,e)},getItem:function(t){return wx.getStorageSync(t)},removeItem:function(t){wx.removeStorageSync(t)},clear:function(){wx.clearStorageSync()}},Cd=(function(){function t(e,r){r===void 0&&(r={});var n=wx.connectSocket(jo({url:e},r)),o={set onopen(i){n.onOpen(i)},set onmessage(i){n.onMessage(i)},set onclose(i){n.onClose(i)},set onerror(i){n.onError(i)},send:function(i){return n.send({data:i})},close:function(i,s){return n.close({code:i,reason:s})},get readyState(){return n.readyState},CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3};return o}return t})();AB={genAdapter:OB,isMatch:IB,runtime:"wx_mp"},Vt=AB});var cw,os,RB,Jr,lw,Nd=X(()=>{xd();cw=st(Ci()),os=function(){return os=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},os.apply(this,arguments)},RB=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]]);return r},Jr={},lw=function(){yc.prototype.upload=function(e){var r=this,n=this;return new Promise(function(o){var i=e.url,s=e.file,u=e.data,l=e.headers,a=wx.getFileSystemManager(),c=wx.request({url:i,method:e.method,header:os({"content-type":" "},l),data:a.readFileSync(s),timeout:r._timeout,success:function(h){var w={statusCode:h.statusCode,data:h.data||{}};h.statusCode===200&&u?.success_action_status&&(w.statusCode=parseInt(u.success_action_status,10)),o(w)},fail:function(h){o(h)},complete:function(h){if(h?.errMsg&&!(!n._timeout||n._restrictedMethods.indexOf("upload")===-1)){var w=h.errMsg;if(w==="request:fail timeout"){console.warn(n._timeoutMsg);try{c.abort()}catch{}}}}})})};function t(){return typeof App>"u"&&typeof getApp>"u"&&!wx.onAppHide&&!wx.offAppHide&&!wx.onAppShow&&!wx.offAppShow}return Vt.genAdapter=function(r){var n={root:{globalThis:{}},reqClass:yc,wsClass:Cd,captchaOptions:{openURIWithCallback:function(o){var i=r.EventBus,s={},u=o;console.log("openURIWithCallback",o);var l=o.match(/^(data:.*?)(\?[^#\s]*)?$/);if(l){u=l[1],console.log("openURIWithCallback url",u);var a=l[2];a&&(s=Pd(a))}console.log("openURIWithCallback queryObj",s);var c=s.token,h=RB(s,["token"]);return/^data:/.test(u)&&!c?Promise.reject({error:"invalid_argument",error_description:"invalie captcha data: ".concat(o)}):c?new Promise(function(w){console.log("wait for captcha..."),i.$emit("CAPTCHA_DATA_CHANGE",os(os({},h),{token:c,url:u})),i.$once("RESOLVE_CAPTCHA_DATA",function(E){w(E)})}):Promise.reject({error:"unimplemented",error_description:"need to impl captcha data"})}},localStorage:Rd,primaryStorage:cw.StorageType.local,getAppSign:function(){var o=wx.getAccountInfoSync();return t()?o&&o.plugin?o.plugin.appId:"":o&&o.miniProgram?o.miniProgram.appId:""}};return n},Vt}});function Ud(t){var e=t.env,r=t.platformInfo,n="".concat(CB,"_").concat(e),o={userInfoKey:n};Ld[e]=Ld[e]||new fw(Mo(Mo({},t),{keys:o,platformInfo:r})),Dd[e]=Dd[e]||new fw(Mo(Mo({},t),{keys:o,platformInfo:r,persistence:"local"}))}function hw(t){return Ld[t]}function _c(t){return Dd[t]}var Mo,CB,fw,Ld,Dd,Bd=X(()=>{Lt();Mo=function(){return Mo=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Mo.apply(this,arguments)},CB="user_info",fw=Mu.CloudbaseCache,Ld={},Dd={}});function mw(t){pw=t}function ko(){return pw}function gw(t){vw=t,xB(t)}function yw(){return vw}function bw(t){return ww.find(function(e){return LB.filter(function(r){return t[r]!=null}).every(function(r){return e[r]===t[r]})})}function as(t){var e,r;t.protocol&&!/:$/.test(t.protocol)&&(t.protocol="".concat(t.protocol,":"));var n=bw(t);n?(t.baseUrl!=null&&(n.baseUrl=t.baseUrl),t.protocol!=null&&(n.protocol=t.protocol)):ww.push(wc(wc({},t),{protocol:(e=t.protocol)!==null&&e!==void 0?e:bc})),t.endPointKey==="CLOUD_API"&&NB((r=t.protocol)!==null&&r!==void 0?r:bc)}function $o(t,e,r){return bw({env:t,endPointKey:e,region:r})}function Ew(t,e,r){r===void 0&&(r="ap-shanghai"),r=r||"ap-shanghai";var n="//".concat(t,".api.tcloudbasegateway.com/v1");PB.includes(r)||(n="//".concat(t,".api.intl.tcloudbasegateway.com/v1")),as({endPointKey:"GATEWAY",env:t,baseUrl:n,protocol:e})}function Sw(t,e,r){var n="//".concat(t,".").concat(e||"ap-shanghai",".tcb-api.tencentcloudapi.com/web");as({env:t,region:e,baseUrl:n,protocol:r,endPointKey:"CLOUD_API"})}function Ec(t,e){e===void 0&&(e="CLOUD_API");var r=$o(t,e||"CLOUD_API"),n=r.protocol,o=r.baseUrl,i="".concat(n).concat(o);return i.match(/(http(s)?:)?\/\/([^/?#]*)/)[0]}var wc,PB,xB,NB,pw,vw,_w,ww,LB,bc,dw,Sc=X(()=>{Lt();wc=function(){return wc=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},wc.apply(this,arguments)},PB=["ap-shanghai","ap-guangzhou","ap-shenzhen-fsi","ap-shanghai-fsi","ap-nanjing","ap-beijing","ap-chengdu","ap-chongqing","ap-hongkong"],xB=Ge.setSdkName,NB=Ge.setProtocol,pw="",vw="@cloudbase/js-sdk";_w="2020-01-10",ww=[],LB=["env","endPointKey","region"],bc="https:";(function(t){t.NULL="NULL",t.ANONYMOUS="ANONYMOUS",t.WECHAT="WECHAT",t.WECHAT_PUBLIC="WECHAT-PUBLIC",t.WECHAT_OPEN="WECHAT-OPEN",t.CUSTOM="CUSTOM",t.EMAIL="EMAIL",t.USERNAME="USERNAME",t.PHONE="PHONE"})(dw||(dw={}))});function Fd(t,e,r){var n=t[e];t[e]=function(o){var i={},s={};r.forEach(function(l){var a=l.call(t,o),c=a.data,h=a.headers;Object.assign(i,c),Object.assign(s,h)});var u=o.data;return u&&(function(){if(BB(u)){Object.keys(i).forEach(function(l){u.append(l,i[l])});return}o.data=Ne(Ne({},u),i)})(),o.headers=Ne(Ne({},o.headers||{}),s),n.call(t,o)}}function jd(){var t=UB();return{data:{seqId:t},headers:{"X-SDK-Version":"@cloudbase/js-sdk/".concat(ko()),"x-seqid":t}}}function Ow(t){Tw[t.env]=new FB(Ne(Ne({},t),{throw:!0}))}function Aw(t){return Tw[t]}var Ne,_n,wn,DB,qd,UB,BB,Iw,qB,FB,Tw,Rw=X(()=>{Sc();Lt();Bd();Nd();Ne=function(){return Ne=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Ne.apply(this,arguments)},_n=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},wn=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},DB=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]]);return r},qd=Ge.ERRORS,UB=it.genSeqId,BB=it.isFormData,Iw=it.formatUrl,qB=["auth.getJwt","auth.logout","auth.signInWithTicket","auth.signInAnonymously","auth.signIn","auth.fetchAccessTokenWithRefreshToken","auth.signUpWithEmailAndPassword","auth.activateEndUserMail","auth.sendPasswordResetEmail","auth.resetPasswordWithToken","auth.isUsernameRegistered"];FB=(function(){function t(e){var r=this;this.throwWhenRequestFail=!1,this.config=e;var n={timeout:this.config.timeout,timeoutMsg:"[@cloudbase/js-sdk] \u8BF7\u6C42\u5728".concat(this.config.timeout/1e3,"s\u5185\u672A\u5B8C\u6210\uFF0C\u5DF2\u4E2D\u65AD"),restrictedMethods:["post","put"]};this.reqClass=new Jr.adapter.reqClass(n),this.throwWhenRequestFail=e.throw||!1,this.localCache=_c(this.config.env),this.config.endPointMode!=="GATEWAY"&&(Fd(this.reqClass,"post",[jd]),Fd(this.reqClass,"upload",[jd]),Fd(this.reqClass,"download",[jd])),Zt.bus.on(Zt.LANG_CHANGE_EVENT,function(o){var i;r.config.i18n=((i=o.data)===null||i===void 0?void 0:i.i18n)||r.config.i18n})}return t.prototype.getAccessToken=function(e){return e===void 0&&(e=null),_n(this,void 0,void 0,function(){var r,n,o;return wn(this,function(i){switch(i.label){case 0:if(e!=null)return[2,e];if(r=this.config._fromApp,!r.oauthInstance)throw new Error("you can't request without auth");return n=r.oauthInstance,o=n.oauth2client,[4,this.getOauthAccessTokenV2(o)];case 1:return[2,i.sent().accessToken]}})})},t.prototype.getDefaultHeaders=function(){var e,r,n;return e={},e[(r=this.config.i18n)===null||r===void 0?void 0:r.LANG_HEADER_KEY]=(n=this.config.i18n)===null||n===void 0?void 0:n.lang,e["X-SDK-Version"]="@cloudbase/js-sdk/".concat(ko()),e},t.prototype.post=function(e,r){return _n(this,void 0,void 0,function(){var n;return wn(this,function(o){switch(o.label){case 0:return[4,this.reqClass.post(Ne(Ne({},e),{headers:Ne(Ne({},e.headers),this.getDefaultHeaders()),customReqOpts:r}))];case 1:return n=o.sent(),[2,n]}})})},t.prototype.upload=function(e){return _n(this,void 0,void 0,function(){var r;return wn(this,function(n){switch(n.label){case 0:return[4,this.reqClass.upload(Ne(Ne({},e),{headers:Ne(Ne({},e.headers),this.getDefaultHeaders())}))];case 1:return r=n.sent(),[2,r]}})})},t.prototype.download=function(e){return _n(this,void 0,void 0,function(){var r;return wn(this,function(n){switch(n.label){case 0:return[4,this.reqClass.download(Ne(Ne({},e),{headers:Ne(Ne({},e.headers),this.getDefaultHeaders())}))];case 1:return r=n.sent(),[2,r]}})})},t.prototype.getBaseEndPoint=function(e){return e===void 0&&(e="CLOUD_API"),Ec(this.config.env,e)},t.prototype.getOauthAccessTokenV2=function(e){return _n(this,void 0,void 0,function(){var r,n;return wn(this,function(o){switch(o.label){case 0:return[4,e.getAccessToken()];case 1:return r=o.sent(),[4,e.getCredentials()];case 2:return n=o.sent(),[2,{accessToken:r,accessTokenExpire:new Date(n.expires_at).getTime()}]}})})},t.prototype.request=function(e,r,n,o){var i,s;return _n(this,void 0,void 0,function(){var u,l,a,c,h,w,E,T,A,O,C,P,q,U,k,W,V,Y,Z,ae,ie;return wn(this,function(ue){switch(ue.label){case 0:if(u="x-tcb-trace_".concat(this.config.env),l="application/x-www-form-urlencoded",a=Ne({action:e,dataVersion:_w,env:this.config.env},r),qB.indexOf(e)!==-1)return[3,2];if(c=this.config._fromApp,!c.oauthInstance)throw new Error("you can't request without auth");return h=c.oauthInstance,w=h.oauth2client,E=a,[4,this.getOauthAccessTokenV2(w)];case 1:E.access_token=ue.sent().accessToken,ue.label=2;case 2:return e==="storage.uploadFile"?(T=new FormData,Object.keys(T).forEach(function(be){Object.prototype.hasOwnProperty.call(T,be)&&T[be]!==void 0&&T.append(be,a[be])}),l="multipart/form-data"):(l="application/json;charset=UTF-8",T={},Object.keys(a).forEach(function(be){a[be]!==void 0&&(T[be]=a[be])})),A={headers:Ne(Ne({"content-type":l},this.getDefaultHeaders()),n?.headers)},n?.onUploadProgress&&(A.onUploadProgress=n.onUploadProgress),this.config.region&&(A.headers["X-TCB-Region"]=this.config.region),O=this.localCache.getStore(u),O&&(A.headers["X-TCB-Trace"]=O),C=n?.parse!==void 0?n.parse:r.parse,P=n?.inQuery!==void 0?n.inQuery:r.inQuery,q=n?.search!==void 0?n.search:r.search,U=Ne(Ne({},n?.defaultQuery||{}),{env:this.config.env}),C&&(U.parse=!0),P&&(U=Ne(Ne({},P),U)),k=this.config.endPointMode||"CLOUD_API",W=$o(this.config.env,k),V=W.baseUrl,Y=W.protocol,k==="GATEWAY"&&(e==="functions.invokeFunction"||/^(storage|database)\./.test(e))&&(V="".concat(V.match(/\/\/([^/?#]*)/)[0],"/web")),n.pathname?Z=Iw(Y,"".concat((i=Ec(this.config.env,k))===null||i===void 0?void 0:i.replace(/^https?:/,""),"/").concat(n.pathname),U):Z=Iw(Y,V,U),q&&(Z+=q),[4,this.post(Ne({url:Z,data:T},A),o)];case 3:if(ae=ue.sent(),ie=(s=ae.header)===null||s===void 0?void 0:s["x-tcb-trace"],ie&&this.localCache.setStore(u,ie),Number(ae.status)!==200&&Number(ae.statusCode)!==200||!ae.data)throw new Error("network request error");return[2,ae]}})})},t.prototype.fetch=function(e){var r,n,o,i,s,u,l,a;return _n(this,void 0,void 0,function(){var c,h,w,E,T,A,O,C=this;return wn(this,function(P){switch(P.label){case 0:c=e.token,h=e.headers,w=h===void 0?{}:h,E=DB(e,["token","headers"]),T=function(){return _n(C,void 0,void 0,function(){var q,U,k,W,V;return wn(this,function(Y){switch(Y.label){case 0:return U=(q=this.reqClass).fetch,W={},V={"X-SDK-Version":"@cloudbase/js-sdk/".concat(ko())},k="Bearer ".concat,[4,this.getAccessToken(c)];case 1:return[2,U.apply(q,[Ne.apply(void 0,[(W.headers=Ne.apply(void 0,[Ne.apply(void 0,[(V.Authorization=k.apply("Bearer ",[Y.sent()]),V),this.getDefaultHeaders()]),w]),W),E])])]}})})},P.label=1;case 1:return P.trys.push([1,3,,6]),[4,T()];case 2:return A=P.sent(),[2,A];case 3:if(O=P.sent(),O?.code!=="ACCESS_TOKEN_EXPIRED")return[3,5];if(typeof((i=(o=(n=(r=this.config)===null||r===void 0?void 0:r._fromApp)===null||n===void 0?void 0:n.oauthInstance)===null||o===void 0?void 0:o.authApi)===null||i===void 0?void 0:i.refreshTokenForce)!="function")throw O;return[4,(a=(l=(u=(s=this.config)===null||s===void 0?void 0:s._fromApp)===null||u===void 0?void 0:u.oauthInstance)===null||l===void 0?void 0:l.authApi)===null||a===void 0?void 0:a.refreshTokenForce()];case 4:return P.sent(),[2,T()];case 5:throw O;case 6:return[2]}})})},t.prototype.send=function(e,r,n,o){return r===void 0&&(r={}),n===void 0&&(n={}),_n(this,void 0,void 0,function(){var i;return wn(this,function(s){switch(s.label){case 0:return[4,this.request(e,r,Ne(Ne({},n),{onUploadProgress:r.onUploadProgress}),o)];case 1:if(i=s.sent(),i.data.code&&this.throwWhenRequestFail)throw new Error(JSON.stringify({code:qd.OPERATION_FAIL,msg:"[".concat(i.data.code,"] ").concat(i.data.message)}));return[2,i.data]}})})},t.prototype.gateWay=function(e,r){return _n(this,void 0,void 0,function(){var n,o,i,s,u,l,a,c,h,w,E,T,A,O,C,P;return wn(this,function(q){switch(q.label){case 0:if(n=e.name,o=e.data,i=e.path,s=i===void 0?"":i,u=e.method,l=e.header,a=l===void 0?{}:l,!n||!s)throw new Error(JSON.stringify({code:qd.INVALID_PARAMS,msg:"[gateWay] invalid function name or path"}));try{c=o?JSON.stringify(o):""}catch{throw new Error(JSON.stringify({code:qd.INVALID_PARAMS,msg:"[gateWay] invalid data"}))}return h=it.generateRequestId(),w=$o(this.config.env,"GATEWAY"),E=w.baseUrl,T=w.protocol,A="".concat(T).concat(E,"/").concat(s,"/").concat(n),[4,this.fetch({method:u||"POST",headers:Ne({"Content-Type":"application/json; charset=utf-8","X-Request-Id":h},a),body:c,url:A,customReqOpts:r})];case 1:return O=q.sent(),C=[Ne({requestId:h},O)],P={},[4,O.data];case 2:return[2,Ne.apply(void 0,C.concat([(P.data=q.sent(),P)]))]}})})},t})(),Tw={}});var Md,ss,jB,MB,Cw,kB,Pw,kd=X(()=>{Lt();(function(t){t.ZH="zh-CN",t.EN="en-US"})(ss||(ss={}));jB="Accept-Language",MB=(Md={},Md[ss.EN]={"\u8BF7\u68C0\u67E5\u8C03\u7528\u65B9\u5F0F\uFF0C\u6216\u524D\u5F80\u4E91\u5F00\u53D1 AI+ \u9996\u9875\u67E5\u770B\u6587\u6863":"Please check the calling method or visit the AI+ homepage to view the documentation","AI+ \u8BF7\u6C42\u51FA\u9519\uFF0C\u9519\u8BEF\u7801":"AI+ request error, error code",\u9519\u8BEF\u4FE1\u606F:"error message",\u672A\u5B9E\u73B0:"not implemented","\u5C0F\u7A0B\u5E8F\u4E0D\u652F\u6301 wasm \u52A0\u8F7D":"wasm loading is not supported in mini programs","\u5C0F\u7A0B\u5E8F\u4E0D\u652F\u6301\u52A8\u6001 js \u52A0\u8F7D":"dynamic js loading is not supported in mini programs",\u8BF7\u6C42\u8D85\u65F6:"request timeout","\u7F3A\u5C11 privatelink sdk \u5730\u5740":"missing privatelink sdk address"},Md),Cw=function(t,e){var r;return((r=MB[e])===null||r===void 0?void 0:r[t])||t},kB=function(t){return"lang_".concat(t.clientId||t.env)},Pw=function(t,e){var r,n,o=kB(e),i=(t.adapter||{}).localStorage,s=e.lang||((r=i?.getItem)===null||r===void 0?void 0:r.call(i,o))||ss.ZH;return(n=i?.setItem)===null||n===void 0||n.call(i,o,s),new Proxy({t:function(u){return Cw(u,s)},LANG_HEADER_KEY:jB,lang:s},{get:function(u,l){var a;return l==="lang"&&((a=i?.getItem)===null||a===void 0?void 0:a.call(i,o))||u[l]},set:function(u,l,a){var c;return l==="lang"&&a!==u[l]&&(u[l]=a,u.t=function(h){return Cw(h,a)},(c=i?.setItem)===null||c===void 0||c.call(i,o,a),Zt.bus.fire(Zt.LANG_CHANGE_EVENT,{i18n:u})),u[l]=a,!0}})}});var us,xw,Wo,$B,WB,HB,GB,Ic,Nw,Lw,Dw,VB,Uw,Bw,qw,zB,Fw,zt,jw=X(()=>{Lt();ky();Nd();Bd();Rw();Sc();kd();Sc();kd();us=function(){return us=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},us.apply(this,arguments)},xw=function(t,e,r,n){var o=arguments.length,i=o<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(s=t[u])&&(i=(o<3?s(i):o>3?s(e,r,i):s(e,r))||i);return o>3&&i&&Object.defineProperty(e,r,i),i},Wo=function(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)},$B=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},WB=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},HB=$a.useAdapters,GB=$a.useDefaultAdapter,Ic=Ge.ERRORS,Nw=Ge.COMMUNITY_SITE_URL,Lw=it.printWarn,Dw=hn.catchErrorsDecorator,VB={timeout:15e3,persistence:"local"},Uw=1e3*60*10,Bw=100,qw={},zB=(function(){function t(e){this.cloudbaseConfig=e||this.cloudbaseConfig,this.authInstance=null,this.oauthInstance=null,this.version=ko()}return Object.defineProperty(t.prototype,"config",{get:function(){return this.cloudbaseConfig},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"platform",{get:function(){return Jr},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cache",{get:function(){return hw(this.cloudbaseConfig.env)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localCache",{get:function(){return _c(this.cloudbaseConfig.env)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"request",{get:function(){return Aw(this.cloudbaseConfig.env)},enumerable:!1,configurable:!0}),t.prototype.init=function(e){var r;if(!e.env)throw new Error(JSON.stringify({code:Ic.INVALID_PARAMS,msg:"env must not be specified"}));Jr.adapter||this.useDefaultAdapter();var n={timeout:e.timeout||5e3,timeoutMsg:"[".concat(yw(),"][REQUEST TIMEOUT] request had been abort since didn't finished within").concat(e.timeout/1e3,"s")};this.requestClient=new Jr.adapter.reqClass(n),this.cloudbaseConfig=us(us(us({},VB),e),{i18n:Pw(Jr,e)}),delete this.cloudbaseConfig.lang,this.cloudbaseConfig.timeout=this.formatTimeout(this.cloudbaseConfig.timeout);var o=this.cloudbaseConfig,i=o.env,s=o.persistence,u=o.debug,l=o.timeout,a=o.oauthClient,c=o.i18n;Ud({env:i,persistence:s,debug:u,platformInfo:this.platform}),Sw(i,e.region||""),Ew(i,bc,e.region||"");var h=new t(this.cloudbaseConfig);return Ow({env:i,region:e.region||"",timeout:l,oauthClient:a,_fromApp:h,i18n:c,endPointMode:e.endPointMode}),h.requestClient=this.requestClient,(r=this===null||this===void 0?void 0:this.fire)===null||r===void 0||r.call(this,"cloudbase_init",h),this.try2InitAuth(h),h},t.prototype.updateConfig=function(e){var r=e.persistence,n=e.debug;this.cloudbaseConfig.persistence=r,this.cloudbaseConfig.debug=n,Ud({env:this.cloudbaseConfig.env,persistence:r,debug:n,platformInfo:this.platform})},t.prototype.updateLang=function(e){var r;!e||e===((r=this.cloudbaseConfig.i18n)===null||r===void 0?void 0:r.lang)||(this.cloudbaseConfig.i18n.lang=e)},t.prototype.registerExtension=function(e){qw[e.name]=e},t.prototype.invokeExtension=function(e,r){return $B(this,void 0,void 0,function(){var n;return WB(this,function(o){switch(o.label){case 0:if(n=qw[e],!n)throw new Error(JSON.stringify({code:Ic.INVALID_PARAMS,msg:"extension:".concat(e," must be registered before invoke")}));return[4,n.invoke(r,this)];case 1:return[2,o.sent()]}})})},t.prototype.useAdapters=function(e,r){var n=HB(e,r)||{},o=n.adapter,i=n.runtime;o&&(Jr.adapter=o),i&&(Jr.runtime=i)},t.prototype.registerHook=function(e){My(t,e)},t.prototype.registerComponent=function(e){Fy(t,e)},t.prototype.registerVersion=function(e){mw(e),this.version=e},t.prototype.registerSdkName=function(e){gw(e)},t.prototype.registerEndPoint=function(e,r){as({baseUrl:e,protocol:r,env:this.config.env,endPointKey:"CLOUD_API"})},t.prototype.registerEndPointWithKey=function(e){as({env:this.config.env,endPointKey:e.key,baseUrl:e.url,protocol:e.protocol})},t.prototype.getEndPointWithKey=function(e){var r=$o(this.config.env,e);return{BASE_URL:r.baseUrl,PROTOCOL:r.protocol}},t.prototype.parseCaptcha=function(e){return it.parseCaptcha(e)},t.prototype.useDefaultAdapter=function(){var e=GB.bind(this)(),r=e.adapter,n=e.runtime;Jr.adapter=r,Jr.runtime=n},t.prototype.formatTimeout=function(e){switch(!0){case e>Uw:return Lw(Ic.INVALID_PARAMS,"timeout is greater than maximum value[10min]"),Uw;case e<Bw:return Lw(Ic.INVALID_PARAMS,"timeout is less than maximum value[100ms]"),Bw;default:return e}},t.prototype.try2InitAuth=function(e){try{e.auth()}catch(r){console.log("try2InitAuth error:",r)}},xw([Dw({mode:"sync",title:"Cloudbase \u521D\u59CB\u5316\u5931\u8D25",messages:["\u8BF7\u786E\u8BA4\u4EE5\u4E0B\u5404\u9879\uFF1A","  1 - \u8C03\u7528 cloudbase.init() \u7684\u8BED\u6CD5\u6216\u53C2\u6570\u662F\u5426\u6B63\u786E","  2 - \u5982\u679C\u662F\u975E\u6D4F\u89C8\u5668\u73AF\u5883\uFF0C\u662F\u5426\u914D\u7F6E\u4E86\u5B89\u5168\u5E94\u7528\u6765\u6E90\uFF08https://docs.cloudbase.net/api-reference/webv3/adapter#%E7%AC%AC-2-%E6%AD%A5%E9%85%8D%E7%BD%AE%E5%AE%89%E5%85%A8%E5%BA%94%E7%94%A8%E6%9D%A5%E6%BA%90\uFF09","\u5982\u679C\u95EE\u9898\u4F9D\u7136\u5B58\u5728\uFF0C\u5EFA\u8BAE\u5230\u5B98\u65B9\u95EE\u7B54\u793E\u533A\u63D0\u95EE\u6216\u5BFB\u627E\u5E2E\u52A9\uFF1A".concat(Nw)]}),Wo("design:type",Function),Wo("design:paramtypes",[Object]),Wo("design:returntype",t)],t.prototype,"init",null),xw([Dw({title:"\u8C03\u7528\u6269\u5C55\u80FD\u529B\u5931\u8D25",messages:["\u8BF7\u786E\u8BA4\u4EE5\u4E0B\u5404\u9879\uFF1A","  1 - \u8C03\u7528 invokeExtension() \u7684\u8BED\u6CD5\u6216\u53C2\u6570\u662F\u5426\u6B63\u786E","  2 - \u88AB\u8C03\u7528\u7684\u6269\u5C55\u80FD\u529B\u662F\u5426\u5DF2\u7ECF\u5B89\u88C5\u5E76\u901A\u8FC7 registerExtension() \u6CE8\u518C","\u5982\u679C\u95EE\u9898\u4F9D\u7136\u5B58\u5728\uFF0C\u5EFA\u8BAE\u5230\u5B98\u65B9\u95EE\u7B54\u793E\u533A\u63D0\u95EE\u6216\u5BFB\u627E\u5E2E\u52A9\uFF1A".concat(Nw)]}),Wo("design:type",Function),Wo("design:paramtypes",[String,Object]),Wo("design:returntype",Promise)],t.prototype,"invokeExtension",null),t})(),Fw=new zB;Fw.useAdapters(lw());zt=Fw});var si,Ee,ai,Mw,bt,Gi,Dt,lt,vr,ui=X(()=>{si="/auth";(function(t){t.AUTH_SIGN_UP_URL="/v1/signup",t.AUTH_TOKEN_URL="/v1/token",t.AUTH_REVOKE_URL="/v1/revoke",t.WEDA_USER_URL="/v1/plugin/weda/userinfo",t.AUTH_RESET_PASSWORD="/v1/reset",t.AUTH_GET_DEVICE_CODE="/v1/device/code",t.CHECK_USERNAME="/v1/checkUsername",t.CHECK_IF_USER_EXIST="/v1/checkIfUserExist",t.GET_PROVIDER_TYPE="/v1/mgr/provider/providerSubType",t.AUTH_SIGN_IN_URL="/v1/signin",t.AUTH_SIGN_IN_ANONYMOUSLY_URL="/v1/signin/anonymously",t.AUTH_SIGN_IN_WITH_PROVIDER_URL="/v1/signin/with/provider",t.AUTH_SIGN_IN_WITH_WECHAT_URL="/v1/signin/wechat/noauth",t.AUTH_SIGN_IN_CUSTOM="/v1/signin/custom",t.PROVIDER_TOKEN_URL="/v1/provider/token",t.PROVIDER_URI_URL="/v1/provider/uri",t.USER_ME_URL="/v1/user/me",t.AUTH_SIGNOUT_URL="/v1/user/signout",t.USER_QUERY_URL="/v1/user/query",t.USER_PRIFILE_URL="/v1/user/profile",t.USER_BASIC_EDIT_URL="/v1/user/basic/edit",t.USER_TRANS_BY_PROVIDER_URL="/v1/user/trans/by/provider",t.PROVIDER_LIST="/v1/user/provider",t.PROVIDER_BIND_URL="/v1/user/provider/bind",t.PROVIDER_UNBIND_URL="/v1/user/provider",t.CHECK_PWD_URL="/v1/user/sudo",t.SUDO_URL="/v1/user/sudo",t.BIND_CONTACT_URL="/v1/user/contact",t.AUTH_SET_PASSWORD="/v1/user/password",t.AUTHORIZE_DEVICE_URL="/v1/user/device/authorize",t.AUTHORIZE_URL="/v1/user/authorize",t.AUTHORIZE_INFO_URL="/v1/user/authorize/info",t.AUTHORIZED_DEVICES_DELETE_URL="/v1/user/authorized/devices/",t.AUTH_REVOKE_ALL_URL="/v1/user/revoke/all",t.GET_USER_BEHAVIOR_LOG="/v1/user/security/history",t.VERIFICATION_URL="/v1/verification",t.VERIFY_URL="/v1/verification/verify",t.CAPTCHA_DATA_URL="/v1/captcha/data",t.VERIFY_CAPTCHA_DATA_URL="/v1/captcha/data/verify",t.GET_CAPTCHA_URL="/v1/captcha/init",t.GET_MINIPROGRAM_QRCODE="/v1/qrcode/generate",t.GET_MINIPROGRAM_QRCODE_STATUS="/v1/qrcode/get/status"})(Ee||(Ee={}));(function(t){t.AUTH_SIGN_IN_URL="/v2/signin/username",t.AUTH_TOKEN_URL="/v2/token",t.USER_ME_URL="/v2/user/me",t.VERIFY_URL="/v2/signin/verificationcode",t.AUTH_SIGN_IN_WITH_PROVIDER_URL="/v2/signin/with/provider",t.AUTH_PUBLIC_KEY="/v2/signin/publichkey",t.AUTH_RESET_PASSWORD="/v2/signin/password/update"})(ai||(ai={}));(function(t){t.REGISTER="REGISTER",t.SIGN_IN="SIGN_IN",t.PASSWORD_RESET="PASSWORD_RESET",t.EMAIL_ADDRESS_CHANGE="EMAIL_ADDRESS_CHANGE",t.PHONE_NUMBER_CHANGE="PHONE_NUMBER_CHANGE"})(Mw||(Mw={}));(function(t){t.UNREACHABLE="unreachable",t.LOCAL="local",t.CANCELLED="cancelled",t.UNKNOWN="unknown",t.UNAUTHENTICATED="unauthenticated",t.RESOURCE_EXHAUSTED="resource_exhausted",t.FAILED_PRECONDITION="failed_precondition",t.INVALID_ARGUMENT="invalid_argument",t.DEADLINE_EXCEEDED="deadline_exceeded",t.NOT_FOUND="not_found",t.ALREADY_EXISTS="already_exists",t.PERMISSION_DENIED="permission_denied",t.ABORTED="aborted",t.OUT_OF_RANGE="out_of_range",t.UNIMPLEMENTED="unimplemented",t.INTERNAL="internal",t.UNAVAILABLE="unavailable",t.DATA_LOSS="data_loss",t.INVALID_PASSWORD="invalid_password",t.PASSWORD_NOT_SET="password_not_set",t.INVALID_STATUS="invalid_status",t.USER_PENDING="user_pending",t.USER_BLOCKED="user_blocked",t.INVALID_VERIFICATION_CODE="invalid_verification_code",t.TWO_FACTOR_REQUIRED="two_factor_required",t.INVALID_TWO_FACTOR="invalid_two_factor",t.INVALID_TWO_FACTOR_RECOVERY="invalid_two_factor_recovery",t.UNDER_REVIEW="under_review",t.INVALID_REQUEST="invalid_request",t.UNAUTHORIZED_CLIENT="unauthorized_client",t.ACCESS_DENIED="access_denied",t.UNSUPPORTED_RESPONSE_TYPE="unsupported_response_type",t.INVALID_SCOPE="invalid_scope",t.INVALID_GRANT="invalid_grant",t.SERVER_ERROR="server_error",t.TEMPORARILY_UNAVAILABLE="temporarily_unavailable",t.INTERACTION_REQUIRED="interaction_required",t.LOGIN_REQUIRED="login_required",t.ACCOUNT_SELECTION_REQUIRED="account_selection_required",t.CONSENT_REQUIRED="consent_required",t.INVALID_REQUEST_URI="invalid_request_uri",t.INVALID_REQUEST_OBJECT="invalid_request_object",t.REQUEST_NOT_SUPPORTED="request_not_supported",t.REQUEST_URI_NOT_SUPPORTED="request_uri_not_supported",t.REGISTRATION_NOT_SUPPORTED="registration_not_supported",t.CAPTCHA_REQUIRED="captcha_required",t.CAPTCHA_INVALID="captcha_invalid"})(bt||(bt={}));Gi={SIGN_OUT:"sign_out",SIGN_IN:"sign_in",CREDENTIALS_ERROR:"credentials_error"},Dt={SIGNED_OUT:"SIGNED_OUT",SIGNED_IN:"SIGNED_IN",INITIAL_SESSION:"INITIAL_SESSION",PASSWORD_RECOVERY:"PASSWORD_RECOVERY",TOKEN_REFRESHED:"TOKEN_REFRESHED",USER_UPDATED:"USER_UPDATED",BIND_IDENTITY:"BIND_IDENTITY"},lt={LOGIN_STATE_CHANGED:"loginStateChanged",AUTH_STATE_CHANGED:"authStateChanged"},vr={SIGN_IN:"sign_in",BIND_IDENTITY:"bind_identity"}});var kw,$w=X(()=>{ui();(function(t){t.CLIENT_ID="client_id",t.CLIENT_SECRET="client_secret",t.RESPONSE_TYPE="response_type",t.SCOPE="scope",t.STATE="state",t.REDIRECT_URI="redirect_uri",t.ERROR="error",t.ERROR_DESCRIPTION="error_description",t.ERROR_URI="error_uri",t.GRANT_TYPE="grant_type",t.CODE="code",t.ACCESS_TOKEN="access_token",t.TOKEN_TYPE="token_type",t.EXPIRES_IN="expires_in",t.USERNAME="username",t.PASSWORD="password",t.REFRESH_TOKEN="refresh_token"})(kw||(kw={}))});function $d(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,t=>{let e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}var Ww=X(()=>{});var Vi,Wd,Tc=X(()=>{Vi=t=>{let e=n=>{for(let o in t)t.hasOwnProperty(o)&&(n[o]=Vi(t[o]));return n},r=t==null?"NullOrUndefined":Object.prototype.toString.call(t).slice(8,-1);if(["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"].includes(r))return t.slice();switch(r){case"Object":return e(Object.create(Object.getPrototypeOf(t)));case"Array":return e([]);case"Date":return new Date(t.valueOf());case"RegExp":return new RegExp(t.source,(t.global?"g":"")+(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.sticky?"y":"")+(t.unicode?"u":""));default:return t}},Wd=t=>{let e=/^(?:http(s)?:\/\/[^\/]+)?(\/[^\?#]*)/,r=t.match(e);return r&&r[2]||""}});var cs,ls,Hw=X(()=>{cs=new Map,ls=class{constructor(e){this.clientId=e?.clientId||"",cs=cs||new Map}async run(e,r){e=`${this.clientId}_${e}`;let n=cs.get(e);return n||(n=new Promise((o,i)=>{(async()=>{try{await this.runIdlePromise();let s=r();o(await s)}catch(s){i(s)}finally{cs.delete(e)}})()}),cs.set(e,n)),n}runIdlePromise(){return Promise.resolve()}}});function Gw(t){t=String(t);let e,r,n,o,i="",s=0,u=t.length%3;for(;s<t.length;){if((r=t.charCodeAt(s++))>255||(n=t.charCodeAt(s++))>255||(o=t.charCodeAt(s++))>255)throw new TypeError("Failed to execute 'btoa' on 'Window': The string to be encoded contains characters outside of the Latin1 range.");e=r<<16|n<<8|o,i+=ci.charAt(e>>18&63)+ci.charAt(e>>12&63)+ci.charAt(e>>6&63)+ci.charAt(e&63)}return u?i.slice(0,u-3)+"===".substring(u):i}function YB(t){return decodeURIComponent(Vw(t).replace(/(.)/g,e=>{let r=e.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r=`0${r}`),`%${r}`}))}function JB(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("Illegal base64url string!")}try{return YB(e)}catch{return Vw(e)}}function Hd(t){if(typeof t!="string")throw new Error("Invalid token specified");try{let e=t.split(".").map((r,n)=>n===2?r:JSON.parse(JB(r)));return{claims:e[1],header:e[0],signature:e[2]}}catch(e){throw new Error(`Invalid token specified: ${e}`?e.message:"")}}var ci,KB,Vw,Gd=X(()=>{ci="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",KB=/^(?:[A-Za-z\d+/]{4})*?(?:[A-Za-z\d+/]{2}(?:==)?|[A-Za-z\d+/]{3}=?)?$/;Vw=function(t){if(t=String(t).replace(/[\t\n\f\r ]+/g,""),!KB.test(t))throw new TypeError("Failed to execute 'atob' on 'Window': The string to be decoded is not correctly encoded.");t+="==".slice(2-(t.length&3));let e,r="",n,o,i=0;for(;i<t.length;)e=ci.indexOf(t.charAt(i++))<<18|ci.indexOf(t.charAt(i++))<<12|(n=ci.indexOf(t.charAt(i++)))<<6|(o=ci.indexOf(t.charAt(i++))),r+=n===64?String.fromCharCode(e>>16&255):o===64?String.fromCharCode(e>>16&255,e>>8&255):String.fromCharCode(e>>16&255,e>>8&255,e&255);return r}});function fs(){if(typeof globalThis>"u")return!1;let{wx:t}=globalThis;if(typeof t>"u"||globalThis.Page===void 0||!t.getDeviceInfo||!t.getStorageSync||!t.setStorageSync||!t.connectSocket||!t.request)return!1;try{if(!t.getDeviceInfo()||t.getDeviceInfo().platform==="qq")return!1}catch{return!1}return!0}function zw(){Oc=Oc||typeof window!==void 0&&window.__wxjs_environment==="miniprogram"}var Oc,Vd=X(()=>{Oc=!1;try{fs()||(Oc=Oc||!!navigator.userAgent.match(/miniprogram/i)||window.__wxjs_environment==="miniprogram",window&&window.WeixinJSBridge&&window.WeixinJSBridge.invoke?zw():typeof document<"u"&&document.addEventListener("WeixinJSBridgeReady",zw,!1))}catch{}});function XB(){return $d()}function Qw(t){let e=!0;return t?.expires_at&&t?.access_token&&(e=t.expires_at<new Date),e}var Kw,Yw,Jw,QB,zd,hs,Kd,bn,Ac=X(()=>{$w();ui();Ww();Tc();Hw();Gd();Vd();Lt();Kw="x-request-id",Yw="x-device-id",Jw="device_id",QB=async function(t,e){let r=null,n=null;try{let o=Object.assign({},e);o.method||(o.method="GET"),o.body&&typeof o.body!="string"&&(o.body=JSON.stringify(o.body));let s=await(await fetch(t,o)).json();s?.error?(n=s,n.error_uri=new URL(t).pathname):r=s}catch(o){n={error:bt.UNREACHABLE,error_description:o.message,error_uri:new URL(t).pathname}}if(n)throw n;return r};zd=class{constructor(e){this._env=e?.env||""}async getItem(e){return window.localStorage.getItem(`${e}${this._env}`)}async removeItem(e){window.localStorage.removeItem(`${e}${this._env}`)}async setItem(e,r){window.localStorage.setItem(`${e}${this._env}`,r)}getItemSync(e){return window.localStorage.getItem(`${e}${this._env}`)}removeItemSync(e){window.localStorage.removeItem(`${e}${this._env}`)}setItemSync(e,r){window.localStorage.setItem(`${e}${this._env}`,r)}},hs=new zd;Kd=class{constructor(e){this.credentials=null,this.accessKeyCredentials=null,this.singlePromise=null,this.tokenSectionName=e.tokenSectionName,this.storage=e.storage,this.clientId=e.clientId,this.singlePromise=new ls({clientId:this.clientId}),this.credentials=e.credentials||null}getStorageCredentialsSync(){let e=null,r=this.storage.getItemSync(this.tokenSectionName);if(r!=null)try{e=JSON.parse(r),e?.expires_at&&(e.expires_at=new Date(e.expires_at))}catch{this.storage.removeItem(this.tokenSectionName),e=null}return e}async setCredentials(e){if(e?.expires_in){if(e?.expires_at||(e.expires_at=new Date(Date.now()+(e.expires_in-30)*1e3)),this.storage){let r=JSON.stringify(e);await this.storage.setItem(this.tokenSectionName,r)}this.credentials=e}else this.storage&&await this.storage.removeItem(this.tokenSectionName),this.credentials=null}setAccessKeyCredentials(e){this.accessKeyCredentials=e}async getCredentials(){return this.singlePromise.run("getCredentials",async()=>{if(Qw(this.credentials)){let{credentials:e,isAccessKeyCredentials:r}=await this.getStorageCredentials();if(r)return e;this.credentials=e}return this.credentials})}async getStorageCredentials(){return this.singlePromise.run("_getStorageCredentials",async()=>{let e=null,r=!1,n=await this.storage.getItem(this.tokenSectionName);if(n)try{e=JSON.parse(n),e?.expires_at&&(e.expires_at=new Date(e.expires_at))}catch{await this.storage.removeItem(this.tokenSectionName),e=null}else e=this.accessKeyCredentials||null,r=!0;return{credentials:e,isAccessKeyCredentials:r}})}},bn=class t{constructor(e){this.initializePromise=null,this.lockAcquired=!1,this.pendingInLock=[],this.singlePromise=null,e.clientSecret||(e.clientSecret=""),!e.clientId&&e.env&&(e.clientId=e.env),this.apiOrigin=e.apiOrigin,this.apiPath=e.apiPath||si,this.clientId=e.clientId,this.i18n=e.i18n,this.eventBus=e.eventBus,this.singlePromise=new ls({clientId:this.clientId}),this.retry=this.formatRetry(e.retry,t.defaultRetry),e.baseRequest?this.baseRequest=e.baseRequest:this.baseRequest=QB,this.tokenInURL=e.tokenInURL,this.headers=e.headers,this.storage=e.storage||hs,this.localCredentials=new Kd({tokenSectionName:`credentials_${e.clientId}`,storage:this.storage,clientId:e.clientId}),this.clientSecret=e.clientSecret,e.clientId&&(this.basicAuth=`Basic ${Gw(`${e.clientId}:${this.clientSecret}`)}`),this.wxCloud=e.wxCloud;try{fs()&&(this.useWxCloud=e.useWxCloud,this.wxCloud===void 0&&e.env&&(wx.cloud.init({env:e.env}),this.wxCloud=wx.cloud))}catch{}this.refreshTokenFunc=e.refreshTokenFunc||this.defaultRefreshTokenFunc,this.anonymousSignInFunc=e.anonymousSignInFunc,this.onCredentialsError=e.onCredentialsError,this.getInitialSession=e.getInitialSession,this.onInitialSessionObtained=e.onInitialSessionObtained,this.logDebugMessages=e.debug??!1,Zt.bus.on(Zt.LANG_CHANGE_EVENT,r=>{this.i18n=r.data?.i18n||this.i18n})}setGetInitialSession(e){this.getInitialSession=e}setOnInitialSessionObtained(e){this.onInitialSessionObtained=e}async initialize(e){return this.initializePromise?await this.initializePromise:e!==void 0?(this.initializePromise=e,await this.initializePromise):(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async setCredentials(e){return await this.initializePromise,this._acquireLock(-1,async()=>this.localCredentials.setCredentials(e))}setAccessKeyCredentials(e){return this.localCredentials.setAccessKeyCredentials(e)}async getAccessToken(){await this.initializePromise;let e=await this.getCredentials();if(e?.access_token)return Promise.resolve(e.access_token);let r={error:bt.UNAUTHENTICATED};return Promise.reject(r)}async request(e,r){r||(r={});let n=this.formatRetry(r.retry,this.retry);if(r.headers={...r.headers,[this.i18n?.LANG_HEADER_KEY]:this.i18n?.lang},this.headers&&(r.headers={...this.headers,...r.headers}),r.headers[Kw]||(r.headers[Kw]=XB()),!r.headers[Yw]){let s=await this.getDeviceId();r.headers[Yw]=s}if(r?.withBasicAuth&&this.basicAuth&&(r.headers.Authorization=this.basicAuth),r?.withCredentials){let s=r.getCredentials?await r.getCredentials():await this.getCredentials();s&&(this.tokenInURL?(e.indexOf("?")<0&&(e+="?"),e+=`access_token=${s.access_token}`):r.headers.Authorization=`${s.token_type} ${s.access_token}`)}else this.clientId&&e.indexOf("client_id")<0&&(e+=e.indexOf("?")<0?"?":"&",e+=`client_id=${this.clientId}`);e.startsWith("/")&&(e=`${this.apiOrigin}${this.apiPath}${e}`);let o=null,i=n+1;for(let s=0;s<i;s++){try{if(r.useWxCloud||this.useWxCloud?o=await this.wxCloudCallFunction(e,r):o=await this.baseRequest(e,r),o?.code)throw{error:o.code,error_description:o.message,error_uri:new URL(e).pathname};break}catch(u){if(r.withCredentials&&u&&u.error===bt.UNAUTHENTICATED)return await this.setCredentials(null),Promise.reject(u);if(s===n||!u||u.error!=="unreachable")return Promise.reject(u)}await this.sleep(t.retryInterval)}return o}async wxCloudCallFunction(e,r){let n=null,o=null;try{let i="";try{i=await wx.getRendererUserAgent()}catch{}let{result:s}=await this.wxCloud.callFunction({name:"httpOverCallFunction",data:{url:e,method:r.method,headers:{origin:"https://servicewechat.com","User-Agent":i,...r.headers},body:r.body}});s?.body?.error_code?(o=s?.body,o.error_uri=Wd(e)):n=s?.body}catch(i){o={error:bt.UNREACHABLE,error_description:i.message,error_uri:Wd(e)}}if(o)throw o;return n}async getCredentials(){return await this.initializePromise,this._acquireLock(-1,async()=>this._getCredentials())}getCredentialsSync(){return this.localCredentials.getStorageCredentialsSync()}getCredentialsAsync(){return this.getCredentials()}async getScope(){let e=await this.localCredentials.getCredentials();if(!e){let r="credentials not found";return this.onCredentialsError?.({msg:r}),this.unAuthenticatedError(r)}return e.scope}async getGroups(){let e=await this.localCredentials.getCredentials();if(!e){let r="credentials not found";return this.onCredentialsError?.({msg:r}),this.unAuthenticatedError(r)}return e.groups}async refreshToken(e,r){return await this.initializePromise,this._acquireLock(-1,async()=>this._refreshToken(e,r))}async _refreshToken(e,r){return this.singlePromise.run("_refreshToken",async()=>{if(!e||!e.refresh_token){let n="no refresh token found in credentials";return this.onCredentialsError?.({msg:n}),this.unAuthenticatedError(n)}try{let n=await this.refreshTokenFunc(e.refresh_token,e);return await this.localCredentials.setCredentials(n),this.eventBus?.fire(lt.AUTH_STATE_CHANGED,{event:Dt.TOKEN_REFRESHED}),n}catch(n){if(r?.throwError)throw n;if(n.error===bt.INVALID_GRANT){await this.localCredentials.setCredentials(null);let o=n.error_description;return this.onCredentialsError?.({msg:o}),this.unAuthenticatedError(o)}return this.onCredentialsError?.({msg:n.error_description}),Promise.reject(n)}})}async anonymousLogin(e){return this.singlePromise.run("_anonymousLogin",async()=>(this.anonymousSignInFunc?e=await this.anonymousSignInFunc(e)||await this.localCredentials.getCredentials():e=await this.anonymousSignIn(e),e))}checkRetry(e){let r=null;if((typeof e!="number"||e<t.minRetry||e>t.maxRetry)&&(r={error:bt.UNREACHABLE,error_description:"wrong options param: retry"}),r)throw r;return e}formatRetry(e,r){return typeof e>"u"?r:this.checkRetry(e)}async sleep(e){return new Promise(r=>{setTimeout(()=>{r()},e)})}async anonymousSignIn(e){return this.singlePromise.run("_anonymous",async()=>{if(!e||e.scope!=="anonymous")return this.unAuthenticatedError("no anonymous in credentials");try{let r=await this.request(Ee.AUTH_SIGN_IN_ANONYMOUSLY_URL,{method:"POST",withBasicAuth:!0,body:{}});return await this.localCredentials.setCredentials(r),r}catch(r){return r.error===bt.INVALID_GRANT?(await this.localCredentials.setCredentials(null),this.unAuthenticatedError(r.error_description)):Promise.reject(r)}})}async defaultRefreshTokenFunc(e,r){if(e===void 0||e===""){let i="refresh token not found";return this.onCredentialsError?.({msg:i}),this.unAuthenticatedError(i)}let n=Ee.AUTH_TOKEN_URL;return r?.version==="v2"&&(n=ai.AUTH_TOKEN_URL),{...await this.request(n,{method:"POST",body:{client_id:this.clientId,client_secret:this.clientSecret,grant_type:"refresh_token",refresh_token:e}}),version:r?.version||"v1"}}async getDeviceId(){if(this.deviceID)return this.deviceID;let e=await this.storage.getItem(Jw);return typeof e=="string"&&e.length>=16&&e.length<=48||(e=$d(),await this.storage.setItem(Jw,e)),this.deviceID=e,e}unAuthenticatedError(e){let r={error:bt.UNAUTHENTICATED,error_description:e};return Promise.reject(r)}_debug(...e){this.logDebugMessages&&console.log("[OAuth2Client]",...e)}async _initialize(){try{if(!this.getInitialSession)return this._debug("#_initialize()","no getInitialSession callback set, skipping"),{error:null};this._debug("#_initialize()","calling getInitialSession callback");try{let{data:e,error:r}=await this.getInitialSession();if(e?.session&&(this._debug("#_initialize()","session obtained from getInitialSession",e.session),await this.localCredentials.setCredentials(e?.session)),this.onInitialSessionObtained){this._debug("#_initialize()","calling onInitialSessionObtained callback");try{await this.onInitialSessionObtained(e,r)}catch(n){this._debug("#_initialize()","error in onInitialSessionObtained",n)}}return r?(this._debug("#_initialize()","error from getInitialSession",r),{error:r}):{error:null}}catch(e){return this._debug("#_initialize()","exception during getInitialSession",e),{error:e instanceof Error?e:new Error(String(e))}}}catch(e){return this._debug("#_initialize()","unexpected error",e),{error:e instanceof Error?e:new Error(String(e))}}finally{this._debug("#_initialize()","end")}}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){let n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await o}catch{}})()),o}this._debug("#_acquireLock","acquiring lock for client",this.clientId);try{this.lockAcquired=!0;let n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){let o=[...this.pendingInLock];await Promise.all(o),this.pendingInLock.splice(0,o.length)}return await n}finally{this._debug("#_acquireLock","releasing lock for client",this.clientId),this.lockAcquired=!1}}finally{this._debug("#_acquireLock","end")}}async _getCredentials(){let e=await this.localCredentials.getCredentials();if(!e){let r="credentials not found";return this.onCredentialsError?.({msg:r}),this.unAuthenticatedError(r)}if(Qw(e))if(e.refresh_token)try{e=await this._refreshToken(e)}catch(r){if(e.scope==="anonymous")e=await this.anonymousLogin(e);else return this.onCredentialsError?.({msg:r.error_description}),Promise.reject(r)}else if(e.scope==="anonymous")e=await this.anonymousLogin(e);else{let r="no refresh token found in credentials";return this.onCredentialsError?.({msg:r}),this.unAuthenticatedError(r)}return e}};bn.defaultRetry=2;bn.minRetry=0;bn.maxRetry=5;bn.retryInterval=1e3});var Yd=K(rr=>{"use strict";Object.defineProperty(rr,"__esModule",{value:!0});rr.COMMUNITY_SITE_URL=rr.IS_DEBUG_MODE=rr.getProtocol=rr.setProtocol=rr.getSdkName=rr.setSdkName=void 0;var Xw="@cloudbase/js-sdk";function ZB(t){Xw=t}rr.setSdkName=ZB;function eq(){return Xw}rr.getSdkName=eq;var Zw="https:";function tq(t){Zw=t}rr.setProtocol=tq;function rq(){return Zw}rr.getProtocol=rq;rr.IS_DEBUG_MODE=!1;rr.COMMUNITY_SITE_URL="https://support.qq.com/products/148793"});var eb=K(Rc=>{"use strict";Object.defineProperty(Rc,"__esModule",{value:!0});Rc.ERRORS=void 0;Rc.ERRORS={INVALID_PARAMS:"INVALID_PARAMS",INVALID_SYNTAX:"INVALID_SYNTAX",INVALID_OPERATION:"INVALID_OPERATION",OPERATION_FAIL:"OPERATION_FAIL",NETWORK_ERROR:"NETWORK_ERROR",UNKOWN_ERROR:"UNKOWN_ERROR"}});var Ho=K(En=>{"use strict";var nq=En&&En.__createBinding||(Object.create?(function(t,e,r,n){n===void 0&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}):(function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]})),tb=En&&En.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&nq(e,t,r)};Object.defineProperty(En,"__esModule",{value:!0});En.OATUH_LOGINTYPE=void 0;tb(Yd(),En);tb(eb(),En);En.OATUH_LOGINTYPE="constants"});var li=K(pe=>{"use strict";var iq=pe&&pe.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]]);return r};Object.defineProperty(pe,"__esModule",{value:!0});pe.parseCaptcha=pe.parseQueryString=pe.transformPhone=pe.sleep=pe.printGroupLog=pe.throwError=pe.printInfo=pe.printError=pe.printWarn=pe.execCallback=pe.createPromiseCallback=pe.removeParam=pe.getHash=pe.getQuery=pe.toQueryString=pe.formatUrl=pe.generateRequestId=pe.genSeqId=pe.isFormData=pe.isInstanceOf=pe.isNull=pe.isPalinObject=pe.isUndefined=pe.isString=pe.isArray=void 0;var Cc=Ho();function oq(t){return Object.prototype.toString.call(t)==="[object Array]"}pe.isArray=oq;function aq(t){return typeof t=="string"}pe.isString=aq;function sq(t){return typeof t>"u"}pe.isUndefined=sq;function uq(t){return Object.prototype.toString.call(t)==="[object Object]"}pe.isPalinObject=uq;function cq(t){return Object.prototype.toString.call(t)==="[object Null]"}pe.isNull=cq;function lq(t,e){return t instanceof e}pe.isInstanceOf=lq;function fq(t){return Object.prototype.toString.call(t)==="[object FormData]"}pe.isFormData=fq;function hq(){return Math.random().toString(16).slice(2)}pe.genSeqId=hq;function dq(){var t=new Date().getTime(),e=Date?.now&&Date.now()*1e3||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var n=Math.random()*16;return t>0?(n=(t+n)%16|0,t=Math.floor(t/16)):(n=(e+n)%16|0,e=Math.floor(e/16)),(r==="x"?n:n&7|8).toString(16)})}pe.generateRequestId=dq;function pq(t,e,r){r===void 0&&(r={});var n=/\?/.test(e),o="";return Object.keys(r).forEach(function(i){o===""?!n&&(e+="?"):o+="&",o+="".concat(i,"=").concat(encodeURIComponent(r[i]))}),e+=o,/^http(s)?:\/\//.test(e)?e:"".concat(t).concat(e)}pe.formatUrl=pq;function vq(t){t===void 0&&(t={});var e=[];return Object.keys(t).forEach(function(r){e.push("".concat(r,"=").concat(encodeURIComponent(t[r])))}),e.join("&")}pe.toQueryString=vq;function mq(t,e){if(typeof window>"u")return!1;var r=e||decodeURIComponent(window.location.search),n=new RegExp("(^|&)".concat(t,"=([^&]*)(&|$)")),o=r.substr(r.indexOf("?")+1).match(n);return o!=null?o[2]:""}pe.getQuery=mq;var gq=function(t){if(typeof window>"u")return"";var e=window.location.hash.match(new RegExp("[#?&/]".concat(t,"=([^&#]*)")));return e?e[1]:""};pe.getHash=gq;function yq(t,e){var r=e.split("?")[0],n,o=[],i=e.indexOf("?")!==-1?e.split("?")[1]:"";if(i!==""){o=i.split("&");for(var s=o.length-1;s>=0;s-=1)n=o[s].split("=")[0],n===t&&o.splice(s,1);r="".concat(r,"?").concat(o.join("&"))}return r}pe.removeParam=yq;function _q(){var t={};if(!Promise){t=function(){},t.promise={};var e=function(){throw new Error('Your Node runtime does support ES6 Promises. Set "global.Promise" to your preferred implementation of promises.')};return Object.defineProperty(t.promise,"then",{get:e}),Object.defineProperty(t.promise,"catch",{get:e}),t}var r=new Promise(function(n,o){t=function(i,s){return i?o(i):n(s)}});return t.promise=r,t}pe.createPromiseCallback=_q;function wq(t,e,r){if(r===void 0&&(r=null),t&&typeof t=="function")return t(e,r);if(e)throw e;return r}pe.execCallback=wq;function bq(t,e){console.warn("[".concat((0,Cc.getSdkName)(),"][").concat(t,"]:").concat(e))}pe.printWarn=bq;function Eq(t,e){console.error({code:t,msg:"[".concat((0,Cc.getSdkName)(),"][").concat(t,"]:").concat(e)})}pe.printError=Eq;function Sq(t,e){console.log("[".concat((0,Cc.getSdkName)(),"][").concat(t,"]:").concat(e))}pe.printInfo=Sq;function Iq(t,e){throw new Error(JSON.stringify({code:t,msg:"[".concat((0,Cc.getSdkName)(),"][").concat(t,"]:").concat(e)}))}pe.throwError=Iq;function Tq(t){var e,r=t.title,n=t.subtitle,o=n===void 0?"":n,i=t.content,s=i===void 0?[]:i,u=t.printTrace,l=u===void 0?!1:u,a=t.collapsed,c=a===void 0?!1:a;c?(console.groupCollapsed||console.error)(r,o):(console.group||console.error)(r,o);for(var h=0,w=s;h<w.length;h++){var E=w[h],T=E.type,A=E.body;switch(T){case"info":console.log(A);break;case"warn":console.warn(A);break;case"error":console.error(A);break}}l&&(console.trace||console.log)("stack trace:"),(e=console.groupEnd)===null||e===void 0||e.call(console)}pe.printGroupLog=Tq;var Oq=function(t){return t===void 0&&(t=0),new Promise(function(e){return setTimeout(e,t)})};pe.sleep=Oq;function Aq(t){return"+86".concat(t)}pe.transformPhone=Aq;var Rq=function(t){t=t.replace(/^\?/,"");var e={},r=t.split("&");return r.forEach(function(n){var o=n.split("="),i=o[0],s=o[1];i=decodeURIComponent(i),s=decodeURIComponent(s),i&&(e[i]?Array.isArray(e[i])?e[i].push(s):e[i]=[e[i],s]:e[i]=s)}),e};pe.parseQueryString=Rq;function Cq(t){var e={},r=t.match(/^(data:.*?)(\?[^#\s]*)?$/);if(r){t=r[1];var n=r[2];n&&(e=(0,pe.parseQueryString)(n))}var o=e.token,i=iq(e,["token"]);return/^data:/.test(t)&&!o?{error:"invalid_argument",error_description:"invalid captcha data: ".concat(t)}:o?{state:i.state,token:o,captchaData:t}:{error:"unimplemented",error_description:"need to impl captcha data"}}pe.parseCaptcha=Cq});var Xd=K(Et=>{"use strict";var Pq=Et&&Et.__extends||(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),xq=Et&&Et.__spreadArray||function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,i;n<o;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))};Object.defineProperty(Et,"__esModule",{value:!0});Et.removeEventListener=Et.activateEvent=Et.addEventListener=Et.CloudbaseEventEmitter=Et.IErrorEvent=Et.CloudbaseEvent=void 0;var rb=li();function Nq(t,e,r){r[t]=r[t]||[],r[t].push(e)}function Lq(t,e,r){if(r?.[t]){var n=r[t].indexOf(e);n!==-1&&r[t].splice(n,1)}}var Jd=(function(){function t(e,r){this.data=r||null,this.name=e}return t})();Et.CloudbaseEvent=Jd;var nb=(function(t){Pq(e,t);function e(r,n){var o=t.call(this,"error",{error:r,data:n})||this;return o.error=r,o}return e})(Jd);Et.IErrorEvent=nb;var ib=(function(){function t(){this.listeners={}}return t.prototype.on=function(e,r){return Nq(e,r,this.listeners),this},t.prototype.off=function(e,r){return Lq(e,r,this.listeners),this},t.prototype.fire=function(e,r){if((0,rb.isInstanceOf)(e,nb))return console.error(e.error),this;var n=(0,rb.isString)(e)?new Jd(e,r||{}):e,o=n.name;if(this.listens(o)){n.target=this;for(var i=this.listeners[o]?xq([],this.listeners[o],!0):[],s=0,u=i;s<u.length;s++){var l=u[s];l.call(this,n)}}return this},t.prototype.listens=function(e){return this.listeners[e]&&this.listeners[e].length>0},t})();Et.CloudbaseEventEmitter=ib;var Qd=new ib;function Dq(t,e){Qd.on(t,e)}Et.addEventListener=Dq;function Uq(t,e){e===void 0&&(e={}),Qd.fire(t,e)}Et.activateEvent=Uq;function Bq(t,e){Qd.off(t,e)}Et.removeEventListener=Bq});var ab,sb,ob,ub,cb,nr,qq,lb,fb=X(()=>{ab=st(Xd()),sb=st(li()),ob=(t,e)=>{let r;return(...n)=>{clearTimeout(r),r=setTimeout(()=>t.apply(null,n),e)}},ub=new ab.CloudbaseEventEmitter,cb={CAPTCHA_DATA_CHANGE:"captchaDataChange",RESOLVE_CAPTCHA_DATA:"resolveCaptchaData"},nr={overlay:"position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);z-index:999",modal:"position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:320px;padding:20px;background:#fff;border-radius:8px;box-shadow:0 0 10px rgba(0,0,0,0.2);z-index:1000",prompt:"margin-bottom:15px",captchaWrap:"display:flex;align-items:center;justify-content:space-between;margin-bottom:15px",captchaImg:"width:100%;height:auto;border:1px solid #eee",refreshBtn:"padding:10px 8px;background:#007bff;color:#fff;border:none;border-radius:4px;cursor:pointer;flex:1;white-space:nowrap;margin-left:10px",input:"width:100%;padding:14px 16px;margin-bottom:15px;box-sizing:border-box;border:2px solid #e8ecf4;border-radius:10px;font-size:15px",confirmBtn:"width:100%;padding:10px;background:#007bff;color:#fff;border:none;border-radius:4px;cursor:pointer",loading:"background:#6c757d;cursor:not-allowed"},qq=({oauthInstance:t,captchaState:e})=>{let r="captcha-image",n=async()=>{try{let T=await t.createCaptchaData({state:e.state});e={...e,captchaData:T.data,token:T.token},document.getElementById(r).src=T.data}catch(T){console.error("\u5237\u65B0\u56FE\u5F62\u9A8C\u8BC1\u7801\u5931\u8D25",T)}},o=(T,A,O)=>{let C=document.createElement(T);return A&&(C.style.cssText=A),O&&(C.textContent=O),C},i=o("div",nr.overlay),s=o("div",nr.modal);s.appendChild(o("p",nr.prompt,"\u8BF7\u8F93\u5165\u4F60\u770B\u5230\u7684\u5B57\u7B26\uFF1A"));let u=o("div",nr.captchaWrap),l=o("img",nr.captchaImg);l.id=r,l.src=e.captchaData,u.appendChild(l);let a=o("button",nr.refreshBtn,"\u5237\u65B0");a.onclick=ob(async()=>{a.textContent="\u52A0\u8F7D\u4E2D...",a.disabled=!0,a.style.cssText=`${nr.refreshBtn};${nr.loading}`;try{await n()}finally{a.textContent="\u5237\u65B0",a.disabled=!1,a.style.cssText=nr.refreshBtn}},500),u.appendChild(a),s.appendChild(u);let c=o("input",nr.input);c.type="text",c.placeholder="\u8F93\u5165\u5B57\u7B26",c.maxLength=4,s.appendChild(c);let h=o("div","color:#dc3545;font-size:12px;margin-bottom:10px;display:none;padding:8px;background:#f8d7da;border:1px solid #f5c6cb;border-radius:4px");s.appendChild(h);let w=T=>{h.textContent=T,h.style.display="block"},E=o("button",nr.confirmBtn,"\u786E\u5B9A");E.onclick=ob(async()=>{let T=c.value.trim();if(!T){w("\u8BF7\u8F93\u5165\u5B57\u7B26");return}h.style.display="none",E.textContent="\u9A8C\u8BC1\u4E2D...",E.disabled=!0,E.style.cssText=`${nr.confirmBtn};${nr.loading}`;try{let A=await t.verifyCaptchaData({token:e.token,key:T});ub.fire(cb.RESOLVE_CAPTCHA_DATA,A),console.log("\u56FE\u5F62\u9A8C\u8BC1\u7801\u6821\u9A8C\u6210\u529F"),document.body.removeChild(i),document.body.removeChild(s)}catch(A){console.error("\u56FE\u5F62\u9A8C\u8BC1\u7801\u6821\u9A8C\u5931\u8D25",A);let O=A.error_description||"\u56FE\u5F62\u9A8C\u8BC1\u7801\u6821\u9A8C\u5931\u8D25";w(O),c.value="",c.focus(),await n()}finally{E.textContent="\u786E\u5B9A",E.disabled=!1,E.style.cssText=nr.confirmBtn}},500),s.appendChild(E),document.body.appendChild(i),document.body.appendChild(s)},lb=async(t,e)=>{let{captchaData:r,state:n,token:o}=(0,sb.parseCaptcha)(t);return qq({oauthInstance:e,captchaState:{captchaData:r,state:n,token:o}}),new Promise(i=>{console.log("\u7B49\u5F85\u56FE\u5F62\u9A8C\u8BC1\u7801\u6821\u9A8C\u7ED3\u679C..."),ub.on(cb.RESOLVE_CAPTCHA_DATA,s=>{i(s?.data)})})}});var Pc,hb=X(()=>{ui();Ac();Vd();fb();Pc=class{constructor(e){e.openURIWithCallback||(e.openURIWithCallback=this.getDefaultOpenURIWithCallback()),e.storage||(e.storage=hs),this.config=e,this.tokenSectionName=`captcha_${e.clientId||e.env}`}isMatch(){return this.config?.adapter?.isMatch?.()||fs()}async request(e,r){r||(r={}),r.method||(r.method="GET");let n=`${r.method}:${e}`,o=e;r.withCaptcha&&(o=await this.appendCaptchaTokenToURL(e,n,!1));let i;try{i=await this.config.request(o,r)}catch(s){return s.error===bt.CAPTCHA_REQUIRED||s.error===bt.CAPTCHA_INVALID?(e=await this.appendCaptchaTokenToURL(e,n,s.error===bt.CAPTCHA_INVALID),this.config.request(e,r)):Promise.reject(s)}return i}getDefaultOpenURIWithCallback(){return e=>lb(e,this.config.oauthInstance)}async getCaptchaToken(e,r){if(!e){let s=await this.findCaptchaToken();if(s)return s}let n=await this.config.request(Ee.CAPTCHA_DATA_URL,{method:"POST",body:{state:r,redirect_uri:""},withCredentials:!1}),o=`${n.data}?state=${encodeURIComponent(r)}&token=${encodeURIComponent(n.token)}`,i=await this.config.openURIWithCallback(o);return this.saveCaptchaToken(i),i.captcha_token}async appendCaptchaTokenToURL(e,r,n){let o=await this.getCaptchaToken(n,r);return e.indexOf("?")>0?e+=`&captcha_token=${o}`:e+=`?captcha_token=${o}`,e}async saveCaptchaToken(e){e.expires_at=new Date(Date.now()+(e.expires_in-10)*1e3);let r=JSON.stringify(e);await this.config.storage.setItem(this.tokenSectionName,r)}async findCaptchaToken(){let e=await this.config.storage.getItem(this.tokenSectionName);if(e!=null)try{let r=JSON.parse(e);return r?.expires_at&&(r.expires_at=new Date(r.expires_at)),r.expires_at<new Date?null:r.captcha_token}catch{return await this.config.storage.removeItem(this.tokenSectionName),null}return null}}});var Zd,ds,db=X(()=>{Zd=class{constructor(e){if(this.params={},typeof e=="string")this.parse(e);else if(e&&typeof e=="object")for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&this.append(r,e[r])}parse(e){e.split("&").forEach(n=>{let[o,i]=n.split("=").map(decodeURIComponent);this.append(o,i)})}append(e,r){this.params[e]?this.params[e]=this.params[e].concat([r]):this.params[e]=[r]}get(e){return this.params[e]?this.params[e][0]:null}getAll(e){return this.params[e]||[]}delete(e){delete this.params[e]}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}set(e,r){this.params[e]=[r]}toString(){let e=[];for(let r in this.params)Object.prototype.hasOwnProperty.call(this.params,r)&&this.params[r].forEach(n=>{e.push(`${encodeURIComponent(r)}=${encodeURIComponent(n)}`)});return e.join("&")}},ds=Zd});var Sn,pb,zi,ep,tp,Ki,vb,Go,xc,Yi,rp,mb,gb,zn,yb,np,Ut,_b,wb,ip,op,bb,Nc,ps,Ji,mr,ap,vs,Kn,Lr,ms,Lc,gs,Eb,Sb=X(()=>{if(!globalThis.IS_MP_BUILD){let e=function(F){return pb.charAt(F)},r=function(F,d){return F&d},n=function(F,d){return F|d},o=function(F,d){return F^d},i=function(F,d){return F&~d},s=function(F){if(F==0)return-1;var d=0;return(F&65535)==0&&(F>>=16,d+=16),(F&255)==0&&(F>>=8,d+=8),(F&15)==0&&(F>>=4,d+=4),(F&3)==0&&(F>>=2,d+=2),(F&1)==0&&++d,d},u=function(F){for(var d=0;F!=0;)F&=F-1,++d;return d},l=function(F){var d,p,y="";for(d=0;d+3<=F.length;d+=3)p=parseInt(F.substring(d,d+3),16),y+=zi.charAt(p>>6)+zi.charAt(p&63);for(d+1==F.length?(p=parseInt(F.substring(d,d+1),16),y+=zi.charAt(p<<2)):d+2==F.length&&(p=parseInt(F.substring(d,d+2),16),y+=zi.charAt(p>>2)+zi.charAt((p&3)<<4));(y.length&3)>0;)y+=ep;return y},a=function(F){var d="",p,y=0,S=0;for(p=0;p<F.length&&F.charAt(p)!=ep;++p){var L=zi.indexOf(F.charAt(p));L<0||(y==0?(d+=e(L>>2),S=L&3,y=1):y==1?(d+=e(S<<2|L>>4),S=L&15,y=2):y==2?(d+=e(S),d+=e(L>>2),S=L&3,y=3):(d+=e(S<<2|L>>4),d+=e(L&15),y=0))}return y==1&&(d+=e(S<<2)),d},h=function(F,d){return F.length>d&&(F=F.substring(0,d)+rp),F},O=function(){return new A(null)},C=function(F,d){return new A(F,d)},P=function(F,d,p,y,S,L){for(;--L>=0;){var B=d*this[F++]+p[y]+S;S=Math.floor(B/67108864),p[y++]=B&67108863}return S},q=function(F,d,p,y,S,L){for(var B=d&32767,$=d>>15;--L>=0;){var Q=this[F]&32767,se=this[F++]>>15,Ie=$*Q+se*B;Q=B*Q+((Ie&32767)<<15)+p[y]+(S&1073741823),S=(Q>>>30)+(Ie>>>15)+$*se+(S>>>30),p[y++]=Q&1073741823}return S},U=function(F,d,p,y,S,L){for(var B=d&16383,$=d>>14;--L>=0;){var Q=this[F]&16383,se=this[F++]>>14,Ie=$*Q+se*B;Q=B*Q+((Ie&16383)<<14)+p[y]+S,S=(Q>>28)+(Ie>>14)+$*se,p[y++]=Q&268435455}return S},k=function(F,d){var p=ps[F.charCodeAt(d)];return p??-1},W=function(F){var d=O();return d.fromInt(F),d},V=function(F){var d=1,p;return(p=F>>>16)!=0&&(F=p,d+=16),(p=F>>8)!=0&&(F=p,d+=8),(p=F>>4)!=0&&(F=p,d+=4),(p=F>>2)!=0&&(F=p,d+=2),(p=F>>1)!=0&&(F=p,d+=1),d},Z=function(){return new Y},ae=function(){if(vs==null){for(vs=Z();Lr<ap;){var F=Math.floor(65536*Math.random());Kn[Lr++]=F&255}for(vs.init(Kn),Lr=0;Lr<Kn.length;++Lr)Kn[Lr]=0;Lr=0}return vs.next()},ue=function(F,d){if(d<F.length+22)return console.error("Message too long for RSA"),null;for(var p=d-F.length-6,y="",S=0;S<p;S+=2)y+="ff";var L="0001"+y+"00"+F;return C(L,16)},be=function(F,d){if(d<F.length+11)return console.error("Message too long for RSA"),null;for(var p=[],y=F.length-1;y>=0&&d>0;){var S=F.charCodeAt(y--);S<128?p[--d]=S:S>127&&S<2048?(p[--d]=S&63|128,p[--d]=S>>6|192):(p[--d]=S&63|128,p[--d]=S>>6&63|128,p[--d]=S>>12|224)}p[--d]=0;for(var L=new ie,B=[];d>2;){for(B[0]=0;B[0]==0;)L.nextBytes(B);p[--d]=B[0]}return p[--d]=2,p[--d]=0,new A(p)},Ot=function(F,d){for(var p=F.toByteArray(),y=0;y<p.length&&p[y]==0;)++y;if(p.length-y!=d-1||p[y]!=2)return null;for(++y;p[y]!=0;)if(++y>=p.length)return null;for(var S="";++y<p.length;){var L=p[y]&255;L<128?S+=String.fromCharCode(L):L>191&&L<224?(S+=String.fromCharCode((L&31)<<6|p[y+1]&63),++y):(S+=String.fromCharCode((L&15)<<12|(p[y+1]&63)<<6|p[y+2]&63),y+=2)}return S},t=typeof globalThis<"u"?globalThis.navigator:window.globalThis;pb="0123456789abcdefghijklmnopqrstuvwxyz",zi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ep="=",tp=function(F,d){return tp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,y){p.__proto__=y}||function(p,y){for(var S in y)y.hasOwnProperty(S)&&(p[S]=y[S])},tp(F,d)},vb={decode:function(F){var d;if(Ki===void 0){var p="0123456789ABCDEF",y=` \f
\r	\xA0\u2028\u2029`;for(Ki={},d=0;d<16;++d)Ki[p.charAt(d)]=d;for(p=p.toLowerCase(),d=10;d<16;++d)Ki[p.charAt(d)]=d;for(d=0;d<y.length;++d)Ki[y.charAt(d)]=-1}var S=[],L=0,B=0;for(d=0;d<F.length;++d){var $=F.charAt(d);if($=="=")break;if($=Ki[$],$!=-1){if($===void 0)throw new Error("Illegal character at offset "+d);L|=$,++B>=2?(S[S.length]=L,L=0,B=0):L<<=4}}if(B)throw new Error("Hex encoding incomplete: 4 bits missing");return S}},xc={decode:function(F){var d;if(Go===void 0){var p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",y=`= \f
\r	\xA0\u2028\u2029`;for(Go=Object.create(null),d=0;d<64;++d)Go[p.charAt(d)]=d;for(d=0;d<y.length;++d)Go[y.charAt(d)]=-1}var S=[],L=0,B=0;for(d=0;d<F.length;++d){var $=F.charAt(d);if($=="=")break;if($=Go[$],$!=-1){if($===void 0)throw new Error("Illegal character at offset "+d);L|=$,++B>=4?(S[S.length]=L>>16,S[S.length]=L>>8&255,S[S.length]=L&255,L=0,B=0):L<<=6}}switch(B){case 1:throw new Error("Base64 encoding incomplete: at least 2 bits missing");case 2:S[S.length]=L>>10;break;case 3:S[S.length]=L>>16,S[S.length]=L>>8&255;break}return S},re:/-----BEGIN [^-]+-----([A-Za-z0-9+\/=\s]+)-----END [^-]+-----|begin-base64[^\n]+\n([A-Za-z0-9+\/=\s]+)====/,unarmor:function(F){var d=xc.re.exec(F);if(d)if(d[1])F=d[1];else if(d[2])F=d[2];else throw new Error("RegExp out of sync");return xc.decode(F)}},Yi=1e13;class c{constructor(d){this.buf=[+d||0]}mulAdd(d,p){var y=this.buf,S=y.length,L,B;for(L=0;L<S;++L)B=y[L]*d+p,B<Yi?p=0:(p=0|B/Yi,B-=p*Yi),y[L]=B;p>0&&(y[L]=p)}sub(d){var p=this.buf,y=p.length,S,L;for(S=0;S<y;++S)L=p[S]-d,L<0?(L+=Yi,d=1):d=0,p[S]=L;for(;p[p.length-1]===0;)p.pop()}toString(d){if((d||10)!=10)throw new Error("only base 10 is supported");for(var p=this.buf,y=p[p.length-1].toString(),S=p.length-2;S>=0;--S)y+=(Yi+p[S]).toString().substring(1);return y}valueOf(){for(var d=this.buf,p=0,y=d.length-1;y>=0;--y)p=p*Yi+d[y];return p}simplify(){var d=this.buf;return d.length==1?d[0]:this}}rp="\u2026",mb=/^(\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,gb=/^(\d\d\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/;class w{constructor(d,p){this.hexDigits="0123456789ABCDEF",d instanceof w?(this.enc=d.enc,this.pos=d.pos):(this.enc=d,this.pos=p)}get(d){if(d===void 0&&(d=this.pos++),d>=this.enc.length)throw new Error("Requesting byte offset "+d+" on a stream of length "+this.enc.length);return typeof this.enc=="string"?this.enc.charCodeAt(d):this.enc[d]}hexByte(d){return this.hexDigits.charAt(d>>4&15)+this.hexDigits.charAt(d&15)}hexDump(d,p,y){for(var S="",L=d;L<p;++L)if(S+=this.hexByte(this.get(L)),y!==!0)switch(L&15){case 7:S+="  ";break;case 15:S+=`
`;break;default:S+=" "}return S}isASCII(d,p){for(var y=d;y<p;++y){var S=this.get(y);if(S<32||S>176)return!1}return!0}parseStringISO(d,p){for(var y="",S=d;S<p;++S)y+=String.fromCharCode(this.get(S));return y}parseStringUTF(d,p){for(var y="",S=d;S<p;){var L=this.get(S++);L<128?y+=String.fromCharCode(L):L>191&&L<224?y+=String.fromCharCode((L&31)<<6|this.get(S++)&63):y+=String.fromCharCode((L&15)<<12|(this.get(S++)&63)<<6|this.get(S++)&63)}return y}parseStringBMP(d,p){for(var y="",S,L,B=d;B<p;)S=this.get(B++),L=this.get(B++),y+=String.fromCharCode(S<<8|L);return y}parseTime(d,p,y){var S=this.parseStringISO(d,p),L=(y?mb:gb).exec(S);return L?(y&&(L[1]=+L[1],L[1]+=+L[1]<70?2e3:1900),S=L[1]+"-"+L[2]+"-"+L[3]+" "+L[4],L[5]&&(S+=":"+L[5],L[6]&&(S+=":"+L[6],L[7]&&(S+="."+L[7]))),L[8]&&(S+=" UTC",L[8]!="Z"&&(S+=L[8],L[9]&&(S+=":"+L[9]))),S):"Unrecognized time: "+S}parseInteger(d,p){for(var y=this.get(d),S=y>127,L=S?255:0,B,$="";y==L&&++d<p;)y=this.get(d);if(B=p-d,B===0)return S?-1:0;if(B>4){for($=y,B<<=3;((+$^L)&128)==0;)$=+$<<1,--B;$="("+B+` bit)
`}S&&(y=y-256);for(var Q=new c(y),se=d+1;se<p;++se)Q.mulAdd(256,this.get(se));return $+Q.toString()}parseBitString(d,p,y){for(var S=this.get(d),L=(p-d-1<<3)-S,B="("+L+` bit)
`,$="",Q=d+1;Q<p;++Q){for(var se=this.get(Q),Ie=Q==p-1?S:0,Ae=7;Ae>=Ie;--Ae)$+=se>>Ae&1?"1":"0";if($.length>y)return B+h($,y)}return B+$}parseOctetString(d,p,y){if(this.isASCII(d,p))return h(this.parseStringISO(d,p),y);var S=p-d,L="("+S+` byte)
`;y/=2,S>y&&(p=d+y);for(var B=d;B<p;++B)L+=this.hexByte(this.get(B));return S>y&&(L+=rp),L}parseOID(d,p,y){for(var S="",L=new c,B=0,$=d;$<p;++$){var Q=this.get($);if(L.mulAdd(128,Q&127),B+=7,!(Q&128)){if(S==="")if(L=L.simplify(),L instanceof c)L.sub(80),S="2."+L.toString();else{var se=L<80?L<40?0:1:2;S=se+"."+(L-se*40)}else S+="."+L.toString();if(S.length>y)return h(S,y);L=new c,B=0}}return B>0&&(S+=".incomplete"),S}}class E{constructor(d,p,y,S,L){if(!(S instanceof T))throw new Error("Invalid tag value.");this.stream=d,this.header=p,this.length=y,this.tag=S,this.sub=L}typeName(){switch(this.tag.tagClass){case 0:switch(this.tag.tagNumber){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString"}return"Universal_"+this.tag.tagNumber.toString();case 1:return"Application_"+this.tag.tagNumber.toString();case 2:return"["+this.tag.tagNumber.toString()+"]";case 3:return"Private_"+this.tag.tagNumber.toString()}}content(d){if(this.tag===void 0)return null;d===void 0&&(d=1/0);var p=this.posContent(),y=Math.abs(this.length);if(!this.tag.isUniversal())return this.sub!==null?"("+this.sub.length+" elem)":this.stream.parseOctetString(p,p+y,d);switch(this.tag.tagNumber){case 1:return this.stream.get(p)===0?"false":"true";case 2:return this.stream.parseInteger(p,p+y);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(p,p+y,d);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(p,p+y,d);case 6:return this.stream.parseOID(p,p+y,d);case 16:case 17:return this.sub!==null?"("+this.sub.length+" elem)":"(no elem)";case 12:return h(this.stream.parseStringUTF(p,p+y),d);case 18:case 19:case 20:case 21:case 22:case 26:return h(this.stream.parseStringISO(p,p+y),d);case 30:return h(this.stream.parseStringBMP(p,p+y),d);case 23:case 24:return this.stream.parseTime(p,p+y,this.tag.tagNumber==23)}return null}toString(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(this.sub===null?"null":this.sub.length)+"]"}toPrettyString(d){d===void 0&&(d="");var p=d+this.typeName()+" @"+this.stream.pos;if(this.length>=0&&(p+="+"),p+=this.length,this.tag.tagConstructed?p+=" (constructed)":this.tag.isUniversal()&&(this.tag.tagNumber==3||this.tag.tagNumber==4)&&this.sub!==null&&(p+=" (encapsulates)"),p+=`
`,this.sub!==null){d+="  ";for(var y=0,S=this.sub.length;y<S;++y)p+=this.sub[y].toPrettyString(d)}return p}posStart(){return this.stream.pos}posContent(){return this.stream.pos+this.header}posEnd(){return this.stream.pos+this.header+Math.abs(this.length)}toHexString(){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)}static decodeLength(d){var p=d.get(),y=p&127;if(y==p)return y;if(y>6)throw new Error("Length over 48 bits not supported at position "+(d.pos-1));if(y===0)return null;p=0;for(var S=0;S<y;++S)p=p*256+d.get();return p}getHexStringValue(){var d=this.toHexString(),p=this.header*2,y=this.length*2;return d.substr(p,y)}static decode(d){var p;d instanceof w?p=d:p=new w(d,0);var y=new w(p),S=new T(p),L=E.decodeLength(p),B=p.pos,$=B-y.pos,Q=null,se=function(){var Ae=[];if(L!==null){for(var Te=B+L;p.pos<Te;)Ae[Ae.length]=E.decode(p);if(p.pos!=Te)throw new Error("Content size is not correct for container starting at offset "+B)}else try{for(;;){var Ce=E.decode(p);if(Ce.tag.isEOC())break;Ae[Ae.length]=Ce}L=B-p.pos}catch(Fe){throw new Error("Exception while decoding undefined length content: "+Fe)}return Ae};if(S.tagConstructed)Q=se();else if(S.isUniversal()&&(S.tagNumber==3||S.tagNumber==4))try{if(S.tagNumber==3&&p.get()!=0)throw new Error("BIT STRINGs with unused bits cannot encapsulate.");Q=se();for(var Ie=0;Ie<Q.length;++Ie)if(Q[Ie].tag.isEOC())throw new Error("EOC is not supposed to be actual content.")}catch{Q=null}if(Q===null){if(L===null)throw new Error("We can't skip over an invalid tag with undefined length at offset "+B);p.pos=B+Math.abs(L)}return new E(y,$,L,S,Q)}}class T{constructor(d){var p=d.get();if(this.tagClass=p>>6,this.tagConstructed=(p&32)!==0,this.tagNumber=p&31,this.tagNumber==31){var y=new c;do p=d.get(),y.mulAdd(128,p&127);while(p&128);this.tagNumber=y.simplify()}}isUniversal(){return this.tagClass===0}isEOC(){return this.tagClass===0&&this.tagNumber===0}}yb=0xdeadbeefcafe,np=(yb&16777215)==15715070,Ut=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],_b=(1<<26)/Ut[Ut.length-1];class A{constructor(d,p,y){d!=null&&(typeof d=="number"?this.fromNumber(d,p,y):p==null&&typeof d!="string"?this.fromString(d,256):this.fromString(d,p))}toString(d){if(this.s<0)return"-"+this.negate().toString(d);var p;if(d==16)p=4;else if(d==8)p=3;else if(d==2)p=1;else if(d==32)p=5;else if(d==4)p=2;else return this.toRadix(d);var y=(1<<p)-1,S,L=!1,B="",$=this.t,Q=this.DB-$*this.DB%p;if($-- >0)for(Q<this.DB&&(S=this[$]>>Q)>0&&(L=!0,B=e(S));$>=0;)Q<p?(S=(this[$]&(1<<Q)-1)<<p-Q,S|=this[--$]>>(Q+=this.DB-p)):(S=this[$]>>(Q-=p)&y,Q<=0&&(Q+=this.DB,--$)),S>0&&(L=!0),L&&(B+=e(S));return L?B:"0"}negate(){var d=O();return A.ZERO.subTo(this,d),d}abs(){return this.s<0?this.negate():this}compareTo(d){var p=this.s-d.s;if(p!=0)return p;var y=this.t;if(p=y-d.t,p!=0)return this.s<0?-p:p;for(;--y>=0;)if((p=this[y]-d[y])!=0)return p;return 0}bitLength(){return this.t<=0?0:this.DB*(this.t-1)+V(this[this.t-1]^this.s&this.DM)}mod(d){var p=O();return this.abs().divRemTo(d,null,p),this.s<0&&p.compareTo(A.ZERO)>0&&d.subTo(p,p),p}modPowInt(d,p){var y;return d<256||p.isEven()?y=new ip(p):y=new op(p),this.exp(d,y)}clone(){var d=O();return this.copyTo(d),d}intValue(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}byteValue(){return this.t==0?this.s:this[0]<<24>>24}shortValue(){return this.t==0?this.s:this[0]<<16>>16}signum(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}toByteArray(){var d=this.t,p=[];p[0]=this.s;var y=this.DB-d*this.DB%8,S,L=0;if(d-- >0)for(y<this.DB&&(S=this[d]>>y)!=(this.s&this.DM)>>y&&(p[L++]=S|this.s<<this.DB-y);d>=0;)y<8?(S=(this[d]&(1<<y)-1)<<8-y,S|=this[--d]>>(y+=this.DB-8)):(S=this[d]>>(y-=8)&255,y<=0&&(y+=this.DB,--d)),(S&128)!=0&&(S|=-256),L==0&&(this.s&128)!=(S&128)&&++L,(L>0||S!=this.s)&&(p[L++]=S);return p}equals(d){return this.compareTo(d)==0}min(d){return this.compareTo(d)<0?this:d}max(d){return this.compareTo(d)>0?this:d}and(d){var p=O();return this.bitwiseTo(d,r,p),p}or(d){var p=O();return this.bitwiseTo(d,n,p),p}xor(d){var p=O();return this.bitwiseTo(d,o,p),p}andNot(d){var p=O();return this.bitwiseTo(d,i,p),p}not(){for(var d=O(),p=0;p<this.t;++p)d[p]=this.DM&~this[p];return d.t=this.t,d.s=~this.s,d}shiftLeft(d){var p=O();return d<0?this.rShiftTo(-d,p):this.lShiftTo(d,p),p}shiftRight(d){var p=O();return d<0?this.lShiftTo(-d,p):this.rShiftTo(d,p),p}getLowestSetBit(){for(var d=0;d<this.t;++d)if(this[d]!=0)return d*this.DB+s(this[d]);return this.s<0?this.t*this.DB:-1}bitCount(){for(var d=0,p=this.s&this.DM,y=0;y<this.t;++y)d+=u(this[y]^p);return d}testBit(d){var p=Math.floor(d/this.DB);return p>=this.t?this.s!=0:(this[p]&1<<d%this.DB)!=0}setBit(d){return this.changeBit(d,n)}clearBit(d){return this.changeBit(d,i)}flipBit(d){return this.changeBit(d,o)}add(d){var p=O();return this.addTo(d,p),p}subtract(d){var p=O();return this.subTo(d,p),p}multiply(d){var p=O();return this.multiplyTo(d,p),p}divide(d){var p=O();return this.divRemTo(d,p,null),p}remainder(d){var p=O();return this.divRemTo(d,null,p),p}divideAndRemainder(d){var p=O(),y=O();return this.divRemTo(d,p,y),[p,y]}modPow(d,p){var y=d.bitLength(),S,L=W(1),B;if(y<=0)return L;y<18?S=1:y<48?S=3:y<144?S=4:y<768?S=5:S=6,y<8?B=new ip(p):p.isEven()?B=new bb(p):B=new op(p);var $=[],Q=3,se=S-1,Ie=(1<<S)-1;if($[1]=B.convert(this),S>1){var Ae=O();for(B.sqrTo($[1],Ae);Q<=Ie;)$[Q]=O(),B.mulTo(Ae,$[Q-2],$[Q]),Q+=2}var Te=d.t-1,Ce,Fe=!0,je=O(),et;for(y=V(d[Te])-1;Te>=0;){for(y>=se?Ce=d[Te]>>y-se&Ie:(Ce=(d[Te]&(1<<y+1)-1)<<se-y,Te>0&&(Ce|=d[Te-1]>>this.DB+y-se)),Q=S;(Ce&1)==0;)Ce>>=1,--Q;if((y-=Q)<0&&(y+=this.DB,--Te),Fe)$[Ce].copyTo(L),Fe=!1;else{for(;Q>1;)B.sqrTo(L,je),B.sqrTo(je,L),Q-=2;Q>0?B.sqrTo(L,je):(et=L,L=je,je=et),B.mulTo(je,$[Ce],L)}for(;Te>=0&&(d[Te]&1<<y)==0;)B.sqrTo(L,je),et=L,L=je,je=et,--y<0&&(y=this.DB-1,--Te)}return B.revert(L)}modInverse(d){var p=d.isEven();if(this.isEven()&&p||d.signum()==0)return A.ZERO;for(var y=d.clone(),S=this.clone(),L=W(1),B=W(0),$=W(0),Q=W(1);y.signum()!=0;){for(;y.isEven();)y.rShiftTo(1,y),p?((!L.isEven()||!B.isEven())&&(L.addTo(this,L),B.subTo(d,B)),L.rShiftTo(1,L)):B.isEven()||B.subTo(d,B),B.rShiftTo(1,B);for(;S.isEven();)S.rShiftTo(1,S),p?((!$.isEven()||!Q.isEven())&&($.addTo(this,$),Q.subTo(d,Q)),$.rShiftTo(1,$)):Q.isEven()||Q.subTo(d,Q),Q.rShiftTo(1,Q);y.compareTo(S)>=0?(y.subTo(S,y),p&&L.subTo($,L),B.subTo(Q,B)):(S.subTo(y,S),p&&$.subTo(L,$),Q.subTo(B,Q))}if(S.compareTo(A.ONE)!=0)return A.ZERO;if(Q.compareTo(d)>=0)return Q.subtract(d);if(Q.signum()<0)Q.addTo(d,Q);else return Q;return Q.signum()<0?Q.add(d):Q}pow(d){return this.exp(d,new wb)}gcd(d){var p=this.s<0?this.negate():this.clone(),y=d.s<0?d.negate():d.clone();if(p.compareTo(y)<0){var S=p;p=y,y=S}var L=p.getLowestSetBit(),B=y.getLowestSetBit();if(B<0)return p;for(L<B&&(B=L),B>0&&(p.rShiftTo(B,p),y.rShiftTo(B,y));p.signum()>0;)(L=p.getLowestSetBit())>0&&p.rShiftTo(L,p),(L=y.getLowestSetBit())>0&&y.rShiftTo(L,y),p.compareTo(y)>=0?(p.subTo(y,p),p.rShiftTo(1,p)):(y.subTo(p,y),y.rShiftTo(1,y));return B>0&&y.lShiftTo(B,y),y}isProbablePrime(d){var p,y=this.abs();if(y.t==1&&y[0]<=Ut[Ut.length-1]){for(p=0;p<Ut.length;++p)if(y[0]==Ut[p])return!0;return!1}if(y.isEven())return!1;for(p=1;p<Ut.length;){for(var S=Ut[p],L=p+1;L<Ut.length&&S<_b;)S*=Ut[L++];for(S=y.modInt(S);p<L;)if(S%Ut[p++]==0)return!1}return y.millerRabin(d)}copyTo(d){for(var p=this.t-1;p>=0;--p)d[p]=this[p];d.t=this.t,d.s=this.s}fromInt(d){this.t=1,this.s=d<0?-1:0,d>0?this[0]=d:d<-1?this[0]=d+this.DV:this.t=0}fromString(d,p){var y;if(p==16)y=4;else if(p==8)y=3;else if(p==256)y=8;else if(p==2)y=1;else if(p==32)y=5;else if(p==4)y=2;else{this.fromRadix(d,p);return}this.t=0,this.s=0;for(var S=d.length,L=!1,B=0;--S>=0;){var $=y==8?+d[S]&255:k(d,S);if($<0){d.charAt(S)=="-"&&(L=!0);continue}L=!1,B==0?this[this.t++]=$:B+y>this.DB?(this[this.t-1]|=($&(1<<this.DB-B)-1)<<B,this[this.t++]=$>>this.DB-B):this[this.t-1]|=$<<B,B+=y,B>=this.DB&&(B-=this.DB)}y==8&&(+d[0]&128)!=0&&(this.s=-1,B>0&&(this[this.t-1]|=(1<<this.DB-B)-1<<B)),this.clamp(),L&&A.ZERO.subTo(this,this)}clamp(){for(var d=this.s&this.DM;this.t>0&&this[this.t-1]==d;)--this.t}dlShiftTo(d,p){var y;for(y=this.t-1;y>=0;--y)p[y+d]=this[y];for(y=d-1;y>=0;--y)p[y]=0;p.t=this.t+d,p.s=this.s}drShiftTo(d,p){for(var y=d;y<this.t;++y)p[y-d]=this[y];p.t=Math.max(this.t-d,0),p.s=this.s}lShiftTo(d,p){for(var y=d%this.DB,S=this.DB-y,L=(1<<S)-1,B=Math.floor(d/this.DB),$=this.s<<y&this.DM,Q=this.t-1;Q>=0;--Q)p[Q+B+1]=this[Q]>>S|$,$=(this[Q]&L)<<y;for(var Q=B-1;Q>=0;--Q)p[Q]=0;p[B]=$,p.t=this.t+B+1,p.s=this.s,p.clamp()}rShiftTo(d,p){p.s=this.s;var y=Math.floor(d/this.DB);if(y>=this.t){p.t=0;return}var S=d%this.DB,L=this.DB-S,B=(1<<S)-1;p[0]=this[y]>>S;for(var $=y+1;$<this.t;++$)p[$-y-1]|=(this[$]&B)<<L,p[$-y]=this[$]>>S;S>0&&(p[this.t-y-1]|=(this.s&B)<<L),p.t=this.t-y,p.clamp()}subTo(d,p){for(var y=0,S=0,L=Math.min(d.t,this.t);y<L;)S+=this[y]-d[y],p[y++]=S&this.DM,S>>=this.DB;if(d.t<this.t){for(S-=d.s;y<this.t;)S+=this[y],p[y++]=S&this.DM,S>>=this.DB;S+=this.s}else{for(S+=this.s;y<d.t;)S-=d[y],p[y++]=S&this.DM,S>>=this.DB;S-=d.s}p.s=S<0?-1:0,S<-1?p[y++]=this.DV+S:S>0&&(p[y++]=S),p.t=y,p.clamp()}multiplyTo(d,p){var y=this.abs(),S=d.abs(),L=y.t;for(p.t=L+S.t;--L>=0;)p[L]=0;for(L=0;L<S.t;++L)p[L+y.t]=y.am(0,S[L],p,L,0,y.t);p.s=0,p.clamp(),this.s!=d.s&&A.ZERO.subTo(p,p)}squareTo(d){for(var p=this.abs(),y=d.t=2*p.t;--y>=0;)d[y]=0;for(y=0;y<p.t-1;++y){var S=p.am(y,p[y],d,2*y,0,1);(d[y+p.t]+=p.am(y+1,2*p[y],d,2*y+1,S,p.t-y-1))>=p.DV&&(d[y+p.t]-=p.DV,d[y+p.t+1]=1)}d.t>0&&(d[d.t-1]+=p.am(y,p[y],d,2*y,0,1)),d.s=0,d.clamp()}divRemTo(d,p,y){var S=d.abs();if(!(S.t<=0)){var L=this.abs();if(L.t<S.t){p?.fromInt(0),y!=null&&this.copyTo(y);return}y==null&&(y=O());var B=O(),$=this.s,Q=d.s,se=this.DB-V(S[S.t-1]);se>0?(S.lShiftTo(se,B),L.lShiftTo(se,y)):(S.copyTo(B),L.copyTo(y));var Ie=B.t,Ae=B[Ie-1];if(Ae!=0){var Te=Ae*(1<<this.F1)+(Ie>1?B[Ie-2]>>this.F2:0),Ce=this.FV/Te,Fe=(1<<this.F1)/Te,je=1<<this.F2,et=y.t,Er=et-Ie,R=p??O();for(B.dlShiftTo(Er,R),y.compareTo(R)>=0&&(y[y.t++]=1,y.subTo(R,y)),A.ONE.dlShiftTo(Ie,R),R.subTo(B,B);B.t<Ie;)B[B.t++]=0;for(;--Er>=0;){var _=y[--et]==Ae?this.DM:Math.floor(y[et]*Ce+(y[et-1]+je)*Fe);if((y[et]+=B.am(0,_,y,Er,0,Ie))<_)for(B.dlShiftTo(Er,R),y.subTo(R,y);y[et]<--_;)y.subTo(R,y)}p!=null&&(y.drShiftTo(Ie,p),$!=Q&&A.ZERO.subTo(p,p)),y.t=Ie,y.clamp(),se>0&&y.rShiftTo(se,y),$<0&&A.ZERO.subTo(y,y)}}}invDigit(){if(this.t<1)return 0;var d=this[0];if((d&1)==0)return 0;var p=d&3;return p=p*(2-(d&15)*p)&15,p=p*(2-(d&255)*p)&255,p=p*(2-((d&65535)*p&65535))&65535,p=p*(2-d*p%this.DV)%this.DV,p>0?this.DV-p:-p}isEven(){return(this.t>0?this[0]&1:this.s)==0}exp(d,p){if(d>4294967295||d<1)return A.ONE;var y=O(),S=O(),L=p.convert(this),B=V(d)-1;for(L.copyTo(y);--B>=0;)if(p.sqrTo(y,S),(d&1<<B)>0)p.mulTo(S,L,y);else{var $=y;y=S,S=$}return p.revert(y)}chunkSize(d){return Math.floor(Math.LN2*this.DB/Math.log(d))}toRadix(d){if(d==null&&(d=10),this.signum()==0||d<2||d>36)return"0";var p=this.chunkSize(d),y=Math.pow(d,p),S=W(y),L=O(),B=O(),$="";for(this.divRemTo(S,L,B);L.signum()>0;)$=(y+B.intValue()).toString(d).substr(1)+$,L.divRemTo(S,L,B);return B.intValue().toString(d)+$}fromRadix(d,p){this.fromInt(0),p==null&&(p=10);for(var y=this.chunkSize(p),S=Math.pow(p,y),L=!1,B=0,$=0,Q=0;Q<d.length;++Q){var se=k(d,Q);if(se<0){d.charAt(Q)=="-"&&this.signum()==0&&(L=!0);continue}$=p*$+se,++B>=y&&(this.dMultiply(S),this.dAddOffset($,0),B=0,$=0)}B>0&&(this.dMultiply(Math.pow(p,B)),this.dAddOffset($,0)),L&&A.ZERO.subTo(this,this)}fromNumber(d,p,y){if(typeof p=="number")if(d<2)this.fromInt(1);else for(this.fromNumber(d,y),this.testBit(d-1)||this.bitwiseTo(A.ONE.shiftLeft(d-1),n,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(p);)this.dAddOffset(2,0),this.bitLength()>d&&this.subTo(A.ONE.shiftLeft(d-1),this);else{var S=[],L=d&7;S.length=(d>>3)+1,p.nextBytes(S),L>0?S[0]&=(1<<L)-1:S[0]=0,this.fromString(S,256)}}bitwiseTo(d,p,y){var S,L,B=Math.min(d.t,this.t);for(S=0;S<B;++S)y[S]=p(this[S],d[S]);if(d.t<this.t){for(L=d.s&this.DM,S=B;S<this.t;++S)y[S]=p(this[S],L);y.t=this.t}else{for(L=this.s&this.DM,S=B;S<d.t;++S)y[S]=p(L,d[S]);y.t=d.t}y.s=p(this.s,d.s),y.clamp()}changeBit(d,p){var y=A.ONE.shiftLeft(d);return this.bitwiseTo(y,p,y),y}addTo(d,p){for(var y=0,S=0,L=Math.min(d.t,this.t);y<L;)S+=this[y]+d[y],p[y++]=S&this.DM,S>>=this.DB;if(d.t<this.t){for(S+=d.s;y<this.t;)S+=this[y],p[y++]=S&this.DM,S>>=this.DB;S+=this.s}else{for(S+=this.s;y<d.t;)S+=d[y],p[y++]=S&this.DM,S>>=this.DB;S+=d.s}p.s=S<0?-1:0,S>0?p[y++]=S:S<-1&&(p[y++]=this.DV+S),p.t=y,p.clamp()}dMultiply(d){this[this.t]=this.am(0,d-1,this,0,0,this.t),++this.t,this.clamp()}dAddOffset(d,p){if(d!=0){for(;this.t<=p;)this[this.t++]=0;for(this[p]+=d;this[p]>=this.DV;)this[p]-=this.DV,++p>=this.t&&(this[this.t++]=0),++this[p]}}multiplyLowerTo(d,p,y){var S=Math.min(this.t+d.t,p);for(y.s=0,y.t=S;S>0;)y[--S]=0;for(var L=y.t-this.t;S<L;++S)y[S+this.t]=this.am(0,d[S],y,S,0,this.t);for(var L=Math.min(d.t,p);S<L;++S)this.am(0,d[S],y,S,0,p-S);y.clamp()}multiplyUpperTo(d,p,y){--p;var S=y.t=this.t+d.t-p;for(y.s=0;--S>=0;)y[S]=0;for(S=Math.max(p-this.t,0);S<d.t;++S)y[this.t+S-p]=this.am(p-S,d[S],y,0,0,this.t+S-p);y.clamp(),y.drShiftTo(1,y)}modInt(d){if(d<=0)return 0;var p=this.DV%d,y=this.s<0?d-1:0;if(this.t>0)if(p==0)y=this[0]%d;else for(var S=this.t-1;S>=0;--S)y=(p*y+this[S])%d;return y}millerRabin(d){var p=this.subtract(A.ONE),y=p.getLowestSetBit();if(y<=0)return!1;var S=p.shiftRight(y);d=d+1>>1,d>Ut.length&&(d=Ut.length);for(var L=O(),B=0;B<d;++B){L.fromInt(Ut[Math.floor(Math.random()*Ut.length)]);var $=L.modPow(S,this);if($.compareTo(A.ONE)!=0&&$.compareTo(p)!=0){for(var Q=1;Q++<y&&$.compareTo(p)!=0;)if($=$.modPowInt(2,this),$.compareTo(A.ONE)==0)return!1;if($.compareTo(p)!=0)return!1}}return!0}square(){var d=O();return this.squareTo(d),d}gcda(d,p){var y=this.s<0?this.negate():this.clone(),S=d.s<0?d.negate():d.clone();if(y.compareTo(S)<0){var L=y;y=S,S=L}var B=y.getLowestSetBit(),$=S.getLowestSetBit();if($<0){p(y);return}B<$&&($=B),$>0&&(y.rShiftTo($,y),S.rShiftTo($,S));var Q=()=>{(B=y.getLowestSetBit())>0&&y.rShiftTo(B,y),(B=S.getLowestSetBit())>0&&S.rShiftTo(B,S),y.compareTo(S)>=0?(y.subTo(S,y),y.rShiftTo(1,y)):(S.subTo(y,S),S.rShiftTo(1,S)),y.signum()>0?setTimeout(Q,0):($>0&&S.lShiftTo($,S),setTimeout(function(){p(S)},0))};setTimeout(Q,10)}fromNumberAsync(d,p,y,S){if(typeof p=="number")if(d<2)this.fromInt(1);else{this.fromNumber(d,y),this.testBit(d-1)||this.bitwiseTo(A.ONE.shiftLeft(d-1),n,this),this.isEven()&&this.dAddOffset(1,0);var L=this,B=function(){L.dAddOffset(2,0),L.bitLength()>d&&L.subTo(A.ONE.shiftLeft(d-1),L),L.isProbablePrime(p)?setTimeout(function(){S()},0):setTimeout(B,0)};setTimeout(B,0)}else{var $=[],Q=d&7;$.length=(d>>3)+1,p.nextBytes($),Q>0?$[0]&=(1<<Q)-1:$[0]=0,this.fromString($,256)}}}for(wb=(function(){function F(){}return F.prototype.convert=function(d){return d},F.prototype.revert=function(d){return d},F.prototype.mulTo=function(d,p,y){d.multiplyTo(p,y)},F.prototype.sqrTo=function(d,p){d.squareTo(p)},F})(),ip=(function(){function F(d){this.m=d}return F.prototype.convert=function(d){return d.s<0||d.compareTo(this.m)>=0?d.mod(this.m):d},F.prototype.revert=function(d){return d},F.prototype.reduce=function(d){d.divRemTo(this.m,null,d)},F.prototype.mulTo=function(d,p,y){d.multiplyTo(p,y),this.reduce(y)},F.prototype.sqrTo=function(d,p){d.squareTo(p),this.reduce(p)},F})(),op=(function(){function F(d){this.m=d,this.mp=d.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<d.DB-15)-1,this.mt2=2*d.t}return F.prototype.convert=function(d){var p=O();return d.abs().dlShiftTo(this.m.t,p),p.divRemTo(this.m,null,p),d.s<0&&p.compareTo(A.ZERO)>0&&this.m.subTo(p,p),p},F.prototype.revert=function(d){var p=O();return d.copyTo(p),this.reduce(p),p},F.prototype.reduce=function(d){for(;d.t<=this.mt2;)d[d.t++]=0;for(var p=0;p<this.m.t;++p){var y=d[p]&32767,S=y*this.mpl+((y*this.mph+(d[p]>>15)*this.mpl&this.um)<<15)&d.DM;for(y=p+this.m.t,d[y]+=this.m.am(0,S,d,p,0,this.m.t);d[y]>=d.DV;)d[y]-=d.DV,d[++y]++}d.clamp(),d.drShiftTo(this.m.t,d),d.compareTo(this.m)>=0&&d.subTo(this.m,d)},F.prototype.mulTo=function(d,p,y){d.multiplyTo(p,y),this.reduce(y)},F.prototype.sqrTo=function(d,p){d.squareTo(p),this.reduce(p)},F})(),bb=(function(){function F(d){this.m=d,this.r2=O(),this.q3=O(),A.ONE.dlShiftTo(2*d.t,this.r2),this.mu=this.r2.divide(d)}return F.prototype.convert=function(d){if(d.s<0||d.t>2*this.m.t)return d.mod(this.m);if(d.compareTo(this.m)<0)return d;var p=O();return d.copyTo(p),this.reduce(p),p},F.prototype.revert=function(d){return d},F.prototype.reduce=function(d){for(d.drShiftTo(this.m.t-1,this.r2),d.t>this.m.t+1&&(d.t=this.m.t+1,d.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);d.compareTo(this.r2)<0;)d.dAddOffset(1,this.m.t+1);for(d.subTo(this.r2,d);d.compareTo(this.m)>=0;)d.subTo(this.m,d)},F.prototype.mulTo=function(d,p,y){d.multiplyTo(p,y),this.reduce(y)},F.prototype.sqrTo=function(d,p){d.squareTo(p),this.reduce(p)},F})(),np&&typeof t<"u"&&t?.appName=="Microsoft Internet Explorer"?(A.prototype.am=q,zn=30):np&&t?.appName!="Netscape"?(A.prototype.am=P,zn=26):(A.prototype.am=U,zn=28),A.prototype.DB=zn,A.prototype.DM=(1<<zn)-1,A.prototype.DV=1<<zn,Nc=52,A.prototype.FV=Math.pow(2,Nc),A.prototype.F1=Nc-zn,A.prototype.F2=2*zn-Nc,ps=[],Ji=48,mr=0;mr<=9;++mr)ps[Ji++]=mr;for(Ji=97,mr=10;mr<36;++mr)ps[Ji++]=mr;for(Ji=65,mr=10;mr<36;++mr)ps[Ji++]=mr;A.ZERO=W(0),A.ONE=W(1);class Y{constructor(){this.i=0,this.j=0,this.S=[]}init(d){var p,y,S;for(p=0;p<256;++p)this.S[p]=p;for(y=0,p=0;p<256;++p)y=y+this.S[p]+d[p%d.length]&255,S=this.S[p],this.S[p]=this.S[y],this.S[y]=S;this.i=0,this.j=0}next(){var d;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,d=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=d,this.S[d+this.S[this.i]&255]}}if(ap=256,Kn=null,Kn==null){if(Kn=[],Lr=0,ms=void 0,window?.crypto&&window?.crypto.getRandomValues)for(Lc=new Uint32Array(256),window?.crypto.getRandomValues(Lc),ms=0;ms<Lc.length;++ms)Kn[Lr++]=Lc[ms]&255;gs=function(F){if(this.count=this.count||0,this.count>=256||Lr>=ap){window?.removeEventListener?window?.removeEventListener("mousemove",gs,!1):window?.detachEvent&&window?.detachEvent("onmousemove",gs);return}try{var d=F.x+F.y;Kn[Lr++]=d&255,this.count+=1}catch{}},window?.addEventListener?window?.addEventListener("mousemove",gs,!1):window?.attachEvent&&window?.attachEvent("onmousemove",gs)}class ie{constructor(){}nextBytes(d){for(var p=0;p<d.length;++p)d[p]=ae()}}class me{constructor(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}doPublic(d){return d.modPowInt(this.e,this.n)}doPrivate(d){if(this.p==null||this.q==null)return d.modPow(this.d,this.n);for(var p=d.mod(this.p).modPow(this.dmp1,this.p),y=d.mod(this.q).modPow(this.dmq1,this.q);p.compareTo(y)<0;)p=p.add(this.p);return p.subtract(y).multiply(this.coeff).mod(this.p).multiply(this.q).add(y)}setPublic(d,p){d!=null&&p!=null&&d.length>0&&p.length>0?(this.n=C(d,16),this.e=parseInt(p,16)):console.error("Invalid RSA public key")}encrypt(d){var p=be(d,this.n.bitLength()+7>>3);if(p==null)return null;var y=this.doPublic(p);if(y==null)return null;var S=y.toString(16);return(S.length&1)==0?S:"0"+S}encryptLong(d){var p=this,y=(this.n.bitLength()+7>>3)-11;try{var S="";if(d.length>y){var L=d.match(/.{1,117}/g);return L.forEach(function(Q){var se=p.encrypt(Q);S+=se}),l(S)}var B=this.encrypt(d),$=l(B);return $}catch{return!1}}decryptLong(d){var p=this,y=this.n.bitLength()+7>>3;d=a(d);try{if(d.length>y){var S="",L=d.match(/.{1,256}/g);return L.forEach(function($){var Q=p.decrypt($);S+=Q}),S}var B=this.decrypt(d);return B}catch{return!1}}setPrivate(d,p,y){d!=null&&p!=null&&d.length>0&&p.length>0?(this.n=C(d,16),this.e=parseInt(p,16),this.d=C(y,16)):console.error("Invalid RSA private key")}setPrivateEx(d,p,y,S,L,B,$,Q){d!=null&&p!=null&&d.length>0&&p.length>0?(this.n=C(d,16),this.e=parseInt(p,16),this.d=C(y,16),this.p=C(S,16),this.q=C(L,16),this.dmp1=C(B,16),this.dmq1=C($,16),this.coeff=C(Q,16)):console.error("Invalid RSA private key")}generate(d,p){var y=new ie,S=d>>1;this.e=parseInt(p,16);for(var L=new A(p,16);;){for(;this.p=new A(d-S,1,y),!(this.p.subtract(A.ONE).gcd(L).compareTo(A.ONE)==0&&this.p.isProbablePrime(10)););for(;this.q=new A(S,1,y),!(this.q.subtract(A.ONE).gcd(L).compareTo(A.ONE)==0&&this.q.isProbablePrime(10)););if(this.p.compareTo(this.q)<=0){var B=this.p;this.p=this.q,this.q=B}var $=this.p.subtract(A.ONE),Q=this.q.subtract(A.ONE),se=$.multiply(Q);if(se.gcd(L).compareTo(A.ONE)==0){this.n=this.p.multiply(this.q),this.d=L.modInverse(se),this.dmp1=this.d.mod($),this.dmq1=this.d.mod(Q),this.coeff=this.q.modInverse(this.p);break}}}decrypt(d){var p=C(d,16),y=this.doPrivate(p);return y==null?null:Ot(y,this.n.bitLength()+7>>3)}generateAsync(d,p,y){var S=new ie,L=d>>1;this.e=parseInt(p,16);var B=new A(p,16),$=this,Q=()=>{var se=()=>{if($.p.compareTo($.q)<=0){var Te=$.p;$.p=$.q,$.q=Te}var Ce=$.p.subtract(A.ONE),Fe=$.q.subtract(A.ONE),je=Ce.multiply(Fe);je.gcd(B).compareTo(A.ONE)==0?($.n=$.p.multiply($.q),$.d=B.modInverse(je),$.dmp1=$.d.mod(Ce),$.dmq1=$.d.mod(Fe),$.coeff=$.q.modInverse($.p),setTimeout(function(){y()},0)):setTimeout(Q,0)},Ie=()=>{$.q=O(),$.q.fromNumberAsync(L,1,S,function(){$.q.subtract(A.ONE).gcda(B,function(Te){Te.compareTo(A.ONE)==0&&$.q.isProbablePrime(10)?setTimeout(se,0):setTimeout(Ie,0)})})},Ae=()=>{$.p=O(),$.p.fromNumberAsync(d-L,1,S,function(){$.p.subtract(A.ONE).gcda(B,function(Te){Te.compareTo(A.ONE)==0&&$.p.isProbablePrime(10)?setTimeout(Ie,0):setTimeout(Ae,0)})})};setTimeout(Ae,0)};setTimeout(Q,0)}}class Pt extends me{constructor(d=""){super(),d&&(typeof d=="string"?this.parseKey(d):(this.hasPrivateKeyProperty(d)||this.hasPublicKeyProperty(d))&&this.parsePropertiesFrom(d))}parseKey(d){try{var p=0,y=0,S=/^\s*(?:[0-9A-Fa-f][0-9A-Fa-f]\s*)+$/,L=S.test(d)?vb.decode(d):xc.unarmor(d),B=E.decode(L);if(B.sub.length===3&&(B=B.sub[2].sub[0]),B.sub.length===9){p=B.sub[1].getHexStringValue(),this.n=C(p,16),y=B.sub[2].getHexStringValue(),this.e=parseInt(y,16);var $=B.sub[3].getHexStringValue();this.d=C($,16);var Q=B.sub[4].getHexStringValue();this.p=C(Q,16);var se=B.sub[5].getHexStringValue();this.q=C(se,16);var Ie=B.sub[6].getHexStringValue();this.dmp1=C(Ie,16);var Ae=B.sub[7].getHexStringValue();this.dmq1=C(Ae,16);var Te=B.sub[8].getHexStringValue();this.coeff=C(Te,16)}else if(B.sub.length===2){var Ce=B.sub[1],Fe=Ce.sub[0];p=Fe.sub[0].getHexStringValue(),this.n=C(p,16),y=Fe.sub[1].getHexStringValue(),this.e=parseInt(y,16)}else return!1;return!0}catch{return!1}}hasPublicKeyProperty(d){return d=d||{},d.hasOwnProperty("n")&&d.hasOwnProperty("e")}hasPrivateKeyProperty(d){return d=d||{},d.hasOwnProperty("n")&&d.hasOwnProperty("e")&&d.hasOwnProperty("d")&&d.hasOwnProperty("p")&&d.hasOwnProperty("q")&&d.hasOwnProperty("dmp1")&&d.hasOwnProperty("dmq1")&&d.hasOwnProperty("coeff")}parsePropertiesFrom(d){this.n=d.n,this.e=d.e,d.hasOwnProperty("d")&&(this.d=d.d,this.p=d.p,this.q=d.q,this.dmp1=d.dmp1,this.dmq1=d.dmq1,this.coeff=d.coeff)}}Sn=function(F){F=F||{},this.default_key_size=parseInt(F.default_key_size,10)||1024,this.default_public_exponent=F.default_public_exponent||"010001",this.log=F.log||!1,this.key=null},Sn.prototype.setKey=function(F){this.log&&this.key&&console.warn("A key was already set, overriding existing."),this.key=new Pt(F)},Sn.prototype.setPrivateKey=function(F){this.setKey(F)},Sn.prototype.setPublicKey=function(F){this.setKey(F)},Sn.prototype.decrypt=function(F){try{return this.getKey().decrypt(a(F))}catch{return!1}},Sn.prototype.encrypt=function(F){try{return l(this.getKey().encrypt(F))}catch{return!1}},Sn.prototype.encryptLong=function(F){try{for(var d=this.getKey().encryptLong(F)||"",p=this.getKey().decryptLong(d)||"",y=0,S=/null$/g;S.test(p)&&(y++,d=this.getKey().encryptLong(F)||"",p=this.getKey().decryptLong(d)||"",!(y>10)););return d}catch{return!1}},Sn.prototype.getKey=function(F){if(!this.key){if(this.key=new Pt,F&&{}.toString.call(F)==="[object Function]"){this.key.generateAsync(this.default_key_size,this.default_public_exponent,F);return}this.key.generate(this.default_key_size,this.default_public_exponent)}return this.key},Sn.version="3.1.4"}Eb=Sn});var sp={};Pr(sp,{getEncryptInfo:()=>Fq});var Fq,up=X(()=>{Sb();Tc();Fq=({publicKey:t="",payload:e={}}={})=>{if(!t)return"";try{let r=Vi(e),n=new Eb;return n.setPublicKey(t),n.encryptLong(typeof r=="object"?JSON.stringify(r):r)}catch(r){console.error("encrypt error:",r)}return""}});async function cp(t,e){let r=async()=>{try{return up(),r3(sp)}catch{try{return await Promise.resolve().then(()=>(up(),sp))}catch{return}}};try{if((e?.root?.globalThis||globalThis).IS_MP_BUILD)return;if(!process.env.IS_MP_BUILD&&t)return r()}catch{if(t)return r()}}var ys,lp=X(()=>{"use strict";ui();Ac();hb();Tc();db();Dc();ys=class t{static parseParamsToSearch(e){return Object.keys(e).forEach(n=>{e[n]||delete e[n]}),new ds(e).toString()}constructor(e){let{request:r}=e,n=e.credentialsClient;if(!n){let o={apiOrigin:e.apiOrigin,apiPath:e.apiPath,clientId:e.clientId,storage:e.storage,env:e.env,baseRequest:e.baseRequest,anonymousSignInFunc:e.anonymousSignInFunc,wxCloud:e.wxCloud,onCredentialsError:e.onCredentialsError,headers:e.headers||{},i18n:e.i18n,debug:e.debug};n=new bn(o)}if(!r){let o=n.request.bind(n),i=new Pc({env:e.env,clientId:e.clientId,request:o,storage:e.storage,adapter:e.adapter,oauthInstance:this,...e.captchaOptions});r=i.request.bind(i)}this.config={env:e.env,apiOrigin:e.apiOrigin,apiPath:e.apiPath,clientId:e.clientId,request:r,credentialsClient:n,storage:e.storage||hs,adapter:e.adapter}}getParamsByVersion(e,r){let n=Vi(e),o={v2:ai}[n?.version]?.[r]||Ee[r];return n&&delete n.version,{params:n,url:o}}async signIn(e){let r=e.version||"v1",n=this.getParamsByVersion(e,"AUTH_SIGN_IN_URL");n.params.query&&delete n.params.query;let o=await this.getEncryptParams(n.params),i=await this.config.request(n.url,{method:"POST",body:o});return await this.config.credentialsClient.setCredentials({...i,version:r}),Promise.resolve(i)}async signInAnonymously(e={},r=!1){let n=await this.config.request(Ee.AUTH_SIGN_IN_ANONYMOUSLY_URL,{method:"POST",body:e,useWxCloud:r});return await this.config.credentialsClient.setCredentials(n),Promise.resolve(n)}async signUp(e){let r=await this.config.request(Ee.AUTH_SIGN_UP_URL,{method:"POST",body:e});return await this.config.credentialsClient.setCredentials(r),Promise.resolve(r)}async signOut(e){let r={};if(e){try{r=await this.config.request(Ee.AUTH_SIGNOUT_URL,{method:"POST",withCredentials:!0,body:e})}catch(i){i.error!==bt.UNAUTHENTICATED&&console.log("sign_out_error",i)}return await this.config.credentialsClient.setCredentials(),r}let n=await this.config.credentialsClient.getAccessToken(),o=await this.config.request(Ee.AUTH_REVOKE_URL,{method:"POST",body:{token:n}});return await this.config.credentialsClient.setCredentials(),Promise.resolve(o)}async revokeAllDevices(){await this.config.request(Ee.AUTH_REVOKE_ALL_URL,{method:"DELETE",withCredentials:!0})}async revokeDevice(e){await this.config.request(Ee.AUTHORIZED_DEVICES_DELETE_URL+e.device_id,{method:"DELETE",withCredentials:!0})}async getVerification(e,r){let n=!1;(e.target==="CUR_USER"||await this.hasLoginState())&&(n=!0);let o=Vi(e);return o.phone_number&&!/^\+\d{1,3}\s+\d+/.test(o.phone_number)&&(o.phone_number=`+86 ${o.phone_number}`),this.config.request(Ee.VERIFICATION_URL,{method:"POST",body:o,withCaptcha:r?.withCaptcha||!1,withCredentials:n})}async verify(e){let r=this.getParamsByVersion(e,"VERIFY_URL"),n=await this.config.request(r.url,{method:"POST",body:r.params});return e?.version==="v2"&&await this.config.credentialsClient.setCredentials({...n,version:"v2"}),n}async genProviderRedirectUri(e){let{provider_redirect_uri:r,other_params:n={},...o}=e;r&&!o.redirect_uri&&(o.redirect_uri=r);let i=`${Ee.PROVIDER_URI_URL}?${t.parseParamsToSearch(o)}`;return Object.keys(n).forEach(s=>{let u=n[s];s==="sign_out_uri"&&!(u?.length>0)||(i+=`&other_params[${s}]=${encodeURIComponent(u)}`)}),this.config.request(i,{method:"GET"})}async grantProviderToken(e,r=!1){return this.config.request(Ee.PROVIDER_TOKEN_URL,{method:"POST",body:e,useWxCloud:r})}async patchProviderToken(e){return this.config.request(Ee.PROVIDER_TOKEN_URL,{method:"PATCH",body:e})}async signInWithProvider(e,r=!1){let n=this.getParamsByVersion(e,"AUTH_SIGN_IN_WITH_PROVIDER_URL"),o=await this.config.request(n.url,{method:"POST",body:n.params,useWxCloud:r});return await this.config.credentialsClient.setCredentials({...o,version:e?.version||"v1"}),Promise.resolve(o)}async toBindIdentity(e){let r=e.credentials||await this.config.credentialsClient.localCredentials.getCredentials(),n;try{await this.bindWithProvider({provider_token:e.provider_token},r),n={data:{type:vr.BIND_IDENTITY,provider:e.provider},error:null}}catch(o){n={data:{type:vr.BIND_IDENTITY},error:new Se(o)}}return e.fireEvent&&this.config.eventBus?.fire?.(lt.AUTH_STATE_CHANGED,{event:Dt.BIND_IDENTITY,info:n}),n}async getInitialSession(){let e={};try{if(typeof window>"u"||typeof document>"u")return{data:null,error:null};let r=new URLSearchParams(location?.search),n=r.get("code"),o=r.get("state");if(!n||!o)return{data:null,error:null};let i=null;try{i=JSON.parse(sessionStorage.getItem(o)||"null")}catch{}e={type:i?.type};let s=r.get("error"),u=r.get("error_description");if(s||u)return{data:e,error:new Se({message:u||s||"Unknown error from OAuth provider"})};let l=i?.provider||r.get("provider");if(!l)return{data:e,error:new Se({message:"Provider is required for OAuth verification"})};let a=location.origin+location.pathname,{provider_token:c}=await this.grantProviderToken({provider_id:l,provider_redirect_uri:a,provider_code:n}),h,w=null,E;if(i.type===vr.BIND_IDENTITY)h=await this.config.credentialsClient.localCredentials.getCredentials(),E=await this.toBindIdentity({provider:l,provider_token:c,credentials:h});else if(i.type===vr.SIGN_IN){E=this.getParamsByVersion({provider:l},"AUTH_SIGN_IN_WITH_PROVIDER_URL"),h=await this.config.request(E.url,{method:"POST",body:{provider_token:c}});try{w=await this.getUserInfo({credentials:h})}catch(T){console.error("get user info error",T)}E={data:{...e,session:h,user:w},error:null}}r.delete("code"),r.delete("state"),r.delete("provider"),this.restoreUrlState(i?.search===void 0?`?${r.toString()}`:i.search,i?.hash||location.hash);try{sessionStorage.removeItem(o)}catch{}return E}catch(r){return{data:e,error:new Se(r)}}}async signInCustom(e){let r=await this.config.request(Ee.AUTH_SIGN_IN_CUSTOM,{method:"POST",body:e});return await this.config.credentialsClient.setCredentials(r),Promise.resolve(r)}async signInWithWechat(e={}){let r=await this.config.request(Ee.AUTH_SIGN_IN_WITH_WECHAT_URL,{method:"POST",body:e});return await this.config.credentialsClient.setCredentials(r),Promise.resolve(r)}async bindWithProvider(e,r){return this.config.request(Ee.PROVIDER_BIND_URL,{method:"POST",body:e,withCredentials:!0,getCredentials:r?()=>r:void 0})}async getUserProfile(e){return this.getUserInfo(e)}async getUserInfo(e={}){let r=this.getParamsByVersion(e,"USER_ME_URL");if(r.params?.query){let o=new ds(r.params.query);r.url+=`?${o.toString()}`}let n=await this.config.request(r.url,{method:"GET",withCredentials:!0,getCredentials:e.credentials?()=>e.credentials:void 0});return n.sub&&(n.uid=n.sub),n}async getWedaUserInfo(){return await this.config.request(Ee.WEDA_USER_URL,{method:"GET",withCredentials:!0})}async deleteMe(e){let r=this.getParamsByVersion(e,"USER_ME_URL"),n=`${r.url}?${t.parseParamsToSearch(r.params)}`;return this.config.request(n,{method:"DELETE",withCredentials:!0})}async hasLoginState(){try{return await this.config.credentialsClient.getAccessToken(),!0}catch{return!1}}hasLoginStateSync(){return this.config.credentialsClient.getCredentialsSync()}async getLoginState(){return this.config.credentialsClient.getCredentialsAsync()}async transByProvider(e){return this.config.request(Ee.USER_TRANS_BY_PROVIDER_URL,{method:"PATCH",body:e,withCredentials:!0})}async grantToken(e){let r=this.getParamsByVersion(e,"AUTH_TOKEN_URL");return this.config.request(r.url,{method:"POST",body:r.params})}async getProviders(){return this.config.request(Ee.PROVIDER_LIST,{method:"GET",withCredentials:!0})}async unbindProvider(e){return this.config.request(`${Ee.PROVIDER_UNBIND_URL}/${e.provider_id}`,{method:"DELETE",withCredentials:!0})}async checkPassword(e){return this.config.request(`${Ee.CHECK_PWD_URL}`,{method:"POST",withCredentials:!0,body:e})}async editContact(e){return this.config.request(`${Ee.BIND_CONTACT_URL}`,{method:"PATCH",withCredentials:!0,body:e})}async setPassword(e){return this.config.request(`${Ee.AUTH_SET_PASSWORD}`,{method:"PATCH",withCredentials:!0,body:e})}async updatePasswordByOld(e){let r=await this.sudo({password:e.old_password});return this.setPassword({sudo_token:r.sudo_token,new_password:e.new_password})}async sudo(e){return this.config.request(`${Ee.SUDO_URL}`,{method:"POST",withCredentials:!0,body:e})}async sendVerificationCodeToCurrentUser(e){return e.target="CUR_USER",this.config.request(Ee.VERIFICATION_URL,{method:"POST",body:e,withCredentials:!0,withCaptcha:!0})}async changeBoundProvider(e){return this.config.request(`${Ee.PROVIDER_LIST}/${e.provider_id}/trans`,{method:"POST",body:{provider_trans_token:e.trans_token},withCredentials:!0})}async setUserProfile(e){return this.config.request(Ee.USER_PRIFILE_URL,{method:"PATCH",body:e,withCredentials:!0})}async updateUserBasicInfo(e){return this.config.request(Ee.USER_BASIC_EDIT_URL,{method:"POST",withCredentials:!0,body:e})}async queryUserProfile(e){let r=new ds(e);return this.config.request(`${Ee.USER_QUERY_URL}?${r.toString()}`,{method:"GET",withCredentials:!0})}setCustomSignFunc(e){this.getCustomSignTicketFn=e}async signInWithCustomTicket(){let e=this.getCustomSignTicketFn;if(!e)return Promise.reject({error:"failed_precondition",error_description:"please use setCustomSignFunc to set custom sign function"});let r=await e();return this.signInCustom({provider_id:"custom",ticket:r})}async resetPassword(e){return this.config.request(Ee.AUTH_RESET_PASSWORD,{method:"POST",body:e})}async authorize(e){return this.config.request(Ee.AUTHORIZE_URL,{method:"POST",withCredentials:!0,body:e})}async authorizeDevice(e){return this.config.request(Ee.AUTHORIZE_DEVICE_URL,{method:"POST",withCredentials:!0,body:e})}async deviceAuthorize(e){return this.config.request(Ee.AUTH_GET_DEVICE_CODE,{method:"POST",body:e,withCredentials:!0})}async authorizeInfo(e){let r=`${Ee.AUTHORIZE_INFO_URL}?${t.parseParamsToSearch(e)}`,n=!0,o=!1;return await this.hasLoginState()&&(o=!0,n=!1),this.config.request(r,{method:"GET",withBasicAuth:n,withCredentials:o})}async checkUsername(e){return this.config.request(Ee.CHECK_USERNAME,{method:"GET",body:e,withCredentials:!0})}async checkIfUserExist(e){let r=new ds(e);return this.config.request(`${Ee.CHECK_IF_USER_EXIST}?${r.toString()}`,{method:"GET"})}async loginScope(){return this.config.credentialsClient.getScope()}async loginGroups(){return this.config.credentialsClient.getGroups()}async refreshTokenForce(e){let r=await this.config.credentialsClient.getCredentials();return await this.config.credentialsClient.refreshToken({...r,version:e?.version||"v1"})}async getCredentials(){return this.config.credentialsClient.getCredentials()}async getPublicKey(){return this.config.request(ai.AUTH_PUBLIC_KEY,{method:"POST",body:{}})}async getEncryptParams(e){let{isEncrypt:r}=e;delete e.isEncrypt;let n=Vi(e),o=await cp(r,this.config.adapter);if(!o)return e;let i="",s="";try{let u=await this.getPublicKey();if(i=u.public_key,s=u.public_key_thumbprint,!i||!s)throw u}catch(u){throw u}return{params:o.getEncryptInfo({publicKey:i,payload:n}),public_key_thumbprint:s}}async getProviderSubType(){return this.config.request(Ee.GET_PROVIDER_TYPE,{method:"POST",body:{provider_id:"weda"}})}async verifyCaptchaData({token:e,key:r}){return this.config.request(Ee.VERIFY_CAPTCHA_DATA_URL,{method:"POST",body:{token:e,key:r},withCredentials:!1})}async createCaptchaData({state:e,redirect_uri:r=void 0}){return this.config.request(Ee.CAPTCHA_DATA_URL,{method:"POST",body:{state:e,redirect_uri:r},withCredentials:!1})}async getMiniProgramCode(e){return this.config.request(Ee.GET_MINIPROGRAM_QRCODE,{method:"POST",body:e})}async getMiniProgramQrCodeStatus(e){return this.config.request(Ee.GET_MINIPROGRAM_QRCODE_STATUS,{method:"POST",body:e})}async getUserBehaviorLog(e){let r={LOGIN:"query[action]=USER_LOGIN",MODIFY:"ne_query[action]=USER_LOGIN"},n=`${Ee.GET_USER_BEHAVIOR_LOG}?${r[e.type]}&limit=${e.limit}${e.page_token?`&page_token=${e.page_token}`:""}`;return this.config.request(n,{method:"GET",withCredentials:!0})}async modifyPassword(e){let r="",n="",o=await cp(!0,this.config.adapter);if(!o)throw new Error("do not support encrypt, a encrypt util required.");try{let u=await this.getPublicKey();if(r=u.public_key,n=u.public_key_thumbprint,!r||!n)throw u}catch(u){throw u}let i=e.password?o.getEncryptInfo({publicKey:r,payload:e.password}):"",s=o.getEncryptInfo({publicKey:r,payload:e.new_password});return this.config.request(Ee.USER_BASIC_EDIT_URL,{method:"POST",withCredentials:!0,body:{user_id:e.user_id,encrypt_password:i,encrypt_new_password:s,public_key_thumbprint:n}})}async modifyPasswordWithoutLogin(e){let r="",n="",o=await cp(!0,this.config.adapter);if(!o)throw new Error("do not support encrypt, a encrypt util required.");try{let u=await this.getPublicKey();if(r=u.public_key,n=u.public_key_thumbprint,!r||!n)throw u}catch(u){throw u}let i=e.password?o.getEncryptInfo({publicKey:r,payload:e.password}):"",s=o.getEncryptInfo({publicKey:r,payload:e.new_password});return this.config.request(ai.AUTH_RESET_PASSWORD,{method:"POST",body:{username:e.username,password:i,new_password:s,public_key_thumbprint:n}})}restoreUrlState(e,r){if(e!==void 0)try{let n=new URL(window.location.href);n.search=e,n.hash=r||"",window.history.replaceState(null,"",n.toString())}catch{}}}});var Se,Ib=X(()=>{Se=class extends Error{constructor(e){super(e.error_description||e.message),this.__isAuthError=!0,this.name="AuthError",this.status=e.error,this.code=e.error_code}}});var Tb=X(()=>{});var Uc,Dc=X(()=>{Ac();lp();ui();lp();ui();Ib();Tb();Gd();ui();Uc=class{constructor(e){let{apiOrigin:r,apiPath:n=si,clientId:o,env:i,storage:s,request:u,baseRequest:l,anonymousSignInFunc:a,wxCloud:c,adapter:h,onCredentialsError:w,headers:E,i18n:T,useWxCloud:A,eventBus:O,detectSessionInUrl:C,debug:P}=e;this.detectSessionInUrl=C??!1,this.oauth2client=new bn({apiOrigin:r,apiPath:n,clientId:o,env:i,storage:s,baseRequest:l||u,anonymousSignInFunc:a,wxCloud:c,onCredentialsError:w,headers:E||{},i18n:T,useWxCloud:A,eventBus:O,debug:P}),this.authApi=new ys({credentialsClient:this.oauth2client,...e,request:u?this.oauth2client.request.bind(this.oauth2client):void 0,adapter:h}),C&&this.oauth2client.setGetInitialSession(this.authApi.getInitialSession.bind(this.authApi))}initializeSession(e){if(!this.detectSessionInUrl){this.oauth2client.initialize(Promise.resolve({error:null}));return}this.oauth2client.setOnInitialSessionObtained(e),this.oauth2client.initialize()}}});var Cb=K(fi=>{"use strict";var jq=fi&&fi.__awaiter||function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},Mq=fi&&fi.__generator||function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(fi,"__esModule",{value:!0});fi.catchErrorsDecorator=void 0;var Ob=li(),kq=Ho(),_s=!1;typeof navigator<"u"&&navigator.userAgent&&(_s=navigator.userAgent.indexOf("Firefox")!==-1);var $q=_s?/(\.js\/)?__decorate(\$\d+)?<@.*\d$/:/(\/\w+\.js\.)?__decorate(\$\d+)?\s*\(.*\)$/,Rb=/https?:\/\/.+:\d*\/.*\.js:\d+:\d+/;function Wq(t){var e=t.mode,r=e===void 0?"async":e,n=t.customInfo,o=n===void 0?{}:n,i=t.title,s=t.messages,u=s===void 0?[]:s;return function(l,a,c){if(kq.IS_DEBUG_MODE){var h=o.className||l.constructor.name,w=o.methodName||a,E=c.value,T=Hq(new Error);r==="sync"?c.value=function(){for(var A=[],O=0;O<arguments.length;O++)A[O]=arguments[O];var C=Ab({err:new Error,className:h,methodName:w,sourceLink:T});try{return E.apply(this,A)}catch(Y){var P=Y,q=Y.message,U=Y.error,k=Y.error_description,W={title:i||"".concat(h,".").concat(w," failed"),content:[{type:"error",body:Y}]};if(q&&/^\{.*\}$/.test(q)){var V=JSON.parse(q);W.subtitle=q,V.code&&(C?(C.code=V.code,C.msg=V.msg):(Y.code=V.code,Y.message=V.msg),P=C||Y,W.content=u.map(function(Z){return{type:"info",body:Z}}))}throw U&&k&&(W.subtitle=k,C?(C.code=U,C.msg=k):(Y.code=U,Y.message=k),P=C||Y,W.content=u.map(function(Z){return{type:"info",body:Z}})),(0,Ob.printGroupLog)(W),P}}:c.value=function(){for(var A=[],O=0;O<arguments.length;O++)A[O]=arguments[O];return jq(this,void 0,void 0,function(){var C,P,q,U,k,W,V,Y;return Mq(this,function(Z){switch(Z.label){case 0:C=Ab({err:new Error,className:h,methodName:w,sourceLink:T}),Z.label=1;case 1:return Z.trys.push([1,3,,4]),[4,E.apply(this,A)];case 2:return[2,Z.sent()];case 3:throw P=Z.sent(),q=P,U=P.message,k=P.error,W=P.error_description,V={title:i||"".concat(h,".").concat(w," failed"),content:[{type:"error",body:P}]},U&&/^\{.*\}$/.test(U)&&(Y=JSON.parse(U),V.subtitle=Y,Y.code&&(C?(C.code=Y.code,C.message=Y.msg):(P.code=Y.code,P.message=Y.msg),q=C||P,V.content=u.map(function(ae){return{type:"info",body:ae}}))),k&&W&&(V.subtitle=W,C?(C.code=k,C.msg=W):(P.code=k,P.message=W),q=C||P,V.content=u.map(function(ae){return{type:"info",body:ae}})),(0,Ob.printGroupLog)(V),q;case 4:return[2]}})})}}}}fi.catchErrorsDecorator=Wq;function Hq(t){var e="",r=t.stack.split(`
`),n=r.findIndex(function(i){return $q.test(i)});if(n!==-1){var o=Rb.exec(r[n+1]||"");e=o?o[0]:""}return e}function Ab(t){var e=t.err,r=t.className,n=t.methodName,o=t.sourceLink;if(!o)return null;var i=e.stack.split(`
`),s=_s?/^catchErrorsDecorator\/<\/descriptor.value@.*\d$/:new RegExp("".concat(r,"\\.descriptor.value\\s*\\[as\\s").concat(n,"\\]\\s*\\(.*\\)$")),u=_s?/^catchErrorsDecorator\/<\/descriptor.value/:new RegExp("".concat(r,"\\.descriptor.value\\s*\\[as\\s").concat(n,"\\]")),l=i.findIndex(function(h){return s.test(h)}),a;if(l!==-1){var c=i.filter(function(h,w){return w>l});c.unshift(i[l].replace(u,"".concat(r,".").concat(n)).replace(Rb,o)),a=new Error,a.stack="".concat(_s?"@debugger":"Error",`
`).concat(c.join(`
`))}return a}});var Pb=K(Qi=>{"use strict";var Gq=Qi&&Qi.__createBinding||(Object.create?(function(t,e,r,n){n===void 0&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}):(function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]})),Vq=Qi&&Qi.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&Gq(e,t,r)};Object.defineProperty(Qi,"__esModule",{value:!0});Vq(Cb(),Qi)});var xb=K(In=>{"use strict";var zq=In&&In.__extends||(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),fp=In&&In.__awaiter||function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},hp=In&&In.__generator||function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(In,"__esModule",{value:!0});In.CloudbaseCache=void 0;var Kq=Ci(),ws=li(),hi=Ho(),dp=(function(t){zq(e,t);function e(r){var n=t.call(this)||this;return n.root=r,r.tcbCacheObject||(r.tcbCacheObject={}),n}return e.prototype.setItem=function(r,n){this.root.tcbCacheObject[r]=n},e.prototype.getItem=function(r){return this.root.tcbCacheObject[r]},e.prototype.removeItem=function(r){delete this.root.tcbCacheObject[r]},e.prototype.clear=function(){delete this.root.tcbCacheObject},e})(Kq.AbstractStorage);function Yq(t,e){switch(t){case"local":return e.localStorage?e.localStorage:((0,ws.printWarn)(hi.ERRORS.INVALID_PARAMS,"localStorage is not supported on current platform"),new dp(e.root));case"none":return new dp(e.root);default:return e.localStorage?e.localStorage:((0,ws.printWarn)(hi.ERRORS.INVALID_PARAMS,"localStorage is not supported on current platform"),new dp(e.root))}}var Jq=(function(){function t(e){this.keys={};var r=e.persistence,n=e.platformInfo,o=n===void 0?{}:n,i=e.keys,s=i===void 0?{}:i;this.platformInfo=o,this.storage||(this.persistenceTag=this.platformInfo.adapter.primaryStorage||r,this.storage=Yq(this.persistenceTag,this.platformInfo.adapter),this.keys=s)}return Object.defineProperty(t.prototype,"mode",{get:function(){return this.storage.mode||"sync"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"persistence",{get:function(){return this.persistenceTag},enumerable:!1,configurable:!0}),t.prototype.setStore=function(e,r,n){if(this.mode==="async"){(0,ws.printWarn)(hi.ERRORS.INVALID_OPERATION,"current platform's storage is asynchronous, please use setStoreAsync insteed");return}if(this.storage)try{var o={version:n||"localCachev1",content:r};this.storage.setItem(e,JSON.stringify(o))}catch(i){throw new Error(JSON.stringify({code:hi.ERRORS.OPERATION_FAIL,msg:"[".concat((0,hi.getSdkName)(),"][").concat(hi.ERRORS.OPERATION_FAIL,"]setStore failed"),info:i}))}},t.prototype.setStoreAsync=function(e,r,n){return fp(this,void 0,void 0,function(){var o,i;return hp(this,function(s){switch(s.label){case 0:if(!this.storage)return[2];s.label=1;case 1:return s.trys.push([1,3,,4]),o={version:n||"localCachev1",content:r},[4,this.storage.setItem(e,JSON.stringify(o))];case 2:return s.sent(),[3,4];case 3:return i=s.sent(),[2];case 4:return[2]}})})},t.prototype.getStore=function(e,r){var n;if(this.mode==="async"){(0,ws.printWarn)(hi.ERRORS.INVALID_OPERATION,"current platform's storage is asynchronous, please use getStoreAsync insteed");return}try{if(typeof process<"u"&&(!((n=process.env)===null||n===void 0)&&n.tcb_token))return process.env.tcb_token;if(!this.storage)return""}catch{return""}r=r||"localCachev1";var o=this.storage.getItem(e);if(!o)return"";if(o.indexOf(r)>=0){var i=JSON.parse(o);return i.content}return""},t.prototype.getStoreAsync=function(e,r){var n;return fp(this,void 0,void 0,function(){var o,i;return hp(this,function(s){switch(s.label){case 0:try{if(typeof process<"u"&&(!((n=process.env)===null||n===void 0)&&n.tcb_token))return[2,process.env.tcb_token];if(!this.storage)return[2,""]}catch{return[2,""]}return r=r||"localCachev1",[4,this.storage.getItem(e)];case 1:return o=s.sent(),o?o.indexOf(r)>=0?(i=JSON.parse(o),[2,i.content]):[2,""]:[2,""]}})})},t.prototype.removeStore=function(e){if(this.mode==="async"){(0,ws.printWarn)(hi.ERRORS.INVALID_OPERATION,"current platform's storage is asynchronous, please use removeStoreAsync insteed");return}this.storage.removeItem(e)},t.prototype.removeStoreAsync=function(e){return fp(this,void 0,void 0,function(){return hp(this,function(r){switch(r.label){case 0:return[4,this.storage.removeItem(e)];case 1:return r.sent(),[2]}})})},t})();In.CloudbaseCache=Jq});var Lb=K(ir=>{"use strict";var Qq=ir&&ir.__extends||(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),Bt=ir&&ir.__assign||function(){return Bt=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Bt.apply(this,arguments)},pp=ir&&ir.__awaiter||function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},vp=ir&&ir.__generator||function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(ir,"__esModule",{value:!0});ir.WebRequest=ir.genAdapter=void 0;var Xq=Ci(),mp=li(),Zq=Yd(),Nb=(function(t){Qq(e,t);function e(r){var n=t.call(this)||this,o=r.timeout,i=r.timeoutMsg,s=r.restrictedMethods;return n.timeout=o||0,n.timeoutMsg=i||"\u8BF7\u6C42\u8D85\u65F6",n.restrictedMethods=s||["get","post","upload","download"],n}return e.prototype.get=function(r){return this.request(Bt(Bt({},r),{method:"get"}),this.restrictedMethods.includes("get"))},e.prototype.post=function(r){return this.request(Bt(Bt({},r),{method:"post"}),this.restrictedMethods.includes("post"))},e.prototype.put=function(r){return this.request(Bt(Bt({},r),{method:"put"}))},e.prototype.upload=function(r){var n=r.data,o=r.file,i=r.name,s=r.method,u=r.headers,l=u===void 0?{}:u,a={post:"post",put:"put"}[s?.toLowerCase()]||"put",c=new FormData;return a==="post"?(Object.keys(n).forEach(function(h){c.append(h,n[h])}),c.append("key",i),c.append("file",o),this.request(Bt(Bt({},r),{data:c,method:a}),this.restrictedMethods.includes("upload"))):this.request(Bt(Bt({},r),{method:"put",headers:l,body:o}),this.restrictedMethods.includes("upload"))},e.prototype.download=function(r){return pp(this,void 0,void 0,function(){var n,o,i,s,u;return vp(this,function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),[4,this.get(Bt(Bt({},r),{headers:{},responseType:"blob"}))];case 1:return n=l.sent().data,o=window.URL.createObjectURL(new Blob([n])),i=decodeURIComponent(new URL(r.url).pathname.split("/").pop()||""),s=document.createElement("a"),s.href=o,s.setAttribute("download",i),s.style.display="none",document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(o),document.body.removeChild(s),[3,3];case 2:return u=l.sent(),[3,3];case 3:return[2,new Promise(function(a){a({statusCode:200,tempFilePath:r.url})})]}})})},e.prototype.fetch=function(r){var n;return pp(this,void 0,void 0,function(){var o,i,s,u,l,a,c,h,w,E,T,A,O,C=this;return vp(this,function(P){switch(P.label){case 0:return o=new AbortController,i=r.url,s=r.enableAbort,u=s===void 0?!1:s,l=r.stream,a=l===void 0?!1:l,c=r.signal,h=r.timeout,w=r.shouldThrowOnError,E=w===void 0?!0:w,T=h??this.timeout,c&&(c.aborted&&o.abort(),c.addEventListener("abort",function(){return o.abort()})),A=null,u&&T&&(A=setTimeout(function(){console.warn(C.timeoutMsg),o.abort(new Error(C.timeoutMsg))},T)),[4,fetch(i,Bt(Bt({},r),{signal:o.signal})).then(function(q){return pp(C,void 0,void 0,function(){var U,k,W;return vp(this,function(V){switch(V.label){case 0:return clearTimeout(A),E?q.ok?(U=q,[3,3]):[3,1]:[3,4];case 1:return W=(k=Promise).reject,[4,q.json()];case 2:U=W.apply(k,[V.sent()]),V.label=3;case 3:return[2,U];case 4:return[2,q]}})})}).catch(function(q){if(clearTimeout(A),E)return Promise.reject(q)})];case 1:return O=P.sent(),[2,{data:a?O.body:!((n=O.headers.get("content-type"))===null||n===void 0)&&n.includes("application/json")?O.json():O.text(),statusCode:O.status,header:O.headers}]}})})},e.prototype.request=function(r,n){var o=this;n===void 0&&(n=!1);var i=String(r.method).toLowerCase()||"get";return new Promise(function(s){var u=r.url,l=r.headers,a=l===void 0?{}:l,c=r.data,h=r.responseType,w=r.withCredentials,E=r.body,T=r.onUploadProgress,A=(0,mp.formatUrl)((0,Zq.getProtocol)(),u,i==="get"?c:{}),O=new XMLHttpRequest;O.open(i,A),h&&(O.responseType=h),Object.keys(a).forEach(function(q){O.setRequestHeader(q,a[q])});var C;T&&O.upload.addEventListener("progress",T),O.onreadystatechange=function(){var q={};if(O.readyState===4){var U=O.getAllResponseHeaders(),k=U.trim().split(/[\r\n]+/),W={};k.forEach(function(V){var Y=V.split(": "),Z=Y.shift().toLowerCase(),ae=Y.join(": ");W[Z]=ae}),q.header=W,q.statusCode=O.status;try{q.data=h==="blob"?O.response:JSON.parse(O.responseText)}catch{q.data=h==="blob"?O.response:O.responseText}clearTimeout(C),s(q)}},n&&o.timeout&&(C=setTimeout(function(){console.warn(o.timeoutMsg),O.abort()},o.timeout));var P;(0,mp.isFormData)(c)?P=c:a["content-type"]==="application/x-www-form-urlencoded"?P=(0,mp.toQueryString)(c):E?P=E:P=c?JSON.stringify(c):void 0,w&&(O.withCredentials=!0),O.send(P)})},e})(Xq.AbstractSDKRequest);ir.WebRequest=Nb;function eF(){var t={type:"default",root:window,reqClass:Nb,wsClass:WebSocket,localStorage};return t}ir.genAdapter=eF});var Ub=K(At=>{"use strict";var Bc=At&&At.__assign||function(){return Bc=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Bc.apply(this,arguments)},tF=At&&At.__createBinding||(Object.create?(function(t,e,r,n){n===void 0&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}):(function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]})),rF=At&&At.__setModuleDefault||(Object.create?(function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}):function(t,e){t.default=e}),nF=At&&At.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&tF(e,t,r);return rF(e,t),e};Object.defineProperty(At,"__esModule",{value:!0});At.useDefaultAdapter=At.useAdapters=At.RUNTIME=void 0;var iF=nF(Lb()),oF=li(),Db;(function(t){t.WEB="web",t.WX_MP="wx_mp"})(Db=At.RUNTIME||(At.RUNTIME={}));function aF(t,e){for(var r=(0,oF.isArray)(t)?t:[t],n=0,o=r;n<o.length;n++){var i=o[n],s=i.isMatch,u=i.genAdapter,l=i.runtime;if(s())return{adapter:Bc({isMatch:s},u(e)),runtime:l}}}At.useAdapters=aF;function sF(){return{adapter:Bc({},iF.genAdapter()),runtime:Db.WEB}}At.useDefaultAdapter=sF});var Yn,$e,tt,gp,yp,_p,qc=X(()=>{Yn=st(li()),$e=st(Ho()),tt=st(Pb()),gp=st(Xd()),yp=st(xb());xd();_p=st(Ub())});function cF(t){return function(e,r){return bs(this,void 0,void 0,function(){return Es(this,function(n){return[2,new Promise(function(o,i){var s=Object.assign({},r);s.body&&typeof s.body!="string"&&(s.body=JSON.stringify(s.body));var u=wx.request({url:e,data:s.body,timeout:t._timeout,method:s.method||"GET",header:s.headers,success:function(l){l=qb(l,gr(gr({},r),{url:e})),l.error&&i(l),o(l)},fail:function(l){i({error:"unreachable",error_description:l.message})},complete:function(l){if(!(!l||!l.errMsg)&&!(!t._timeout||t._restrictedMethods.indexOf("request")===-1)){var a=l.errMsg;if(a==="request:fail timeout"){console.warn(t._timeoutMsg);try{u.abort()}catch{}}}}})})]})})}}function lF(t){return uF.test(t)?RegExp.$1:t}var gr,bs,Es,Bb,uF,qb,fF,hF,Fb,jb=X(()=>{qc();gr=function(){return gr=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},gr.apply(this,arguments)},bs=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},Es=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Bb=(function(){function t(e){var r,n;try{this.localStorage=e?.localStorage||(((n=(r=e?.adapter)===null||r===void 0?void 0:r.root)===null||n===void 0?void 0:n.globalThis)||globalThis).localStorage}catch{this.localStorage=e?.localStorage||{}}}return t.prototype.getItem=function(e){return bs(this,void 0,void 0,function(){return Es(this,function(r){return[2,this.localStorage.getItem(e)]})})},t.prototype.removeItem=function(e){return bs(this,void 0,void 0,function(){return Es(this,function(r){return this.localStorage.removeItem(e),[2]})})},t.prototype.setItem=function(e,r){return bs(this,void 0,void 0,function(){return Es(this,function(n){return this.localStorage.setItem(e,r),[2]})})},t.prototype.getItemSync=function(e){return this.localStorage.getItem(e)},t.prototype.setItemSync=function(e,r){this.localStorage.setItem(e,r)},t.prototype.removeItemSync=function(e){this.localStorage.removeItem(e)},t})(),uF=/^[^:]+:\/\/[^/]+(\/[^?#]+)/,qb=function(t,e){var r,n,o,i=(r=e?.headers)===null||r===void 0?void 0:r["x-request-id"];return t||(t={}),(t?.code||!((n=t?.data)===null||n===void 0)&&n.error_code)&&(t={error:t.code||t.data.error,error_description:t.data.error_description||t.message||t.code||t.data.error_code,request_id:t.requestId,error_code:(o=t.data)===null||o===void 0?void 0:o.error_code}),t?.request_id||(t.request_id=t.request_id||i),t?.error?(t.error_uri=lF(e?.url),t):t?.data||{}};fF=function(t,e){var r=gr({},t);try{if(!t?.storage&&e?.localStorage&&(r.storage=new Bb({localStorage:e.localStorage,adapter:e})),!t.captchaOptions&&e?.captchaOptions&&(r.captchaOptions=e.captchaOptions),!t.baseRequest&&!t.request&&e?.reqClass){var n={timeout:1e4,restrictedMethods:["get","post","upload","download","request"]},o=new e.reqClass(n);r.baseRequest=function(i,s){var u,l,a,c,h;return bs(this,void 0,void 0,function(){var w,E,T,A;return Es(this,function(O){switch(O.label){case 0:if(w={},E=((u=s.method)===null||u===void 0?void 0:u.toLocaleLowerCase())||"post",T=(a=(l=o?.[E])===null||l===void 0?void 0:l.bind)===null||a===void 0?void 0:a.call(l,o),typeof T!="function")throw new Error("invalid \u3010".concat(E,"\u3011 request method"));O.label=1;case 1:return O.trys.push([1,3,,4]),(!(!((c=s.headers)===null||c===void 0)&&c["content-type"])||!((h=s.headers)===null||h===void 0)&&h["content-type"].includes("application/json"))&&!["string","undefined"].includes(typeof s.body)&&(s.data=s.data||s.body,s.body=JSON.stringify(s.body)),[4,T(gr({url:i},s))];case 2:return w=O.sent(),w=qb(w,gr(gr({},s),{url:i})),[3,4];case 3:throw A=O.sent(),w=gr(gr({},A?.data),A),w;case 4:if(w?.error)throw w;return[2,w]}})})}}}catch(i){console.error("user adapter generate fail:",i)}return r},hF=function(t,e){var r=gr({},t),n={};if(e?.captchaOptions&&(r.captchaOptions=e.captchaOptions),!Vt.isMatch()||t.storage&&t.baseRequest)return r;try{var o=Vt.genAdapter({}),i=o.localStorage,s=o.reqClass;if(i&&(n.storage=new Bb({localStorage:i,adapter:e})),s){var u=new s({timeout:1e4,restrictedMethods:["get","post","upload","download","request"]});n.request=cF(u)}return r.captchaOptions&&(n.baseRequest=n.request,n.request=void 0),gr(gr({},r),n)}catch(l){console.error("adapter generate fail:",l)}return r},Fb=function(t){return t.adapter&&t.adapter.type!=="default"?fF(t,t.adapter):hF(t,t.adapter)}});function Mb(t,e){try{sessionStorage.setItem(t,JSON.stringify(e))}catch(r){console.error("Failed to save to browser session:",r)}}function kb(t){try{var e=JSON.parse(sessionStorage.getItem(t));return e}catch(r){return console.error("Failed to get browser session:",r),null}}function $b(t){try{return sessionStorage.removeItem(t),!0}catch(e){return console.error("Failed to remove browser session:",e),null}}function Wb(t,e){if(t!==void 0){var r=new URL(window.location.href);r.search=t,r.hash=e||r.hash,window.history.replaceState({},"",r.href)}}var Hb=X(()=>{});var Ye,ge,ye,dF,Gb,Vb,zb=X(()=>{Dc();Hb();Lt();qc();Ye=function(){return Ye=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Ye.apply(this,arguments)},ge=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},ye=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},dF=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]]);return r},Gb=function(){return typeof window<"u"&&typeof document<"u"},Vb=(function(){function t(e){this.listeners=new Map,this.hasListenerSetUp=!1,this.config=e,this.oauthInstance=e.oauthInstance,this.cache=e.cache,this.init()}return Object.defineProperty(t.prototype,"currentUser",{get:function(){var e=this.hasLoginState();return e&&e.user||null},enumerable:!1,configurable:!0}),t.prototype.hasLoginState=function(){throw new Error("Auth.hasLoginState() is not implemented")},t.prototype.setAccessKey=function(){return ge(this,void 0,void 0,function(){return ye(this,function(e){throw new Error("Auth.setAccessKey() is not implemented")})})},t.prototype.signIn=function(e){return ge(this,void 0,void 0,function(){return ye(this,function(r){throw new Error("Auth.signIn() is not implemented")})})},t.prototype.signInWithProvider=function(e){return ge(this,void 0,void 0,function(){return ye(this,function(r){throw new Error("Auth.signInWithProvider() is not implemented")})})},t.prototype.genProviderRedirectUri=function(e){return ge(this,void 0,void 0,function(){return ye(this,function(r){throw new Error("Auth.genProviderRedirectUri() is not implemented")})})},t.prototype.getAccessToken=function(){return ge(this,void 0,void 0,function(){return ye(this,function(e){throw new Error("Auth.getAccessToken() is not implemented")})})},t.prototype.getUserInfo=function(){return ge(this,void 0,void 0,function(){return ye(this,function(e){throw new Error("Auth.getUserInfo() is not implemented")})})},t.prototype.updateUserBasicInfo=function(e){return ge(this,void 0,void 0,function(){return ye(this,function(r){throw new Error("Auth.updateUserBasicInfo() is not implemented")})})},t.prototype.setCustomSignFunc=function(e){throw new Error("Auth.setCustomSignFunc() is not implemented")},t.prototype.grantProviderToken=function(e){return ge(this,void 0,void 0,function(){return ye(this,function(r){throw new Error("Auth.grantProviderToken() is not implemented")})})},t.prototype.bindWithProvider=function(e){return ge(this,void 0,void 0,function(){return ye(this,function(r){throw new Error("Auth.bindWithProvider() is not implemented")})})},t.prototype.signInWithUsername=function(e){return ge(this,void 0,void 0,function(){return ye(this,function(r){throw new Error("Auth.signInWithUsername() is not implemented")})})},t.prototype.getVerification=function(e,r){return ge(this,void 0,void 0,function(){return ye(this,function(n){throw new Error("Auth.getVerification() is not implemented")})})},t.prototype.createLoginState=function(e,r){return ge(this,void 0,void 0,function(){return ye(this,function(n){throw new Error("Auth.createLoginState() is not implemented")})})},t.prototype.verify=function(e){return ge(this,void 0,void 0,function(){return ye(this,function(r){throw new Error("Auth.verify() is not implemented")})})},t.prototype.signInAnonymously=function(e){return ge(this,void 0,void 0,function(){var r,n,o,i,s;return ye(this,function(u){switch(u.label){case 0:return u.trys.push([0,4,,5]),[4,this.oauthInstance.authApi.signInAnonymously(e)];case 1:return u.sent(),[4,this.createLoginState()];case 2:return r=u.sent(),[4,this.getSession()];case 3:return n=u.sent().data,o=n===void 0?{}:n,i=o.session,[2,Ye(Ye({},r),{data:{user:i.user,session:i},error:null})];case 4:return s=u.sent(),[2,{data:{},error:new Se(s)}];case 5:return[2]}})})},t.prototype.signUp=function(e){return ge(this,void 0,void 0,function(){var r,n,o=this;return ye(this,function(i){switch(i.label){case 0:return e.phone_number||e.verification_code||e.verification_token||e.provider_token?[4,this.oauthInstance.authApi.signUp(e)]:[3,2];case 1:return i.sent(),[2,this.createLoginState()];case 2:return i.trys.push([2,4,,5]),this.validateAtLeastOne(e,[["email"],["phone"]],"You must provide either an email or phone number"),[4,this.getVerification(e.email?{email:e.email}:{phone_number:this.formatPhone(e.phone)})];case 3:return r=i.sent(),[2,{data:{verifyOtp:function(s){var u=s.token,l=s.messageId,a=l===void 0?r.verification_id:l;return ge(o,void 0,void 0,function(){var c,h,w,E,T,A;return ye(this,function(O){switch(O.label){case 0:return O.trys.push([0,8,,9]),[4,this.verify({verification_id:a||r.verification_id,verification_code:u})];case 1:return c=O.sent(),r.is_user?[4,this.signIn({username:e.email||this.formatPhone(e.phone),verification_token:c.verification_token})]:[3,3];case 2:return O.sent(),[3,6];case 3:return h=JSON.parse(JSON.stringify(e)),delete h.email,delete h.phone,[4,this.oauthInstance.authApi.signUp(Ye(Ye(Ye({},h),e.email?{email:e.email}:{phone_number:this.formatPhone(e.phone)}),{verification_token:c.verification_token,verification_code:u}))];case 4:return O.sent(),[4,this.createLoginState()];case 5:O.sent(),O.label=6;case 6:return[4,this.getSession()];case 7:return w=O.sent().data,E=w===void 0?{}:w,T=E.session,[2,{data:{user:T.user,session:T},error:null}];case 8:return A=O.sent(),[2,{data:{},error:new Se(A)}];case 9:return[2]}})})}},error:null}];case 4:return n=i.sent(),[2,{data:{},error:new Se(n)}];case 5:return[2]}})})},t.prototype.signOut=function(e){var r,n;return ge(this,void 0,void 0,function(){var o,i,s;return ye(this,function(u){switch(u.label){case 0:return u.trys.push([0,3,,4]),o=this.cache.keys.userInfoKey,[4,this.oauthInstance.authApi.signOut(e)];case 1:return i=u.sent(),[4,this.cache.removeStoreAsync(o)];case 2:return u.sent(),this.setAccessKey(),(r=this.config.eventBus)===null||r===void 0||r.fire(lt.LOGIN_STATE_CHANGED,{eventType:Gi.SIGN_OUT}),(n=this.config.eventBus)===null||n===void 0||n.fire(lt.AUTH_STATE_CHANGED,{event:Dt.SIGNED_OUT}),[2,Ye(Ye({},i),{data:{},error:null})];case 3:return s=u.sent(),[2,{data:{},error:new Se(s)}];case 4:return[2]}})})},t.prototype.onAuthStateChange=function(e){var r=this;this.hasListenerSetUp||(this.setupListeners(),this.hasListenerSetUp=!0);var n=Math.random().toString(36);this.listeners.has(n)||this.listeners.set(n,new Set),this.listeners.get(n).add(e);var o={id:n,callback:e,unsubscribe:function(){var i=r.listeners.get(n);i&&(i.delete(e),i.size===0&&r.listeners.delete(n))}};return{data:{subscription:o}}},t.prototype.signInWithPassword=function(e){return ge(this,void 0,void 0,function(){var r,n,o,i;return ye(this,function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),this.validateAtLeastOne(e,[["username"],["email"],["phone"]],"You must provide either username, email, or phone"),this.validateParams(e,{password:{required:!0,message:"Password is required"}}),[4,this.signIn(Ye({username:e.username||e.email||this.formatPhone(e.phone),password:e.password},e.is_encrypt?{isEncrypt:!0,version:"v2"}:{}))];case 1:return s.sent(),[4,this.getSession()];case 2:return r=s.sent().data,n=r===void 0?{}:r,o=n.session,[2,{data:{user:o.user,session:o},error:null}];case 3:return i=s.sent(),[2,{data:{},error:new Se(i)}];case 4:return[2]}})})},t.prototype.signInWithIdToken=function(e){return ge(this,void 0,void 0,function(){var r,n,o,i;return ye(this,function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),this.validateParams(e,{token:{required:!0,message:"Token is required"}}),[4,this.signInWithProvider({provider_token:e.token})];case 1:return s.sent(),[4,this.getSession()];case 2:return r=s.sent().data,n=r===void 0?{}:r,o=n.session,[2,{data:{user:o.user,session:o},error:null}];case 3:return i=s.sent(),[2,{data:{},error:new Se(i)}];case 4:return[2]}})})},t.prototype.signInWithOtp=function(e){return ge(this,void 0,void 0,function(){var r,n,o=this;return ye(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),this.validateAtLeastOne(e,[["email"],["phone"]],"You must provide either an email or phone number"),[4,this.getVerification(e.email?{email:e.email}:{phone_number:this.formatPhone(e.phone)})];case 1:return r=i.sent(),[2,{data:{user:null,session:null,verifyOtp:function(s){var u=s.token,l=s.messageId,a=l===void 0?r.verification_id:l;return ge(o,void 0,void 0,function(){return ye(this,function(c){return[2,this.verifyOtp({email:e.email,phone:e.phone,token:u,messageId:a})]})})}},error:null}];case 2:return n=i.sent(),[2,{data:{},error:new Se(n)}];case 3:return[2]}})})},t.prototype.verifyOAuth=function(e){return ge(this,void 0,void 0,function(){var r,n,o,i,s,u,l,a,c;return ye(this,function(h){switch(h.label){case 0:r={},h.label=1;case 1:return h.trys.push([1,7,,8]),n=e?.code||it.getQuery("code"),o=e?.state||it.getQuery("state"),n?o?(i=kb(o),r.type=i?.type,s=e?.provider||i?.provider||it.getQuery("provider"),s?[4,this.grantProviderToken({provider_id:s,provider_redirect_uri:location.origin+location.pathname,provider_code:n})]:[2,{data:r,error:new Se({message:"Provider is required"})}]):[2,{data:{},error:new Se({message:"State is required"})}]:[2,{data:{},error:new Se({message:"Code is required"})}];case 2:return u=h.sent().provider_token,l=void 0,i.type!==vr.BIND_IDENTITY?[3,4]:[4,this.oauthInstance.authApi.toBindIdentity({provider_token:u,provider:s,fireEvent:!0})];case 3:return l=h.sent(),[3,6];case 4:return[4,this.signInWithIdToken({token:u})];case 5:l=h.sent(),l.data=Ye(Ye({},r),l.data),h.label=6;case 6:return a=new URLSearchParams(location?.search),a.delete("code"),a.delete("state"),Wb(i?.search===void 0?"?".concat(a.toString()):i?.search,i?.hash||location.hash),$b(o),[2,l];case 7:return c=h.sent(),[2,{data:r,error:new Se(c)}];case 8:return[2]}})})},t.prototype.signInWithOAuth=function(e){var r,n,o,i,s;return ge(this,void 0,void 0,function(){var u,l,a,c,h,w,E,T,A;return ye(this,function(O){switch(O.label){case 0:return O.trys.push([0,2,,3]),this.validateParams(e,{provider:{required:!0,message:"Provider is required"}}),u=((r=e.options)===null||r===void 0?void 0:r.redirectTo)||location.href,l=new URL(u),a=l.origin+l.pathname,c=((n=e.options)===null||n===void 0?void 0:n.state)||"prd-".concat(e.provider,"-").concat(Math.random().toString(36).slice(2)),[4,this.genProviderRedirectUri({provider_id:e.provider,provider_redirect_uri:a,state:c})];case 1:return h=O.sent().uri,w=decodeURIComponent(h),E=w,!((o=e.options)===null||o===void 0)&&o.queryParams&&(T=new URL(w),Object.entries(e.options.queryParams).forEach(function(C){var P=C[0],q=C[1];T.searchParams.set(P,q)}),E=T.toString()),Mb(c,{provider:e.provider,search:l.search,hash:l.hash,type:((i=e.options)===null||i===void 0?void 0:i.type)||vr.SIGN_IN}),Gb()&&!(!((s=e.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(E),[2,{data:{url:E,provider:e.provider},error:null}];case 2:return A=O.sent(),[2,{data:{},error:new Se(A)}];case 3:return[2]}})})},t.prototype.signInWithSSO=function(){return ge(this,void 0,void 0,function(){return ye(this,function(e){return[2]})})},t.prototype.signInWithWeb3=function(){return ge(this,void 0,void 0,function(){return ye(this,function(e){return[2]})})},t.prototype.getClaims=function(){return ge(this,void 0,void 0,function(){var e,r,n;return ye(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.getAccessToken()];case 1:return e=o.sent().accessToken,r=Hd(e),[2,{data:r,error:null}];case 2:return n=o.sent(),[2,{data:{},error:new Se(n)}];case 3:return[2]}})})},t.prototype.resetPasswordForEmail=function(e,r){return ge(this,void 0,void 0,function(){var n,o,i,s,u,l,a=this;return ye(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),this.validateParams({emailOrPhone:e},{emailOrPhone:{required:!0,message:"Email or phone is required"}}),n=(r||{}).redirectTo,o=e.includes("@"),i=void 0,o?i={email:e}:(s=this.formatPhone(e),i={phone_number:s}),[4,this.getVerification(i)];case 1:return u=c.sent(),[2,{data:{updateUser:function(h){return ge(a,void 0,void 0,function(){var w,E,T,A;return ye(this,function(O){switch(O.label){case 0:this.validateParams(h,{nonce:{required:!0,message:"Nonce is required"},password:{required:!0,message:"Password is required"}}),O.label=1;case 1:return O.trys.push([1,5,,6]),[4,this.verify({verification_id:u.verification_id,verification_code:h.nonce})];case 2:return w=O.sent(),[4,this.oauthInstance.authApi.resetPassword({email:o?e:void 0,phone:o?void 0:e,new_password:h.password,verification_token:w.verification_token})];case 3:return O.sent(),(A=this.config.eventBus)===null||A===void 0||A.fire(lt.AUTH_STATE_CHANGED,{event:Dt.PASSWORD_RECOVERY}),[4,this.signInWithPassword({email:o?e:void 0,phone:o?void 0:e,password:h.password})];case 4:return E=O.sent(),n&&Gb()&&window.location.assign(n),[2,E];case 5:return T=O.sent(),[2,{data:{},error:new Se(T)}];case 6:return[2]}})})}},error:null}];case 2:return l=c.sent(),[2,{data:{},error:new Se(l)}];case 3:return[2]}})})},t.prototype.resetPasswordForOld=function(e){return ge(this,void 0,void 0,function(){var r,n,o,i;return ye(this,function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),[4,this.oauthInstance.authApi.updatePasswordByOld({old_password:e.old_password,new_password:e.new_password})];case 1:return s.sent(),[4,this.getSession()];case 2:return r=s.sent().data,n=r===void 0?{}:r,o=n.session,[2,{data:{user:o.user,session:o},error:null}];case 3:return i=s.sent(),[2,{data:{},error:new Se(i)}];case 4:return[2]}})})},t.prototype.verifyOtp=function(e){return ge(this,void 0,void 0,function(){var r,n,o,i,s;return ye(this,function(u){switch(u.label){case 0:return u.trys.push([0,6,,7]),r=e.type,this.validateParams(e,{token:{required:!0,message:"Token is required"},messageId:{required:!0,message:"messageId is required"}}),["phone_change","email_change"].includes(r)?[4,this.verify({verification_id:e.messageId,verification_code:e.token})]:[3,2];case 1:return u.sent(),[3,4];case 2:return[4,this.signInWithUsername({verificationInfo:{verification_id:e.messageId,is_user:!0},verificationCode:e.token,username:e.email||this.formatPhone(e.phone)||"",loginType:e.email?"email":"phone"})];case 3:u.sent(),u.label=4;case 4:return[4,this.getSession()];case 5:return n=u.sent().data,o=n===void 0?{}:n,i=o.session,[2,{data:{user:i.user,session:i},error:null}];case 6:return s=u.sent(),[2,{data:{},error:new Se(s)}];case 7:return[2]}})})},t.prototype.getSession=function(){return ge(this,void 0,void 0,function(){var e,r,n,o,i;return ye(this,function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),[4,this.oauthInstance.oauth2client.getCredentials()];case 1:return e=s.sent(),!e||e.scope==="accessKey"?[2,{data:{session:null},error:null}]:[4,this.getUser()];case 2:return r=s.sent().data,n=r===void 0?{}:r,o=n.user,[2,{data:{session:Ye(Ye({},e),{user:o})},error:null}];case 3:return i=s.sent(),[2,{data:{},error:new Se(i)}];case 4:return[2]}})})},t.prototype.refreshSession=function(e){return ge(this,void 0,void 0,function(){var r,n,o,i,s,u;return ye(this,function(l){switch(l.label){case 0:return l.trys.push([0,4,,5]),[4,this.oauthInstance.oauth2client.localCredentials.getCredentials()];case 1:return r=l.sent(),r.refresh_token=e||r.refresh_token,[4,this.oauthInstance.oauth2client.refreshToken(r)];case 2:return n=l.sent(),[4,this.getUser()];case 3:return o=l.sent().data,i=o===void 0?{}:o,s=i.user,[2,{data:{user:s,session:Ye(Ye({},n),{user:s})},error:null}];case 4:return u=l.sent(),[2,{data:{},error:new Se(u)}];case 5:return[2]}})})},t.prototype.getUser=function(){return ge(this,void 0,void 0,function(){var e,r,n;return ye(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),r=this.convertToUser,[4,this.getUserInfo()];case 1:return e=r.apply(this,[o.sent()]),[2,{data:{user:e},error:null}];case 2:return n=o.sent(),[2,{data:{},error:new Se(n)}];case 3:return[2]}})})},t.prototype.refreshUser=function(){return ge(this,void 0,void 0,function(){var e,r,n,o;return ye(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,this.currentUser.refresh()];case 1:return i.sent(),[4,this.getSession()];case 2:return e=i.sent().data,r=e===void 0?{}:e,n=r.session,[2,{data:{user:n.user,session:n},error:null}];case 3:return o=i.sent(),[2,{data:{},error:new Se(o)}];case 4:return[2]}})})},t.prototype.updateUser=function(e){var r;return ge(this,void 0,void 0,function(){var n,o,i,s,u,l,a,c,h,w,E,T,A,O,C=this;return ye(this,function(P){switch(P.label){case 0:if(P.trys.push([0,8,,9]),n=Object.keys(e).some(function(q){return e[q]!==void 0&&e[q]!==null&&e[q]!==""}),!n)throw new Se({message:"At least one field must be provided for update"});return o=e.email,i=e.phone,s=dF(e,["email","phone"]),u=o!==void 0,l=i!==void 0,a={},u||l?(c=void 0,u?(c={email:e.email},h="email_change"):(w=this.formatPhone(e.phone),c={phone_number:w},h="phone_change"),[4,this.getVerification(c)]):[3,4];case 1:return E=P.sent(),T=Object.keys(s).length>0,T?[4,this.updateUserBasicInfo(s)]:[3,3];case 2:T=P.sent(),P.label=3;case 3:return a={messageId:E.verification_id,verifyOtp:function(q){return ge(C,void 0,void 0,function(){var U,k,W;return ye(this,function(V){switch(V.label){case 0:return V.trys.push([0,11,,12]),q.email&&e.email===q.email?[4,this.verifyOtp({type:"email_change",email:e.email,token:q.token,messageId:E.verification_id})]:[3,3];case 1:return V.sent(),[4,this.updateUserBasicInfo({email:e.email})];case 2:return V.sent(),[3,9];case 3:return q.phone&&e.phone===q.phone?[4,this.verifyOtp({type:"phone_change",phone:e.phone,token:q.token,messageId:E.verification_id})]:[3,6];case 4:return V.sent(),[4,this.updateUserBasicInfo({phone:this.formatPhone(e.phone)})];case 5:return V.sent(),[3,9];case 6:return[4,this.verifyOtp({type:h,email:u?e.email:void 0,phone:u?void 0:e.phone,token:q.token,messageId:E.verification_id})];case 7:return V.sent(),[4,this.updateUserBasicInfo(e)];case 8:V.sent(),V.label=9;case 9:return[4,this.getUser()];case 10:return U=V.sent().data.user,(W=this.config.eventBus)===null||W===void 0||W.fire(lt.AUTH_STATE_CHANGED,{event:Dt.USER_UPDATED}),[2,{data:{user:U},error:null}];case 11:return k=V.sent(),[2,{data:{},error:new Se(k)}];case 12:return[2]}})})}},[3,6];case 4:return[4,this.updateUserBasicInfo(e)];case 5:P.sent(),P.label=6;case 6:return[4,this.getUser()];case 7:return A=P.sent().data.user,(r=this.config.eventBus)===null||r===void 0||r.fire(lt.AUTH_STATE_CHANGED,{event:Dt.USER_UPDATED}),[2,{data:Ye({user:A},a),error:null}];case 8:return O=P.sent(),[2,{data:{},error:new Se(O)}];case 9:return[2]}})})},t.prototype.getUserIdentities=function(){var e;return ge(this,void 0,void 0,function(){var r,n;return ye(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.oauthInstance.authApi.getProviders()];case 1:return r=o.sent(),[2,{data:{identities:(e=r?.data)===null||e===void 0?void 0:e.filter(function(i){return!!i.bind})},error:null}];case 2:return n=o.sent(),[2,{data:{},error:new Se(n)}];case 3:return[2]}})})},t.prototype.linkIdentity=function(e){return ge(this,void 0,void 0,function(){var r;return ye(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),this.validateParams(e,{provider:{required:!0,message:"Provider is required"}}),[4,this.signInWithOAuth({provider:e.provider,options:{type:vr.BIND_IDENTITY}})];case 1:return n.sent(),[2,{data:{provider:e.provider},error:null}];case 2:return r=n.sent(),[2,{data:{},error:new Se(r)}];case 3:return[2]}})})},t.prototype.unlinkIdentity=function(e){return ge(this,void 0,void 0,function(){var r;return ye(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),this.validateParams(e,{provider:{required:!0,message:"Provider is required"}}),[4,this.oauthInstance.authApi.unbindProvider({provider_id:e.provider})];case 1:return n.sent(),[2,{data:{},error:null}];case 2:return r=n.sent(),[2,{data:{},error:new Se(r)}];case 3:return[2]}})})},t.prototype.reauthenticate=function(){return ge(this,void 0,void 0,function(){var e,r,n,o,i=this;return ye(this,function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),[4,this.getUser()];case 1:return e=s.sent().data.user,this.validateAtLeastOne(e,[["email","phone"]],"You must provide either an email or phone number"),r=e.email?{email:e.email}:{phone_number:this.formatPhone(e.phone)},[4,this.getVerification(r)];case 2:return n=s.sent(),[2,{data:{updateUser:function(u){return ge(i,void 0,void 0,function(){var l,a,c,h,w,E;return ye(this,function(T){switch(T.label){case 0:this.validateParams(u,{nonce:{required:!0,message:"Nonce is required"}}),T.label=1;case 1:return T.trys.push([1,9,,10]),u.password?[4,this.verify({verification_id:n.verification_id,verification_code:u.nonce})]:[3,5];case 2:return l=T.sent(),[4,this.oauthInstance.authApi.sudo({verification_token:l.verification_token})];case 3:return a=T.sent(),[4,this.oauthInstance.authApi.setPassword({new_password:u.password,sudo_token:a.sudo_token})];case 4:return T.sent(),[3,7];case 5:return[4,this.signInWithUsername(Ye(Ye({verificationInfo:n,verificationCode:u.nonce},r),{loginType:r.email?"email":"phone"}))];case 6:T.sent(),T.label=7;case 7:return[4,this.getSession()];case 8:return c=T.sent().data,h=c===void 0?{}:c,w=h.session,[2,{data:{user:w.user,session:w},error:null}];case 9:return E=T.sent(),[2,{data:{},error:new Se(E)}];case 10:return[2]}})})}},error:null}];case 3:return o=s.sent(),[2,{data:{},error:new Se(o)}];case 4:return[2]}})})},t.prototype.resend=function(e){return ge(this,void 0,void 0,function(){var r,n,o,i;return ye(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),this.validateAtLeastOne(e,[["email"],["phone"]],"You must provide either an email or phone number"),r=e.type==="signup"?"ANY":"USER",n={target:r},"email"in e&&(n.email=e.email),"phone"in e&&(n.phone_number=this.formatPhone(e.phone)),[4,this.oauthInstance.authApi.getVerification(n)];case 1:return o=s.sent().verification_id,[2,{data:{messageId:o},error:null}];case 2:return i=s.sent(),[2,{data:{},error:new Se(i)}];case 3:return[2]}})})},t.prototype.setSession=function(e){var r;return ge(this,void 0,void 0,function(){var n,o,i,s;return ye(this,function(u){switch(u.label){case 0:return u.trys.push([0,3,,4]),this.validateParams(e,{access_token:{required:!0,message:"Access token is required"},refresh_token:{required:!0,message:"Refresh token is required"}}),[4,this.oauthInstance.oauth2client.refreshToken(e,{throwOnError:!0})];case 1:return u.sent(),[4,this.getSession()];case 2:return n=u.sent().data,o=n===void 0?{}:n,i=o.session,(r=this.config.eventBus)===null||r===void 0||r.fire(lt.AUTH_STATE_CHANGED,{event:Dt.SIGNED_IN}),[2,{data:{user:i.user,session:i},error:null}];case 3:return s=u.sent(),[2,{data:{},error:new Se(s)}];case 4:return[2]}})})},t.prototype.exchangeCodeForSession=function(){return ge(this,void 0,void 0,function(){return ye(this,function(e){return[2]})})},t.prototype.deleteUser=function(e){return ge(this,void 0,void 0,function(){var r,n;return ye(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),this.validateParams(e,{password:{required:!0,message:"Password is required"}}),[4,this.oauthInstance.authApi.sudo(e)];case 1:return r=o.sent().sudo_token,[4,this.oauthInstance.authApi.deleteMe({sudo_token:r})];case 2:return o.sent(),[2,{data:{},error:null}];case 3:return n=o.sent(),[2,{data:{},error:new Se(n)}];case 4:return[2]}})})},t.prototype.toDefaultLoginPage=function(e){return e===void 0&&(e={}),ge(this,void 0,void 0,function(){var r,n,o,i,s;return ye(this,function(u){try{return r=e.config_version||"env",n=Object.keys(e.query||{}).map(function(l){return"".concat(l,"=").concat(e.query[l])}).join("&"),Vt.isMatch()?wx.navigateTo({url:"/packages/$wd_system/pages/login/index".concat(n?"?".concat(n):"")}):(o=e.redirect_uri||window.location.href,i=new URL(o),s="".concat(i.origin,"/__auth/?app_id=").concat(e.app_id||"","&env_id=").concat(this.config.env,"&client_id=").concat(this.config.clientId||this.config.env,"&config_version=").concat(r,"&redirect_uri=").concat(encodeURIComponent(o)).concat(n?"&".concat(n):""),window.location.href=s),[2,{data:{},error:null}]}catch(l){return[2,{data:{},error:new Se(l)}]}return[2]})})},t.prototype.signInWithCustomTicket=function(e){return ge(this,void 0,void 0,function(){var r,n,o,i,s;return ye(this,function(u){switch(u.label){case 0:e&&this.setCustomSignFunc(e),u.label=1;case 1:return u.trys.push([1,5,,6]),[4,this.oauthInstance.authApi.signInWithCustomTicket()];case 2:return u.sent(),[4,this.createLoginState()];case 3:return r=u.sent(),[4,this.getSession()];case 4:return n=u.sent().data,o=n===void 0?{}:n,i=o.session,[2,Ye(Ye({},r),{data:{user:i.user,session:i},error:null})];case 5:return s=u.sent(),[2,{data:{},error:new Se(s)}];case 6:return[2]}})})},t.prototype.signInWithOpenId=function(e){var r=e===void 0?{}:e,n=r.useWxCloud,o=n===void 0?!0:n;return ge(this,void 0,void 0,function(){var i,s,u,l,a,c,h,w=this;return ye(this,function(E){switch(E.label){case 0:if(!Vt.isMatch())throw Error("wx api undefined");i=wx.getAccountInfoSync().miniProgram,s=function(T){return ge(w,void 0,void 0,function(){var A,O,C;return ye(this,function(P){switch(P.label){case 0:A=void 0,O=void 0,P.label=1;case 1:return P.trys.push([1,4,,5]),[4,this.oauthInstance.authApi.grantProviderToken({provider_id:i?.appId,provider_code:T,provider_params:{provider_code_type:"open_id",appid:i?.appId}},o)];case 2:if(A=P.sent(),A?.error_code||!A.provider_token)throw A;return[4,this.oauthInstance.authApi.signInWithProvider({provider_token:A.provider_token},o)];case 3:if(O=P.sent(),O?.error_code)throw O;return[3,5];case 4:throw C=P.sent(),C;case 5:return[4,this.oauthInstance.oauth2client.setCredentials(O)];case 6:return P.sent(),[2]}})})},E.label=1;case 1:return E.trys.push([1,5,,6]),[4,new Promise(function(T,A){wx.login({success:function(O){return ge(w,void 0,void 0,function(){var C;return ye(this,function(P){switch(P.label){case 0:return P.trys.push([0,2,,3]),[4,s(O.code)];case 1:return P.sent(),T(!0),[3,3];case 2:return C=P.sent(),A(C),[3,3];case 3:return[2]}})})},fail:function(O){var C=new Error(O?.errMsg);C.code=O?.errno,A(C)}})})];case 2:return E.sent(),[4,this.createLoginState()];case 3:return u=E.sent(),[4,this.getSession()];case 4:return l=E.sent().data,a=l===void 0?{}:l,c=a.session,[2,Ye(Ye({},u),{data:{user:c.user,session:c},error:null})];case 5:return h=E.sent(),[2,{data:{},error:new Se(h)}];case 6:return[2]}})})},t.prototype.signInWithPhoneAuth=function(e){var r=e.phoneCode,n=r===void 0?"":r;return ge(this,void 0,void 0,function(){var o,i,s,u,l,a,c,h,w,E;return ye(this,function(T){switch(T.label){case 0:return Vt.isMatch()?(o=wx.getAccountInfoSync().miniProgram,i={provider_params:{provider_code_type:"phone"},provider_id:o.appId},[4,wx.login()]):[2,{data:{},error:new Se({message:"wx api undefined"})}];case 1:s=T.sent().code,i.provider_code=s,T.label=2;case 2:return T.trys.push([2,6,,7]),[4,this.oauthInstance.authApi.grantProviderToken(i)];case 3:if(u=T.sent(),u.error_code)throw u;return[4,this.oauthInstance.authApi.patchProviderToken({provider_token:u.provider_token,provider_id:o.appId,provider_params:{code:n,provider_code_type:"phone"}})];case 4:if(u=T.sent(),u.error_code)throw u;return[4,this.oauthInstance.authApi.signInWithProvider({provider_token:u.provider_token})];case 5:if(l=T.sent(),l?.error_code)throw l;return[3,7];case 6:return a=T.sent(),[2,{data:{},error:new Se(a)}];case 7:return[4,this.createLoginState()];case 8:return c=T.sent(),[4,this.getSession()];case 9:return h=T.sent().data,w=h===void 0?{}:h,E=w.session,[2,Ye(Ye({},c),{data:{user:E.user,session:E},error:null})]}})})},t.prototype.formatPhone=function(e){return!/\s+/.test(e)&&/^\+\d{1,3}\d+/.test(e)?e.replace(/^(\+\d{1,2})(\d+)$/,"$1 $2"):/^\+\d{1,3}\s+/.test(e)?e:"+86 ".concat(e)},t.prototype.notifyListeners=function(e,r,n){this.listeners.forEach(function(o){o.forEach(function(i){try{i(e,r,n)}catch(s){console.error("Error in auth state change callback:",s)}})})},t.prototype.init=function(){var e;return ge(this,void 0,void 0,function(){var r,n;return ye(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.oauthInstance.oauth2client.localCredentials.getCredentials()];case 1:return r=o.sent(),r&&((e=this.config.eventBus)===null||e===void 0||e.fire(lt.AUTH_STATE_CHANGED,{event:Dt.INITIAL_SESSION})),[3,3];case 2:return n=o.sent(),[3,3];case 3:return[2,{error:null}]}})})},t.prototype.setupListeners=function(){var e=this,r;(r=this.config.eventBus)===null||r===void 0||r.on(lt.AUTH_STATE_CHANGED,function(n){return ge(e,void 0,void 0,function(){var o,i,s,u,l;return ye(this,function(a){switch(a.label){case 0:return o=(u=n?.data)===null||u===void 0?void 0:u.event,i=(l=n?.data)===null||l===void 0?void 0:l.info,[4,this.getSession()];case 1:return s=a.sent().data.session,this.notifyListeners(o,s,i),[2]}})})})},t.prototype.convertToUser=function(e){var r,n,o;if(!e)return null;var i=e?.email||e?.username,s=e?.phone_number,u=e?.sub||e?.uid||"";return{id:u,aud:"authenticated",role:e.groups,email:i||"",email_confirmed_at:(e?.email_verified,e.created_at),phone:s,phone_confirmed_at:s?e.created_at:void 0,confirmed_at:e.created_at,last_sign_in_at:e.last_sign_in_at,app_metadata:{provider:((r=e.loginType)===null||r===void 0?void 0:r.toLowerCase())||"cloudbase",providers:[((n=e.loginType)===null||n===void 0?void 0:n.toLowerCase())||"cloudbase"]},user_metadata:{name:e?.name,picture:e?.picture,username:e?.username,gender:e?.gender,locale:e?.locale,uid:e.uid,nickName:e.nickName,avatarUrl:e.avatarUrl||e.picture,location:e.location,hasPassword:e.hasPassword},identities:((o=e?.providers)===null||o===void 0?void 0:o.map(function(l){return{id:l.id||"",identity_id:l.id||"",user_id:u,identity_data:{provider_id:l.id,provider_user_id:l.provider_user_id,name:l.name},provider:l.id||"cloudbase",created_at:e.created_at,updated_at:e.updated_at,last_sign_in_at:e.last_sign_in_at}}))||[],created_at:e.created_at,updated_at:e.updated_at,is_anonymous:e.name==="anonymous"}},t.prototype.validateParams=function(e,r){for(var n=0,o=Object.entries(r);n<o.length;n++){var i=o[n],s=i[0],u=i[1];if(u.required&&(e?.[s]===void 0||e?.[s]===null||e?.[s]===""))throw new Se({message:u.message})}},t.prototype.validateAtLeastOne=function(e,r,n){var o=r.some(function(i){return i.some(function(s){return e?.[s]!==void 0&&e?.[s]!==null&&e?.[s]!==""})});if(!o)throw new Se({message:n})},t})()});function _F(t,e){var r=this,n=t.region,o=n===void 0?"ap-shanghai":n,i=t.i18n,s=t.accessKey,u=t.useWxCloud,l=e?.platform||_p.useDefaultAdapter.bind(e)(),a=l.runtime,c=l.adapter,h=e||{},w=h.env,E=h.clientId,T=h.debug,A=h.cache,O=h.app,C=(e||{}).apiOrigin;C||(C="https://".concat(w,".").concat(o,".tcb-api.tencentcloudapi.com"));var P={env:w,clientId:E,i18n:i,accessKey:s,useWxCloud:u,eventBus:new gp.CloudbaseEventEmitter},q=new Uc(Fb(rt(rt({},P),{apiOrigin:C,apiPath:t?.apiPath||si,storage:t?.storage,baseRequest:t?.baseRequest,request:t?.request,anonymousSignInFunc:t?.anonymousSignInFunc,captchaOptions:t?.captchaOptions,wxCloud:t?.wxCloud,adapter:c,onCredentialsError:mF(P.eventBus),headers:rt({"X-SDK-Version":"@cloudbase/js-sdk/".concat(t.sdkVersion)},t.headers||{}),detectSessionInUrl:t.detectSessionInUrl,debug:T}))),U=new yF(rt(rt({},P),{region:o,persistence:t.persistence,debug:T,cache:A||new yp.CloudbaseCache({persistence:t.persistence,keys:{userInfoKey:"user_info_".concat(w)},platformInfo:l}),runtime:a||"web",_fromApp:O,oauthInstance:q}));return q.initializeSession(function(k,W){return fe(r,void 0,void 0,function(){return he(this,function(V){return k?(k.type===vr.SIGN_IN?W?P.eventBus.fire(lt.AUTH_STATE_CHANGED,{event:Dt.SIGNED_IN,info:rt(rt({},k),{error:W})}):k.user&&U.createLoginState({},{userInfo:k.user}):k.type===vr.BIND_IDENTITY&&P.eventBus.fire(lt.AUTH_STATE_CHANGED,{event:Dt.BIND_IDENTITY,info:rt(rt({},k),{error:W})}),[2]):[2]})})}),{authInstance:U,oauthInstance:q}}function Jb(t){try{t.registerComponent(Yb)}catch(e){console.warn(e)}}var pF,rt,ft,le,fe,he,vF,mF,gF,wp,yF,Kb,Yb,Qb=X(()=>{Dc();jb();qc();zb();pF=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),rt=function(){return rt=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},rt.apply(this,arguments)},ft=function(t,e,r,n){var o=arguments.length,i=o<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(s=t[u])&&(i=(o<3?s(i):o>3?s(e,r,i):s(e,r))||i);return o>3&&i&&Object.defineProperty(e,r,i),i},le=function(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)},fe=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},he=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},vF="auth",mF=function(t){return function(e){t.fire(lt.LOGIN_STATE_CHANGED,rt(rt({},e),{eventType:Gi.CREDENTIALS_ERROR}))}},gF=(function(){function t(e){var r=e.cache,n=e.oauthInstance;this.cache=r,this.oauthInstance=n,this.setUserInfo()}return t.prototype.checkLocalInfo=function(){return fe(this,void 0,void 0,function(){return he(this,function(e){return this.uid=this.getLocalUserInfo("uid"),this.gender=this.getLocalUserInfo("gender"),this.picture=this.getLocalUserInfo("picture"),this.email=this.getLocalUserInfo("email"),this.emailVerified=this.getLocalUserInfo("email_verified"),this.phoneNumber=this.getLocalUserInfo("phone_number"),this.username=this.getLocalUserInfo("username"),this.name=this.getLocalUserInfo("name"),this.birthdate=this.getLocalUserInfo("birthdate"),this.zoneinfo=this.getLocalUserInfo("zoneinfo"),this.locale=this.getLocalUserInfo("locale"),this.sub=this.getLocalUserInfo("sub"),this.createdFrom=this.getLocalUserInfo("created_from"),this.providers=this.getLocalUserInfo("providers"),[2]})})},t.prototype.checkLocalInfoAsync=function(){return fe(this,void 0,void 0,function(){var e,r,n,o;return he(this,function(i){switch(i.label){case 0:return e=this,[4,this.getLocalUserInfoAsync("uid")];case 1:return e.uid=i.sent(),r=this,[4,this.getLocalUserInfoAsync("gender")];case 2:return r.gender=i.sent(),this.picture=this.getLocalUserInfo("picture"),n=this,[4,this.getLocalUserInfoAsync("email")];case 3:return n.email=i.sent(),this.emailVerified=this.getLocalUserInfo("email_verified"),this.phoneNumber=this.getLocalUserInfo("phone_number"),o=this,[4,this.getLocalUserInfoAsync("username")];case 4:return o.username=i.sent(),this.name=this.getLocalUserInfo("name"),this.birthdate=this.getLocalUserInfo("birthdate"),this.zoneinfo=this.getLocalUserInfo("zoneinfo"),this.locale=this.getLocalUserInfo("locale"),this.sub=this.getLocalUserInfo("sub"),this.createdFrom=this.getLocalUserInfo("created_from"),this.providers=this.getLocalUserInfo("providers"),[2]}})})},t.prototype.update=function(e){return fe(this,void 0,void 0,function(){var r;return he(this,function(n){switch(n.label){case 0:return[4,this.oauthInstance.authApi.setUserProfile(rt({},e))];case 1:return r=n.sent(),this.setLocalUserInfo(r),[2]}})})},t.prototype.updateUserBasicInfo=function(e){return fe(this,void 0,void 0,function(){return he(this,function(r){switch(r.label){case 0:return[4,this.oauthInstance.authApi.updateUserBasicInfo(rt({},e))];case 1:return r.sent(),[4,this.refresh()];case 2:return r.sent(),[2]}})})},t.prototype.updatePassword=function(e,r){return this.oauthInstance.authApi.updatePasswordByOld({old_password:r,new_password:e})},t.prototype.updateUsername=function(e){return typeof e!="string"&&(0,Yn.throwError)($e.ERRORS.INVALID_PARAMS,"username must be a string"),this.update({username:e})},t.prototype.refresh=function(e){return fe(this,void 0,void 0,function(){var r;return he(this,function(n){switch(n.label){case 0:return[4,this.oauthInstance.authApi.getUserInfo(e)];case 1:if(r=n.sent(),r.code==="INVALID_ACCESS_TOKEN")throw this.setLocalUserInfo({}),r;return this.setLocalUserInfo(r),[2,r]}})})},t.prototype.getLocalUserInfo=function(e){var r=this.cache.keys.userInfoKey,n=this.cache.getStore(r);return e?n[e]:n||{}},t.prototype.setLocalUserInfo=function(e){var r=this.cache.keys.userInfoKey;this.cache.setStore(r,e),this.setUserInfo()},t.prototype.getLocalUserInfoAsync=function(e){return fe(this,void 0,void 0,function(){var r,n;return he(this,function(o){switch(o.label){case 0:return r=this.cache.keys.userInfoKey,[4,this.cache.getStoreAsync(r)];case 1:return n=o.sent(),[2,n[e]]}})})},t.prototype.setUserInfo=function(){var e=this,r=this.cache.keys.userInfoKey,n=this.cache.getStore(r);["uid","email","name","gender","picture","email_verified","phone_number","birthdate","zoneinfo","locale","sub","created_from","providers","username","created_at"].forEach(function(o){e[o]=n[o]})},ft([(0,tt.catchErrorsDecorator)({title:"\u66F4\u65B0\u7528\u6237\u4FE1\u606F\u5931\u8D25",messages:["\u8BF7\u786E\u8BA4\u4EE5\u4E0B\u5404\u9879\uFF1A","  1 - \u8C03\u7528 User.update() \u7684\u8BED\u6CD5\u6216\u53C2\u6570\u662F\u5426\u6B63\u786E","  2 - \u7528\u6237\u4FE1\u606F\u4E2D\u662F\u5426\u5305\u542B\u975E\u6CD5\u503C","\u5982\u679C\u95EE\u9898\u4F9D\u7136\u5B58\u5728\uFF0C\u5EFA\u8BAE\u5230\u5B98\u65B9\u95EE\u7B54\u793E\u533A\u63D0\u95EE\u6216\u5BFB\u627E\u5E2E\u52A9\uFF1A".concat($e.COMMUNITY_SITE_URL)]}),le("design:type",Function),le("design:paramtypes",[Object]),le("design:returntype",Promise)],t.prototype,"update",null),ft([(0,tt.catchErrorsDecorator)({title:"\u66F4\u65B0\u5BC6\u7801\u5931\u8D25",messages:["\u8BF7\u786E\u8BA4\u4EE5\u4E0B\u5404\u9879\uFF1A","  1 - \u8C03\u7528 User.updatePassword() \u7684\u8BED\u6CD5\u6216\u53C2\u6570\u662F\u5426\u6B63\u786E","  3 - \u65B0\u5BC6\u7801\u4E2D\u662F\u5426\u5305\u542B\u975E\u6CD5\u5B57\u7B26","\u5982\u679C\u95EE\u9898\u4F9D\u7136\u5B58\u5728\uFF0C\u5EFA\u8BAE\u5230\u5B98\u65B9\u95EE\u7B54\u793E\u533A\u63D0\u95EE\u6216\u5BFB\u627E\u5E2E\u52A9\uFF1A".concat($e.COMMUNITY_SITE_URL)]}),le("design:type",Function),le("design:paramtypes",[String,String]),le("design:returntype",void 0)],t.prototype,"updatePassword",null),ft([(0,tt.catchErrorsDecorator)({title:"\u66F4\u65B0\u7528\u6237\u540D\u5931\u8D25",messages:["\u8BF7\u786E\u8BA4\u4EE5\u4E0B\u5404\u9879\uFF1A","  1 - \u8C03\u7528 User.updateUsername() \u7684\u8BED\u6CD5\u6216\u53C2\u6570\u662F\u5426\u6B63\u786E","  2 - \u5F53\u524D\u73AF\u5883\u662F\u5426\u5F00\u901A\u4E86\u7528\u6237\u540D\u5BC6\u7801\u767B\u5F55","\u5982\u679C\u95EE\u9898\u4F9D\u7136\u5B58\u5728\uFF0C\u5EFA\u8BAE\u5230\u5B98\u65B9\u95EE\u7B54\u793E\u533A\u63D0\u95EE\u6216\u5BFB\u627E\u5E2E\u52A9\uFF1A".concat($e.COMMUNITY_SITE_URL)]}),le("design:type",Function),le("design:paramtypes",[String]),le("design:returntype",void 0)],t.prototype,"updateUsername",null),ft([(0,tt.catchErrorsDecorator)({title:"\u5237\u65B0\u672C\u5730\u7528\u6237\u4FE1\u606F\u5931\u8D25",messages:["\u8BF7\u786E\u8BA4\u4EE5\u4E0B\u5404\u9879\uFF1A","  1 - \u8C03\u7528 User.refresh() \u7684\u8BED\u6CD5\u6216\u53C2\u6570\u662F\u5426\u6B63\u786E","\u5982\u679C\u95EE\u9898\u4F9D\u7136\u5B58\u5728\uFF0C\u5EFA\u8BAE\u5230\u5B98\u65B9\u95EE\u7B54\u793E\u533A\u63D0\u95EE\u6216\u5BFB\u627E\u5E2E\u52A9\uFF1A".concat($e.COMMUNITY_SITE_URL)]}),le("design:type",Function),le("design:paramtypes",[Object]),le("design:returntype",Promise)],t.prototype,"refresh",null),t})(),wp=(function(){function t(e){var r=e.envId,n=e.cache,o=e.oauthInstance;r||(0,Yn.throwError)($e.ERRORS.INVALID_PARAMS,"envId is not defined"),this.cache=n,this.oauthInstance=o,this.user=new gF({cache:this.cache,oauthInstance:o})}return t.prototype.checkLocalState=function(){var e;this.oauthLoginState=(e=this.oauthInstance)===null||e===void 0?void 0:e.authApi.hasLoginStateSync(),this.user.checkLocalInfo()},t.prototype.checkLocalStateAsync=function(){var e;return fe(this,void 0,void 0,function(){return he(this,function(r){switch(r.label){case 0:return[4,(e=this.oauthInstance)===null||e===void 0?void 0:e.authApi.getLoginState()];case 1:return r.sent(),[4,this.user.checkLocalInfoAsync()];case 2:return r.sent(),[2]}})})},t})(),yF=(function(t){pF(e,t);function e(r){var n=t.call(this,r)||this;return n.setAccessKey(),n}return e.prototype.bindPhoneNumber=function(r){return fe(this,void 0,void 0,function(){return he(this,function(n){return[2,this.oauthInstance.authApi.editContact(r)]})})},e.prototype.unbindProvider=function(r){return fe(this,void 0,void 0,function(){return he(this,function(n){return[2,this.oauthInstance.authApi.unbindProvider(r)]})})},e.prototype.bindEmail=function(r){return this.oauthInstance.authApi.editContact(r)},e.prototype.verify=function(r){return fe(this,void 0,void 0,function(){return he(this,function(n){return[2,this.oauthInstance.authApi.verify(r)]})})},e.prototype.getVerification=function(r,n){return fe(this,void 0,void 0,function(){return he(this,function(o){return[2,this.oauthInstance.authApi.getVerification(r,n)]})})},Object.defineProperty(e.prototype,"currentUser",{get:function(){if(this.cache.mode==="async"){(0,Yn.printWarn)($e.ERRORS.INVALID_OPERATION,"current platform's storage is asynchronous, please use getCurrentUser instead");return}var r=this.hasLoginState();return r&&r.user||null},enumerable:!1,configurable:!0}),e.prototype.getCurrentUser=function(){return fe(this,void 0,void 0,function(){var r,n;return he(this,function(o){switch(o.label){case 0:return[4,this.getLoginState()];case 1:return r=o.sent(),r?(n=r.user.getLocalUserInfo(),[4,r.user.checkLocalInfoAsync()]):[3,3];case 2:return o.sent(),[2,rt(rt({},r.user),n)];case 3:return[2,null]}})})},e.prototype.signInAnonymouslyInWx=function(r){var n=r===void 0?{}:r,o=n.useWxCloud;return fe(this,void 0,void 0,function(){var i,s,u=this;return he(this,function(l){switch(l.label){case 0:if(!Vt.isMatch())throw Error("wx api undefined");return i=wx.getAccountInfoSync().miniProgram,s=function(a){return fe(u,void 0,void 0,function(){var c,h,w;return he(this,function(E){switch(E.label){case 0:c=void 0,h=void 0,E.label=1;case 1:return E.trys.push([1,4,,5]),[4,this.oauthInstance.authApi.grantProviderToken({provider_id:i?.appId,provider_code:a,provider_params:{provider_code_type:"open_id",appid:i?.appId}},o)];case 2:if(c=E.sent(),c?.error_code||!c.provider_token)throw c;return[4,this.oauthInstance.authApi.signInAnonymously({provider_token:c.provider_token},o)];case 3:if(h=E.sent(),h?.error_code)throw h;return[3,5];case 4:throw w=E.sent(),w;case 5:return[2]}})})},[4,new Promise(function(a,c){wx.login({success:function(h){return fe(u,void 0,void 0,function(){var w;return he(this,function(E){switch(E.label){case 0:return E.trys.push([0,2,,3]),[4,s(h.code)];case 1:return E.sent(),a(!0),[3,3];case 2:return w=E.sent(),c(w),[3,3];case 3:return[2]}})})},fail:function(h){var w=new Error(h?.errMsg);w.code=h?.errno,c(w)}})})];case 1:return l.sent(),[2,this.createLoginState(void 0,{asyncRefreshUser:!0})]}})})},e.prototype.bindOpenId=function(){return fe(this,void 0,void 0,function(){var r,n,o=this;return he(this,function(i){switch(i.label){case 0:if(!Vt.isMatch())throw Error("wx api undefined");return r=wx.getAccountInfoSync().miniProgram,n=function(s){return fe(o,void 0,void 0,function(){var u,l;return he(this,function(a){switch(a.label){case 0:u=void 0,a.label=1;case 1:return a.trys.push([1,4,,5]),[4,this.oauthInstance.authApi.grantProviderToken({provider_id:r?.appId,provider_code:s,provider_params:{provider_code_type:"open_id",appid:r?.appId}})];case 2:if(u=a.sent(),u?.error_code||!u.provider_token)throw u;return[4,this.oauthInstance.authApi.bindWithProvider({provider_token:u.provider_token})];case 3:return a.sent(),[3,5];case 4:throw l=a.sent(),l;case 5:return[2]}})})},[4,new Promise(function(s,u){wx.login({success:function(l){return fe(o,void 0,void 0,function(){var a;return he(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,n(l.code)];case 1:return c.sent(),s(!0),[3,3];case 2:return a=c.sent(),u(a),[3,3];case 3:return[2]}})})},fail:function(l){var a=new Error(l?.errMsg);a.code=l?.errno,u(a)}})})];case 1:return i.sent(),[2]}})})},e.prototype.signInWithUnionId=function(){return fe(this,void 0,void 0,function(){var r,n=this;return he(this,function(o){switch(o.label){case 0:if(!Vt.isMatch())throw Error("wx api undefined");o.label=1;case 1:return o.trys.push([1,3,,4]),[4,new Promise(function(i,s){var u=wx.getAccountInfoSync().miniProgram;wx.login({success:function(l){return fe(n,void 0,void 0,function(){var a,c,h,w,E;return he(this,function(T){switch(T.label){case 0:a=u?.appId,T.label=1;case 1:return T.trys.push([1,4,,5]),[4,this.oauthInstance.authApi.grantProviderToken({provider_code:l.code,provider_id:a,provider_params:{provider_code_type:"union_id",appid:u?.appId}})];case 2:return c=T.sent(),h=c.provider_token,h?[4,this.oauthInstance.authApi.signInWithProvider({provider_id:a,provider_token:h})]:(s(c),[2]);case 3:return w=T.sent(),w?.error_code?(s(w),[2]):(i(!0),[3,5]);case 4:return E=T.sent(),s(E),[3,5];case 5:return[2]}})})},fail:function(l){var a=new Error(l?.errMsg);a.code=l?.errno,s(a)}})})];case 2:return o.sent(),[3,4];case 3:throw r=o.sent(),r;case 4:return[2,this.createLoginState()]}})})},e.prototype.signInWithSms=function(r){var n=r.verificationInfo,o=n===void 0?{verification_id:"",is_user:!1}:n,i=r.verificationCode,s=i===void 0?"":i,u=r.phoneNum,l=u===void 0?"":u,a=r.bindInfo,c=a===void 0?void 0:a;return fe(this,void 0,void 0,function(){return he(this,function(h){try{return[2,this.signInWithUsername({verificationInfo:o,verificationCode:s,bindInfo:c,username:l,loginType:"sms"})]}catch(w){throw w}return[2]})})},e.prototype.signInWithEmail=function(r){var n=r.verificationInfo,o=n===void 0?{verification_id:"",is_user:!1}:n,i=r.verificationCode,s=i===void 0?"":i,u=r.bindInfo,l=u===void 0?void 0:u,a=r.email,c=a===void 0?"":a;return fe(this,void 0,void 0,function(){return he(this,function(h){try{return[2,this.signInWithUsername({verificationInfo:o,verificationCode:s,bindInfo:l,username:c,loginType:"email"})]}catch(w){throw w}return[2]})})},e.prototype.setCustomSignFunc=function(r){this.oauthInstance.authApi.setCustomSignFunc(r)},e.prototype.signIn=function(r){return fe(this,void 0,void 0,function(){return he(this,function(n){switch(n.label){case 0:return[4,this.oauthInstance.authApi.signIn(r)];case 1:return n.sent(),[2,this.createLoginState(r)]}})})},e.prototype.setPassword=function(r){return fe(this,void 0,void 0,function(){return he(this,function(n){return[2,this.oauthInstance.authApi.setPassword(r)]})})},e.prototype.isUsernameRegistered=function(r){return fe(this,void 0,void 0,function(){var n;return he(this,function(o){switch(o.label){case 0:return typeof r!="string"&&(0,Yn.throwError)($e.ERRORS.INVALID_PARAMS,"username must be a string"),[4,this.oauthInstance.authApi.checkIfUserExist({username:r})];case 1:return n=o.sent().exist,[2,n]}})})},e.prototype.hasLoginState=function(){var r;if(this.cache.mode==="async"){(0,Yn.printWarn)($e.ERRORS.INVALID_OPERATION,"current platform's storage is asynchronous, please use getLoginState insteed");return}var n=(r=this.oauthInstance)===null||r===void 0?void 0:r.authApi.hasLoginStateSync();if(n){var o=new wp({envId:this.config.env,cache:this.cache,oauthInstance:this.oauthInstance});return o}return null},e.prototype.getLoginState=function(){return fe(this,void 0,void 0,function(){var r,n,o;return he(this,function(i){switch(i.label){case 0:r=null,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.oauthInstance.authApi.getLoginState()];case 2:return r=i.sent(),[3,4];case 3:return n=i.sent(),[2,null];case 4:return r?(o=new wp({envId:this.config.env,cache:this.cache,oauthInstance:this.oauthInstance}),[2,o]):[2,null]}})})},e.prototype.getUserInfo=function(){return fe(this,void 0,void 0,function(){return he(this,function(r){return[2,this.getCurrentUser()]})})},e.prototype.getWedaUserInfo=function(){return fe(this,void 0,void 0,function(){return he(this,function(r){return[2,this.oauthInstance.authApi.getWedaUserInfo()]})})},e.prototype.updateUserBasicInfo=function(r){return fe(this,void 0,void 0,function(){var n;return he(this,function(o){switch(o.label){case 0:return[4,this.getLoginState()];case 1:return n=o.sent(),n?[4,n.user.updateUserBasicInfo(r)]:[3,3];case 2:o.sent(),o.label=3;case 3:return[2]}})})},e.prototype.getAuthHeader=function(){return console.error("Auth.getAuthHeader API \u5DF2\u5E9F\u5F03"),{}},e.prototype.bindWithProvider=function(r){return fe(this,void 0,void 0,function(){return he(this,function(n){return[2,this.oauthInstance.authApi.bindWithProvider(r)]})})},e.prototype.queryUser=function(r){return fe(this,void 0,void 0,function(){return he(this,function(n){return[2,this.oauthInstance.authApi.queryUserProfile(r)]})})},e.prototype.getAccessToken=function(){return fe(this,void 0,void 0,function(){var r;return he(this,function(n){switch(n.label){case 0:return[4,this.oauthInstance.oauth2client.getAccessToken()];case 1:return r=n.sent(),[2,{accessToken:r,env:this.config.env}]}})})},e.prototype.grantProviderToken=function(r){return fe(this,void 0,void 0,function(){return he(this,function(n){return[2,this.oauthInstance.authApi.grantProviderToken(r)]})})},e.prototype.patchProviderToken=function(r){return fe(this,void 0,void 0,function(){return he(this,function(n){return[2,this.oauthInstance.authApi.patchProviderToken(r)]})})},e.prototype.signInWithProvider=function(r){return fe(this,void 0,void 0,function(){return he(this,function(n){switch(n.label){case 0:return[4,this.oauthInstance.authApi.signInWithProvider(r)];case 1:return n.sent(),[2,this.createLoginState(r)]}})})},e.prototype.signInWithWechat=function(r){return r===void 0&&(r={}),fe(this,void 0,void 0,function(){return he(this,function(n){switch(n.label){case 0:return[4,this.oauthInstance.authApi.signInWithWechat(r)];case 1:return n.sent(),[2,this.createLoginState(r)]}})})},e.prototype.grantToken=function(r){return fe(this,void 0,void 0,function(){return he(this,function(n){switch(n.label){case 0:return[4,this.oauthInstance.authApi.grantToken(r)];case 1:return n.sent(),[2,this.createLoginState()]}})})},e.prototype.genProviderRedirectUri=function(r){return fe(this,void 0,void 0,function(){return he(this,function(n){return[2,this.oauthInstance.authApi.genProviderRedirectUri(r)]})})},e.prototype.resetPassword=function(r){return fe(this,void 0,void 0,function(){return he(this,function(n){return[2,this.oauthInstance.authApi.resetPassword(r)]})})},e.prototype.deviceAuthorize=function(r){return fe(this,void 0,void 0,function(){return he(this,function(n){return[2,this.oauthInstance.authApi.deviceAuthorize(r)]})})},e.prototype.sudo=function(r){return fe(this,void 0,void 0,function(){return he(this,function(n){return[2,this.oauthInstance.authApi.sudo(r)]})})},e.prototype.deleteMe=function(r){return fe(this,void 0,void 0,function(){return he(this,function(n){return[2,this.oauthInstance.authApi.deleteMe(r)]})})},e.prototype.getProviders=function(){return fe(this,void 0,void 0,function(){return he(this,function(r){return[2,this.oauthInstance.authApi.getProviders()]})})},e.prototype.loginScope=function(){return fe(this,void 0,void 0,function(){return he(this,function(r){return[2,this.oauthInstance.authApi.loginScope()]})})},e.prototype.loginGroups=function(){return fe(this,void 0,void 0,function(){return he(this,function(r){return[2,this.oauthInstance.authApi.loginGroups()]})})},e.prototype.onLoginStateChanged=function(r){var n;return fe(this,void 0,void 0,function(){var o,i=this;return he(this,function(s){switch(s.label){case 0:return(n=this.config.eventBus)===null||n===void 0||n.on(lt.LOGIN_STATE_CHANGED,function(u){return fe(i,void 0,void 0,function(){var l,a,c;return he(this,function(h){switch(h.label){case 0:return((c=u?.data)===null||c===void 0?void 0:c.eventType)===Gi.CREDENTIALS_ERROR?[3,2]:[4,this.getLoginState()];case 1:return a=h.sent(),[3,3];case 2:a={},h.label=3;case 3:return l=a,r.call(this,rt(rt({},u),l)),[2]}})})}),[4,this.getLoginState()];case 1:return o=s.sent(),r.call(this,o),[2]}})})},e.prototype.refreshTokenForce=function(r){return fe(this,void 0,void 0,function(){return he(this,function(n){return[2,this.oauthInstance.authApi.refreshTokenForce(r)]})})},e.prototype.getCredentials=function(){return fe(this,void 0,void 0,function(){return he(this,function(r){return[2,this.oauthInstance.authApi.getCredentials()]})})},e.prototype.setCredentials=function(r){return fe(this,void 0,void 0,function(){return he(this,function(n){switch(n.label){case 0:return[4,this.oauthInstance.oauth2client.setCredentials(r)];case 1:return n.sent(),[2]}})})},e.prototype.getProviderSubType=function(){return fe(this,void 0,void 0,function(){return he(this,function(r){return[2,this.oauthInstance.authApi.getProviderSubType()]})})},e.prototype.createCaptchaData=function(r){return fe(this,void 0,void 0,function(){return he(this,function(n){return[2,this.oauthInstance.authApi.createCaptchaData(r)]})})},e.prototype.verifyCaptchaData=function(r){return fe(this,void 0,void 0,function(){return he(this,function(n){return[2,this.oauthInstance.authApi.verifyCaptchaData(r)]})})},e.prototype.getMiniProgramQrCode=function(r){return fe(this,void 0,void 0,function(){return he(this,function(n){return[2,this.oauthInstance.authApi.getMiniProgramCode(r)]})})},e.prototype.getMiniProgramQrCodeStatus=function(r){return fe(this,void 0,void 0,function(){return he(this,function(n){return[2,this.oauthInstance.authApi.getMiniProgramQrCodeStatus(r)]})})},e.prototype.modifyPassword=function(r){return fe(this,void 0,void 0,function(){return he(this,function(n){return[2,this.oauthInstance.authApi.modifyPassword(r)]})})},e.prototype.modifyPasswordWithoutLogin=function(r){return fe(this,void 0,void 0,function(){return he(this,function(n){return[2,this.oauthInstance.authApi.modifyPasswordWithoutLogin(r)]})})},e.prototype.getUserBehaviorLog=function(r){return fe(this,void 0,void 0,function(){return he(this,function(n){return[2,this.oauthInstance.authApi.getUserBehaviorLog(r)]})})},e.prototype.signInWithUsername=function(r){var n=r.verificationInfo,o=n===void 0?{verification_id:"",is_user:!1}:n,i=r.verificationCode,s=i===void 0?"":i,u=r.username,l=u===void 0?"":u,a=r.bindInfo,c=a===void 0?void 0:a,h=r.loginType,w=h===void 0?"":h;return fe(this,void 0,void 0,function(){var E,T,A,O,C,P,q,U;return he(this,function(k){switch(k.label){case 0:return k.trys.push([0,8,,9]),[4,this.oauthInstance.authApi.verify({verification_id:o.verification_id,verification_code:s})];case 1:if(E=k.sent(),E?.error_code)throw E;return T=E.verification_token,A=/^\+\d{1,3}\s+/.test(l)?l:"+86 ".concat(l),O={phone_number:A},w==="email"&&(A=l,O={email:A}),o.is_user?[4,this.oauthInstance.authApi.signIn({username:A,verification_token:T})]:[3,5];case 2:if(C=k.sent(),C?.error_code)throw C;return c?[4,this.oauthInstance.authApi.bindWithProvider({provider_token:c?.providerToken})]:[3,4];case 3:if(P=k.sent(),P?.error_code)throw P;k.label=4;case 4:return[3,7];case 5:return[4,this.oauthInstance.authApi.signUp(rt(rt({},O),{verification_token:T,provider_token:c?.providerId}))];case 6:if(q=k.sent(),q?.error_code)throw q;k.label=7;case 7:return[2,this.createLoginState()];case 8:throw U=k.sent(),U;case 9:return[2]}})})},e.prototype.createLoginState=function(r,n){var o,i;return fe(this,void 0,void 0,function(){var s;return he(this,function(u){switch(u.label){case 0:return s=new wp({envId:this.config.env,cache:this.cache,oauthInstance:this.oauthInstance}),[4,s.checkLocalStateAsync()];case 1:return u.sent(),n?.userInfo?(s.user.setLocalUserInfo(n.userInfo),[3,5]):[3,2];case 2:return n?.asyncRefreshUser?(s.user.refresh(r),[3,5]):[3,3];case 3:return[4,s.user.refresh(r)];case 4:u.sent(),u.label=5;case 5:return(o=this.config.eventBus)===null||o===void 0||o.fire(lt.LOGIN_STATE_CHANGED,{eventType:Gi.SIGN_IN}),(i=this.config.eventBus)===null||i===void 0||i.fire(lt.AUTH_STATE_CHANGED,{event:Dt.SIGNED_IN}),[2,s]}})})},e.prototype.setAccessKey=function(){return fe(this,void 0,void 0,function(){return he(this,function(r){if(this.config.accessKey)try{this.oauthInstance.oauth2client.setAccessKeyCredentials({access_token:this.config.accessKey,token_type:"Bearer",scope:"accessKey",expires_at:new Date(+new Date+ +new Date),expires_in:+new Date+ +new Date})}catch(n){console.warn("accessKey error: ",n)}return[2]})})},ft([(0,tt.catchErrorsDecorator)({title:"\u7ED1\u5B9A\u624B\u673A\u53F7\u5931\u8D25",messages:["\u8BF7\u786E\u8BA4\u4EE5\u4E0B\u5404\u9879\uFF1A","  1 - \u8C03\u7528 auth().bindPhoneNumber() \u7684\u8BED\u6CD5\u6216\u53C2\u6570\u662F\u5426\u6B63\u786E","  2 - \u5F53\u524D\u73AF\u5883\u662F\u5426\u5F00\u901A\u4E86\u77ED\u4FE1\u9A8C\u8BC1\u7801\u767B\u5F55","\u5982\u679C\u95EE\u9898\u4F9D\u7136\u5B58\u5728\uFF0C\u5EFA\u8BAE\u5230\u5B98\u65B9\u95EE\u7B54\u793E\u533A\u63D0\u95EE\u6216\u5BFB\u627E\u5E2E\u52A9\uFF1A".concat($e.COMMUNITY_SITE_URL)]}),le("design:type",Function),le("design:paramtypes",[Object]),le("design:returntype",Promise)],e.prototype,"bindPhoneNumber",null),ft([(0,tt.catchErrorsDecorator)({title:"\u89E3\u9664\u4E09\u65B9\u7ED1\u5B9A\u5931\u8D25",messages:["\u8BF7\u786E\u8BA4\u4EE5\u4E0B\u5404\u9879\uFF1A","  1 - \u8C03\u7528 auth().unbindProvider() \u7684\u8BED\u6CD5\u6216\u53C2\u6570\u662F\u5426\u6B63\u786E","  2 - \u5F53\u524D\u8D26\u6237\u662F\u5426\u5DF2\u7ECF\u4E0E\u6B64\u767B\u5F55\u65B9\u5F0F\u89E3\u7ED1","\u5982\u679C\u95EE\u9898\u4F9D\u7136\u5B58\u5728\uFF0C\u5EFA\u8BAE\u5230\u5B98\u65B9\u95EE\u7B54\u793E\u533A\u63D0\u95EE\u6216\u5BFB\u627E\u5E2E\u52A9\uFF1A".concat($e.COMMUNITY_SITE_URL)]}),le("design:type",Function),le("design:paramtypes",[Object]),le("design:returntype",Promise)],e.prototype,"unbindProvider",null),ft([(0,tt.catchErrorsDecorator)({title:"\u7ED1\u5B9A\u90AE\u7BB1\u5730\u5740\u5931\u8D25",messages:["\u8BF7\u786E\u8BA4\u4EE5\u4E0B\u5404\u9879\uFF1A","  1 - \u8C03\u7528 auth().bindEmail() \u7684\u8BED\u6CD5\u6216\u53C2\u6570\u662F\u5426\u6B63\u786E","  2 - \u5F53\u524D\u73AF\u5883\u662F\u5426\u5F00\u901A\u4E86\u90AE\u7BB1\u5BC6\u7801\u767B\u5F55","\u5982\u679C\u95EE\u9898\u4F9D\u7136\u5B58\u5728\uFF0C\u5EFA\u8BAE\u5230\u5B98\u65B9\u95EE\u7B54\u793E\u533A\u63D0\u95EE\u6216\u5BFB\u627E\u5E2E\u52A9\uFF1A".concat($e.COMMUNITY_SITE_URL)]}),le("design:type",Function),le("design:paramtypes",[Object]),le("design:returntype",void 0)],e.prototype,"bindEmail",null),ft([(0,tt.catchErrorsDecorator)({title:"\u9A8C\u8BC1\u7801\u9A8C\u8BC1\u5931\u8D25",messages:["\u8BF7\u786E\u8BA4\u4EE5\u4E0B\u5404\u9879\uFF1A","  1 - \u8C03\u7528 auth().verify() \u7684\u8BED\u6CD5\u6216\u53C2\u6570\u662F\u5426\u6B63\u786E","  2 - \u5F53\u524D\u73AF\u5883\u662F\u5426\u5F00\u901A\u4E86\u624B\u673A\u9A8C\u8BC1\u7801/\u90AE\u7BB1\u767B\u5F55","\u5982\u679C\u95EE\u9898\u4F9D\u7136\u5B58\u5728\uFF0C\u5EFA\u8BAE\u5230\u5B98\u65B9\u95EE\u7B54\u793E\u533A\u63D0\u95EE\u6216\u5BFB\u627E\u5E2E\u52A9\uFF1A".concat($e.COMMUNITY_SITE_URL)]}),le("design:type",Function),le("design:paramtypes",[Object]),le("design:returntype",Promise)],e.prototype,"verify",null),ft([(0,tt.catchErrorsDecorator)({title:"\u83B7\u53D6\u9A8C\u8BC1\u7801\u5931\u8D25",messages:["\u8BF7\u786E\u8BA4\u4EE5\u4E0B\u5404\u9879\uFF1A","  1 - \u8C03\u7528 auth().getVerification() \u7684\u8BED\u6CD5\u6216\u53C2\u6570\u662F\u5426\u6B63\u786E","  2 - \u5F53\u524D\u73AF\u5883\u662F\u5426\u5F00\u901A\u4E86\u624B\u673A\u9A8C\u8BC1\u7801/\u90AE\u7BB1\u767B\u5F55","\u5982\u679C\u95EE\u9898\u4F9D\u7136\u5B58\u5728\uFF0C\u5EFA\u8BAE\u5230\u5B98\u65B9\u95EE\u7B54\u793E\u533A\u63D0\u95EE\u6216\u5BFB\u627E\u5E2E\u52A9\uFF1A".concat($e.COMMUNITY_SITE_URL)]}),le("design:type",Function),le("design:paramtypes",[Object,Object]),le("design:returntype",Promise)],e.prototype,"getVerification",null),ft([(0,tt.catchErrorsDecorator)({title:"\u83B7\u53D6\u7528\u6237\u4FE1\u606F\u5931\u8D25",messages:["\u8BF7\u786E\u8BA4\u4EE5\u4E0B\u5404\u9879\uFF1A","  1 - \u8C03\u7528 auth().getCurrentUser() \u7684\u8BED\u6CD5\u6216\u53C2\u6570\u662F\u5426\u6B63\u786E","\u5982\u679C\u95EE\u9898\u4F9D\u7136\u5B58\u5728\uFF0C\u5EFA\u8BAE\u5230\u5B98\u65B9\u95EE\u7B54\u793E\u533A\u63D0\u95EE\u6216\u5BFB\u627E\u5E2E\u52A9\uFF1A".concat($e.COMMUNITY_SITE_URL)]}),le("design:type",Function),le("design:paramtypes",[]),le("design:returntype",Promise)],e.prototype,"getCurrentUser",null),ft([(0,tt.catchErrorsDecorator)({title:"\u5C0F\u7A0B\u5E8F\u533F\u540D\u767B\u5F55\u5931\u8D25",messages:["\u8BF7\u786E\u8BA4\u4EE5\u4E0B\u5404\u9879\uFF1A","  1 - \u5F53\u524D\u73AF\u5883\u662F\u5426\u5F00\u542F\u4E86\u533F\u540D\u767B\u5F55","  2 - \u8C03\u7528 auth().signInAnonymouslyInWx() \u7684\u8BED\u6CD5\u6216\u53C2\u6570\u662F\u5426\u6B63\u786E","\u5982\u679C\u95EE\u9898\u4F9D\u7136\u5B58\u5728\uFF0C\u5EFA\u8BAE\u5230\u5B98\u65B9\u95EE\u7B54\u793E\u533A\u63D0\u95EE\u6216\u5BFB\u627E\u5E2E\u52A9\uFF1A".concat($e.COMMUNITY_SITE_URL)]}),le("design:type",Function),le("design:paramtypes",[Object]),le("design:returntype",Promise)],e.prototype,"signInAnonymouslyInWx",null),ft([(0,tt.catchErrorsDecorator)({title:"\u5C0F\u7A0B\u5E8F\u7ED1\u5B9AOpenID\u5931\u8D25",messages:["\u8BF7\u786E\u8BA4\u4EE5\u4E0B\u5404\u9879\uFF1A","  1 - \u5F53\u524D\u73AF\u5883\u662F\u5426\u5F00\u542F\u4E86\u5C0F\u7A0B\u5E8FopenId\u9759\u9ED8\u767B\u5F55","  2 - \u8C03\u7528 auth().bindOpenId() \u7684\u8BED\u6CD5\u6216\u53C2\u6570\u662F\u5426\u6B63\u786E","\u5982\u679C\u95EE\u9898\u4F9D\u7136\u5B58\u5728\uFF0C\u5EFA\u8BAE\u5230\u5B98\u65B9\u95EE\u7B54\u793E\u533A\u63D0\u95EE\u6216\u5BFB\u627E\u5E2E\u52A9\uFF1A".concat($e.COMMUNITY_SITE_URL)]}),le("design:type",Function),le("design:paramtypes",[]),le("design:returntype",Promise)],e.prototype,"bindOpenId",null),ft([(0,tt.catchErrorsDecorator)({title:"\u5C0F\u7A0B\u5E8FunionId\u9759\u9ED8\u767B\u5F55\u5931\u8D25",messages:["\u8BF7\u786E\u8BA4\u4EE5\u4E0B\u5404\u9879\uFF1A","  1 - \u5F53\u524D\u73AF\u5883\u662F\u5426\u5F00\u542F\u4E86\u5C0F\u7A0B\u5E8FunionId\u9759\u9ED8\u767B\u5F55","  2 - \u8C03\u7528 auth().signInWithUnionId() \u7684\u8BED\u6CD5\u6216\u53C2\u6570\u662F\u5426\u6B63\u786E","\u5982\u679C\u95EE\u9898\u4F9D\u7136\u5B58\u5728\uFF0C\u5EFA\u8BAE\u5230\u5B98\u65B9\u95EE\u7B54\u793E\u533A\u63D0\u95EE\u6216\u5BFB\u627E\u5E2E\u52A9\uFF1A".concat($e.COMMUNITY_SITE_URL)]}),le("design:type",Function),le("design:paramtypes",[]),le("design:returntype",Promise)],e.prototype,"signInWithUnionId",null),ft([(0,tt.catchErrorsDecorator)({title:"\u77ED\u4FE1\u9A8C\u8BC1\u7801\u767B\u9646",messages:["\u8BF7\u786E\u8BA4\u4EE5\u4E0B\u5404\u9879\uFF1A","  1 - \u5F53\u524D\u73AF\u5883\u662F\u5426\u5F00\u542F\u4E86\u5C0F\u7A0B\u5E8F\u77ED\u4FE1\u9A8C\u8BC1\u7801\u767B\u9646","  2 - \u8C03\u7528 auth().signInWithSms() \u7684\u8BED\u6CD5\u6216\u53C2\u6570\u662F\u5426\u6B63\u786E","\u5982\u679C\u95EE\u9898\u4F9D\u7136\u5B58\u5728\uFF0C\u5EFA\u8BAE\u5230\u5B98\u65B9\u95EE\u7B54\u793E\u533A\u63D0\u95EE\u6216\u5BFB\u627E\u5E2E\u52A9\uFF1A".concat($e.COMMUNITY_SITE_URL)]}),le("design:type",Function),le("design:paramtypes",[Object]),le("design:returntype",Promise)],e.prototype,"signInWithSms",null),ft([(0,tt.catchErrorsDecorator)({title:"\u90AE\u7BB1\u9A8C\u8BC1\u7801\u767B\u9646",messages:["\u8BF7\u786E\u8BA4\u4EE5\u4E0B\u5404\u9879\uFF1A","  1 - \u5F53\u524D\u73AF\u5883\u662F\u5426\u5F00\u542F\u4E86\u90AE\u7BB1\u767B\u9646","  2 - \u8C03\u7528 auth().signInWithEmail() \u7684\u8BED\u6CD5\u6216\u53C2\u6570\u662F\u5426\u6B63\u786E","\u5982\u679C\u95EE\u9898\u4F9D\u7136\u5B58\u5728\uFF0C\u5EFA\u8BAE\u5230\u5B98\u65B9\u95EE\u7B54\u793E\u533A\u63D0\u95EE\u6216\u5BFB\u627E\u5E2E\u52A9\uFF1A".concat($e.COMMUNITY_SITE_URL)]}),le("design:type",Function),le("design:paramtypes",[Object]),le("design:returntype",Promise)],e.prototype,"signInWithEmail",null),ft([(0,tt.catchErrorsDecorator)({title:"\u83B7\u53D6\u7528\u6237\u662F\u5426\u88AB\u5360\u7528\u5931\u8D25",messages:["\u8BF7\u786E\u8BA4\u4EE5\u4E0B\u5404\u9879\uFF1A","  1 - \u8C03\u7528 auth().isUsernameRegistered() \u7684\u8BED\u6CD5\u6216\u53C2\u6570\u662F\u5426\u6B63\u786E","\u5982\u679C\u95EE\u9898\u4F9D\u7136\u5B58\u5728\uFF0C\u5EFA\u8BAE\u5230\u5B98\u65B9\u95EE\u7B54\u793E\u533A\u63D0\u95EE\u6216\u5BFB\u627E\u5E2E\u52A9\uFF1A".concat($e.COMMUNITY_SITE_URL)]}),le("design:type",Function),le("design:paramtypes",[String]),le("design:returntype",Promise)],e.prototype,"isUsernameRegistered",null),ft([(0,tt.catchErrorsDecorator)({title:"\u83B7\u53D6\u672C\u5730\u767B\u5F55\u6001\u5931\u8D25",messages:["\u8BF7\u786E\u8BA4\u4EE5\u4E0B\u5404\u9879\uFF1A","  1 - \u8C03\u7528 auth().getLoginState() \u7684\u8BED\u6CD5\u6216\u53C2\u6570\u662F\u5426\u6B63\u786E","\u5982\u679C\u95EE\u9898\u4F9D\u7136\u5B58\u5728\uFF0C\u5EFA\u8BAE\u5230\u5B98\u65B9\u95EE\u7B54\u793E\u533A\u63D0\u95EE\u6216\u5BFB\u627E\u5E2E\u52A9\uFF1A".concat($e.COMMUNITY_SITE_URL)]}),le("design:type",Function),le("design:paramtypes",[]),le("design:returntype",Promise)],e.prototype,"getLoginState",null),ft([(0,tt.catchErrorsDecorator)({title:"\u83B7\u53D6\u7528\u6237\u4FE1\u606F\u5931\u8D25",messages:["\u8BF7\u786E\u8BA4\u4EE5\u4E0B\u5404\u9879\uFF1A","  1 - \u662F\u5426\u5DF2\u767B\u5F55","  2 - \u8C03\u7528 auth().getUserInfo() \u7684\u8BED\u6CD5\u6216\u53C2\u6570\u662F\u5426\u6B63\u786E","\u5982\u679C\u95EE\u9898\u4F9D\u7136\u5B58\u5728\uFF0C\u5EFA\u8BAE\u5230\u5B98\u65B9\u95EE\u7B54\u793E\u533A\u63D0\u95EE\u6216\u5BFB\u627E\u5E2E\u52A9\uFF1A".concat($e.COMMUNITY_SITE_URL)]}),le("design:type",Function),le("design:paramtypes",[]),le("design:returntype",Promise)],e.prototype,"getUserInfo",null),ft([(0,tt.catchErrorsDecorator)({title:"\u83B7\u53D6\u5FAE\u642D\u63D2\u4EF6\u7528\u6237\u4FE1\u606F\u5931\u8D25",messages:["\u8BF7\u786E\u8BA4\u4EE5\u4E0B\u5404\u9879\uFF1A","  1 - \u662F\u5426\u5DF2\u767B\u5F55","  2 - \u8C03\u7528 auth().getWedaUserInfo() \u7684\u8BED\u6CD5\u6216\u53C2\u6570\u662F\u5426\u6B63\u786E","\u5982\u679C\u95EE\u9898\u4F9D\u7136\u5B58\u5728\uFF0C\u5EFA\u8BAE\u5230\u5B98\u65B9\u95EE\u7B54\u793E\u533A\u63D0\u95EE\u6216\u5BFB\u627E\u5E2E\u52A9\uFF1A".concat($e.COMMUNITY_SITE_URL)]}),le("design:type",Function),le("design:paramtypes",[]),le("design:returntype",Promise)],e.prototype,"getWedaUserInfo",null),ft([(0,tt.catchErrorsDecorator)({title:"\u7ED1\u5B9A\u7B2C\u4E09\u65B9\u767B\u5F55\u65B9\u5F0F\u5931\u8D25",messages:["\u8BF7\u786E\u8BA4\u4EE5\u4E0B\u5404\u9879\uFF1A","  1 - \u8C03\u7528 auth().bindWithProvider() \u7684\u8BED\u6CD5\u6216\u53C2\u6570\u662F\u5426\u6B63\u786E","  2 - \u6B64\u8D26\u6237\u662F\u5426\u5DF2\u7ECF\u7ED1\u5B9A\u6B64\u7B2C\u4E09\u65B9","\u5982\u679C\u95EE\u9898\u4F9D\u7136\u5B58\u5728\uFF0C\u5EFA\u8BAE\u5230\u5B98\u65B9\u95EE\u7B54\u793E\u533A\u63D0\u95EE\u6216\u5BFB\u627E\u5E2E\u52A9\uFF1A".concat($e.COMMUNITY_SITE_URL)]}),le("design:type",Function),le("design:paramtypes",[Object]),le("design:returntype",Promise)],e.prototype,"bindWithProvider",null),ft([(0,tt.catchErrorsDecorator)({title:"\u83B7\u53D6\u8EAB\u4EFD\u6E90\u7C7B\u578B",messages:["\u8BF7\u786E\u8BA4\u4EE5\u4E0B\u5404\u9879\uFF1A","  1 - \u8C03\u7528 auth().getProviderSubType() \u7684\u8BED\u6CD5\u6216\u53C2\u6570\u662F\u5426\u6B63\u786E","\u5982\u679C\u95EE\u9898\u4F9D\u7136\u5B58\u5728\uFF0C\u5EFA\u8BAE\u5230\u5B98\u65B9\u95EE\u7B54\u793E\u533A\u63D0\u95EE\u6216\u5BFB\u627E\u5E2E\u52A9\uFF1A".concat($e.COMMUNITY_SITE_URL)]}),le("design:type",Function),le("design:paramtypes",[]),le("design:returntype",Promise)],e.prototype,"getProviderSubType",null),e})(Vb);Kb="auth",Yb={name:vF,namespace:Kb,entity:function(t){var e=function(n){var o;if(this.authInstance&&!n)return this.authInstance;n=n||{region:"",persistence:"local",apiPath:si};var i=this.platform.adapter,s=n.persistence||i.primaryStorage;s&&s!==this.config.persistence&&this.updateConfig({persistence:s});var u=_F(rt(rt({wxCloud:this.config.wxCloud,storage:this.config.storage},n),{persistence:this.config.persistence,i18n:this.config.i18n,accessKey:this.config.accessKey,useWxCloud:this.config.useWxCloud,sdkVersion:this.version,detectSessionInUrl:(o=this.config.auth)===null||o===void 0?void 0:o.detectSessionInUrl}),{env:this.config.env,clientId:this.config.clientId,apiOrigin:this.request.getBaseEndPoint(this.config.endPointMode||"CLOUD_API"),platform:this.platform,cache:this.cache,app:this,debug:this.config.debug}),l=u.authInstance,a=u.oauthInstance;return this.oauthInstance=a,this.authInstance=l,this.authInstance},r=e.call(this,t);return Object.assign(e,r),Object.setPrototypeOf(e,Object.getPrototypeOf(r)),this[Kb]=e,e}};try{cloudbase.registerComponent(Yb)}catch{}});function Ep(t,e){return Zb(this,void 0,void 0,function(){var r,n,o,i,s,u,l,a,c,h,w,E,T;return eE(this,function(A){switch(A.label){case 0:return r=t.name,n=t.data,o=t.path,i=o===void 0?"":o,s=t.method,u=t.header,l=u===void 0?{}:u,a=this.getEndPointWithKey("GATEWAY"),c=a.BASE_URL,h=a.PROTOCOL,w="".concat(h).concat(c,"/cloudrun/").concat(r),E=i.startsWith("/")?i:"/".concat(i),[4,this.request.fetch({method:s||"POST",headers:Object.assign({},{"Content-Type":"application/json; charset=utf-8"},l),body:n,url:"".concat(w).concat(E),customReqOpts:e})];case 1:return T=A.sent(),e?.from==="node-sdk"?[2,T]:[4,T.data];case 2:return[2,A.sent()]}})})}function Sp(t){try{t.registerComponent(tE)}catch(e){console.warn(e)}}var Fc,Zb,eE,Xb,bp,wF,bF,tE,Ip=X(()=>{Lt();Fc=function(){return Fc=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Fc.apply(this,arguments)},Zb=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},eE=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Xb=Ge.ERRORS,bp="cloudrun",wF=(function(){function t(){}return t.prototype.callContainer=function(e,r){return Zb(this,void 0,void 0,function(){var n,o,i;return eE(this,function(s){switch(s.label){case 0:if(n=e.name,o=e.data,!n)throw new Error(JSON.stringify({code:Xb.INVALID_PARAMS,msg:"[".concat(bp,".callContainer] invalid name")}));try{i=o?JSON.stringify(o):""}catch{throw new Error(JSON.stringify({code:Xb.INVALID_PARAMS,msg:"[".concat(bp,".callContainer] invalid data")}))}return[4,Ep.call(this,Fc(Fc({},e),{data:i}),r)];case 1:return[2,s.sent()]}})})},t})();bF=new wF,tE={name:bp,entity:{callContainer:bF.callContainer}};try{cloudbase.registerComponent(tE)}catch{}try{window.registerCloudrun=Sp}catch{}});function nE(t){try{t.registerComponent(rE)}catch(e){console.warn(e)}}var Xi,EF,Tp,SF,IF,TF,Op,OF,Ss,AF,jc,RF,CF,rE,iE=X(()=>{Lt();Ip();Xi=function(){return Xi=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Xi.apply(this,arguments)},EF=function(t,e,r,n){var o=arguments.length,i=o<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(s=t[u])&&(i=(o<3?s(i):o>3?s(e,r,i):s(e,r))||i);return o>3&&i&&Object.defineProperty(e,r,i),i},Tp=function(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)},SF=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},IF=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},TF=Ge.getSdkName,Op=Ge.ERRORS,OF=Ge.COMMUNITY_SITE_URL,Ss=it.execCallback,AF=hn.catchErrorsDecorator,jc="functions",RF=(function(){function t(){}return t.prototype.callFunction=function(e,r,n){var o,i,s;return SF(this,void 0,void 0,function(){var u,l,a,c,h,w,E,T,A,O,C,P,q,ie,U,k,W,V,Y,Z,ae,ie,ue;return IF(this,function(be){switch(be.label){case 0:if(u=e.name,l=e.data,a=e.query,c=e.parse,h=e.search,w=e.type,E=e.path,T=E===void 0?"":E,A=e.method,O=e.header,C=O===void 0?{}:O,!u)throw new Error(JSON.stringify({code:Op.INVALID_PARAMS,msg:"[".concat(jc,".callFunction] invalid function name")}));try{P=l?JSON.stringify(l):""}catch{throw new Error(JSON.stringify({code:Op.INVALID_PARAMS,msg:"[".concat(jc,".callFunction] invalid data")}))}return w!=="cloudrun"?[3,2]:(q=it.generateRequestId(),[4,Ep.call(this,{name:u,data:P,path:T,method:A,header:Xi(Xi({},C),{"X-Request-Id":q})})]);case 1:return ie=be.sent(),[2,{result:ie,requestId:q}];case 2:U=this,k=U.request,W=U.config,V="functions.invokeFunction",Y={inQuery:a,parse:c,search:h,function_name:u,request_data:P},Z={},be.label=3;case 3:return be.trys.push([3,8,,9]),W.endPointMode!=="GATEWAY"?[3,5]:[4,k.gateWay(Xi(Xi({},e),{path:"functions"}),n)];case 4:return ae=be.sent(),Z=Xi({requestId:ae.requestId},!((o=ae.data)===null||o===void 0)&&o.code?ae.data:{data:{response_data:ae.data}}),[3,7];case 5:return[4,k.send(V,Y,{defaultQuery:!((i=l?.params)===null||i===void 0)&&i.action?{action:(s=l?.params)===null||s===void 0?void 0:s.action}:{}},n)];case 6:Z=be.sent(),be.label=7;case 7:if(Z.code)return[2,Ss(r,null,Z)];if(ie=Z.data.response_data,c||W.endPointMode==="GATEWAY")return[2,Ss(r,null,{result:ie,requestId:Z.requestId})];try{return ie=JSON.parse(Z.data.response_data),[2,Ss(r,null,{result:ie,requestId:Z.requestId})]}catch{Ss(r,new Error("[".concat(TF(),"][").concat(Op.INVALID_PARAMS,"][").concat(jc,".callFunction] response data must be json")))}return[3,9];case 8:return ue=be.sent(),Ss(r,ue),[3,9];case 9:return[2]}})})},EF([AF({customInfo:{className:"Cloudbase",methodName:"callFunction"},title:"\u51FD\u6570\u8C03\u7528\u5931\u8D25",messages:["\u8BF7\u786E\u8BA4\u4EE5\u4E0B\u5404\u9879\uFF1A","  1 - \u8C03\u7528 callFunction() \u7684\u8BED\u6CD5\u6216\u53C2\u6570\u662F\u5426\u6B63\u786E","  2 - \u5F53\u524D\u73AF\u5883\u4E0B\u662F\u5426\u5B58\u5728\u6B64\u51FD\u6570","  3 - \u51FD\u6570\u5B89\u5168\u89C4\u5219\u662F\u5426\u9650\u5236\u4E86\u5F53\u524D\u767B\u5F55\u72B6\u6001\u8BBF\u95EE","\u5982\u679C\u95EE\u9898\u4F9D\u7136\u5B58\u5728\uFF0C\u5EFA\u8BAE\u5230\u5B98\u65B9\u95EE\u7B54\u793E\u533A\u63D0\u95EE\u6216\u5BFB\u627E\u5E2E\u52A9\uFF1A".concat(OF)]}),Tp("design:type",Function),Tp("design:paramtypes",[Object,Function,Object]),Tp("design:returntype",Promise)],t.prototype,"callFunction",null),t})(),CF=new RF,rE={name:jc,entity:{callFunction:CF.callFunction}};try{cloudbase.registerComponent(rE)}catch{}});var vt,Vo,St,Br,qr,Qr,PF,Dr,zo,Ap,Is,xF,Ur,Ko,Rt,Mc,kc,Rp=X(()=>{Lt();vt=function(){return vt=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},vt.apply(this,arguments)},Vo=function(t,e,r,n){var o=arguments.length,i=o<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(s=t[u])&&(i=(o<3?s(i):o>3?s(e,r,i):s(e,r))||i);return o>3&&i&&Object.defineProperty(e,r,i),i},St=function(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)},Br=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},qr=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};(function(t){t.put="put",t.post="post"})(Qr||(Qr={}));PF=Ge.getSdkName,Dr=Ge.ERRORS,zo=Ge.COMMUNITY_SITE_URL,Ap=it.isArray,Is=it.isString,xF=it.isPalinObject,Ur=it.execCallback,Ko=hn.catchErrorsDecorator,Rt="storage",Mc={getUploadInfo:function(t,e,r){return Br(void 0,void 0,void 0,function(){var n,o,i;return qr(this,function(s){switch(s.label){case 0:return[4,t.gateWay({path:"storages",name:"get-objects-upload-info",data:[vt({objectId:e.path},e.headers?{signedHeader:e.headers}:{})]},r)];case 1:return n=s.sent(),o=((i=n.data)===null||i===void 0?void 0:i[0])||{},n=vt(vt({},n),{data:vt(vt({},o.code?vt({},o):{}),{authorization:o.authorization,token:o.token,url:o.uploadUrl,fileId:o.cloudObjectId,cosFileId:o.cloudObjectMeta,download_url:o.downloadUrl})}),[2,n]}})})},getDownLoadInfo:function(t,e,r){return Br(void 0,void 0,void 0,function(){var n,o;return qr(this,function(i){switch(i.label){case 0:return[4,t.gateWay({path:"storages",name:"get-objects-download-info",data:e.convertedFileList.map(function(s){return{cloudObjectId:s.fileid}})},r)];case 1:return n=i.sent(),n=vt(vt({},n),{data:{download_list:(o=n.data)===null||o===void 0?void 0:o.map(function(s){return{code:s.code||"SUCCESS",message:s.message,fileid:s.cloudObjectId,download_url:s.downloadUrl,fileID:s.cloudObjectId,tempFileURL:s.downloadUrl}})}}),[2,n]}})})},delete:function(t,e,r){return Br(void 0,void 0,void 0,function(){var n,o;return qr(this,function(i){switch(i.label){case 0:return[4,t.gateWay({path:"storages",name:"delete-objects",data:e.fileList.map(function(s){return{cloudObjectId:s}})},r)];case 1:return n=i.sent(),n=vt(vt({},n),{data:{delete_list:(o=n.data)===null||o===void 0?void 0:o.map(function(s){return{code:s.code||"SUCCESS",fileID:s.cloudObjectId,message:s.message}})}}),[2,n]}})})},copyFile:function(t,e,r){return Br(void 0,void 0,void 0,function(){var n,o;return qr(this,function(i){switch(i.label){case 0:return[4,t.gateWay({path:"storages",name:"copy-objects",data:e.convertedFileList.map(function(s){return{srcPath:s.src_path,dstPath:s.dst_path,overwrite:s.overwrite,removeOriginal:s.remove_original}})},r)];case 1:return n=i.sent(),n=vt(vt({},n),{data:{copy_list:(o=n.data)===null||o===void 0?void 0:o.map(function(s){return{code:s.code||"SUCCESS",fileID:s.cloudObjectId,message:s.message}})}}),[2,n]}})})}},kc=(function(){function t(){}return t.prototype.isGateWay=function(){var e=this.config,r=e.endPointMode||"CLOUD_API";return r==="GATEWAY"},t.prototype.uploadFile=function(e,r){return Br(this,void 0,void 0,function(){var n,o,i,s,u,l,a,c,h,w,E,T,A,O,C,P,q,U,k,W,V,Y,Z,ae;return qr(this,function(ie){switch(ie.label){case 0:if(n=e.cloudPath,o=e.filePath,i=e.onUploadProgress,s=(Y=e.method,Y===void 0?"put":Y),u=(Z=e.headers,Z===void 0?{}:Z),l=e.fileContent,!Is(n)||!o&&!l)throw new Error(JSON.stringify({code:Dr.INVALID_PARAMS,msg:"[".concat(Rt,".uploadFile] invalid params")}));return a={put:Qr.put,post:Qr.post}[s.toLocaleLowerCase()]||Qr.put,[4,this.getUploadMetadata({cloudPath:n,method:a,headers:a===Qr.put?u:void 0,customReqOpts:e.customReqOpts})];case 1:return c=ie.sent(),h=c.data,w=c.requestId,E=h.url,T=h.authorization,A=h.token,O=h.fileId,C=h.cosFileId,P=h.download_url,q={url:E,file:o,name:n,onUploadProgress:i,fileContent:l,fileId:O,requestId:w},U=vt(vt({},q),{method:Qr.put,headers:vt(vt({},u),{authorization:T,"x-cos-meta-fileid":C,"x-cos-security-token":A})}),k=vt(vt({},q),{method:Qr.post,data:{key:n,signature:T,"x-cos-meta-fileid":C,success_action_status:"201","x-cos-security-token":A}}),W=(ae={},ae[Qr.put]={params:U,isSuccess:function(ue){return ue>=200&&ue<300}},ae[Qr.post]={params:k,isSuccess:function(ue){return ue===201}},ae),[4,this.request.upload(W[a].params)];case 2:return V=ie.sent(),W[a].isSuccess(V.statusCode)?[2,Ur(r,null,{fileID:O,download_url:P,requestId:w})]:[2,Ur(r,new Error("[".concat(PF(),"][").concat(Dr.OPERATION_FAIL,"][").concat(Rt,"]:").concat(V.data)))]}})})},t.prototype.getUploadMetadata=function(e,r){return Br(this,void 0,void 0,function(){var n,o,i,s,u,l,a,c;return qr(this,function(h){switch(h.label){case 0:if(n=e.cloudPath,o=e.method,i=e.headers,!Is(n))throw new Error(JSON.stringify({code:Dr.INVALID_PARAMS,msg:"[".concat(Rt,".getUploadMetadata] invalid cloudPath")}));s=this.request,u="storage.getUploadMetadata",h.label=1;case 1:return h.trys.push([1,6,,7]),l=void 0,a={path:n},o&&(a.method=o),o===Qr.put&&i&&(a.headers=i),this.isGateWay()?[4,Mc.getUploadInfo(s,a,e.customReqOpts)]:[3,3];case 2:return l=h.sent(),[3,5];case 3:return[4,s.send(u,a,e.customReqOpts)];case 4:l=h.sent(),h.label=5;case 5:return[2,Ur(r,null,l)];case 6:return c=h.sent(),[2,Ur(r,c)];case 7:return[2]}})})},t.prototype.deleteFile=function(e,r){return Br(this,void 0,void 0,function(){var n,o,i,s,u,l,a,c;return qr(this,function(h){switch(h.label){case 0:if(n=e.fileList,!n||!Ap(n)||n.length===0)throw new Error(JSON.stringify({code:Dr.INVALID_PARAMS,msg:"[".concat(Rt,".deleteFile] fileList must not be empty")}));for(o=0,i=n;o<i.length;o++)if(s=i[o],!s||!Is(s))throw new Error(JSON.stringify({code:Dr.INVALID_PARAMS,msg:"[".concat(Rt,".deleteFile] fileID must be string")}));return u="storage.batchDeleteFile",l=this.request,a={},this.isGateWay()?[4,Mc.delete(l,{fileList:n},e.customReqOpts)]:[3,2];case 1:return a=h.sent(),[3,4];case 2:return[4,l.send(u,{fileid_list:n},e.customReqOpts)];case 3:a=h.sent(),h.label=4;case 4:return a.code?[2,Ur(r,null,a)]:(c={fileList:a.data.delete_list,requestId:a.requestId},[2,Ur(r,null,c)])}})})},t.prototype.getTempFileURL=function(e,r){return Br(this,void 0,void 0,function(){var n,o,i,s,u,l,a,c;return qr(this,function(h){switch(h.label){case 0:if(n=e.fileList,!n||!Ap(n)||n.length===0)throw new Error(JSON.stringify({code:Dr.INVALID_PARAMS,msg:"[".concat(Rt,".getTempFileURL] fileList must not be empty")}));for(o=[],i=0,s=n;i<s.length;i++)if(u=s[i],xF(u)){if(!Object.prototype.hasOwnProperty.call(u,"fileID"))throw new Error(JSON.stringify({code:Dr.INVALID_PARAMS,msg:"[".concat(Rt,".getTempFileURL] file info must include fileID")}));o.push({fileid:u.fileID,max_age:u.maxAge||7200})}else if(Is(u))o.push({fileid:u});else throw new Error(JSON.stringify({code:Dr.INVALID_PARAMS,msg:"[".concat(Rt,".getTempFileURL] invalid fileList")}));return l="storage.batchGetDownloadUrl",a=this.request,c={},this.isGateWay()?[4,Mc.getDownLoadInfo(a,{convertedFileList:o},e.customReqOpts)]:[3,2];case 1:return c=h.sent(),[3,4];case 2:return[4,a.send(l,{file_list:o},e.customReqOpts)];case 3:c=h.sent(),h.label=4;case 4:return c.code?[2,Ur(r,null,c)]:[2,Ur(r,null,{fileList:c.data.download_list,requestId:c.requestId})]}})})},t.prototype.downloadFile=function(e,r){return Br(this,void 0,void 0,function(){var n,o,i,s,u,l;return qr(this,function(a){switch(a.label){case 0:if(n=e.fileID,!Is(n))throw new Error(JSON.stringify({code:Dr.INVALID_PARAMS,msg:"[".concat(Rt,".getTempFileURL] fileID must be string")}));return[4,this.getTempFileURL.call(this,{fileList:[{fileID:n,maxAge:600}],customReqOpts:e.customReqOpts})];case 1:return o=a.sent(),i=o.fileList[0],i.code!=="SUCCESS"?[2,Ur(r,i)]:(s=this.request,u=encodeURI(i.download_url),[4,s.download({url:u,tempFilePath:e.tempFilePath})]);case 2:return l=a.sent(),[2,Ur(r,null,l)]}})})},t.prototype.copyFile=function(e,r){return Br(this,void 0,void 0,function(){var n,o,i,s,u,l,a,c,h,w;return qr(this,function(E){switch(E.label){case 0:if(n=e.fileList,!n||!Ap(n)||n.length===0)throw new Error(JSON.stringify({code:Dr.INVALID_PARAMS,msg:"[".concat(Rt,".copyFile] fileList must not be empty")}));for(o=[],i=0,s=n;i<s.length;i++){if(u=s[i],l=u.srcPath,a=u.dstPath,!l||!a||typeof l!="string"||typeof a!="string")throw new Error(JSON.stringify({code:Dr.INVALID_PARAMS,msg:"[".concat(Rt,".copyFile] srcPath and dstPath may not be empty")}));if(l===a)throw new Error(JSON.stringify({code:Dr.INVALID_PARAMS,msg:"[".concat(Rt,".copyFile] srcPath and dstPath can not be the same")}));o.push({src_path:l,dst_path:a,overwrite:u.overwrite,remove_original:u.removeOriginal})}return c=this.request,h={},this.isGateWay()?[4,Mc.copyFile(c,{convertedFileList:o},e.customReqOpts)]:[3,2];case 1:return h=E.sent(),[3,4];case 2:return w="storage.batchCopyFile",[4,c.send(w,{file_list:o},e.customReqOpts)];case 3:h=E.sent(),E.label=4;case 4:return h.code?[2,Ur(r,null,h)]:[2,Ur(r,null,{fileList:h.data.copy_list,requestId:h.requestId})]}})})},t.prototype.getFileInfo=function(e){var r;return Br(this,void 0,void 0,function(){var n,o,i=this;return qr(this,function(s){switch(s.label){case 0:return[4,this.getTempFileURL(e)];case 1:return n=s.sent(),n?.fileList&&((r=n?.fileList)===null||r===void 0?void 0:r.length)>0?[4,Promise.all(n.fileList.map(function(u){return Br(i,void 0,void 0,function(){var l,a,c,h,w,E,T;return qr(this,function(A){switch(A.label){case 0:if(u.code!=="SUCCESS")return[2,{code:u.code,fileID:u.fileID,tempFileURL:u.tempFileURL,message:u.message}];A.label=1;case 1:return A.trys.push([1,3,,4]),l=this.request,[4,l.fetch({url:u.tempFileURL,method:"HEAD"})];case 2:return a=A.sent(),c=a.header,Headers&&c instanceof Headers&&(c=Object.fromEntries(a.header.entries())),h=parseInt(c["content-length"])||0,w=c["content-type"]||"",[400,404].includes(Number(a.statusCode))?[2,{code:"FILE_NOT_FOUND",fileID:u.fileID,tempFileURL:u.tempFileURL,message:"file not found"}]:(E={code:u.code,fileID:u.fileID,tempFileURL:u.tempFileURL,cloudId:u.fileID,fileName:u.fileID.split("/").pop(),contentType:w,mime:w.split(";")[0].trim(),size:h,etag:c.etag||"",lastModified:c["last-modified"]||"",cacheControl:c["cache-control"]||""},[2,E]);case 3:return T=A.sent(),[2,{code:"FETCH_FILE_INFO_ERROR",fileID:u.fileID,tempFileURL:u.tempFileURL,message:T.message}];case 4:return[2]}})})}))]:[3,3];case 2:return o=s.sent(),[2,{fileList:o,requestId:n.requestId}];case 3:return[2,{fileList:[],requestId:n.requestId}]}})})},Vo([Ko({customInfo:{className:"Cloudbase",methodName:"uploadFile"},title:"\u4E0A\u4F20\u6587\u4EF6\u5931\u8D25",messages:["\u8BF7\u786E\u8BA4\u4EE5\u4E0B\u5404\u9879\uFF1A","  1 - \u8C03\u7528 uploadFile() \u7684\u8BED\u6CD5\u6216\u53C2\u6570\u662F\u5426\u6B63\u786E","  2 - \u5F53\u524D\u57DF\u540D\u662F\u5426\u5728\u5B89\u5168\u57DF\u540D\u5217\u8868\u4E2D\uFF1Ahttps://console.cloud.tencent.com/tcb/env/safety","  3 - \u4E91\u5B58\u50A8\u5B89\u5168\u89C4\u5219\u662F\u5426\u9650\u5236\u4E86\u5F53\u524D\u767B\u5F55\u72B6\u6001\u8BBF\u95EE","\u5982\u679C\u95EE\u9898\u4F9D\u7136\u5B58\u5728\uFF0C\u5EFA\u8BAE\u5230\u5B98\u65B9\u95EE\u7B54\u793E\u533A\u63D0\u95EE\u6216\u5BFB\u627E\u5E2E\u52A9\uFF1A".concat(zo)]}),St("design:type",Function),St("design:paramtypes",[Object,Function]),St("design:returntype",Promise)],t.prototype,"uploadFile",null),Vo([Ko({customInfo:{className:"Cloudbase",methodName:"getUploadMetadata"},title:"\u83B7\u53D6\u4E0A\u4F20\u5143\u4FE1\u606F\u5931\u8D25",messages:["\u8BF7\u786E\u8BA4\u4EE5\u4E0B\u5404\u9879\uFF1A","  1 - \u8C03\u7528 getUploadMetadata() \u7684\u8BED\u6CD5\u6216\u53C2\u6570\u662F\u5426\u6B63\u786E","  2 - \u5F53\u524D\u57DF\u540D\u662F\u5426\u5728\u5B89\u5168\u57DF\u540D\u5217\u8868\u4E2D\uFF1Ahttps://console.cloud.tencent.com/tcb/env/safety","  3 - \u4E91\u5B58\u50A8\u5B89\u5168\u89C4\u5219\u662F\u5426\u9650\u5236\u4E86\u5F53\u524D\u767B\u5F55\u72B6\u6001\u8BBF\u95EE","\u5982\u679C\u95EE\u9898\u4F9D\u7136\u5B58\u5728\uFF0C\u5EFA\u8BAE\u5230\u5B98\u65B9\u95EE\u7B54\u793E\u533A\u63D0\u95EE\u6216\u5BFB\u627E\u5E2E\u52A9\uFF1A".concat(zo)]}),St("design:type",Function),St("design:paramtypes",[Object,Function]),St("design:returntype",Promise)],t.prototype,"getUploadMetadata",null),Vo([Ko({customInfo:{className:"Cloudbase",methodName:"deleteFile"},title:"\u5220\u9664\u6587\u4EF6\u5931\u8D25",messages:["\u8BF7\u786E\u8BA4\u4EE5\u4E0B\u5404\u9879\uFF1A","  1 - \u8C03\u7528 deleteFile() \u7684\u8BED\u6CD5\u6216\u53C2\u6570\u662F\u5426\u6B63\u786E","  2 - \u5F53\u524D\u57DF\u540D\u662F\u5426\u5728\u5B89\u5168\u57DF\u540D\u5217\u8868\u4E2D\uFF1Ahttps://console.cloud.tencent.com/tcb/env/safety","  3 - \u4E91\u5B58\u50A8\u5B89\u5168\u89C4\u5219\u662F\u5426\u9650\u5236\u4E86\u5F53\u524D\u767B\u5F55\u72B6\u6001\u8BBF\u95EE","\u5982\u679C\u95EE\u9898\u4F9D\u7136\u5B58\u5728\uFF0C\u5EFA\u8BAE\u5230\u5B98\u65B9\u95EE\u7B54\u793E\u533A\u63D0\u95EE\u6216\u5BFB\u627E\u5E2E\u52A9\uFF1A".concat(zo)]}),St("design:type",Function),St("design:paramtypes",[Object,Function]),St("design:returntype",Promise)],t.prototype,"deleteFile",null),Vo([Ko({customInfo:{className:"Cloudbase",methodName:"getTempFileURL"},title:"\u83B7\u53D6\u6587\u4EF6\u4E0B\u8F7D\u94FE\u63A5",messages:["\u8BF7\u786E\u8BA4\u4EE5\u4E0B\u5404\u9879\uFF1A","  1 - \u8C03\u7528 getTempFileURL() \u7684\u8BED\u6CD5\u6216\u53C2\u6570\u662F\u5426\u6B63\u786E","  2 - \u5F53\u524D\u57DF\u540D\u662F\u5426\u5728\u5B89\u5168\u57DF\u540D\u5217\u8868\u4E2D\uFF1Ahttps://console.cloud.tencent.com/tcb/env/safety","  3 - \u4E91\u5B58\u50A8\u5B89\u5168\u89C4\u5219\u662F\u5426\u9650\u5236\u4E86\u5F53\u524D\u767B\u5F55\u72B6\u6001\u8BBF\u95EE","\u5982\u679C\u95EE\u9898\u4F9D\u7136\u5B58\u5728\uFF0C\u5EFA\u8BAE\u5230\u5B98\u65B9\u95EE\u7B54\u793E\u533A\u63D0\u95EE\u6216\u5BFB\u627E\u5E2E\u52A9\uFF1A".concat(zo)]}),St("design:type",Function),St("design:paramtypes",[Object,Function]),St("design:returntype",Promise)],t.prototype,"getTempFileURL",null),Vo([Ko({customInfo:{className:"Cloudbase",methodName:"downloadFile"},title:"\u4E0B\u8F7D\u6587\u4EF6\u5931\u8D25",messages:["\u8BF7\u786E\u8BA4\u4EE5\u4E0B\u5404\u9879\uFF1A","  1 - \u8C03\u7528 downloadFile() \u7684\u8BED\u6CD5\u6216\u53C2\u6570\u662F\u5426\u6B63\u786E","  2 - \u5F53\u524D\u57DF\u540D\u662F\u5426\u5728\u5B89\u5168\u57DF\u540D\u5217\u8868\u4E2D\uFF1Ahttps://console.cloud.tencent.com/tcb/env/safety","  3 - \u4E91\u5B58\u50A8\u5B89\u5168\u89C4\u5219\u662F\u5426\u9650\u5236\u4E86\u5F53\u524D\u767B\u5F55\u72B6\u6001\u8BBF\u95EE","\u5982\u679C\u95EE\u9898\u4F9D\u7136\u5B58\u5728\uFF0C\u5EFA\u8BAE\u5230\u5B98\u65B9\u95EE\u7B54\u793E\u533A\u63D0\u95EE\u6216\u5BFB\u627E\u5E2E\u52A9\uFF1A".concat(zo)]}),St("design:type",Function),St("design:paramtypes",[Object,Function]),St("design:returntype",Promise)],t.prototype,"downloadFile",null),Vo([Ko({customInfo:{className:"Cloudbase",methodName:"copyFile"},title:"\u6279\u91CF\u590D\u5236\u6587\u4EF6",messages:["\u8BF7\u786E\u8BA4\u4EE5\u4E0B\u5404\u9879\uFF1A","  1 - \u8C03\u7528 copyFile() \u7684\u8BED\u6CD5\u6216\u53C2\u6570\u662F\u5426\u6B63\u786E","  2 - \u5F53\u524D\u57DF\u540D\u662F\u5426\u5728\u5B89\u5168\u57DF\u540D\u5217\u8868\u4E2D\uFF1Ahttps://console.cloud.tencent.com/tcb/env/safety","  3 - \u4E91\u5B58\u50A8\u5B89\u5168\u89C4\u5219\u662F\u5426\u9650\u5236\u4E86\u5F53\u524D\u767B\u5F55\u72B6\u6001\u8BBF\u95EE","\u5982\u679C\u95EE\u9898\u4F9D\u7136\u5B58\u5728\uFF0C\u5EFA\u8BAE\u5230\u5B98\u65B9\u95EE\u7B54\u793E\u533A\u63D0\u95EE\u6216\u5BFB\u627E\u5E2E\u52A9\uFF1A".concat(zo)]}),St("design:type",Function),St("design:paramtypes",[Object,Function]),St("design:returntype",Promise)],t.prototype,"copyFile",null),t})()});function di(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var Cp,qt,GG,VG,oE=X(()=>{Cp=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),qt=(function(t){Cp(e,t);function e(r){var n=t.call(this,r)||this;return n.__isStorageError=!0,n.name="StorageError",n}return e})(Error);GG=(function(t){Cp(e,t);function e(r,n,o){var i=t.call(this,r)||this;return i.name="StorageApiError",i.status=n,i.statusCode=o,i}return e.prototype.toJSON=function(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}},e})(qt),VG=(function(t){Cp(e,t);function e(r,n){var o=t.call(this,r)||this;return o.name="StorageUnknownError",o.originalError=n,o}return e})(qt)});var NF,Ts,Kt,Yt,LF,aE,sE=X(()=>{Lt();Rp();oE();NF=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),Ts=function(){return Ts=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Ts.apply(this,arguments)},Kt=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},Yt=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},LF=Ge.ERRORS,aE=(function(t){NF(e,t);function e(r){var n=t.call(this)||this;return n.shouldThrowOnError=!1,n.bucketId="",n.context=r,n}return Object.defineProperty(e.prototype,"config",{get:function(){var r;return(r=this.context)===null||r===void 0?void 0:r.config},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"request",{get:function(){var r;return(r=this.context)===null||r===void 0?void 0:r.request},enumerable:!1,configurable:!0}),e.prototype.throwOnError=function(){return this.shouldThrowOnError=!0,this},e.prototype.from=function(r){return this.bucketId=r||"",this},e.prototype.upload=function(r,n,o){return Kt(this,void 0,void 0,function(){var i,s,u,l,a,c,h,w,E;return Yt(this,function(T){switch(T.label){case 0:i=Ts({upsert:!0},o),s=i.cacheControl,u=i.contentType,l=i.metadata,T.label=1;case 1:return T.trys.push([1,3,,4]),a=this._getCloudPath(r),c={cloudPath:a,filePath:n},(s||u||l)&&(h={},s&&(h["cache-control"]=s),u&&(h["content-type"]=u),l&&(h["x-cos-metadata-metadata"]=this.toBase64(JSON.stringify(l))),c.headers=h),[4,this.uploadFile(c)];case 2:if(w=T.sent(),!w.fileID)throw new Error(JSON.stringify({code:LF.OPERATION_FAIL,msg:"[".concat(Rt,".update] no fileID returned")}));return[2,{data:{id:w.fileID,path:r,fullPath:r},error:null}];case 3:if(E=T.sent(),this.shouldThrowOnError)throw E;if(di(E))return[2,{data:null,error:E}];throw E;case 4:return[2]}})})},e.prototype.uploadToSignedUrl=function(r,n,o,i){return Kt(this,void 0,void 0,function(){return Yt(this,function(s){return[2,this.upload(r,o,i)]})})},e.prototype.createSignedUploadUrl=function(r){return Kt(this,void 0,void 0,function(){var n,o,i;return Yt(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),n=this._getCloudPath(r),[4,this.getUploadMetadata({cloudPath:n})];case 1:return o=s.sent().data,[2,{data:{signedUrl:o.url,token:o.token,path:r,authorization:o.authorization,id:o.fileId,cosFileId:o.cosFileId,downloadUrl:o.download_url},error:null}];case 2:if(i=s.sent(),this.shouldThrowOnError)throw i;return[2,{data:null,error:i instanceof qt?i:new qt(i.message)}];case 3:return[2]}})})},e.prototype.update=function(r,n,o){return Kt(this,void 0,void 0,function(){return Yt(this,function(i){return[2,this.upload(r,n,Ts(Ts({},o),{upsert:!0}))]})})},e.prototype.move=function(r,n){return Kt(this,void 0,void 0,function(){var o,i;return Yt(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,this.copyFile({fileList:[{srcPath:this._getCloudPath(r),dstPath:this._getCloudPath(n),overwrite:!0,removeOriginal:!0}]})];case 1:if(o=s.sent(),o.fileList[0].code&&o.fileList[0].code!=="SUCCESS")throw new qt(o.fileList[0].message||"Move failed");return[2,{data:{message:"File moved from ".concat(r," to ").concat(n)},error:null}];case 2:if(i=s.sent(),this.shouldThrowOnError)throw i;if(di(i))return[2,{data:null,error:i}];throw i;case 3:return[2]}})})},e.prototype.copy=function(r,n){return Kt(this,void 0,void 0,function(){var o,i;return Yt(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,this.copyFile({fileList:[{srcPath:this._getCloudPath(r),dstPath:this._getCloudPath(n),overwrite:!0,removeOriginal:!1}]})];case 1:if(o=s.sent(),o.fileList[0].code&&o.fileList[0].code!=="SUCCESS")throw new qt(o.fileList[0].message||"Copy failed");return[2,{data:{path:this._getCloudPath(n)},error:null}];case 2:if(i=s.sent(),this.shouldThrowOnError)throw i;if(di(i))return[2,{data:null,error:i}];throw i;case 3:return[2]}})})},e.prototype.createSignedUrl=function(r,n,o){return Kt(this,void 0,void 0,function(){var i,s,u,l,a,c,h;return Yt(this,function(w){switch(w.label){case 0:return w.trys.push([0,2,,3]),i=this._normalizeCloudId(r),[4,this.getTempFileURL({fileList:[{fileID:i,maxAge:n}]})];case 1:if(s=w.sent(),s.fileList[0].code!=="SUCCESS")throw new qt("Failed to create signed URL: [".concat(s.fileList[0].code,"] ").concat(s.fileList[0].fileID));return u=s.fileList[0].download_url,l=[],o?.download!==void 0&&(typeof o.download=="string"?l.push("download=".concat(encodeURIComponent(o.download))):o.download===!0&&l.push("download=true")),o?.transform&&(a=this._transformOptsToQueryString(o.transform),a&&l.push(a)),l.length>0&&(c=u.includes("?")?"&":"?",u="".concat(u).concat(c).concat(l.join("&"))),[2,{data:{signedUrl:u},error:null}];case 2:if(h=w.sent(),this.shouldThrowOnError)throw h;if(di(h))return[2,{data:null,error:h}];throw h;case 3:return[2]}})})},e.prototype.createSignedUrls=function(r,n){return Kt(this,void 0,void 0,function(){var o,i,s,u=this;return Yt(this,function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),o=r.map(function(a){return{fileID:u._normalizeCloudId(a),maxAge:n}}),[4,this.getTempFileURL({fileList:o})];case 1:return i=l.sent(),[2,{data:i.fileList.map(function(a,c){return{path:r[c],signedUrl:a.tempFileURL||"",error:a.code==="SUCCESS"?null:a.message}}),error:null}];case 2:if(s=l.sent(),this.shouldThrowOnError)throw s;if(di(s))return[2,{data:null,error:s}];throw s;case 3:return[2]}})})},e.prototype.download=function(r,n){return Kt(this,void 0,void 0,function(){var o,i,s=this;return Yt(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),i={},[4,(function(){return Kt(s,void 0,void 0,function(){var l,a,c,h;return Yt(this,function(w){switch(w.label){case 0:return[4,this.createSignedUrl(r,600,{transform:n})];case 1:if(l=w.sent(),l.error)throw l.error;return a=encodeURI((h=l.data)===null||h===void 0?void 0:h.signedUrl),[4,this.request.reqClass.get({url:a,headers:{},responseType:"blob"})];case 2:if(c=w.sent().data,!c)throw new qt("Download failed: no file content");return[2,new Blob([c])]}})})})()];case 1:return[2,(i.data=u.sent(),i.error=null,i)];case 2:if(o=u.sent(),this.shouldThrowOnError)throw o;if(di(o))return[2,{data:null,error:o}];throw o;case 3:return[2]}})})},e.prototype.info=function(r){return Kt(this,void 0,void 0,function(){var n,o,i,s,u,l,a,c;return Yt(this,function(h){switch(h.label){case 0:return h.trys.push([0,2,,3]),n=r.startsWith("cloud://"),o=n?this._extractPathFromFileId(r):r,i=n?this._extractBucketFromFileId(r):this.bucketId,[4,this.getFileInfo({fileList:[this._normalizeCloudId(r)]})];case 1:if(s=h.sent(),u=s.fileList[0],u.code!=="SUCCESS")throw new qt(u.message);return l=new Date().toISOString(),a=(u.lastModified?new Date(u.lastModified):new Date).toISOString(),[2,{data:{id:u.fileID,version:"1",name:o,bucketId:i,updatedAt:a,createdAt:a,lastAccessedAt:l,size:u.size,cacheControl:u.cacheControl,contentType:u.contentType,etag:u.etag,lastModified:a,metadata:{}},error:null}];case 2:if(c=h.sent(),this.shouldThrowOnError)throw c;return[2,{data:null,error:c instanceof qt?c:new qt(c.message)}];case 3:return[2]}})})},e.prototype.exists=function(r){return Kt(this,void 0,void 0,function(){var n,o,i;return Yt(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,this.getFileInfo({fileList:[this._normalizeCloudId(r)]})];case 1:if(n=s.sent(),o=n.fileList[0],o.code==="FILE_NOT_FOUND")return[2,{data:!1,error:null}];if(o.code!=="SUCCESS")throw new qt(o.message);return[2,{data:!0,error:null}];case 2:throw i=s.sent(),this.shouldThrowOnError,i;case 3:return[2]}})})},e.prototype.getPublicUrl=function(r,n){return Kt(this,void 0,void 0,function(){var o;return Yt(this,function(i){switch(i.label){case 0:return[4,this.createSignedUrl(r,600,n)];case 1:return o=i.sent(),o.data?[2,{data:{publicUrl:o.data.signedUrl}}]:[2,{data:null,error:o.error}]}})})},e.prototype.remove=function(r){return Kt(this,void 0,void 0,function(){var n,o,i,s,u,l,a,c,h,w,E=this;return Yt(this,function(T){switch(T.label){case 0:for(T.trys.push([0,3,,4]),n=10,o=[],i=0;i<r.length;i+=n)o.push(r.slice(i,i+n));return[4,Promise.all(o.map(function(A){return Promise.all(A.map(function(O){return E.info(O)}))}))];case 1:return s=T.sent(),u=new Map,s.flat().forEach(function(A,O){A.data&&u.set(r[Math.floor(O/n)*n+O%n],A.data)}),l=r.map(function(A){return E._normalizeCloudId(A)}),[4,this.deleteFile({fileList:l})];case 2:if(a=T.sent(),c=a.fileList.filter(function(A){return A.code!=="SUCCESS"}),c.length>0)throw new qt("Delete failed for ".concat(c.length," file(s)"));return h=new Date().toISOString(),[2,{data:r.map(function(A){var O=u.get(A);return{name:O?.name,id:O?.id,bucket_id:O?.bucketId,owner:void 0,updated_at:O?.updatedAt||h,created_at:O?.createdAt,last_accessed_at:O?.lastAccessedAt||h,metadata:O?.metadata||{},buckets:{id:O?.bucketId,name:O?.bucketId,owner:void 0,public:!1,created_at:"",updated_at:h}}}),error:null}];case 3:if(w=T.sent(),this.shouldThrowOnError)throw w;if(di(w))return[2,{data:null,error:w}];throw w;case 4:return[2]}})})},e.prototype.list=function(){return Kt(this,void 0,void 0,function(){return Yt(this,function(r){throw new qt("Not implemented")})})},e.prototype._getCloudPath=function(r){var n=r.replace(/^\/|\/$/g,"").replace(/\/+/g,"/");return n},e.prototype._normalizeCloudId=function(r){var n;if(/^cloud:\/\//.test(r))return r;var o=this._getCloudPath(r);if(this.bucketId){var i=((n=this.config)===null||n===void 0?void 0:n.env)||"";if(i)return"cloud://".concat(i,".").concat(this.bucketId,"/").concat(o)}else throw new qt("bucketId is not set")},e.prototype.toBase64=function(r){return typeof Buffer<"u"?Buffer.from(r).toString("base64"):btoa(r)},e.prototype._transformOptsToQueryString=function(r){var n=["imageMogr2"];if(r.width||r.height){var o=r.width||"",i=r.height||"";r.resize==="fill"?n.push("thumbnail/".concat(o,"x").concat(i,"!")):r.resize==="contain"?n.push("thumbnail/".concat(o,"x").concat(i)):n.push("thumbnail/".concat(o,"x").concat(i,"^"))}if(r.format&&r.format!=="origin"&&n.push("format/".concat(r.format)),r.quality!==void 0){var s=Math.max(1,Math.min(100,r.quality));n.push("quality/".concat(s))}return n.join("/")},e.prototype._extractPathFromFileId=function(r){var n=r.replace(/^cloud:\/\//,""),o=n.split("/");return o.length<2?r:o.slice(1).join("/")},e.prototype._extractBucketFromFileId=function(r){var n=r.replace(/^cloud:\/\//,""),o=n.split("/");if(o.length<1)return"";var i=o[0],s=i.indexOf(".");return s===-1?i:i.substring(s+1)},e})(kc)});function Pp(t){try{t.registerComponent(uE),t.registerComponent(cE)}catch(e){console.warn(e)}}var pi,uE,cE,lE=X(()=>{Rp();sE();pi=new kc,uE={name:Rt,entity:{uploadFile:pi.uploadFile,deleteFile:pi.deleteFile,getTempFileURL:pi.getTempFileURL,downloadFile:pi.downloadFile,getUploadMetadata:pi.getUploadMetadata,copyFile:pi.copyFile,getFileInfo:pi.getFileInfo,isGateWay:pi.isGateWay}},cE={name:"".concat(Rt,"/supabase"),IIFE:!0,entity:function(){var t=new WeakMap;Object.defineProperty(this.prototype,"storage",{get:function(){if(t.has(this))return t.get(this);var e=this,r=new Proxy({},{get:function(o,i){if(i==="config")return e.config;if(i==="request")return e.request}}),n=new aE(r);return t.set(this,n),n},configurable:!0,enumerable:!0})}};try{cloudbase.registerComponent(uE),cloudbase.registerComponent(cE)}catch{}try{window.registerStorage=Pp}catch{}});var xp=K((tV,fE)=>{var DF=typeof global=="object"&&global&&global.Object===Object&&global;fE.exports=DF});var Xr=K((rV,hE)=>{var UF=xp(),BF=typeof self=="object"&&self&&self.Object===Object&&self,qF=UF||BF||Function("return this")();hE.exports=qF});var Os=K((nV,dE)=>{var FF=Xr(),jF=FF.Symbol;dE.exports=jF});var gE=K((iV,mE)=>{var pE=Os(),vE=Object.prototype,MF=vE.hasOwnProperty,kF=vE.toString,As=pE?pE.toStringTag:void 0;function $F(t){var e=MF.call(t,As),r=t[As];try{t[As]=void 0;var n=!0}catch{}var o=kF.call(t);return n&&(e?t[As]=r:delete t[As]),o}mE.exports=$F});var _E=K((oV,yE)=>{var WF=Object.prototype,HF=WF.toString;function GF(t){return HF.call(t)}yE.exports=GF});var Yo=K((aV,EE)=>{var wE=Os(),VF=gE(),zF=_E(),KF="[object Null]",YF="[object Undefined]",bE=wE?wE.toStringTag:void 0;function JF(t){return t==null?t===void 0?YF:KF:bE&&bE in Object(t)?VF(t):zF(t)}EE.exports=JF});var Zi=K((sV,SE)=>{function QF(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}SE.exports=QF});var Np=K((uV,IE)=>{var XF=Yo(),ZF=Zi(),ej="[object AsyncFunction]",tj="[object Function]",rj="[object GeneratorFunction]",nj="[object Proxy]";function ij(t){if(!ZF(t))return!1;var e=XF(t);return e==tj||e==rj||e==ej||e==nj}IE.exports=ij});var OE=K((cV,TE)=>{var oj=Xr(),aj=oj["__core-js_shared__"];TE.exports=aj});var CE=K((lV,RE)=>{var Lp=OE(),AE=(function(){var t=/[^.]+$/.exec(Lp&&Lp.keys&&Lp.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""})();function sj(t){return!!AE&&AE in t}RE.exports=sj});var Dp=K((fV,PE)=>{var uj=Function.prototype,cj=uj.toString;function lj(t){if(t!=null){try{return cj.call(t)}catch{}try{return t+""}catch{}}return""}PE.exports=lj});var NE=K((hV,xE)=>{var fj=Np(),hj=CE(),dj=Zi(),pj=Dp(),vj=/[\\^$.*+?()[\]{}|]/g,mj=/^\[object .+?Constructor\]$/,gj=Function.prototype,yj=Object.prototype,_j=gj.toString,wj=yj.hasOwnProperty,bj=RegExp("^"+_j.call(wj).replace(vj,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Ej(t){if(!dj(t)||hj(t))return!1;var e=fj(t)?bj:mj;return e.test(pj(t))}xE.exports=Ej});var DE=K((dV,LE)=>{function Sj(t,e){return t?.[e]}LE.exports=Sj});var vi=K((pV,UE)=>{var Ij=NE(),Tj=DE();function Oj(t,e){var r=Tj(t,e);return Ij(r)?r:void 0}UE.exports=Oj});var qE=K((vV,BE)=>{var Aj=vi(),Rj=(function(){try{var t=Aj(Object,"defineProperty");return t({},"",{}),t}catch{}})();BE.exports=Rj});var Up=K((mV,jE)=>{var FE=qE();function Cj(t,e,r){e=="__proto__"&&FE?FE(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}jE.exports=Cj});var Bp=K((gV,ME)=>{function Pj(t,e){return t===e||t!==t&&e!==e}ME.exports=Pj});var $c=K((yV,kE)=>{var xj=Up(),Nj=Bp(),Lj=Object.prototype,Dj=Lj.hasOwnProperty;function Uj(t,e,r){var n=t[e];(!(Dj.call(t,e)&&Nj(n,r))||r===void 0&&!(e in t))&&xj(t,e,r)}kE.exports=Uj});var eo=K((_V,$E)=>{var Bj=Array.isArray;$E.exports=Bj});var to=K((wV,WE)=>{function qj(t){return t!=null&&typeof t=="object"}WE.exports=qj});var Wc=K((bV,HE)=>{var Fj=Yo(),jj=to(),Mj="[object Symbol]";function kj(t){return typeof t=="symbol"||jj(t)&&Fj(t)==Mj}HE.exports=kj});var VE=K((EV,GE)=>{var $j=eo(),Wj=Wc(),Hj=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Gj=/^\w*$/;function Vj(t,e){if($j(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||Wj(t)?!0:Gj.test(t)||!Hj.test(t)||e!=null&&t in Object(e)}GE.exports=Vj});var Rs=K((SV,zE)=>{var zj=vi(),Kj=zj(Object,"create");zE.exports=Kj});var JE=K((IV,YE)=>{var KE=Rs();function Yj(){this.__data__=KE?KE(null):{},this.size=0}YE.exports=Yj});var XE=K((TV,QE)=>{function Jj(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}QE.exports=Jj});var e1=K((OV,ZE)=>{var Qj=Rs(),Xj="__lodash_hash_undefined__",Zj=Object.prototype,eM=Zj.hasOwnProperty;function tM(t){var e=this.__data__;if(Qj){var r=e[t];return r===Xj?void 0:r}return eM.call(e,t)?e[t]:void 0}ZE.exports=tM});var r1=K((AV,t1)=>{var rM=Rs(),nM=Object.prototype,iM=nM.hasOwnProperty;function oM(t){var e=this.__data__;return rM?e[t]!==void 0:iM.call(e,t)}t1.exports=oM});var i1=K((RV,n1)=>{var aM=Rs(),sM="__lodash_hash_undefined__";function uM(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=aM&&e===void 0?sM:e,this}n1.exports=uM});var a1=K((CV,o1)=>{var cM=JE(),lM=XE(),fM=e1(),hM=r1(),dM=i1();function Jo(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Jo.prototype.clear=cM;Jo.prototype.delete=lM;Jo.prototype.get=fM;Jo.prototype.has=hM;Jo.prototype.set=dM;o1.exports=Jo});var u1=K((PV,s1)=>{function pM(){this.__data__=[],this.size=0}s1.exports=pM});var Cs=K((xV,c1)=>{var vM=Bp();function mM(t,e){for(var r=t.length;r--;)if(vM(t[r][0],e))return r;return-1}c1.exports=mM});var f1=K((NV,l1)=>{var gM=Cs(),yM=Array.prototype,_M=yM.splice;function wM(t){var e=this.__data__,r=gM(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():_M.call(e,r,1),--this.size,!0}l1.exports=wM});var d1=K((LV,h1)=>{var bM=Cs();function EM(t){var e=this.__data__,r=bM(e,t);return r<0?void 0:e[r][1]}h1.exports=EM});var v1=K((DV,p1)=>{var SM=Cs();function IM(t){return SM(this.__data__,t)>-1}p1.exports=IM});var g1=K((UV,m1)=>{var TM=Cs();function OM(t,e){var r=this.__data__,n=TM(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}m1.exports=OM});var Ps=K((BV,y1)=>{var AM=u1(),RM=f1(),CM=d1(),PM=v1(),xM=g1();function Qo(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Qo.prototype.clear=AM;Qo.prototype.delete=RM;Qo.prototype.get=CM;Qo.prototype.has=PM;Qo.prototype.set=xM;y1.exports=Qo});var Hc=K((qV,_1)=>{var NM=vi(),LM=Xr(),DM=NM(LM,"Map");_1.exports=DM});var E1=K((FV,b1)=>{var w1=a1(),UM=Ps(),BM=Hc();function qM(){this.size=0,this.__data__={hash:new w1,map:new(BM||UM),string:new w1}}b1.exports=qM});var I1=K((jV,S1)=>{function FM(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}S1.exports=FM});var xs=K((MV,T1)=>{var jM=I1();function MM(t,e){var r=t.__data__;return jM(e)?r[typeof e=="string"?"string":"hash"]:r.map}T1.exports=MM});var A1=K((kV,O1)=>{var kM=xs();function $M(t){var e=kM(this,t).delete(t);return this.size-=e?1:0,e}O1.exports=$M});var C1=K(($V,R1)=>{var WM=xs();function HM(t){return WM(this,t).get(t)}R1.exports=HM});var x1=K((WV,P1)=>{var GM=xs();function VM(t){return GM(this,t).has(t)}P1.exports=VM});var L1=K((HV,N1)=>{var zM=xs();function KM(t,e){var r=zM(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}N1.exports=KM});var qp=K((GV,D1)=>{var YM=E1(),JM=A1(),QM=C1(),XM=x1(),ZM=L1();function Xo(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Xo.prototype.clear=YM;Xo.prototype.delete=JM;Xo.prototype.get=QM;Xo.prototype.has=XM;Xo.prototype.set=ZM;D1.exports=Xo});var q1=K((VV,B1)=>{var U1=qp(),e4="Expected a function";function Fp(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(e4);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var s=t.apply(this,n);return r.cache=i.set(o,s)||i,s};return r.cache=new(Fp.Cache||U1),r}Fp.Cache=U1;B1.exports=Fp});var j1=K((zV,F1)=>{var t4=q1(),r4=500;function n4(t){var e=t4(t,function(n){return r.size===r4&&r.clear(),n}),r=e.cache;return e}F1.exports=n4});var k1=K((KV,M1)=>{var i4=j1(),o4=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,a4=/\\(\\)?/g,s4=i4(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(o4,function(r,n,o,i){e.push(o?i.replace(a4,"$1"):n||r)}),e});M1.exports=s4});var W1=K((YV,$1)=>{function u4(t,e){for(var r=-1,n=t==null?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}$1.exports=u4});var Y1=K((JV,K1)=>{var H1=Os(),c4=W1(),l4=eo(),f4=Wc(),h4=1/0,G1=H1?H1.prototype:void 0,V1=G1?G1.toString:void 0;function z1(t){if(typeof t=="string")return t;if(l4(t))return c4(t,z1)+"";if(f4(t))return V1?V1.call(t):"";var e=t+"";return e=="0"&&1/t==-h4?"-0":e}K1.exports=z1});var Q1=K((QV,J1)=>{var d4=Y1();function p4(t){return t==null?"":d4(t)}J1.exports=p4});var Gc=K((XV,X1)=>{var v4=eo(),m4=VE(),g4=k1(),y4=Q1();function _4(t,e){return v4(t)?t:m4(t,e)?[t]:g4(y4(t))}X1.exports=_4});var jp=K((ZV,Z1)=>{var w4=9007199254740991,b4=/^(?:0|[1-9]\d*)$/;function E4(t,e){var r=typeof t;return e=e??w4,!!e&&(r=="number"||r!="symbol"&&b4.test(t))&&t>-1&&t%1==0&&t<e}Z1.exports=E4});var Vc=K((ez,eS)=>{var S4=Wc(),I4=1/0;function T4(t){if(typeof t=="string"||S4(t))return t;var e=t+"";return e=="0"&&1/t==-I4?"-0":e}eS.exports=T4});var nS=K((tz,rS)=>{var O4=$c(),A4=Gc(),R4=jp(),tS=Zi(),C4=Vc();function P4(t,e,r,n){if(!tS(t))return t;e=A4(e,t);for(var o=-1,i=e.length,s=i-1,u=t;u!=null&&++o<i;){var l=C4(e[o]),a=r;if(l==="__proto__"||l==="constructor"||l==="prototype")return t;if(o!=s){var c=u[l];a=n?n(c,l,u):void 0,a===void 0&&(a=tS(c)?c:R4(e[o+1])?[]:{})}O4(u,l,a),u=u[l]}return t}rS.exports=P4});var oS=K((rz,iS)=>{var x4=nS();function N4(t,e,r){return t==null?t:x4(t,e,r)}iS.exports=N4});var sS=K((nz,aS)=>{function L4(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}aS.exports=L4});var cS=K((iz,uS)=>{var D4=Gc(),U4=Vc();function B4(t,e){e=D4(e,t);for(var r=0,n=e.length;t!=null&&r<n;)t=t[U4(e[r++])];return r&&r==n?t:void 0}uS.exports=B4});var fS=K((oz,lS)=>{function q4(t,e,r){var n=-1,o=t.length;e<0&&(e=-e>o?0:o+e),r=r>o?o:r,r<0&&(r+=o),o=e>r?0:r-e>>>0,e>>>=0;for(var i=Array(o);++n<o;)i[n]=t[n+e];return i}lS.exports=q4});var dS=K((az,hS)=>{var F4=cS(),j4=fS();function M4(t,e){return e.length<2?t:F4(t,j4(e,0,-1))}hS.exports=M4});var vS=K((sz,pS)=>{var k4=Gc(),$4=sS(),W4=dS(),H4=Vc();function G4(t,e){return e=k4(e,t),t=W4(t,e),t==null||delete t[H4($4(e))]}pS.exports=G4});var gS=K((uz,mS)=>{var V4=vS();function z4(t,e){return t==null?!0:V4(t,e)}mS.exports=z4});var _S=K((cz,yS)=>{var K4=Ps();function Y4(){this.__data__=new K4,this.size=0}yS.exports=Y4});var bS=K((lz,wS)=>{function J4(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}wS.exports=J4});var SS=K((fz,ES)=>{function Q4(t){return this.__data__.get(t)}ES.exports=Q4});var TS=K((hz,IS)=>{function X4(t){return this.__data__.has(t)}IS.exports=X4});var AS=K((dz,OS)=>{var Z4=Ps(),ek=Hc(),tk=qp(),rk=200;function nk(t,e){var r=this.__data__;if(r instanceof Z4){var n=r.__data__;if(!ek||n.length<rk-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new tk(n)}return r.set(t,e),this.size=r.size,this}OS.exports=nk});var CS=K((pz,RS)=>{var ik=Ps(),ok=_S(),ak=bS(),sk=SS(),uk=TS(),ck=AS();function Zo(t){var e=this.__data__=new ik(t);this.size=e.size}Zo.prototype.clear=ok;Zo.prototype.delete=ak;Zo.prototype.get=sk;Zo.prototype.has=uk;Zo.prototype.set=ck;RS.exports=Zo});var xS=K((vz,PS)=>{function lk(t,e){for(var r=-1,n=t==null?0:t.length;++r<n&&e(t[r],r,t)!==!1;);return t}PS.exports=lk});var Ns=K((mz,NS)=>{var fk=$c(),hk=Up();function dk(t,e,r,n){var o=!r;r||(r={});for(var i=-1,s=e.length;++i<s;){var u=e[i],l=n?n(r[u],t[u],u,r,t):void 0;l===void 0&&(l=t[u]),o?hk(r,u,l):fk(r,u,l)}return r}NS.exports=dk});var DS=K((gz,LS)=>{function pk(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}LS.exports=pk});var BS=K((yz,US)=>{var vk=Yo(),mk=to(),gk="[object Arguments]";function yk(t){return mk(t)&&vk(t)==gk}US.exports=yk});var MS=K((_z,jS)=>{var qS=BS(),_k=to(),FS=Object.prototype,wk=FS.hasOwnProperty,bk=FS.propertyIsEnumerable,Ek=qS((function(){return arguments})())?qS:function(t){return _k(t)&&wk.call(t,"callee")&&!bk.call(t,"callee")};jS.exports=Ek});var $S=K((wz,kS)=>{function Sk(){return!1}kS.exports=Sk});var Mp=K((Ls,ea)=>{var Ik=Xr(),Tk=$S(),GS=typeof Ls=="object"&&Ls&&!Ls.nodeType&&Ls,WS=GS&&typeof ea=="object"&&ea&&!ea.nodeType&&ea,Ok=WS&&WS.exports===GS,HS=Ok?Ik.Buffer:void 0,Ak=HS?HS.isBuffer:void 0,Rk=Ak||Tk;ea.exports=Rk});var kp=K((bz,VS)=>{var Ck=9007199254740991;function Pk(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Ck}VS.exports=Pk});var KS=K((Ez,zS)=>{var xk=Yo(),Nk=kp(),Lk=to(),Dk="[object Arguments]",Uk="[object Array]",Bk="[object Boolean]",qk="[object Date]",Fk="[object Error]",jk="[object Function]",Mk="[object Map]",kk="[object Number]",$k="[object Object]",Wk="[object RegExp]",Hk="[object Set]",Gk="[object String]",Vk="[object WeakMap]",zk="[object ArrayBuffer]",Kk="[object DataView]",Yk="[object Float32Array]",Jk="[object Float64Array]",Qk="[object Int8Array]",Xk="[object Int16Array]",Zk="[object Int32Array]",e6="[object Uint8Array]",t6="[object Uint8ClampedArray]",r6="[object Uint16Array]",n6="[object Uint32Array]",Je={};Je[Yk]=Je[Jk]=Je[Qk]=Je[Xk]=Je[Zk]=Je[e6]=Je[t6]=Je[r6]=Je[n6]=!0;Je[Dk]=Je[Uk]=Je[zk]=Je[Bk]=Je[Kk]=Je[qk]=Je[Fk]=Je[jk]=Je[Mk]=Je[kk]=Je[$k]=Je[Wk]=Je[Hk]=Je[Gk]=Je[Vk]=!1;function i6(t){return Lk(t)&&Nk(t.length)&&!!Je[xk(t)]}zS.exports=i6});var zc=K((Sz,YS)=>{function o6(t){return function(e){return t(e)}}YS.exports=o6});var Kc=K((Ds,ta)=>{var a6=xp(),JS=typeof Ds=="object"&&Ds&&!Ds.nodeType&&Ds,Us=JS&&typeof ta=="object"&&ta&&!ta.nodeType&&ta,s6=Us&&Us.exports===JS,$p=s6&&a6.process,u6=(function(){try{var t=Us&&Us.require&&Us.require("util").types;return t||$p&&$p.binding&&$p.binding("util")}catch{}})();ta.exports=u6});var eI=K((Iz,ZS)=>{var c6=KS(),l6=zc(),QS=Kc(),XS=QS&&QS.isTypedArray,f6=XS?l6(XS):c6;ZS.exports=f6});var Wp=K((Tz,tI)=>{var h6=DS(),d6=MS(),p6=eo(),v6=Mp(),m6=jp(),g6=eI(),y6=Object.prototype,_6=y6.hasOwnProperty;function w6(t,e){var r=p6(t),n=!r&&d6(t),o=!r&&!n&&v6(t),i=!r&&!n&&!o&&g6(t),s=r||n||o||i,u=s?h6(t.length,String):[],l=u.length;for(var a in t)(e||_6.call(t,a))&&!(s&&(a=="length"||o&&(a=="offset"||a=="parent")||i&&(a=="buffer"||a=="byteLength"||a=="byteOffset")||m6(a,l)))&&u.push(a);return u}tI.exports=w6});var Yc=K((Oz,rI)=>{var b6=Object.prototype;function E6(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||b6;return t===r}rI.exports=E6});var Hp=K((Az,nI)=>{function S6(t,e){return function(r){return t(e(r))}}nI.exports=S6});var oI=K((Rz,iI)=>{var I6=Hp(),T6=I6(Object.keys,Object);iI.exports=T6});var sI=K((Cz,aI)=>{var O6=Yc(),A6=oI(),R6=Object.prototype,C6=R6.hasOwnProperty;function P6(t){if(!O6(t))return A6(t);var e=[];for(var r in Object(t))C6.call(t,r)&&r!="constructor"&&e.push(r);return e}aI.exports=P6});var Gp=K((Pz,uI)=>{var x6=Np(),N6=kp();function L6(t){return t!=null&&N6(t.length)&&!x6(t)}uI.exports=L6});var Jc=K((xz,cI)=>{var D6=Wp(),U6=sI(),B6=Gp();function q6(t){return B6(t)?D6(t):U6(t)}cI.exports=q6});var fI=K((Nz,lI)=>{var F6=Ns(),j6=Jc();function M6(t,e){return t&&F6(e,j6(e),t)}lI.exports=M6});var dI=K((Lz,hI)=>{function k6(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}hI.exports=k6});var vI=K((Dz,pI)=>{var $6=Zi(),W6=Yc(),H6=dI(),G6=Object.prototype,V6=G6.hasOwnProperty;function z6(t){if(!$6(t))return H6(t);var e=W6(t),r=[];for(var n in t)n=="constructor"&&(e||!V6.call(t,n))||r.push(n);return r}pI.exports=z6});var Qc=K((Uz,mI)=>{var K6=Wp(),Y6=vI(),J6=Gp();function Q6(t){return J6(t)?K6(t,!0):Y6(t)}mI.exports=Q6});var yI=K((Bz,gI)=>{var X6=Ns(),Z6=Qc();function e5(t,e){return t&&X6(e,Z6(e),t)}gI.exports=e5});var SI=K((Bs,ra)=>{var t5=Xr(),EI=typeof Bs=="object"&&Bs&&!Bs.nodeType&&Bs,_I=EI&&typeof ra=="object"&&ra&&!ra.nodeType&&ra,r5=_I&&_I.exports===EI,wI=r5?t5.Buffer:void 0,bI=wI?wI.allocUnsafe:void 0;function n5(t,e){if(e)return t.slice();var r=t.length,n=bI?bI(r):new t.constructor(r);return t.copy(n),n}ra.exports=n5});var TI=K((qz,II)=>{function i5(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}II.exports=i5});var AI=K((Fz,OI)=>{function o5(t,e){for(var r=-1,n=t==null?0:t.length,o=0,i=[];++r<n;){var s=t[r];e(s,r,t)&&(i[o++]=s)}return i}OI.exports=o5});var Vp=K((jz,RI)=>{function a5(){return[]}RI.exports=a5});var Xc=K((Mz,PI)=>{var s5=AI(),u5=Vp(),c5=Object.prototype,l5=c5.propertyIsEnumerable,CI=Object.getOwnPropertySymbols,f5=CI?function(t){return t==null?[]:(t=Object(t),s5(CI(t),function(e){return l5.call(t,e)}))}:u5;PI.exports=f5});var NI=K((kz,xI)=>{var h5=Ns(),d5=Xc();function p5(t,e){return h5(t,d5(t),e)}xI.exports=p5});var zp=K(($z,LI)=>{function v5(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}LI.exports=v5});var Kp=K((Wz,DI)=>{var m5=Hp(),g5=m5(Object.getPrototypeOf,Object);DI.exports=g5});var Yp=K((Hz,UI)=>{var y5=zp(),_5=Kp(),w5=Xc(),b5=Vp(),E5=Object.getOwnPropertySymbols,S5=E5?function(t){for(var e=[];t;)y5(e,w5(t)),t=_5(t);return e}:b5;UI.exports=S5});var qI=K((Gz,BI)=>{var I5=Ns(),T5=Yp();function O5(t,e){return I5(t,T5(t),e)}BI.exports=O5});var Jp=K((Vz,FI)=>{var A5=zp(),R5=eo();function C5(t,e,r){var n=e(t);return R5(t)?n:A5(n,r(t))}FI.exports=C5});var MI=K((zz,jI)=>{var P5=Jp(),x5=Xc(),N5=Jc();function L5(t){return P5(t,N5,x5)}jI.exports=L5});var $I=K((Kz,kI)=>{var D5=Jp(),U5=Yp(),B5=Qc();function q5(t){return D5(t,B5,U5)}kI.exports=q5});var HI=K((Yz,WI)=>{var F5=vi(),j5=Xr(),M5=F5(j5,"DataView");WI.exports=M5});var VI=K((Jz,GI)=>{var k5=vi(),$5=Xr(),W5=k5($5,"Promise");GI.exports=W5});var KI=K((Qz,zI)=>{var H5=vi(),G5=Xr(),V5=H5(G5,"Set");zI.exports=V5});var JI=K((Xz,YI)=>{var z5=vi(),K5=Xr(),Y5=z5(K5,"WeakMap");YI.exports=Y5});var Zc=K((Zz,nT)=>{var Qp=HI(),Xp=Hc(),Zp=VI(),ev=KI(),tv=JI(),rT=Yo(),na=Dp(),QI="[object Map]",J5="[object Object]",XI="[object Promise]",ZI="[object Set]",eT="[object WeakMap]",tT="[object DataView]",Q5=na(Qp),X5=na(Xp),Z5=na(Zp),e8=na(ev),t8=na(tv),ro=rT;(Qp&&ro(new Qp(new ArrayBuffer(1)))!=tT||Xp&&ro(new Xp)!=QI||Zp&&ro(Zp.resolve())!=XI||ev&&ro(new ev)!=ZI||tv&&ro(new tv)!=eT)&&(ro=function(t){var e=rT(t),r=e==J5?t.constructor:void 0,n=r?na(r):"";if(n)switch(n){case Q5:return tT;case X5:return QI;case Z5:return XI;case e8:return ZI;case t8:return eT}return e});nT.exports=ro});var oT=K((eK,iT)=>{var r8=Object.prototype,n8=r8.hasOwnProperty;function i8(t){var e=t.length,r=new t.constructor(e);return e&&typeof t[0]=="string"&&n8.call(t,"index")&&(r.index=t.index,r.input=t.input),r}iT.exports=i8});var sT=K((tK,aT)=>{var o8=Xr(),a8=o8.Uint8Array;aT.exports=a8});var el=K((rK,cT)=>{var uT=sT();function s8(t){var e=new t.constructor(t.byteLength);return new uT(e).set(new uT(t)),e}cT.exports=s8});var fT=K((nK,lT)=>{var u8=el();function c8(t,e){var r=e?u8(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}lT.exports=c8});var dT=K((iK,hT)=>{var l8=/\w*$/;function f8(t){var e=new t.constructor(t.source,l8.exec(t));return e.lastIndex=t.lastIndex,e}hT.exports=f8});var yT=K((oK,gT)=>{var pT=Os(),vT=pT?pT.prototype:void 0,mT=vT?vT.valueOf:void 0;function h8(t){return mT?Object(mT.call(t)):{}}gT.exports=h8});var wT=K((aK,_T)=>{var d8=el();function p8(t,e){var r=e?d8(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}_T.exports=p8});var ET=K((sK,bT)=>{var v8=el(),m8=fT(),g8=dT(),y8=yT(),_8=wT(),w8="[object Boolean]",b8="[object Date]",E8="[object Map]",S8="[object Number]",I8="[object RegExp]",T8="[object Set]",O8="[object String]",A8="[object Symbol]",R8="[object ArrayBuffer]",C8="[object DataView]",P8="[object Float32Array]",x8="[object Float64Array]",N8="[object Int8Array]",L8="[object Int16Array]",D8="[object Int32Array]",U8="[object Uint8Array]",B8="[object Uint8ClampedArray]",q8="[object Uint16Array]",F8="[object Uint32Array]";function j8(t,e,r){var n=t.constructor;switch(e){case R8:return v8(t);case w8:case b8:return new n(+t);case C8:return m8(t,r);case P8:case x8:case N8:case L8:case D8:case U8:case B8:case q8:case F8:return _8(t,r);case E8:return new n;case S8:case O8:return new n(t);case I8:return g8(t);case T8:return new n;case A8:return y8(t)}}bT.exports=j8});var TT=K((uK,IT)=>{var M8=Zi(),ST=Object.create,k8=(function(){function t(){}return function(e){if(!M8(e))return{};if(ST)return ST(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}})();IT.exports=k8});var AT=K((cK,OT)=>{var $8=TT(),W8=Kp(),H8=Yc();function G8(t){return typeof t.constructor=="function"&&!H8(t)?$8(W8(t)):{}}OT.exports=G8});var CT=K((lK,RT)=>{var V8=Zc(),z8=to(),K8="[object Map]";function Y8(t){return z8(t)&&V8(t)==K8}RT.exports=Y8});var LT=K((fK,NT)=>{var J8=CT(),Q8=zc(),PT=Kc(),xT=PT&&PT.isMap,X8=xT?Q8(xT):J8;NT.exports=X8});var UT=K((hK,DT)=>{var Z8=Zc(),e$=to(),t$="[object Set]";function r$(t){return e$(t)&&Z8(t)==t$}DT.exports=r$});var jT=K((dK,FT)=>{var n$=UT(),i$=zc(),BT=Kc(),qT=BT&&BT.isSet,o$=qT?i$(qT):n$;FT.exports=o$});var HT=K((pK,WT)=>{var a$=CS(),s$=xS(),u$=$c(),c$=fI(),l$=yI(),f$=SI(),h$=TI(),d$=NI(),p$=qI(),v$=MI(),m$=$I(),g$=Zc(),y$=oT(),_$=ET(),w$=AT(),b$=eo(),E$=Mp(),S$=LT(),I$=Zi(),T$=jT(),O$=Jc(),A$=Qc(),R$=1,C$=2,P$=4,MT="[object Arguments]",x$="[object Array]",N$="[object Boolean]",L$="[object Date]",D$="[object Error]",kT="[object Function]",U$="[object GeneratorFunction]",B$="[object Map]",q$="[object Number]",$T="[object Object]",F$="[object RegExp]",j$="[object Set]",M$="[object String]",k$="[object Symbol]",$$="[object WeakMap]",W$="[object ArrayBuffer]",H$="[object DataView]",G$="[object Float32Array]",V$="[object Float64Array]",z$="[object Int8Array]",K$="[object Int16Array]",Y$="[object Int32Array]",J$="[object Uint8Array]",Q$="[object Uint8ClampedArray]",X$="[object Uint16Array]",Z$="[object Uint32Array]",Ke={};Ke[MT]=Ke[x$]=Ke[W$]=Ke[H$]=Ke[N$]=Ke[L$]=Ke[G$]=Ke[V$]=Ke[z$]=Ke[K$]=Ke[Y$]=Ke[B$]=Ke[q$]=Ke[$T]=Ke[F$]=Ke[j$]=Ke[M$]=Ke[k$]=Ke[J$]=Ke[Q$]=Ke[X$]=Ke[Z$]=!0;Ke[D$]=Ke[kT]=Ke[$$]=!1;function tl(t,e,r,n,o,i){var s,u=e&R$,l=e&C$,a=e&P$;if(r&&(s=o?r(t,n,o,i):r(t)),s!==void 0)return s;if(!I$(t))return t;var c=b$(t);if(c){if(s=y$(t),!u)return h$(t,s)}else{var h=g$(t),w=h==kT||h==U$;if(E$(t))return f$(t,u);if(h==$T||h==MT||w&&!o){if(s=l||w?{}:w$(t),!u)return l?p$(t,l$(s,t)):d$(t,c$(s,t))}else{if(!Ke[h])return o?t:{};s=_$(t,h,u)}}i||(i=new a$);var E=i.get(t);if(E)return E;i.set(t,s),T$(t)?t.forEach(function(O){s.add(tl(O,e,r,O,t,i))}):S$(t)&&t.forEach(function(O,C){s.set(C,tl(O,e,r,C,t,i))});var T=a?l?m$:v$:l?A$:O$,A=c?void 0:T(t);return s$(A||t,function(O,C){A&&(C=O,O=t[C]),u$(s,C,tl(O,e,r,C,t,i))}),s}WT.exports=tl});var VT=K((vK,GT)=>{var eW=HT(),tW=1,rW=4;function nW(t){return eW(t,tW|rW)}GT.exports=nW});function mi(t){return t===void 0&&(t=""),"".concat(t?"".concat(t,"_"):"").concat(+new Date,"_").concat(Math.random())}var rv=X(()=>{});var zT,KT=X(()=>{zT=(function(){function t(e){this.close=e.close,this.onChange=e.onChange,this.onError=e.onError,e.debug&&Object.defineProperty(this,"virtualClient",{get:function(){return e.virtualClient}})}return t})()});var nv,YT=X(()=>{nv=(function(){function t(e){var r=e.id,n=e.docChanges,o=e.docs,i=e.msgType,s=e.type,u,l;Object.defineProperties(this,{id:{get:function(){return r},enumerable:!0},docChanges:{get:function(){return u||(u=JSON.parse(JSON.stringify(n))),u},enumerable:!0},docs:{get:function(){return l||(l=JSON.parse(JSON.stringify(o))),l},enumerable:!0},msgType:{get:function(){return i},enumerable:!0},type:{get:function(){return s},enumerable:!0}})}return t})()});var rl,JT,iv,QT,XT,ZT,eO,Jt,Ct,nl=X(()=>{rl=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),JT=(function(t){rl(e,t);function e(r){var n=t.call(this,"Watch Error ".concat(JSON.stringify(r.msgData)," (requestid: ").concat(r.requestId,")"))||this;return n.isRealtimeErrorMessageError=!0,n.payload=r,n}return e})(Error),iv=function(t){return t?.isRealtimeErrorMessageError},QT=(function(t){rl(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type="timeout",r.payload=null,r.generic=!0,r}return e})(Error),XT=function(t){return t.type==="timeout"},ZT=(function(t){rl(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type="cancelled",r.payload=null,r.generic=!0,r}return e})(Error),eO=function(t){return t.type==="cancelled"},Jt=(function(t){rl(e,t);function e(r){var n=t.call(this,r.errMsg)||this;return n.errCode="UNKNOWN_ERROR",Object.defineProperties(n,{message:{get:function(){return"errCode: ".concat(this.errCode," ").concat(Ct[this.errCode]||""," | errMsg: ").concat(this.errMsg)},set:function(o){this.errMsg=o}}}),n.errCode=r.errCode||"UNKNOWN_ERROR",n.errMsg=r.errMsg,n}return Object.defineProperty(e.prototype,"message",{get:function(){return"errCode: ".concat(this.errCode," | errMsg: ").concat(this.errMsg)},set:function(r){this.errMsg=r},enumerable:!1,configurable:!0}),e})(Error),Ct={UNKNOWN_ERROR:"UNKNOWN_ERROR",SDK_DATABASE_REALTIME_LISTENER_INIT_WATCH_FAIL:"SDK_DATABASE_REALTIME_LISTENER_INIT_WATCH_FAIL",SDK_DATABASE_REALTIME_LISTENER_RECONNECT_WATCH_FAIL:"SDK_DATABASE_REALTIME_LISTENER_RECONNECT_WATCH_FAIL",SDK_DATABASE_REALTIME_LISTENER_REBUILD_WATCH_FAIL:"SDK_DATABASE_REALTIME_LISTENER_REBUILD_WATCH_FAIL",SDK_DATABASE_REALTIME_LISTENER_CLOSE_WATCH_FAIL:"SDK_DATABASE_REALTIME_LISTENER_CLOSE_WATCH_FAIL",SDK_DATABASE_REALTIME_LISTENER_SERVER_ERROR_MSG:"SDK_DATABASE_REALTIME_LISTENER_SERVER_ERROR_MSG",SDK_DATABASE_REALTIME_LISTENER_RECEIVE_INVALID_SERVER_DATA:"SDK_DATABASE_REALTIME_LISTENER_RECEIVE_INVALID_SERVER_DATA",SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_ERROR:"SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_ERROR",SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_CLOSED:"SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_CLOSED",SDK_DATABASE_REALTIME_LISTENER_CHECK_LAST_FAIL:"SDK_DATABASE_REALTIME_LISTENER_CHECK_LAST_FAIL",SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR:"SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR"}});var qs,ov=X(()=>{qs=function(t){return t===void 0&&(t=0),new Promise(function(e){return setTimeout(e,t)})}});function cW(t){var e={id:t.ID,dataType:t.DataType,queueType:t.QueueType,docId:t.DocID,doc:t.Doc&&t.Doc!=="{}"?JSON.parse(t.Doc):void 0};return t.DataType==="update"&&(t.UpdatedFields&&(e.updatedFields=JSON.parse(t.UpdatedFields)),(t.removedFields||t.RemovedFields)&&(e.removedFields=JSON.parse(t.removedFields))),e}var rO,nO,iO,yr,or,tO,Ve,iW,il,oW,aW,sW,uW,oO,aO=X(()=>{rO=st(oS()),nO=st(gS()),iO=st(VT());rv();KT();YT();nl();ov();yr=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},or=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},tO=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,i;n<o;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))};(function(t){t.LOGGINGIN="LOGGINGIN",t.INITING="INITING",t.REBUILDING="REBUILDING",t.ACTIVE="ACTIVE",t.ERRORED="ERRORED",t.CLOSING="CLOSING",t.CLOSED="CLOSED",t.PAUSED="PAUSED",t.RESUMING="RESUMING"})(Ve||(Ve={}));iW=100,il=2,oW=2,aW=10*1e3,sW=10*1e3,uW=10*1e3,oO=(function(){function t(e){var r=this;this.watchStatus=Ve.INITING,this.wsLogin=function(n,o){return yr(r,void 0,void 0,function(){var i;return or(this,function(s){switch(s.label){case 0:return this.watchStatus=Ve.LOGGINGIN,[4,this.login(n,o)];case 1:return i=s.sent(),this.envId||(this.envId=i.envId),[2,i]}})})},this.initWatch=function(n){return yr(r,void 0,void 0,function(){var o,i=this;return or(this,function(s){switch(s.label){case 0:if(this.initWatchPromise!==null&&this.initWatchPromise!==void 0)return[2,this.initWatchPromise];this.initWatchPromise=new Promise(function(u,l){(function(){return yr(i,void 0,void 0,function(){var a,c,h,w,E,T,A,O,C,P,q;return or(this,function(U){switch(U.label){case 0:return U.trys.push([0,3,,4]),this.watchStatus===Ve.PAUSED?(console.log("[realtime] initWatch cancelled on pause"),[2,u()]):[4,this.wsLogin(this.envId,n)];case 1:return a=U.sent().envId,this.watchStatus===Ve.PAUSED?(console.log("[realtime] initWatch cancelled on pause"),[2,u()]):(this.watchStatus=Ve.INITING,c={watchId:this.watchId,requestId:mi(),msgType:"INIT_WATCH",msgData:{envId:a,collName:this.collectionName,query:this.query,limit:this.limit,orderBy:this.orderBy}},[4,this.send({msg:c,waitResponse:!0,skipOnMessage:!0,timeout:sW})]);case 2:if(h=U.sent(),w=h.msgData,E=w.events,T=w.currEvent,this.sessionInfo={queryID:h.msgData.queryID,currentEventId:T-1,currentDocs:[]},E.length>0){for(A=0,O=E;A<O.length;A++)C=O[A],C.ID=T;this.handleServerEvents(h)}else this.sessionInfo.currentEventId=T,P=new nv({id:T,docChanges:[],docs:[],type:"init"}),this.listener.onChange(P),this.scheduleSendACK();return this.onWatchStart(this,this.sessionInfo.queryID),this.watchStatus=Ve.ACTIVE,this.availableRetries.INIT_WATCH=il,u(),[3,4];case 3:return q=U.sent(),this.handleWatchEstablishmentError(q,{operationName:"INIT_WATCH",resolve:u,reject:l}),[3,4];case 4:return[2]}})})})()}),o=!1,s.label=1;case 1:return s.trys.push([1,,3,4]),[4,this.initWatchPromise];case 2:return s.sent(),o=!0,[3,4];case 3:return this.initWatchPromise=void 0,[7];case 4:return console.log("[realtime] initWatch ".concat(o?"success":"fail")),[2]}})})},this.rebuildWatch=function(n){return yr(r,void 0,void 0,function(){var o,i=this;return or(this,function(s){switch(s.label){case 0:if(this.rebuildWatchPromise!==null&&this.rebuildWatchPromise!==void 0)return[2,this.rebuildWatchPromise];this.rebuildWatchPromise=new Promise(function(u,l){(function(){return yr(i,void 0,void 0,function(){var a,c,h,w;return or(this,function(E){switch(E.label){case 0:return E.trys.push([0,3,,4]),this.watchStatus===Ve.PAUSED?(console.log("[realtime] rebuildWatch cancelled on pause"),[2,u()]):[4,this.wsLogin(this.envId,n)];case 1:if(a=E.sent().envId,!this.sessionInfo)throw new Error("can not rebuildWatch without a successful initWatch (lack of sessionInfo)");return this.watchStatus===Ve.PAUSED?(console.log("[realtime] rebuildWatch cancelled on pause"),[2,u()]):(this.watchStatus=Ve.REBUILDING,c={watchId:this.watchId,requestId:mi(),msgType:"REBUILD_WATCH",msgData:{envId:a,collName:this.collectionName,queryID:this.sessionInfo.queryID,eventID:this.sessionInfo.currentEventId}},[4,this.send({msg:c,waitResponse:!0,skipOnMessage:!1,timeout:uW})]);case 2:return h=E.sent(),this.handleServerEvents(h),this.watchStatus=Ve.ACTIVE,this.availableRetries.REBUILD_WATCH=il,u(),[3,4];case 3:return w=E.sent(),this.handleWatchEstablishmentError(w,{operationName:"REBUILD_WATCH",resolve:u,reject:l}),[3,4];case 4:return[2]}})})})()}),o=!1,s.label=1;case 1:return s.trys.push([1,,3,4]),[4,this.rebuildWatchPromise];case 2:return s.sent(),o=!0,[3,4];case 3:return this.rebuildWatchPromise=void 0,[7];case 4:return console.log("[realtime] rebuildWatch ".concat(o?"success":"fail")),[2]}})})},this.handleWatchEstablishmentError=function(n,o){return yr(r,void 0,void 0,function(){var i,s,u,l=this;return or(this,function(a){return i=o.operationName==="INIT_WATCH",s=function(){l.closeWithError(new Jt({errCode:i?Ct.SDK_DATABASE_REALTIME_LISTENER_INIT_WATCH_FAIL:Ct.SDK_DATABASE_REALTIME_LISTENER_REBUILD_WATCH_FAIL,errMsg:n})),o.reject(n)},u=function(c){l.useRetryTicket(o.operationName)?i?(l.initWatchPromise=void 0,o.resolve(l.initWatch(c))):(l.rebuildWatchPromise=void 0,o.resolve(l.rebuildWatch(c))):s()},this.handleCommonError(n,{onSignError:function(){return u(!0)},onTimeoutError:function(){return u(!1)},onNotRetryableError:s,onCancelledError:o.reject,onUnknownError:function(){(function(){return yr(l,void 0,void 0,function(){var c,h,w=this;return or(this,function(E){switch(E.label){case 0:return E.trys.push([0,8,,9]),c=function(){return yr(w,void 0,void 0,function(){return or(this,function(T){switch(T.label){case 0:return this.pause(),[4,this.onceWSConnected()];case 1:return T.sent(),u(!0),[2]}})})},this.isWSConnected()?[3,2]:[4,c()];case 1:return E.sent(),[3,7];case 2:return[4,qs(iW)];case 3:return E.sent(),this.watchStatus!==Ve.PAUSED?[3,4]:(o.reject(new ZT("".concat(o.operationName," cancelled due to pause after unknownError"))),[3,7]);case 4:return this.isWSConnected()?[3,6]:[4,c()];case 5:return E.sent(),[3,7];case 6:u(!1),E.label=7;case 7:return[3,9];case 8:return h=E.sent(),u(!0),[3,9];case 9:return[2]}})})})()}}),[2]})})},this.closeWatch=function(){return yr(r,void 0,void 0,function(){var n,o,i;return or(this,function(s){switch(s.label){case 0:if(n=this.sessionInfo?this.sessionInfo.queryID:"",this.watchStatus!==Ve.ACTIVE)return this.watchStatus=Ve.CLOSED,this.onWatchClose(this,n),[2];s.label=1;case 1:return s.trys.push([1,3,4,5]),this.watchStatus=Ve.CLOSING,o={watchId:this.watchId,requestId:mi(),msgType:"CLOSE_WATCH",msgData:null},[4,this.send({msg:o})];case 2:return s.sent(),this.sessionInfo=void 0,this.watchStatus=Ve.CLOSED,[3,5];case 3:return i=s.sent(),this.closeWithError(new Jt({errCode:Ct.SDK_DATABASE_REALTIME_LISTENER_CLOSE_WATCH_FAIL,errMsg:i})),[3,5];case 4:return this.onWatchClose(this,n),[7];case 5:return[2]}})})},this.scheduleSendACK=function(){r.clearACKSchedule(),r.ackTimeoutId=setTimeout(function(){r.waitExpectedTimeoutId?r.scheduleSendACK():r.sendACK()},aW)},this.clearACKSchedule=function(){r.ackTimeoutId&&clearTimeout(r.ackTimeoutId)},this.sendACK=function(){return yr(r,void 0,void 0,function(){var n,o,i;return or(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),this.watchStatus!==Ve.ACTIVE?(this.scheduleSendACK(),[2]):this.sessionInfo?(n={watchId:this.watchId,requestId:mi(),msgType:"CHECK_LAST",msgData:{queryID:this.sessionInfo.queryID,eventID:this.sessionInfo.currentEventId}},[4,this.send({msg:n})]):(console.warn("[realtime listener] can not send ack without a successful initWatch (lack of sessionInfo)"),[2]);case 1:return s.sent(),this.scheduleSendACK(),[3,3];case 2:if(o=s.sent(),iv(o))switch(i=o.payload,i.msgData.code){case"CHECK_LOGIN_FAILED":case"SIGN_EXPIRED_ERROR":case"SIGN_INVALID_ERROR":case"SIGN_PARAM_INVALID":return this.rebuildWatch(),[2];case"QUERYID_INVALID_ERROR":case"SYS_ERR":case"INVALIID_ENV":case"COLLECTION_PERMISSION_DENIED":return this.closeWithError(new Jt({errCode:Ct.SDK_DATABASE_REALTIME_LISTENER_CHECK_LAST_FAIL,errMsg:i.msgData.code})),[2];default:break}return this.availableRetries.CHECK_LAST&&this.availableRetries.CHECK_LAST>0?(this.availableRetries.CHECK_LAST-=1,this.scheduleSendACK()):this.closeWithError(new Jt({errCode:Ct.SDK_DATABASE_REALTIME_LISTENER_CHECK_LAST_FAIL,errMsg:o})),[3,3];case 3:return[2]}})})},this.handleCommonError=function(n,o){if(iv(n)){var i=n.payload;switch(i.msgData.code){case"CHECK_LOGIN_FAILED":case"SIGN_EXPIRED_ERROR":case"SIGN_INVALID_ERROR":case"SIGN_PARAM_INVALID":{o.onSignError(n);return}case"QUERYID_INVALID_ERROR":case"SYS_ERR":case"INVALIID_ENV":case"COLLECTION_PERMISSION_DENIED":{o.onNotRetryableError(n);return}default:{o.onNotRetryableError(n);return}}}else if(XT(n)){o.onTimeoutError(n);return}else if(eO(n)){o.onCancelledError(n);return}o.onUnknownError(n)},this.watchId="watchid_".concat(+new Date,"_").concat(Math.random()),this.envId=e.envId,this.collectionName=e.collectionName,this.query=e.query,this.limit=e.limit,this.orderBy=e.orderBy,this.send=e.send,this.login=e.login,this.isWSConnected=e.isWSConnected,this.onceWSConnected=e.onceWSConnected,this.getWaitExpectedTimeoutLength=e.getWaitExpectedTimeoutLength,this.onWatchStart=e.onWatchStart,this.onWatchClose=e.onWatchClose,this.debug=e.debug,this.availableRetries={INIT_WATCH:il,REBUILD_WATCH:il,CHECK_LAST:oW},this.listener=new zT({close:function(){r.closeWatch()},onChange:e.onChange,onError:e.onError,debug:this.debug,virtualClient:this}),this.initWatch()}return t.prototype.onMessage=function(e){var r=this;switch(this.watchStatus){case Ve.PAUSED:{if(e.msgType!=="ERROR")return;break}case Ve.LOGGINGIN:case Ve.INITING:case Ve.REBUILDING:{console.warn("[realtime listener] internal non-fatal error: unexpected message received while ".concat(this.watchStatus));return}case Ve.CLOSED:{console.warn("[realtime listener] internal non-fatal error: unexpected message received when the watch has closed");return}case Ve.ERRORED:{console.warn("[realtime listener] internal non-fatal error: unexpected message received when the watch has ended with error");return}}if(!this.sessionInfo){console.warn("[realtime listener] internal non-fatal error: sessionInfo not found while message is received.");return}switch(this.scheduleSendACK(),e.msgType){case"NEXT_EVENT":{console.warn("nextevent ".concat(e.msgData.currEvent," ignored"),e),this.handleServerEvents(e);break}case"CHECK_EVENT":{this.sessionInfo.currentEventId<e.msgData.currEvent&&(this.sessionInfo.expectEventId=e.msgData.currEvent,this.clearWaitExpectedEvent(),this.waitExpectedTimeoutId=setTimeout(function(){r.rebuildWatch()},this.getWaitExpectedTimeoutLength()),console.log("[realtime] waitExpectedTimeoutLength ".concat(this.getWaitExpectedTimeoutLength())));break}case"ERROR":{this.closeWithError(new Jt({errCode:Ct.SDK_DATABASE_REALTIME_LISTENER_SERVER_ERROR_MSG,errMsg:"".concat(e.msgData.code," - ").concat(e.msgData.message)}));break}default:{console.warn("[realtime listener] virtual client receive unexpected msg ".concat(e.msgType,": "),e);break}}},t.prototype.closeWithError=function(e){var r;this.watchStatus=Ve.ERRORED,this.clearACKSchedule(),this.listener.onError(e),this.onWatchClose(this,((r=this.sessionInfo)===null||r===void 0?void 0:r.queryID)||""),console.log("[realtime] client closed (".concat(this.collectionName," ").concat(this.query,") (watchId ").concat(this.watchId,")"))},t.prototype.pause=function(){this.watchStatus=Ve.PAUSED,console.log("[realtime] client paused (".concat(this.collectionName," ").concat(this.query,") (watchId ").concat(this.watchId,")"))},t.prototype.resume=function(){return yr(this,void 0,void 0,function(){var e;return or(this,function(r){switch(r.label){case 0:this.watchStatus=Ve.RESUMING,console.log("[realtime] client resuming with ".concat(this.sessionInfo?"REBUILD_WATCH":"INIT_WATCH"," (").concat(this.collectionName," ").concat(this.query,") (").concat(this.watchId,")")),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.sessionInfo?this.rebuildWatch():this.initWatch()];case 2:return r.sent(),console.log("[realtime] client successfully resumed (".concat(this.collectionName," ").concat(this.query,") (").concat(this.watchId,")")),[3,4];case 3:return e=r.sent(),console.error("[realtime] client resume failed (".concat(this.collectionName," ").concat(this.query,") (").concat(this.watchId,")"),e),[3,4];case 4:return[2]}})})},t.prototype.useRetryTicket=function(e){return this.availableRetries[e]&&this.availableRetries[e]>0?(this.availableRetries[e]-=1,console.log("[realtime] ".concat(e," use a retry ticket, now only ").concat(this.availableRetries[e]," retry left")),!0):!1},t.prototype.handleServerEvents=function(e){return yr(this,void 0,void 0,function(){var r;return or(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),this.scheduleSendACK(),[4,this.handleServerEventsInternel(e)];case 1:return n.sent(),this.postHandleServerEventsValidityCheck(e),[3,3];case 2:throw r=n.sent(),console.error("[realtime listener] internal non-fatal error: handle server events failed with error: ",r),r;case 3:return[2]}})})},t.prototype.handleServerEventsInternel=function(e){return yr(this,void 0,void 0,function(){var r,n,o,i,s,u,l,a,c,h,w,E;return or(this,function(T){switch(T.label){case 0:if(r=e.requestId,n=e.msgData.events,o=e.msgType,!n.length||!this.sessionInfo)return[2];i=this.sessionInfo;try{s=n.map(cW)}catch(A){return this.closeWithError(new Jt({errCode:Ct.SDK_DATABASE_REALTIME_LISTENER_RECEIVE_INVALID_SERVER_DATA,errMsg:A})),[2]}u=tO([],i.currentDocs,!0),l=!1,a=function(A,O){var C,P,q,U,k,W,Y,Y,V,V,Y,Z,Z,ae,ie,ue;return or(this,function(be){switch(be.label){case 0:return C=s[A],i.currentEventId>=C.id?(!s[A-1]||C.id>s[A-1].id?console.warn("[realtime] duplicate event received, cur ".concat(i.currentEventId," but got ").concat(C.id)):console.error("[realtime listener] server non-fatal error: events out of order (the latter event's id is smaller than that of the former) (requestId ".concat(r,")")),[2,"continue"]):[3,1];case 1:if(i.currentEventId!==C.id-1)return[3,2];switch(C.dataType){case"update":{if(!C.doc)switch(C.queueType){case"update":case"dequeue":{if(P=u.find(function(me){return me._id===C.docId}),P){if(q=(0,iO.default)(P),C.updatedFields&&Object.keys(C.updatedFields).forEach(function(me){(0,rO.default)(q,me,C.updatedFields[me])}),C.removedFields)for(U=0,k=C.removedFields;U<k.length;U++)W=k[U],(0,nO.default)(q,W);C.doc=q}else console.error("[realtime listener] internal non-fatal server error: unexpected update dataType event where no doc is associated.");break}case"enqueue":throw Y=new Jt({errCode:Ct.SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR,errMsg:'HandleServerEvents: full doc is not provided with dataType="update" and queueType="enqueue" (requestId '.concat(e.requestId,")")}),c.closeWithError(Y),Y;default:break}break}case"replace":{if(!C.doc)throw Y=new Jt({errCode:Ct.SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR,errMsg:'HandleServerEvents: full doc is not provided with dataType="replace" (requestId '.concat(e.requestId,")")}),c.closeWithError(Y),Y;break}case"remove":{V=u.find(function(me){return me._id===C.docId}),V?C.doc=V:console.error("[realtime listener] internal non-fatal server error: unexpected remove event where no doc is associated.");break}case"limit":{if(!C.doc)switch(C.queueType){case"dequeue":{V=u.find(function(me){return me._id===C.docId}),V?C.doc=V:console.error("[realtime listener] internal non-fatal server error: unexpected limit dataType event where no doc is associated.");break}case"enqueue":throw Y=new Jt({errCode:Ct.SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR,errMsg:'HandleServerEvents: full doc is not provided with dataType="limit" and queueType="enqueue" (requestId '.concat(e.requestId,")")}),c.closeWithError(Y),Y;default:break}break}}switch(C.queueType){case"init":{l?u.push(C.doc):(l=!0,u=[C.doc]);break}case"enqueue":{u.push(C.doc);break}case"dequeue":{Z=u.findIndex(function(me){return me._id===C.docId}),Z>-1?u.splice(Z,1):console.error("[realtime listener] internal non-fatal server error: unexpected dequeue event where no doc is associated.");break}case"update":{Z=u.findIndex(function(me){return me._id===C.docId}),Z>-1?u[Z]=C.doc:console.error("[realtime listener] internal non-fatal server error: unexpected queueType update event where no doc is associated.");break}}return(A===O-1||s[A+1]&&s[A+1].id!==C.id)&&(ae=tO([],u,!0),ie=s.slice(0,A+1).filter(function(me){return me.id===C.id}),c.sessionInfo.currentEventId=C.id,c.sessionInfo.currentDocs=u,ue=new nv({id:C.id,docChanges:ie,docs:ae,msgType:o}),c.listener.onChange(ue)),[3,4];case 2:return console.warn("[realtime listener] event received is out of order, cur ".concat(c.sessionInfo.currentEventId," but got ").concat(C.id)),[4,c.rebuildWatch()];case 3:return be.sent(),[2,{value:void 0}];case 4:return[2]}})},c=this,h=0,w=s.length,T.label=1;case 1:return h<w?[5,a(h,w)]:[3,4];case 2:if(E=T.sent(),typeof E=="object")return[2,E.value];T.label=3;case 3:return h++,[3,1];case 4:return[2]}})})},t.prototype.postHandleServerEventsValidityCheck=function(e){if(!this.sessionInfo){console.error("[realtime listener] internal non-fatal error: sessionInfo lost after server event handling, this should never occur");return}if(this.sessionInfo.expectEventId&&this.sessionInfo.currentEventId>=this.sessionInfo.expectEventId&&this.clearWaitExpectedEvent(),this.sessionInfo.currentEventId<e.msgData.currEvent){console.warn("[realtime listener] internal non-fatal error: client eventId does not match with server event id after server event handling");return}},t.prototype.clearWaitExpectedEvent=function(){this.waitExpectedTimeoutId&&(clearTimeout(this.waitExpectedTimeoutId),this.waitExpectedTimeoutId=void 0)},t})()});var av,_r,ol,sO=X(()=>{nl();av={1e3:{code:1e3,name:"Normal Closure",description:"Normal closure; the connection successfully completed whatever purpose for which it was created."},1001:{code:1001,name:"Going Away",description:"The endpoint is going away, either because of a server failure or because the browser is navigating away from the page that opened the connection."},1002:{code:1002,name:"Protocol Error",description:"The endpoint is terminating the connection due to a protocol error."},1003:{code:1003,name:"Unsupported Data",description:"The connection is being terminated because the endpoint received data of a type it cannot accept (for example, a text-only endpoint received binary data)."},1005:{code:1005,name:"No Status Received",description:"Indicates that no status code was provided even though one was expected."},1006:{code:1006,name:"Abnormal Closure",description:"Used to indicate that a connection was closed abnormally (that is, with no close frame being sent) when a status code is expected."},1007:{code:1007,name:"Invalid frame payload data",description:"The endpoint is terminating the connection because a message was received that contained inconsistent data (e.g., non-UTF-8 data within a text message)."},1008:{code:1008,name:"Policy Violation",description:"The endpoint is terminating the connection because it received a message that violates its policy. This is a generic status code, used when codes 1003 and 1009 are not suitable."},1009:{code:1009,name:"Message too big",description:"The endpoint is terminating the connection because a data frame was received that is too large."},1010:{code:1010,name:"Missing Extension",description:"The client is terminating the connection because it expected the server to negotiate one or more extension, but the server didn't."},1011:{code:1011,name:"Internal Error",description:"The server is terminating the connection because it encountered an unexpected condition that prevented it from fulfilling the request."},1012:{code:1012,name:"Service Restart",description:"The server is terminating the connection because it is restarting."},1013:{code:1013,name:"Try Again Later",description:"The server is terminating the connection due to a temporary condition, e.g. it is overloaded and is casting off some of its clients."},1014:{code:1014,name:"Bad Gateway",description:"The server was acting as a gateway or proxy and received an invalid response from the upstream server. This is similar to 502 HTTP Status Code."},1015:{code:1015,name:"TLS Handshake",description:"Indicates that the connection was closed due to a failure to perform a TLS handshake (e.g., the server certificate can't be verified)."},3e3:{code:3e3,name:"Reconnect WebSocket",description:"The client is terminating the connection because it wants to reconnect"},3001:{code:3001,name:"No Realtime Listeners",description:"The client is terminating the connection because no more realtime listeners exist"},3002:{code:3002,name:"Heartbeat Ping Error",description:"The client is terminating the connection due to its failure in sending heartbeat messages"},3003:{code:3003,name:"Heartbeat Pong Timeout Error",description:"The client is terminating the connection because no heartbeat response is received from the server"},3050:{code:3050,name:"Server Close",description:"The client is terminating the connection because no heartbeat response is received from the server"}};(function(t){t[t.NormalClosure=1e3]="NormalClosure",t[t.GoingAway=1001]="GoingAway",t[t.ProtocolError=1002]="ProtocolError",t[t.UnsupportedData=1003]="UnsupportedData",t[t.NoStatusReceived=1005]="NoStatusReceived",t[t.AbnormalClosure=1006]="AbnormalClosure",t[t.InvalidFramePayloadData=1007]="InvalidFramePayloadData",t[t.PolicyViolation=1008]="PolicyViolation",t[t.MessageTooBig=1009]="MessageTooBig",t[t.MissingExtension=1010]="MissingExtension",t[t.InternalError=1011]="InternalError",t[t.ServiceRestart=1012]="ServiceRestart",t[t.TryAgainLater=1013]="TryAgainLater",t[t.BadGateway=1014]="BadGateway",t[t.TLSHandshake=1015]="TLSHandshake",t[t.ReconnectWebSocket=3e3]="ReconnectWebSocket",t[t.NoRealtimeListeners=3001]="NoRealtimeListeners",t[t.HeartbeatPingError=3002]="HeartbeatPingError",t[t.HeartbeatPongTimeoutError=3003]="HeartbeatPongTimeoutError",t[t.NoAuthentication=3050]="NoAuthentication"})(_r||(_r={}));ol=function(t,e){var r=av[t],n=r?"".concat(r.name,", code ").concat(t,", reason ").concat(e||r.description):"code ".concat(t);return new Jt({errCode:Ct.SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_CLOSED,errMsg:n})}});function lO(){return uO}function fO(t){uO=t}function sv(){return cO}function hO(t){cO=t}var uO,cO,uv=X(()=>{uO=null,cO="web"});var al,Zr,en,cv,dO,lW,fW,hW,dW,pW,vW,mW,pO,vO=X(()=>{aO();rv();sO();nl();uv();ov();al=function(){return al=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},al.apply(this,arguments)},Zr=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},en=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},cv={CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3},dO=3,lW=5e3,fW=1e4,hW=5,dW=1e4,pW=2,vW=2,mW=5e3,pO=(function(){function t(e){var r=this;this.virtualWSClient=new Set,this.queryIdClientMap=new Map,this.watchIdClientMap=new Map,this.pingFailed=0,this.pongMissed=0,this.logins=new Map,this.wsReadySubsribers=[],this.wsResponseWait=new Map,this.rttObserved=[],this.send=function(n){return Zr(r,void 0,void 0,function(){var o=this;return en(this,function(i){return[2,new Promise(function(s,u){(function(){return Zr(o,void 0,void 0,function(){var l,a,c,h,w,E,T,A,O=this;return en(this,function(C){switch(C.label){case 0:a=!1,c=!1,h=function(P){a=!0,l&&clearTimeout(l),s(P)},w=function(P){c=!0,l&&clearTimeout(l),u(P)},n.timeout&&(l=setTimeout(function(){(function(){return Zr(O,void 0,void 0,function(){return en(this,function(P){switch(P.label){case 0:return!a||!c?[4,qs(0)]:[3,2];case 1:P.sent(),(!a||!c)&&w(new QT("wsclient.send timedout")),P.label=2;case 2:return[2]}})})})()},n.timeout)),C.label=1;case 1:return C.trys.push([1,8,,9]),this.wsInitPromise!==void 0||this.wsInitPromise!==null?[4,this.wsInitPromise]:[3,3];case 2:C.sent(),C.label=3;case 3:if(!this.ws)return w(new Error("invalid state: ws connection not exists, can not send message")),[2];if(this.ws.readyState!==cv.OPEN)return w(new Error("ws readyState invalid: ".concat(this.ws.readyState,", can not send message"))),[2];n.waitResponse&&(E={resolve:h,reject:w,skipOnMessage:n.skipOnMessage},this.wsResponseWait.set(n.msg.requestId,E)),C.label=4;case 4:return C.trys.push([4,6,,7]),[4,this.ws.send(JSON.stringify(n.msg))];case 5:return C.sent(),n.waitResponse||h(void 0),[3,7];case 6:return T=C.sent(),T&&(w(T),n.waitResponse&&this.wsResponseWait.delete(n.msg.requestId)),[3,7];case 7:return[3,9];case 8:return A=C.sent(),w(A),[3,9];case 9:return[2]}})})})()})]})})},this.closeAllClients=function(n){r.virtualWSClient.forEach(function(o){o.closeWithError(n)})},this.pauseClients=function(n){(n||r.virtualWSClient).forEach(function(o){o.pause()})},this.resumeClients=function(n){(n||r.virtualWSClient).forEach(function(o){o.resume()})},this.initWebSocketConnection=function(n,o){return o===void 0&&(o=r.maxReconnect),Zr(r,void 0,void 0,function(){var i,s=this;return en(this,function(u){switch(u.label){case 0:if(n&&this.reconnectState)return[2];if(n&&(this.reconnectState=!0),this.wsInitPromise!==void 0&&this.wsInitPromise!==null)return[2,this.wsInitPromise];n&&this.pauseClients(),this.close(_r.ReconnectWebSocket),this.wsInitPromise=new Promise(function(l,a){(function(){return Zr(s,void 0,void 0,function(){var c,h,w,E=this;return en(this,function(T){switch(T.label){case 0:return T.trys.push([0,6,,11]),[4,this.getWsSign()];case 1:return c=T.sent(),[4,new Promise(function(A){var O=c.wsUrl||"wss://tcb-ws.tencentcloudapi.com",C=lO();E.ws=C?new C(O):new WebSocket(O),A(void 0)})];case 2:return T.sent(),this.ws.connect?[4,this.ws.connect()]:[3,4];case 3:T.sent(),T.label=4;case 4:return[4,this.initWebSocketEvent()];case 5:return T.sent(),l(),n&&(this.resumeClients(),this.reconnectState=!1),[3,11];case 6:return h=T.sent(),console.error("[realtime] initWebSocketConnection connect fail",h),o>0?(w=!0,this.wsInitPromise=void 0,w?[4,qs(this.reconnectInterval)]:[3,8]):[3,9];case 7:T.sent(),n&&(this.reconnectState=!1),T.label=8;case 8:return l(this.initWebSocketConnection(n,o-1)),[3,10];case 9:a(h),n&&this.closeAllClients(new Jt({errCode:Ct.SDK_DATABASE_REALTIME_LISTENER_RECONNECT_WATCH_FAIL,errMsg:h})),T.label=10;case 10:return[3,11];case 11:return[2]}})})})()}),u.label=1;case 1:return u.trys.push([1,3,4,5]),[4,this.wsInitPromise];case 2:return u.sent(),this.wsReadySubsribers.forEach(function(l){var a=l.resolve;return a()}),[3,5];case 3:return i=u.sent(),this.wsReadySubsribers.forEach(function(l){var a=l.reject;return a()}),[3,5];case 4:return this.wsInitPromise=void 0,this.wsReadySubsribers=[],[7];case 5:return[2]}})})},this.initWebSocketEvent=function(){return new Promise(function(n,o){if(!r.ws)throw new Error("can not initWebSocketEvent, ws not exists");var i=!1;r.ws.onopen=function(s){console.warn("[realtime] ws event: open",s),i=!0,n()},r.ws.onerror=function(s){r.logins=new Map,i?(console.error("[realtime] ws event: error",s),r.clearHeartbeat(),r.virtualWSClient.forEach(function(u){return u.closeWithError(new Jt({errCode:Ct.SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_ERROR,errMsg:s}))})):(console.error("[realtime] ws open failed with ws event: error",s),o(s))},r.ws.onclose=function(s){switch(console.warn("[realtime] ws event: close",s),r.logins=new Map,r.clearHeartbeat(),s.code){case _r.ReconnectWebSocket:break;case _r.NoRealtimeListeners:break;case _r.HeartbeatPingError:case _r.HeartbeatPongTimeoutError:case _r.NormalClosure:case _r.AbnormalClosure:{r.maxReconnect>0?r.initWebSocketConnection(!0,r.maxReconnect):r.closeAllClients(ol(s.code));break}case _r.NoAuthentication:{r.closeAllClients(ol(s.code,s.reason));break}default:r.maxReconnect>0?r.initWebSocketConnection(!0,r.maxReconnect):r.closeAllClients(ol(s.code))}},r.ws.onmessage=function(s){var u,l=((u=s.data)===null||u===void 0?void 0:u.data)||s.data;r.heartbeat();var a;try{a=typeof l=="string"?JSON.parse(l):l}catch(P){throw new Error("[realtime] onMessage parse res.data error: ".concat(P))}if(a.msgType==="ERROR"){var c=null;r.virtualWSClient.forEach(function(P){P.watchId===a.watchId&&(c=P)}),c&&c.listener.onError(a)}var h=r.wsResponseWait.get(a.requestId);if(h){try{a.msgType==="ERROR"?h.reject(new JT(a)):h.resolve(a)}catch(P){console.error("ws onMessage responseWaitSpec.resolve(msg) errored:",P)}finally{r.wsResponseWait.delete(a.requestId)}if(h.skipOnMessage)return}if(a.msgType==="PONG"){if(r.lastPingSendTS){var w=Date.now()-r.lastPingSendTS;if(w>fW){console.warn("[realtime] untrusted rtt observed: ".concat(w));return}r.rttObserved.length>=dO&&r.rttObserved.splice(0,r.rttObserved.length-dO+1),r.rttObserved.push(w)}return}var E=a.watchId&&r.watchIdClientMap.get(a.watchId);if(E)E.onMessage(a);else switch(console.error("[realtime] no realtime listener found responsible for watchId ".concat(a.watchId,": "),a),a.msgType){case"INIT_EVENT":case"NEXT_EVENT":case"CHECK_EVENT":{E=r.queryIdClientMap.get(a.msgData.queryID),E&&E.onMessage(a);break}default:for(var T=0,A=Array.from(r.watchIdClientMap.entries());T<A.length;T++){var O=A[T],C=O[1];C.onMessage(a);break}}},r.heartbeat()})},this.isWSConnected=function(){return!!(r.ws&&r.ws.readyState===cv.OPEN)},this.onceWSConnected=function(){return Zr(r,void 0,void 0,function(){var n=this;return en(this,function(o){return this.isWSConnected()?[2]:this.wsInitPromise!==null&&this.wsInitPromise!==void 0?[2,this.wsInitPromise]:[2,new Promise(function(i,s){n.wsReadySubsribers.push({resolve:i,reject:s})})]})})},this.webLogin=function(n,o){return Zr(r,void 0,void 0,function(){var i,s,u,l,a,c,h,w,E=this;return en(this,function(T){switch(T.label){case 0:if(!o){if(n){if(i=this.logins.get(n),i){if(i.loggedIn&&i.loginResult)return[2,i.loginResult];if(i.loggingInPromise!==null&&i.loggingInPromise!==void 0)return[2,i.loggingInPromise]}}else if(s=this.logins.get(""),s?.loggingInPromise!==null&&s?.loggingInPromise!==void 0)return[2,s.loggingInPromise]}u=new Promise(function(A,O){(function(){return Zr(E,void 0,void 0,function(){var C,P,q,U,k;return en(this,function(W){switch(W.label){case 0:return W.trys.push([0,3,,4]),[4,this.getWsSign()];case 1:return C=W.sent(),P={envId:C.envId||"",accessToken:"",referrer:"web",sdkVersion:"",dataVersion:""},q={watchId:void 0,requestId:mi(),msgType:"LOGIN",msgData:P,exMsgData:{runtime:sv(),signStr:C.signStr,secretVersion:C.secretVersion}},[4,this.send({msg:q,waitResponse:!0,skipOnMessage:!0,timeout:mW})];case 2:return U=W.sent(),U.msgData.code?O(new Error("".concat(U.msgData.code," ").concat(U.msgData.message))):A({envId:C.envId}),[3,4];case 3:return k=W.sent(),O(k),[3,4];case 4:return[2]}})})})()}),l=n&&this.logins.get(n),a=Date.now(),l?(l.loggedIn=!1,l.loggingInPromise=u,l.loginStartTS=a):(l={loggedIn:!1,loggingInPromise:u,loginStartTS:a},this.logins.set(n||"",l)),T.label=1;case 1:return T.trys.push([1,3,,4]),[4,u];case 2:if(c=T.sent(),h=n&&this.logins.get(n),h&&h===l&&h.loginStartTS===a)return l.loggedIn=!0,l.loggingInPromise=void 0,l.loginStartTS=void 0,l.loginResult=c,[2,c];if(h){if(h.loggedIn&&h.loginResult)return[2,h.loginResult];if(h.loggingInPromise!==null&&h.loggingInPromise!==void 0)return[2,h.loggingInPromise];throw new Error("ws unexpected login info")}else throw new Error("ws login info reset");return[3,4];case 3:throw w=T.sent(),l.loggedIn=!1,l.loggingInPromise=void 0,l.loginStartTS=void 0,l.loginResult=void 0,w;case 4:return[2]}})})},this.getWsSign=function(){return Zr(r,void 0,void 0,function(){var n,o,i,s,u,l,a;return en(this,function(c){switch(c.label){case 0:return this.wsSign&&this.wsSign.expiredTs>Date.now()?[2,this.wsSign]:(n=Date.now()+6e4,[4,this.context.appConfig.request.send("auth.wsWebSign",{runtime:sv()})]);case 1:if(o=c.sent(),o.code)throw new Error("[tcb-js-sdk] \u83B7\u53D6\u5B9E\u65F6\u6570\u636E\u63A8\u9001\u767B\u5F55\u7968\u636E\u5931\u8D25: ".concat(o.code));if(o.data)return i=o.data,s=i.signStr,u=i.wsUrl,l=i.secretVersion,a=i.envId,[2,{signStr:s,wsUrl:u,secretVersion:l,envId:a,expiredTs:n}];throw new Error("[tcb-js-sdk] \u83B7\u53D6\u5B9E\u65F6\u6570\u636E\u63A8\u9001\u767B\u5F55\u7968\u636E\u5931\u8D25")}})})},this.getWaitExpectedTimeoutLength=function(){return r.rttObserved.length?r.rttObserved.reduce(function(n,o){return n+o})/r.rttObserved.length*1.5:lW},this.ping=function(){return Zr(r,void 0,void 0,function(){var n;return en(this,function(o){switch(o.label){case 0:return n={watchId:void 0,requestId:mi(),msgType:"PING",msgData:null},[4,this.send({msg:n})];case 1:return o.sent(),[2]}})})},this.onWatchStart=function(n,o){r.queryIdClientMap.set(o,n)},this.onWatchClose=function(n,o){o&&r.queryIdClientMap.delete(o),r.watchIdClientMap.delete(n.watchId),r.virtualWSClient.delete(n),r.virtualWSClient.size||r.close(_r.NoRealtimeListeners)},this.maxReconnect=e.maxReconnect||hW,this.reconnectInterval=e.reconnectInterval||dW,this.context=e.context}return t.prototype.clearHeartbeat=function(){this.pingTimeoutId&&clearTimeout(this.pingTimeoutId),this.pongTimeoutId&&clearTimeout(this.pongTimeoutId)},t.prototype.close=function(e){this.clearHeartbeat(),this.ws&&(this.ws.close(e,av[e].name),this.ws=void 0)},t.prototype.watch=function(e){!this.ws&&(this.wsInitPromise===void 0||this.wsInitPromise===null)&&this.initWebSocketConnection(!1);var r=new oO(al(al({},e),{send:this.send,login:this.webLogin,isWSConnected:this.isWSConnected,onceWSConnected:this.onceWSConnected,getWaitExpectedTimeoutLength:this.getWaitExpectedTimeoutLength,onWatchStart:this.onWatchStart,onWatchClose:this.onWatchClose,debug:!0}));return this.virtualWSClient.add(r),this.watchIdClientMap.set(r.watchId,r),r.listener},t.prototype.heartbeat=function(e){var r=this;this.clearHeartbeat(),this.pingTimeoutId=setTimeout(function(){(function(){return Zr(r,void 0,void 0,function(){var n,o=this;return en(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),!this.ws||this.ws.readyState!==cv.OPEN?[2]:(this.lastPingSendTS=Date.now(),[4,this.ping()]);case 1:return i.sent(),this.pingFailed=0,this.pongTimeoutId=setTimeout(function(){console.error("pong timed out"),o.pongMissed<vW?(o.pongMissed+=1,o.heartbeat(!0)):o.initWebSocketConnection(!0)},this.context.appConfig.realtimePongWaitTimeout),[3,3];case 2:return n=i.sent(),this.pingFailed<pW?(this.pingFailed+=1,this.heartbeat()):this.close(_r.HeartbeatPingError),[3,3];case 3:return[2]}})})})()},e?0:this.context.appConfig.realtimePingInterval)},t})()});function yO(t){try{t.registerComponent(gO),t.registerHook(mO)}catch(e){console.warn(e)}}var mO,gO,_O=X(()=>{vO();uv();mO={target:"database",entity:function(){var t=this.platform,e=t.adapter,r=t.runtime;fO(e.wsClass),hO(r)}},gO={name:"realtime",IIFE:!0,entity:function(){this.prototype.wsClientClass=pO}};try{cloudbase.registerComponent(gO),cloudbase.registerHook(mO)}catch{}});function IW(t){if(Object.prototype.toString.call(t).slice(8,-1)!=="Object")return!1;var e=t.report_data,r=t.report_type;return!(SW.includes(r)===!1||Object.prototype.toString.call(e).slice(8,-1)!=="Object"||e.action_time!==void 0&&!Number.isInteger(e.action_time)||typeof e.action_type!="string")}function EO(t){try{t.registerComponent(bO)}catch(e){console.warn(e)}}var gW,lv,yW,_W,wW,bW,EW,wO,SW,TW,OW,bO,SO=X(()=>{Lt();gW=function(t,e,r,n){var o=arguments.length,i=o<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(s=t[u])&&(i=(o<3?s(i):o>3?s(e,r,i):s(e,r))||i);return o>3&&i&&Object.defineProperty(e,r,i),i},lv=function(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)},yW=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},_W=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},wW=Ge.ERRORS,bW=Ge.COMMUNITY_SITE_URL,EW=hn.catchErrorsDecorator,wO="analytics",SW=["mall"];TW=(function(){function t(){}return t.prototype.analytics=function(e){return yW(this,void 0,void 0,function(){var r,n,o,i,s;return _W(this,function(u){if(!IW(e))throw new Error(JSON.stringify({code:wW.INVALID_PARAMS,msg:"[".concat(wO,".analytics] invalid report data")}));return r="analytics.report",n=e.report_data.action_time===void 0?Math.floor(Date.now()/1e3):e.report_data.action_time,o={analytics_scene:e.report_type,analytics_data:Object.assign({},e.report_data,{action_time:n})},i={requestData:o},s=this.request,s.send(r,i),[2]})})},gW([EW({customInfo:{className:"Cloudbase",methodName:"analytics"},title:"\u4E0A\u62A5\u8C03\u7528\u5931\u8D25",messages:["\u8BF7\u786E\u8BA4\u4EE5\u4E0B\u5404\u9879\uFF1A","  1 - \u8C03\u7528 analytics() \u7684\u8BED\u6CD5\u6216\u53C2\u6570\u662F\u5426\u6B63\u786E","\u5982\u679C\u95EE\u9898\u4F9D\u7136\u5B58\u5728\uFF0C\u5EFA\u8BAE\u5230\u5B98\u65B9\u95EE\u7B54\u793E\u533A\u63D0\u95EE\u6216\u5BFB\u627E\u5E2E\u52A9\uFF1A".concat(bW)]}),lv("design:type",Function),lv("design:paramtypes",[Object]),lv("design:returntype",Promise)],t.prototype,"analytics",null),t})(),OW=new TW,bO={name:wO,entity:{analytics:OW.analytics}};try{cloudbase.registerComponent(bO)}catch{}});var Fs=K((sl,IO)=>{(function(t,e){typeof sl=="object"&&typeof IO<"u"?e(sl):typeof define=="function"&&define.amd?define(["exports"],e):(t=typeof globalThis<"u"?globalThis:t||self,e(t.wxCloudClientSDK={}))})(sl,(function(t){"use strict";var e=function(f,v){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,g){m.__proto__=g}||function(m,g){for(var I in g)Object.prototype.hasOwnProperty.call(g,I)&&(m[I]=g[I])},e(f,v)};function r(f,v){if(typeof v!="function"&&v!==null)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");e(f,v);function m(){this.constructor=f}f.prototype=v===null?Object.create(v):(m.prototype=v.prototype,new m)}var n=function(){return n=Object.assign||function(v){for(var m,g=1,I=arguments.length;g<I;g++){m=arguments[g];for(var x in m)Object.prototype.hasOwnProperty.call(m,x)&&(v[x]=m[x])}return v},n.apply(this,arguments)};function o(f,v,m,g){function I(x){return x instanceof m?x:new m(function(D){D(x)})}return new(m||(m=Promise))(function(x,D){function G(J){try{z(g.next(J))}catch(j){D(j)}}function H(J){try{z(g.throw(J))}catch(j){D(j)}}function z(J){J.done?x(J.value):I(J.value).then(G,H)}z((g=g.apply(f,[])).next())})}function i(f,v){var m={label:0,sent:function(){if(x[0]&1)throw x[1];return x[1]},trys:[],ops:[]},g,I,x,D;return D={next:G(0),throw:G(1),return:G(2)},typeof Symbol=="function"&&(D[Symbol.iterator]=function(){return this}),D;function G(z){return function(J){return H([z,J])}}function H(z){if(g)throw new TypeError("Generator is already executing.");for(;m;)try{if(g=1,I&&(x=z[0]&2?I.return:z[0]?I.throw||((x=I.return)&&x.call(I),0):I.next)&&!(x=x.call(I,z[1])).done)return x;switch(I=0,x&&(z=[z[0]&2,x.value]),z[0]){case 0:case 1:x=z;break;case 4:return m.label++,{value:z[1],done:!1};case 5:m.label++,I=z[1],z=[0];continue;case 7:z=m.ops.pop(),m.trys.pop();continue;default:if(x=m.trys,!(x=x.length>0&&x[x.length-1])&&(z[0]===6||z[0]===2)){m=0;continue}if(z[0]===3&&(!x||z[1]>x[0]&&z[1]<x[3])){m.label=z[1];break}if(z[0]===6&&m.label<x[1]){m.label=x[1],x=z;break}if(x&&m.label<x[2]){m.label=x[2],m.ops.push(z);break}x[2]&&m.ops.pop(),m.trys.pop();continue}z=v.call(f,m)}catch(J){z=[6,J],I=0}finally{g=x=0}if(z[0]&5)throw z[1];return{value:z[0]?z[1]:void 0,done:!0}}}var s=(function(f){r(v,f);function v(m,g){var I=f.call(this,m)||this;return I.name="WxCloudSDKError",I.code=g?.code,I.requestId=g?.requestId,I.originError=g?.originError,I}return v})(Error);function u(){return typeof window<"u"&&window||typeof globalThis<"u"&&globalThis}function l(){try{var f=u();return f?typeof wx>"u"?u().location.href:f.__wxRoute:void 0}catch{}}function a(){var f=u();if(f?.navigator)return f.navigator.userAgent;if(typeof wx<"u"&&wx.getSystemInfo){var v;return wx.getSystemInfo({success:function(m){m&&(v=["brand","model","version","system","platform","SDKVersion","language"].map(function(g){return"".concat(g,": ").concat(m[g])}).join(", "))}}),v}}var c="1.7.2",h=function(f){var v=f.dataSourceName,m=f.methodName,g=f.params,I=f.realMethodName,x=f.callFunction,D=f.envType,G=D===void 0?"prod":D,H=f.mode;return o(void 0,void 0,void 0,function(){var z,J,j,te,ce,oe;return i(this,function(Re){switch(Re.label){case 0:z={data:{},requestId:""},Re.label=1;case 1:return Re.trys.push([1,3,,4]),[4,x({name:"lowcode-datasource",data:{dataSourceName:v,methodName:m,params:g,userAgent:a(),referrer:l(),"x-sdk-version":c,envType:G,mode:H}})];case 2:if(J=Re.sent(),j=((ce=J?.result)===null||ce===void 0?void 0:ce.requestId)||J?.requestId||J?.requestID,J?.result.code)throw new s("\u3010\u9519\u8BEF\u3011".concat(J?.result.message,`
\u3010\u64CD\u4F5C\u3011\u8C03\u7528 models.`).concat(v?"".concat(v,"."):"").concat(I,`
\u3010\u9519\u8BEF\u7801\u3011`).concat(J?.result.code,`
\u3010\u8BF7\u6C42ID\u3011`).concat(j||"N/A"),{code:J?.result.code,requestId:j});return z.data=((oe=J?.result)===null||oe===void 0?void 0:oe.data)||{},z.requestId=j,[3,4];case 3:throw te=Re.sent(),te.name==="WxCloudSDKError"?te:(console.log(te),new s("\u3010\u9519\u8BEF\u3011".concat(te.message,`
      \u3010\u64CD\u4F5C\u3011\u8C03\u7528 models.`).concat(v?"".concat(v,"."):"").concat(I,`
      \u3010\u8BF7\u6C42ID\u3011N/A`),{code:"UnknownError",originError:te}));case 4:return[2,z]}})})},w=function(f){var v=f.sql,m=f.params,g=f.config,I=f.callFunction,x=f.unsafe,D=x===void 0?!1:x;return o(void 0,void 0,void 0,function(){return i(this,function(G){return[2,h({realMethodName:"$runSQL",methodName:"callWedaApi",params:{action:"RunMysqlCommand",data:{sqlTemplate:v,config:g,parameter:D?"":Object.entries(m||{}).reduce(function(H,z){var J=z[0],j=z[1];if(j!==void 0){var te="OBJECT",ce=typeof j;switch(ce){case"boolean":{te="BOOLEAN";break}case"number":{te="NUMBER";break}case"string":{te="STRING";break}default:Array.isArray(j)?te="ARRAY":te="OBJECT"}H.push({key:J,type:te,value:te==="STRING"?j:JSON.stringify(j)})}return H},[])||[]}},callFunction:I,mode:"sdk"})]})})},E=function(f){return{$runSQL:function(v,m,g){return o(this,void 0,void 0,function(){var I;return i(this,function(x){switch(x.label){case 0:return[4,w({sql:v,params:m,config:n(n({},g),{preparedStatements:!0}),callFunction:f})];case 1:return I=x.sent(),[2,I]}})})},$runSQLRaw:function(v,m){return o(this,void 0,void 0,function(){var g;return i(this,function(I){switch(I.label){case 0:return[4,w({sql:v,params:[],config:n(n({},m),{preparedStatements:!1}),callFunction:f})];case 1:return g=I.sent(),[2,g]}})})}}},T={filter:{where:{}},select:{$master:!0}};function A(f){return{getUrl:function(v){return"".concat(v,"/").concat(f)},method:"post"}}var O={get:n(n({},A("get")),{defaultParams:n({},T)}),list:n(n({},A("list")),{defaultParams:n({},T)}),create:A("create"),createMany:A("createMany"),update:n(n({},A("update")),{method:"put"}),updateMany:n(n({},A("updateMany")),{method:"put"}),upsert:A("upsert"),delete:A("delete"),deleteMany:A("deleteMany")},C="Unknown error occurred",P="NotSupported",q=function(f,v,m,g){var I=E(f);return new Proxy({},{get:function(x,D){if(typeof D=="string")return Object.prototype.hasOwnProperty.call(I,D)?I[D]:k(m,D,v,g)}})},U=function(f,v,m,g,I){return new s("\u3010\u9519\u8BEF\u3011".concat(f,`
\u3010\u64CD\u4F5C\u3011\u8C03\u7528 models.`).concat(v,".").concat(m,`
\u3010\u9519\u8BEF\u7801\u3011`).concat(g,`
\u3010\u8BF7\u6C42ID\u3011`).concat(I),{code:g,requestId:I})},k=function(f,v,m,g){var I=new Proxy({},{get:function(x,D){if(D!=="runSQLTemplate"){var G=O[D];if(!G){var H=new Error("\u4E0D\u652F\u6301\u7684\u64CD\u4F5C: ".concat(D));throw new s(H.message||C,{originError:H,code:P,requestId:"N/A"})}return function(z){return z===void 0&&(z={}),o(void 0,void 0,void 0,function(){var J,j,te,ce,oe,Re,we,Oe,wt,zr;return i(this,function(Gt){switch(Gt.label){case 0:J=G.getUrl,j=G.method,te=G.defaultParams,ce=te===void 0?{}:te,oe=Object.assign({},ce,z),Re=oe.envType==="pre"?"pre":"prod",we=[f,Re,J(v)].join("/"),Gt.label=1;case 1:return Gt.trys.push([1,3,,4]),[4,m({url:we,body:JSON.stringify(oe),method:j})];case 2:if(Oe=Gt.sent(),Oe.code)throw U(Oe?.message,v,D,Oe?.code,Oe?.requestId);return D==="get"&&Object.assign(Oe,{data:(zr=Oe.data.record)!==null&&zr!==void 0?zr:Oe.data}),[2,Oe];case 3:throw wt=Gt.sent(),new s(wt?.message||C,{originError:wt});case 4:return[2]}})})}}else{if(!g?.sqlBaseUrl){var H=new Error("\u4E0D\u652F\u6301\u7684\u64CD\u4F5C: ".concat(D));throw new s(H.message||C,{originError:H,code:P,requestId:"N/A"})}return function(z){return o(void 0,void 0,void 0,function(){var J,j,te,ce,oe,Re,we,Oe,wt,zr,Gt,Lu,gh,yh,_h,wh;return i(this,function(ja){switch(ja.label){case 0:J=z.params,j=z.templateName,te=z.envType,ce=te==="pre"?"pre":"prod",oe=[g.sqlBaseUrl,ce,j,"run"].join("/"),Re=Object.entries(J||{}).reduce(function(dy,py){var YU=py[0],Ma=py[1];if(Ma!==void 0){var Ri="OBJECT",JU=typeof Ma;switch(JU){case"boolean":{Ri="BOOLEAN";break}case"number":{Ri="NUMBER";break}case"string":{Ri="STRING";break}default:Array.isArray(Ma)?Ri="ARRAY":Ri="OBJECT"}dy.push({key:YU,type:Ri,value:Ri==="STRING"?Ma:JSON.stringify(Ma)})}return dy},[]),ja.label=1;case 1:return ja.trys.push([1,3,,4]),[4,m({url:oe,body:JSON.stringify({parameter:Re}),method:"POST"})];case 2:if(we=ja.sent(),!((wt=we?.Response)===null||wt===void 0)&&wt.Error)throw U((Gt=(zr=we?.Response)===null||zr===void 0?void 0:zr.Error)===null||Gt===void 0?void 0:Gt.Message,v,D,(gh=(Lu=we?.Response)===null||Lu===void 0?void 0:Lu.Error)===null||gh===void 0?void 0:gh.Code,(yh=we?.Response)===null||yh===void 0?void 0:yh.RequestId);return[2,n(n({},(_h=we?.Response)!==null&&_h!==void 0?_h:{}),{data:(wh=we?.Response)===null||wh===void 0?void 0:wh.Data})];case 3:throw Oe=ja.sent(),new s(Oe?.message||C,{originError:Oe});case 4:return[2]}})})}}}});return I},W={create:{methodName:"wedaCreateV2"},createMany:{methodName:"wedaBatchCreateV2"},update:{methodName:"wedaUpdateV2"},upsert:{methodName:"wedaUpsertV2"},updateMany:{methodName:"wedaBatchUpdateV2"},delete:{methodName:"wedaDeleteV2"},deleteMany:{methodName:"wedaBatchDeleteV2"},get:{methodName:"wedaGetItemV2",defaultParams:{filter:{where:{}},select:{$master:!0}}},list:{methodName:"wedaGetRecordsV2",defaultParams:{filter:{where:{}},select:{$master:!0}}}},V=function(f,v){var m=new Proxy({},{get:function(g,I){var x=W[I];if(!x){var D=new Error("\u4E0D\u652F\u6301\u7684\u64CD\u4F5C: ".concat(I));throw new s(D.message||"Unknown error occurred",{originError:D,code:"NotSupported",requestId:"N/A"})}return function(G){return o(void 0,void 0,void 0,function(){var H,z,J,j,te;return i(this,function(ce){switch(ce.label){case 0:return H=n(n({},x.defaultParams||{}),G||{}),[4,h({callFunction:v,dataSourceName:f,methodName:x.methodName,realMethodName:I,params:H,envType:G?.envType})];case 1:return z=ce.sent(),J={data:{}},j=x.responseKey,J.data=j?(te=z?.data)===null||te===void 0?void 0:te[j]:z?.data,[2,J]}})})}}});return m},Y=function(f){var v=E(f);return new Proxy({},{get:function(m,g){if(typeof g=="string")return Object.prototype.hasOwnProperty.call(v,g)?v[g]:V(g,f)}})},Z=(function(){function f(v){var m=this;this.map=new Map,v&&(v instanceof Headers?v.forEach(function(g,I){m.append(I,g)}):Array.isArray(v)?v.forEach(function(g){var I=g[0],x=g[1];m.append(I,x)}):typeof v=="object"&&Object.keys(v).forEach(function(g){m.append(g,v[g])}))}return f.prototype.append=function(v,m){var g=v.toLowerCase(),I=this.map.get(g);I?this.map.set(g,"".concat(I,", ").concat(m)):this.map.set(g,String(m))},f.prototype.delete=function(v){this.map.delete(v.toLowerCase())},f.prototype.forEach=function(v,m){var g=this;this.map.forEach(function(I,x){v.call(m,I,x,g)})},f.prototype.get=function(v){return this.map.get(v.toLowerCase())||null},f.prototype.has=function(v){return this.map.has(v.toLowerCase())},f.prototype.set=function(v,m){this.map.set(v.toLowerCase(),String(m))},f.prototype.entries=function(){return this.map.entries()},f.prototype.keys=function(){return this.map.keys()},f.prototype.values=function(){return this.map.values()},f.prototype.getSetCookie=function(){var v=[];return this.map.forEach(function(m,g){g==="set-cookie"&&v.push(m)}),v},f.prototype.toJSON=function(){var v={};return this.map.forEach(function(m,g){v[g]=m}),v},f.prototype[Symbol.iterator]=function(){return this.entries()},f})();typeof globalThis=="object"&&!globalThis.Headers&&(globalThis.Headers=Z);var ae=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ie(f){return f&&f.__esModule&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f}var ue=function(f){try{return!!f()}catch{return!0}},be=ue,me=!be(function(){var f=(function(){}).bind();return typeof f!="function"||f.hasOwnProperty("prototype")}),Ot=me,Pt=Function.prototype,F=Pt.call,d=Ot&&Pt.bind.bind(F,F),p=Ot?d:function(f){return function(){return F.apply(f,arguments)}},y=p,S=y({}.toString),L=y("".slice),B=function(f){return L(S(f),8,-1)},$=p,Q=ue,se=B,Ie=Object,Ae=$("".split),Te=Q(function(){return!Ie("z").propertyIsEnumerable(0)})?function(f){return se(f)==="String"?Ae(f,""):Ie(f)}:Ie,Ce=function(f){return f==null},Fe=Ce,je=TypeError,et=function(f){if(Fe(f))throw new je("Can't call method on "+f);return f},Er=Te,R=et,_=function(f){return Er(R(f))},b={},N=function(f){return f&&f.Math===Math&&f},M=N(typeof globalThis=="object"&&globalThis)||N(typeof window=="object"&&window)||N(typeof self=="object"&&self)||N(typeof ae=="object"&&ae)||N(typeof ae=="object"&&ae)||(function(){return this})()||Function("return this")(),re=typeof document=="object"&&document.all,ee=typeof re>"u"&&re!==void 0?function(f){return typeof f=="function"||f===re}:function(f){return typeof f=="function"},Le=M,We=ee,He=Le.WeakMap,_t=We(He)&&/native code/.test(String(He)),Xe=ee,Sr=function(f){return typeof f=="object"?f!==null:Xe(f)},tu=ue,xt=!tu(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),Si={},T2=M,S0=Sr,Yl=T2.document,O2=S0(Yl)&&S0(Yl.createElement),I0=function(f){return O2?Yl.createElement(f):{}},A2=xt,R2=ue,C2=I0,T0=!A2&&!R2(function(){return Object.defineProperty(C2("div"),"a",{get:function(){return 7}}).a!==7}),P2=xt,x2=ue,O0=P2&&x2(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),N2=Sr,L2=String,D2=TypeError,Ii=function(f){if(N2(f))return f;throw new D2(L2(f)+" is not an object")},U2=me,ru=Function.prototype.call,Ln=U2?ru.bind(ru):function(){return ru.apply(ru,arguments)},Jl={},Ql=Jl,Xl=M,B2=ee,A0=function(f){return B2(f)?f:void 0},po=function(f,v){return arguments.length<2?A0(Ql[f])||A0(Xl[f]):Ql[f]&&Ql[f][v]||Xl[f]&&Xl[f][v]},q2=p,R0=q2({}.isPrototypeOf),F2=M,C0=F2.navigator,P0=C0&&C0.userAgent,j2=P0?String(P0):"",x0=M,Zl=j2,N0=x0.process,L0=x0.Deno,D0=N0&&N0.versions||L0&&L0.version,U0=D0&&D0.v8,Wr,nu;U0&&(Wr=U0.split("."),nu=Wr[0]>0&&Wr[0]<4?1:+(Wr[0]+Wr[1])),!nu&&Zl&&(Wr=Zl.match(/Edge\/(\d+)/),(!Wr||Wr[1]>=74)&&(Wr=Zl.match(/Chrome\/(\d+)/),Wr&&(nu=+Wr[1])));var M2=nu,B0=M2,k2=ue,$2=M,W2=$2.String,q0=!!Object.getOwnPropertySymbols&&!k2(function(){var f=Symbol("symbol detection");return!W2(f)||!(Object(f)instanceof Symbol)||!Symbol.sham&&B0&&B0<41}),H2=q0,F0=H2&&!Symbol.sham&&typeof Symbol.iterator=="symbol",G2=po,V2=ee,z2=R0,K2=F0,Y2=Object,j0=K2?function(f){return typeof f=="symbol"}:function(f){var v=G2("Symbol");return V2(v)&&z2(v.prototype,Y2(f))},J2=String,M0=function(f){try{return J2(f)}catch{return"Object"}},Q2=ee,X2=M0,Z2=TypeError,ef=function(f){if(Q2(f))return f;throw new Z2(X2(f)+" is not a function")},eC=ef,tC=Ce,tf=function(f,v){var m=f[v];return tC(m)?void 0:eC(m)},rf=Ln,nf=ee,of=Sr,rC=TypeError,nC=function(f,v){var m,g;if(v==="string"&&nf(m=f.toString)&&!of(g=rf(m,f))||nf(m=f.valueOf)&&!of(g=rf(m,f))||v!=="string"&&nf(m=f.toString)&&!of(g=rf(m,f)))return g;throw new rC("Can't convert object to primitive value")},k0={exports:{}},iC=!0,$0=M,oC=Object.defineProperty,aC=function(f,v){try{oC($0,f,{value:v,configurable:!0,writable:!0})}catch{$0[f]=v}return v},sC=M,uC=aC,W0="__core-js_shared__",H0=k0.exports=sC[W0]||uC(W0,{});(H0.versions||(H0.versions=[])).push({version:"3.45.0",mode:"pure",copyright:"\xA9 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.45.0/LICENSE",source:"https://github.com/zloirock/core-js"});var af=k0.exports,G0=af,V0=function(f,v){return G0[f]||(G0[f]=v||{})},cC=et,lC=Object,iu=function(f){return lC(cC(f))},fC=p,hC=iu,dC=fC({}.hasOwnProperty),un=Object.hasOwn||function(v,m){return dC(hC(v),m)},pC=p,vC=0,mC=Math.random(),gC=pC(1.1.toString),z0=function(f){return"Symbol("+(f===void 0?"":f)+")_"+gC(++vC+mC,36)},yC=M,_C=V0,K0=un,wC=z0,bC=q0,EC=F0,vo=yC.Symbol,sf=_C("wks"),SC=EC?vo.for||vo:vo&&vo.withoutSetter||wC,cn=function(f){return K0(sf,f)||(sf[f]=bC&&K0(vo,f)?vo[f]:SC("Symbol."+f)),sf[f]},IC=Ln,Y0=Sr,J0=j0,TC=tf,OC=nC,AC=cn,RC=TypeError,CC=AC("toPrimitive"),PC=function(f,v){if(!Y0(f)||J0(f))return f;var m=TC(f,CC),g;if(m){if(v===void 0&&(v="default"),g=IC(m,f,v),!Y0(g)||J0(g))return g;throw new RC("Can't convert object to primitive value")}return v===void 0&&(v="number"),OC(f,v)},xC=PC,NC=j0,Q0=function(f){var v=xC(f,"string");return NC(v)?v:v+""},LC=xt,DC=T0,UC=O0,ou=Ii,X0=Q0,BC=TypeError,uf=Object.defineProperty,qC=Object.getOwnPropertyDescriptor,cf="enumerable",lf="configurable",ff="writable";Si.f=LC?UC?function(v,m,g){if(ou(v),m=X0(m),ou(g),typeof v=="function"&&m==="prototype"&&"value"in g&&ff in g&&!g[ff]){var I=qC(v,m);I&&I[ff]&&(v[m]=g.value,g={configurable:lf in g?g[lf]:I[lf],enumerable:cf in g?g[cf]:I[cf],writable:!1})}return uf(v,m,g)}:uf:function(v,m,g){if(ou(v),m=X0(m),ou(g),DC)try{return uf(v,m,g)}catch{}if("get"in g||"set"in g)throw new BC("Accessors not supported");return"value"in g&&(v[m]=g.value),v};var Ea=function(f,v){return{enumerable:!(f&1),configurable:!(f&2),writable:!(f&4),value:v}},FC=xt,jC=Si,MC=Ea,au=FC?function(f,v,m){return jC.f(f,v,MC(1,m))}:function(f,v,m){return f[v]=m,f},kC=V0,$C=z0,Z0=kC("keys"),hf=function(f){return Z0[f]||(Z0[f]=$C(f))},df={},WC=_t,em=M,HC=Sr,GC=au,pf=un,vf=af,VC=hf,zC=df,tm="Object already initialized",mf=em.TypeError,KC=em.WeakMap,su,Sa,uu,YC=function(f){return uu(f)?Sa(f):su(f,{})},JC=function(f){return function(v){var m;if(!HC(v)||(m=Sa(v)).type!==f)throw new mf("Incompatible receiver, "+f+" required");return m}};if(WC||vf.state){var ln=vf.state||(vf.state=new KC);ln.get=ln.get,ln.has=ln.has,ln.set=ln.set,su=function(f,v){if(ln.has(f))throw new mf(tm);return v.facade=f,ln.set(f,v),v},Sa=function(f){return ln.get(f)||{}},uu=function(f){return ln.has(f)}}else{var mo=VC("state");zC[mo]=!0,su=function(f,v){if(pf(f,mo))throw new mf(tm);return v.facade=f,GC(f,mo,v),v},Sa=function(f){return pf(f,mo)?f[mo]:{}},uu=function(f){return pf(f,mo)}}var cu={set:su,get:Sa,has:uu,enforce:YC,getterFor:JC},QC=me,rm=Function.prototype,nm=rm.apply,im=rm.call,XC=typeof Reflect=="object"&&Reflect.apply||(QC?im.bind(nm):function(){return im.apply(nm,arguments)}),ZC=B,eP=p,om=function(f){if(ZC(f)==="Function")return eP(f)},am={},gf={},sm={}.propertyIsEnumerable,um=Object.getOwnPropertyDescriptor,tP=um&&!sm.call({1:2},1);gf.f=tP?function(v){var m=um(this,v);return!!m&&m.enumerable}:sm;var rP=xt,nP=Ln,iP=gf,oP=Ea,aP=_,sP=Q0,uP=un,cP=T0,cm=Object.getOwnPropertyDescriptor;am.f=rP?cm:function(v,m){if(v=aP(v),m=sP(m),cP)try{return cm(v,m)}catch{}if(uP(v,m))return oP(!nP(iP.f,v,m),v[m])};var lP=ue,fP=ee,hP=/#|\.prototype\./,Ia=function(f,v){var m=pP[dP(f)];return m===mP?!0:m===vP?!1:fP(v)?lP(v):!!v},dP=Ia.normalize=function(f){return String(f).replace(hP,".").toLowerCase()},pP=Ia.data={},vP=Ia.NATIVE="N",mP=Ia.POLYFILL="P",gP=Ia,lm=om,yP=ef,_P=me,wP=lm(lm.bind),lu=function(f,v){return yP(f),v===void 0?f:_P?wP(f,v):function(){return f.apply(v,arguments)}},Ta=M,bP=XC,EP=om,SP=ee,IP=am.f,TP=gP,go=Jl,OP=lu,yo=au,fm=un,AP=function(f){var v=function(m,g,I){if(this instanceof v){switch(arguments.length){case 0:return new f;case 1:return new f(m);case 2:return new f(m,g)}return new f(m,g,I)}return bP(f,this,arguments)};return v.prototype=f.prototype,v},_o=function(f,v){var m=f.target,g=f.global,I=f.stat,x=f.proto,D=g?Ta:I?Ta[m]:Ta[m]&&Ta[m].prototype,G=g?go:go[m]||yo(go,m,{})[m],H=G.prototype,z,J,j,te,ce,oe,Re,we,Oe;for(te in v)z=TP(g?te:m+(I?".":"#")+te,f.forced),J=!z&&D&&fm(D,te),oe=G[te],J&&(f.dontCallGetSet?(Oe=IP(D,te),Re=Oe&&Oe.value):Re=D[te]),ce=J&&Re?Re:v[te],!(!z&&!x&&typeof oe==typeof ce)&&(f.bind&&J?we=OP(ce,Ta):f.wrap&&J?we=AP(ce):x&&SP(ce)?we=EP(ce):we=ce,(f.sham||ce&&ce.sham||oe&&oe.sham)&&yo(we,"sham",!0),yo(G,te,we),x&&(j=m+"Prototype",fm(go,j)||yo(go,j,{}),yo(go[j],te,ce),f.real&&H&&(z||!H[te])&&yo(H,te,ce)))},yf=xt,RP=un,hm=Function.prototype,CP=yf&&Object.getOwnPropertyDescriptor,_f=RP(hm,"name"),PP=_f&&(function(){}).name==="something",xP=_f&&(!yf||yf&&CP(hm,"name").configurable),NP={EXISTS:_f,PROPER:PP,CONFIGURABLE:xP},dm={},LP=Math.ceil,DP=Math.floor,UP=Math.trunc||function(v){var m=+v;return(m>0?DP:LP)(m)},BP=UP,wf=function(f){var v=+f;return v!==v||v===0?0:BP(v)},qP=wf,FP=Math.max,jP=Math.min,pm=function(f,v){var m=qP(f);return m<0?FP(m+v,0):jP(m,v)},MP=wf,kP=Math.min,$P=function(f){var v=MP(f);return v>0?kP(v,9007199254740991):0},WP=$P,vm=function(f){return WP(f.length)},HP=_,GP=pm,VP=vm,mm=function(f){return function(v,m,g){var I=HP(v),x=VP(I);if(x===0)return!f&&-1;var D=GP(g,x),G;if(f&&m!==m){for(;x>D;)if(G=I[D++],G!==G)return!0}else for(;x>D;D++)if((f||D in I)&&I[D]===m)return f||D||0;return!f&&-1}},zP={includes:mm(!0),indexOf:mm(!1)},KP=p,bf=un,YP=_,JP=zP.indexOf,QP=df,gm=KP([].push),XP=function(f,v){var m=YP(f),g=0,I=[],x;for(x in m)!bf(QP,x)&&bf(m,x)&&gm(I,x);for(;v.length>g;)bf(m,x=v[g++])&&(~JP(I,x)||gm(I,x));return I},ym=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],ZP=XP,ex=ym,_m=Object.keys||function(v){return ZP(v,ex)},tx=xt,rx=O0,nx=Si,ix=Ii,ox=_,ax=_m;dm.f=tx&&!rx?Object.defineProperties:function(v,m){ix(v);for(var g=ox(m),I=ax(m),x=I.length,D=0,G;x>D;)nx.f(v,G=I[D++],g[G]);return v};var sx=po,ux=sx("document","documentElement"),cx=Ii,lx=dm,wm=ym,fx=df,hx=ux,dx=I0,px=hf,bm=">",Em="<",Ef="prototype",Sf="script",Sm=px("IE_PROTO"),If=function(){},Im=function(f){return Em+Sf+bm+f+Em+"/"+Sf+bm},Tm=function(f){f.write(Im("")),f.close();var v=f.parentWindow.Object;return f=null,v},vx=function(){var f=dx("iframe"),v="java"+Sf+":",m;return f.style.display="none",hx.appendChild(f),f.src=String(v),m=f.contentWindow.document,m.open(),m.write(Im("document.F=Object")),m.close(),m.F},fu,hu=function(){try{fu=new ActiveXObject("htmlfile")}catch{}hu=typeof document<"u"?document.domain&&fu?Tm(fu):vx():Tm(fu);for(var f=wm.length;f--;)delete hu[Ef][wm[f]];return hu()};fx[Sm]=!0;var Tf=Object.create||function(v,m){var g;return v!==null?(If[Ef]=cx(v),g=new If,If[Ef]=null,g[Sm]=v):g=hu(),m===void 0?g:lx.f(g,m)},mx=ue,gx=!mx(function(){function f(){}return f.prototype.constructor=null,Object.getPrototypeOf(new f)!==f.prototype}),yx=un,_x=ee,bx=iu,Ex=hf,Sx=gx,Om=Ex("IE_PROTO"),Of=Object,Ix=Of.prototype,Am=Sx?Of.getPrototypeOf:function(f){var v=bx(f);if(yx(v,Om))return v[Om];var m=v.constructor;return _x(m)&&v instanceof m?m.prototype:v instanceof Of?Ix:null},Tx=au,Oa=function(f,v,m,g){return g&&g.enumerable?f[v]=m:Tx(f,v,m),f},Ox=ue,Ax=ee,Rx=Sr,Cx=Tf,Rm=Am,Px=Oa,xx=cn,Af=xx("iterator"),Cm=!1,Dn,Rf,Cf;[].keys&&(Cf=[].keys(),"next"in Cf?(Rf=Rm(Rm(Cf)),Rf!==Object.prototype&&(Dn=Rf)):Cm=!0);var Nx=!Rx(Dn)||Ox(function(){var f={};return Dn[Af].call(f)!==f});Nx?Dn={}:Dn=Cx(Dn),Ax(Dn[Af])||Px(Dn,Af,function(){return this});var Pm={IteratorPrototype:Dn,BUGGY_SAFARI_ITERATORS:Cm},Lx=cn,Dx=Lx("toStringTag"),xm={};xm[Dx]="z";var Pf=String(xm)==="[object z]",Ux=Pf,Bx=ee,du=B,qx=cn,Fx=qx("toStringTag"),jx=Object,Mx=du((function(){return arguments})())==="Arguments",kx=function(f,v){try{return f[v]}catch{}},Aa=Ux?du:function(f){var v,m,g;return f===void 0?"Undefined":f===null?"Null":typeof(m=kx(v=jx(f),Fx))=="string"?m:Mx?du(v):(g=du(v))==="Object"&&Bx(v.callee)?"Arguments":g},$x=Pf,Wx=Aa,Hx=$x?{}.toString:function(){return"[object "+Wx(this)+"]"},Gx=Pf,Vx=Si.f,zx=au,Kx=un,Yx=Hx,Jx=cn,Nm=Jx("toStringTag"),pu=function(f,v,m,g){var I=m?f:f&&f.prototype;I&&(Kx(I,Nm)||Vx(I,Nm,{configurable:!0,value:v}),g&&!Gx&&zx(I,"toString",Yx))},Qx=Pm.IteratorPrototype,Xx=Tf,Zx=Ea,eN=pu,tN=b,rN=function(){return this},Lm=function(f,v,m,g){var I=v+" Iterator";return f.prototype=Xx(Qx,{next:Zx(+!g,m)}),eN(f,I,!1,!0),tN[I]=rN,f},nN=_o,iN=Ln,Dm=NP,oN=Lm,aN=Am,sN=pu,Um=Oa,uN=cn,Bm=b,qm=Pm,cN=Dm.PROPER;Dm.CONFIGURABLE,qm.IteratorPrototype;var vu=qm.BUGGY_SAFARI_ITERATORS,xf=uN("iterator"),Fm="keys",mu="values",jm="entries",lN=function(){return this},Mm=function(f,v,m,g,I,x,D){oN(m,v,g);var G=function(Oe){if(Oe===I&&te)return te;if(!vu&&Oe&&Oe in J)return J[Oe];switch(Oe){case Fm:return function(){return new m(this,Oe)};case mu:return function(){return new m(this,Oe)};case jm:return function(){return new m(this,Oe)}}return function(){return new m(this)}},H=v+" Iterator",z=!1,J=f.prototype,j=J[xf]||J["@@iterator"]||I&&J[I],te=!vu&&j||G(I),ce=v==="Array"&&J.entries||j,oe,Re,we;if(ce&&(oe=aN(ce.call(new f)),oe!==Object.prototype&&oe.next&&(sN(oe,H,!0,!0),Bm[H]=lN)),cN&&I===mu&&j&&j.name!==mu&&(z=!0,te=function(){return iN(j,this)}),I)if(Re={values:G(mu),keys:x?te:G(Fm),entries:G(jm)},D)for(we in Re)(vu||z||!(we in J))&&Um(J,we,Re[we]);else nN({target:v,proto:!0,forced:vu||z},Re);return D&&J[xf]!==te&&Um(J,xf,te,{name:I}),Bm[v]=te,Re},Nf=function(f,v){return{value:f,done:v}},fN=_,km=b,$m=cu;Si.f;var hN=Mm,gu=Nf,Wm="Array Iterator",dN=$m.set,pN=$m.getterFor(Wm);hN(Array,"Array",function(f,v){dN(this,{type:Wm,target:fN(f),index:0,kind:v})},function(){var f=pN(this),v=f.target,m=f.index++;if(!v||m>=v.length)return f.target=null,gu(void 0,!0);switch(f.kind){case"keys":return gu(m,!1);case"values":return gu(v[m],!1)}return gu([m,v[m]],!1)},"values"),km.Arguments=km.Array;var vN=_o,mN=p,gN=pm,yN=RangeError,Hm=String.fromCharCode,Gm=String.fromCodePoint,_N=mN([].join),wN=!!Gm&&Gm.length!==1;vN({target:"String",stat:!0,arity:1,forced:wN},{fromCodePoint:function(v){for(var m=[],g=arguments.length,I=0,x;g>I;){if(x=+arguments[I++],gN(x,1114111)!==x)throw new yN(x+" is not a valid code point");m[I]=x<65536?Hm(x):Hm(((x-=65536)>>10)+55296,x%1024+56320)}return _N(m,"")}});var Vm=M,bN=xt,EN=Object.getOwnPropertyDescriptor,SN=function(f){if(!bN)return Vm[f];var v=EN(Vm,f);return v&&v.value},IN=ue,TN=cn,ON=xt,zm=iC,AN=TN("iterator"),yu=!IN(function(){var f=new URL("b?a=1&b=2&c=3","https://a"),v=f.searchParams,m=new URLSearchParams("a=1&a=2&b=3"),g="";return f.pathname="c%20d",v.forEach(function(I,x){v.delete("b"),g+=x+I}),m.delete("a",2),m.delete("b",void 0),zm&&(!f.toJSON||!m.has("a",1)||m.has("a",2)||!m.has("a",void 0)||m.has("b"))||!v.size&&(zm||!ON)||!v.sort||f.href!=="https://a/c%20d?a=1&c=3"||v.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!v[AN]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("https://\u0442\u0435\u0441\u0442").host!=="xn--e1aybc"||new URL("https://a#\u0431").hash!=="#%D0%B1"||g!=="a1c3"||new URL("https://x",void 0).host!=="x"}),RN=Si,Km=function(f,v,m){return RN.f(f,v,m)},CN=Oa,PN=function(f,v,m){for(var g in v)m&&m.unsafe&&f[g]?f[g]=v[g]:CN(f,g,v[g],m);return f},xN=R0,NN=TypeError,Ym=function(f,v){if(xN(v,f))return f;throw new NN("Incorrect invocation")},LN=Aa,DN=String,wo=function(f){if(LN(f)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return DN(f)},UN=Aa,Jm=tf,BN=Ce,qN=b,FN=cn,jN=FN("iterator"),Lf=function(f){if(!BN(f))return Jm(f,jN)||Jm(f,"@@iterator")||qN[UN(f)]},MN=Ln,kN=ef,$N=Ii,WN=M0,HN=Lf,GN=TypeError,Qm=function(f,v){var m=arguments.length<2?HN(f):v;if(kN(m))return $N(MN(m,f));throw new GN(WN(f)+" is not iterable")},VN=TypeError,_u=function(f,v){if(f<v)throw new VN("Not enough arguments");return f},zN=p,Xm=zN([].slice),Zm=Xm,KN=Math.floor,Df=function(f,v){var m=f.length;if(m<8)for(var g=1,I,x;g<m;){for(x=g,I=f[g];x&&v(f[x-1],I)>0;)f[x]=f[--x];x!==g++&&(f[x]=I)}else for(var D=KN(m/2),G=Df(Zm(f,0,D),v),H=Df(Zm(f,D),v),z=G.length,J=H.length,j=0,te=0;j<z||te<J;)f[j+te]=j<z&&te<J?v(G[j],H[te])<=0?G[j++]:H[te++]:j<z?G[j++]:H[te++];return f},YN=Df,Uf=_o,eg=M,Bf=SN,JN=po,wu=Ln,Hr=p,Ra=xt,tg=yu,rg=Oa,QN=Km,XN=PN,ZN=pu,eL=Lm,qf=cu,ng=Ym,Ff=ee,tL=un,rL=lu,nL=Aa,iL=Ii,ig=Sr,Wt=wo,oL=Tf,og=Ea,ag=Qm,aL=Lf,bu=Nf,bo=_u,sL=cn,uL=YN,cL=sL("iterator"),Eo="URLSearchParams",sg=Eo+"Iterator",ug=qf.set,Ir=qf.getterFor(Eo),lL=qf.getterFor(sg),cg=Bf("fetch"),Eu=Bf("Request"),Ca=Bf("Headers"),jf=Eu&&Eu.prototype,lg=Ca&&Ca.prototype,fL=eg.TypeError,hL=eg.encodeURIComponent,dL=String.fromCharCode,pL=JN("String","fromCodePoint"),vL=parseInt,Su=Hr("".charAt),fg=Hr([].join),Qn=Hr([].push),hg=Hr("".replace),mL=Hr([].shift),dg=Hr([].splice),pg=Hr("".split),vg=Hr("".slice),gL=Hr(/./.exec),yL=/\+/g,Mf="\uFFFD",_L=/^[0-9a-f]+$/i,mg=function(f,v){var m=vg(f,v,v+2);return gL(_L,m)?vL(m,16):NaN},wL=function(f){for(var v=0,m=128;m>0&&(f&m)!==0;m>>=1)v++;return v},bL=function(f){var v=null;switch(f.length){case 1:v=f[0];break;case 2:v=(f[0]&31)<<6|f[1]&63;break;case 3:v=(f[0]&15)<<12|(f[1]&63)<<6|f[2]&63;break;case 4:v=(f[0]&7)<<18|(f[1]&63)<<12|(f[2]&63)<<6|f[3]&63;break}return v>1114111?null:v},gg=function(f){f=hg(f,yL," ");for(var v=f.length,m="",g=0;g<v;){var I=Su(f,g);if(I==="%"){if(Su(f,g+1)==="%"||g+3>v){m+="%",g++;continue}var x=mg(f,g+1);if(x!==x){m+=I,g++;continue}g+=2;var D=wL(x);if(D===0)I=dL(x);else{if(D===1||D>4){m+=Mf,g++;continue}for(var G=[x],H=1;H<D&&(g++,!(g+3>v||Su(f,g)!=="%"));){var z=mg(f,g+1);if(z!==z){g+=3;break}if(z>191||z<128)break;Qn(G,z),g+=2,H++}if(G.length!==D){m+=Mf;continue}var J=bL(G);J===null?m+=Mf:I=pL(J)}}m+=I,g++}return m},EL=/[!'()~]|%20/g,SL={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},IL=function(f){return SL[f]},yg=function(f){return hg(hL(f),EL,IL)},kf=eL(function(v,m){ug(this,{type:sg,target:Ir(v).entries,index:0,kind:m})},Eo,function(){var v=lL(this),m=v.target,g=v.index++;if(!m||g>=m.length)return v.target=null,bu(void 0,!0);var I=m[g];switch(v.kind){case"keys":return bu(I.key,!1);case"values":return bu(I.value,!1)}return bu([I.key,I.value],!1)},!0),_g=function(f){this.entries=[],this.url=null,f!==void 0&&(ig(f)?this.parseObject(f):this.parseQuery(typeof f=="string"?Su(f,0)==="?"?vg(f,1):f:Wt(f)))};_g.prototype={type:Eo,bindURL:function(f){this.url=f,this.update()},parseObject:function(f){var v=this.entries,m=aL(f),g,I,x,D,G,H,z;if(m)for(g=ag(f,m),I=g.next;!(x=wu(I,g)).done;){if(D=ag(iL(x.value)),G=D.next,(H=wu(G,D)).done||(z=wu(G,D)).done||!wu(G,D).done)throw new fL("Expected sequence with length 2");Qn(v,{key:Wt(H.value),value:Wt(z.value)})}else for(var J in f)tL(f,J)&&Qn(v,{key:J,value:Wt(f[J])})},parseQuery:function(f){if(f)for(var v=this.entries,m=pg(f,"&"),g=0,I,x;g<m.length;)I=m[g++],I.length&&(x=pg(I,"="),Qn(v,{key:gg(mL(x)),value:gg(fg(x,"="))}))},serialize:function(){for(var f=this.entries,v=[],m=0,g;m<f.length;)g=f[m++],Qn(v,yg(g.key)+"="+yg(g.value));return fg(v,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var Iu=function(){ng(this,So);var v=arguments.length>0?arguments[0]:void 0,m=ug(this,new _g(v));Ra||(this.size=m.entries.length)},So=Iu.prototype;if(XN(So,{append:function(v,m){var g=Ir(this);bo(arguments.length,2),Qn(g.entries,{key:Wt(v),value:Wt(m)}),Ra||this.length++,g.updateURL()},delete:function(f){for(var v=Ir(this),m=bo(arguments.length,1),g=v.entries,I=Wt(f),x=m<2?void 0:arguments[1],D=x===void 0?x:Wt(x),G=0;G<g.length;){var H=g[G];if(H.key===I&&(D===void 0||H.value===D)){if(dg(g,G,1),D!==void 0)break}else G++}Ra||(this.size=g.length),v.updateURL()},get:function(v){var m=Ir(this).entries;bo(arguments.length,1);for(var g=Wt(v),I=0;I<m.length;I++)if(m[I].key===g)return m[I].value;return null},getAll:function(v){var m=Ir(this).entries;bo(arguments.length,1);for(var g=Wt(v),I=[],x=0;x<m.length;x++)m[x].key===g&&Qn(I,m[x].value);return I},has:function(v){for(var m=Ir(this).entries,g=bo(arguments.length,1),I=Wt(v),x=g<2?void 0:arguments[1],D=x===void 0?x:Wt(x),G=0;G<m.length;){var H=m[G++];if(H.key===I&&(D===void 0||H.value===D))return!0}return!1},set:function(v,m){var g=Ir(this);bo(arguments.length,1);for(var I=g.entries,x=!1,D=Wt(v),G=Wt(m),H=0,z;H<I.length;H++)z=I[H],z.key===D&&(x?dg(I,H--,1):(x=!0,z.value=G));x||Qn(I,{key:D,value:G}),Ra||(this.size=I.length),g.updateURL()},sort:function(){var v=Ir(this);uL(v.entries,function(m,g){return m.key>g.key?1:-1}),v.updateURL()},forEach:function(v){for(var m=Ir(this).entries,g=rL(v,arguments.length>1?arguments[1]:void 0),I=0,x;I<m.length;)x=m[I++],g(x.value,x.key,this)},keys:function(){return new kf(this,"keys")},values:function(){return new kf(this,"values")},entries:function(){return new kf(this,"entries")}},{enumerable:!0}),rg(So,cL,So.entries,{name:"entries"}),rg(So,"toString",function(){return Ir(this).serialize()},{enumerable:!0}),Ra&&QN(So,"size",{get:function(){return Ir(this).entries.length},configurable:!0,enumerable:!0}),ZN(Iu,Eo),Uf({global:!0,constructor:!0,forced:!tg},{URLSearchParams:Iu}),!tg&&Ff(Ca)){var TL=Hr(lg.has),OL=Hr(lg.set),wg=function(f){if(ig(f)){var v=f.body,m;if(nL(v)===Eo)return m=f.headers?new Ca(f.headers):new Ca,TL(m,"content-type")||OL(m,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),oL(f,{body:og(0,Wt(v)),headers:og(0,m)})}return f};if(Ff(cg)&&Uf({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(v){return cg(v,arguments.length>1?wg(arguments[1]):{})}}),Ff(Eu)){var $f=function(v){return ng(this,jf),new Eu(v,arguments.length>1?wg(arguments[1]):{})};jf.constructor=$f,$f.prototype=jf,Uf({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:$f})}}var AL={URLSearchParams:Iu,getState:Ir},Wf=p,RL=wf,CL=wo,PL=et,xL=Wf("".charAt),bg=Wf("".charCodeAt),NL=Wf("".slice),Eg=function(f){return function(v,m){var g=CL(PL(v)),I=RL(m),x=g.length,D,G;return I<0||I>=x?f?"":void 0:(D=bg(g,I),D<55296||D>56319||I+1===x||(G=bg(g,I+1))<56320||G>57343?f?xL(g,I):D:f?NL(g,I,I+2):(D-55296<<10)+(G-56320)+65536)}},Sg={codeAt:Eg(!1),charAt:Eg(!0)},LL=Sg.charAt,DL=wo,Ig=cu,UL=Mm,Tg=Nf,Og="String Iterator",BL=Ig.set,qL=Ig.getterFor(Og);UL(String,"String",function(f){BL(this,{type:Og,string:DL(f),index:0})},function(){var v=qL(this),m=v.string,g=v.index,I;return g>=m.length?Tg(void 0,!0):(I=LL(m,g),v.index+=I.length,Tg(I,!1))});var Ag={};Ag.f=Object.getOwnPropertySymbols;var Rg=xt,FL=p,jL=Ln,ML=ue,Hf=_m,kL=Ag,$L=gf,WL=iu,HL=Te,Io=Object.assign,Cg=Object.defineProperty,GL=FL([].concat),VL=!Io||ML(function(){if(Rg&&Io({b:1},Io(Cg({},"a",{enumerable:!0,get:function(){Cg(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var f={},v={},m=Symbol("assign detection"),g="abcdefghijklmnopqrst";return f[m]=7,g.split("").forEach(function(I){v[I]=I}),Io({},f)[m]!==7||Hf(Io({},v)).join("")!==g})?function(v,m){for(var g=WL(v),I=arguments.length,x=1,D=kL.f,G=$L.f;I>x;)for(var H=HL(arguments[x++]),z=D?GL(Hf(H),D(H)):Hf(H),J=z.length,j=0,te;J>j;)te=z[j++],(!Rg||jL(G,H,te))&&(g[te]=H[te]);return g}:Io,zL=Ln,Pg=Ii,KL=tf,YL=function(f,v,m){var g,I;Pg(f);try{if(g=KL(f,"return"),!g){if(v==="throw")throw m;return m}g=zL(g,f)}catch(x){I=!0,g=x}if(v==="throw")throw m;if(I)throw g;return Pg(g),m},JL=Ii,QL=YL,XL=function(f,v,m,g){try{return g?v(JL(m)[0],m[1]):v(m)}catch(I){QL(f,"throw",I)}},ZL=cn,eD=b,tD=ZL("iterator"),rD=Array.prototype,nD=function(f){return f!==void 0&&(eD.Array===f||rD[tD]===f)},iD=p,oD=ee,Gf=af,aD=iD(Function.toString);oD(Gf.inspectSource)||(Gf.inspectSource=function(f){return aD(f)});var sD=Gf.inspectSource,uD=p,cD=ue,xg=ee,lD=Aa,fD=po,hD=sD,Ng=function(){},Lg=fD("Reflect","construct"),Vf=/^\s*(?:class|function)\b/,dD=uD(Vf.exec),pD=!Vf.test(Ng),Pa=function(v){if(!xg(v))return!1;try{return Lg(Ng,[],v),!0}catch{return!1}},Dg=function(v){if(!xg(v))return!1;switch(lD(v)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return pD||!!dD(Vf,hD(v))}catch{return!0}};Dg.sham=!0;var vD=!Lg||cD(function(){var f;return Pa(Pa.call)||!Pa(Object)||!Pa(function(){f=!0})||f})?Dg:Pa,mD=xt,gD=Si,yD=Ea,_D=function(f,v,m){mD?gD.f(f,v,yD(0,m)):f[v]=m},wD=lu,bD=Ln,ED=iu,SD=XL,ID=nD,TD=vD,OD=vm,Ug=_D,AD=Qm,RD=Lf,Bg=Array,CD=function(v){var m=ED(v),g=TD(this),I=arguments.length,x=I>1?arguments[1]:void 0,D=x!==void 0;D&&(x=wD(x,I>2?arguments[2]:void 0));var G=RD(m),H=0,z,J,j,te,ce,oe;if(G&&!(this===Bg&&ID(G)))for(J=g?new this:[],te=AD(m,G),ce=te.next;!(j=bD(ce,te)).done;H++)oe=D?SD(te,x,[j.value,H],!0):j.value,Ug(J,H,oe);else for(z=OD(m),J=g?new this(z):Bg(z);z>H;H++)oe=D?x(m[H],H):m[H],Ug(J,H,oe);return J.length=H,J},Ti=p,zf=2147483647,xa=36,qg=1,Kf=26,PD=38,xD=700,ND=72,LD=128,DD="-",UD=/[^\0-\u007E]/,Fg=/[.\u3002\uFF0E\uFF61]/g,jg="Overflow: input needs wider integers to process",Yf=xa-qg,Mg=RangeError,BD=Ti(Fg.exec),To=Math.floor,Jf=String.fromCharCode,kg=Ti("".charCodeAt),$g=Ti([].join),Xn=Ti([].push),qD=Ti("".replace),FD=Ti("".split),jD=Ti("".toLowerCase),MD=function(f){for(var v=[],m=0,g=f.length;m<g;){var I=kg(f,m++);if(I>=55296&&I<=56319&&m<g){var x=kg(f,m++);(x&64512)===56320?Xn(v,((I&1023)<<10)+(x&1023)+65536):(Xn(v,I),m--)}else Xn(v,I)}return v},Wg=function(f){return f+22+75*(f<26)},kD=function(f,v,m){var g=0;for(f=m?To(f/xD):f>>1,f+=To(f/v);f>Yf*Kf>>1;)f=To(f/Yf),g+=xa;return To(g+(Yf+1)*f/(f+PD))},$D=function(f){var v=[];f=MD(f);var m=f.length,g=LD,I=0,x=ND,D,G;for(D=0;D<f.length;D++)G=f[D],G<128&&Xn(v,Jf(G));var H=v.length,z=H;for(H&&Xn(v,DD);z<m;){var J=zf;for(D=0;D<f.length;D++)G=f[D],G>=g&&G<J&&(J=G);var j=z+1;if(J-g>To((zf-I)/j))throw new Mg(jg);for(I+=(J-g)*j,g=J,D=0;D<f.length;D++){if(G=f[D],G<g&&++I>zf)throw new Mg(jg);if(G===g){for(var te=I,ce=xa;;){var oe=ce<=x?qg:ce>=x+Kf?Kf:ce-x;if(te<oe)break;var Re=te-oe,we=xa-oe;Xn(v,Jf(Wg(oe+Re%we))),te=To(Re/we),ce+=xa}Xn(v,Jf(Wg(te))),x=kD(I,j,z===H),I=0,z++}}I++,g++}return $g(v,"")},WD=function(f){var v=[],m=FD(qD(jD(f),Fg,"."),"."),g,I;for(g=0;g<m.length;g++)I=m[g],Xn(v,BD(UD,I)?"xn--"+$D(I):I);return $g(v,".")},HD=_o,Qf=xt,GD=yu,Xf=M,Hg=lu,Tr=p,Tu=Oa,Or=Km,VD=Ym,Zf=un,eh=VL,Oo=CD,Gr=Xm,zD=Sg.codeAt,KD=WD,Un=wo,YD=pu,JD=_u,Gg=AL,Vg=cu,QD=Vg.set,Ou=Vg.getterFor("URL"),XD=Gg.URLSearchParams,ZD=Gg.getState,Na=Xf.URL,th=Xf.TypeError,Au=Xf.parseInt,eU=Math.floor,zg=Math.pow,Ar=Tr("".charAt),Vr=Tr(/./.exec),La=Tr([].join),tU=Tr(1.1.toString),rU=Tr([].pop),Ao=Tr([].push),rh=Tr("".replace),nU=Tr([].shift),iU=Tr("".split),Da=Tr("".slice),Ru=Tr("".toLowerCase),oU=Tr([].unshift),aU="Invalid authority",nh="Invalid scheme",Oi="Invalid host",Kg="Invalid port",Yg=/[a-z]/i,sU=/[\d+-.a-z]/i,ih=/\d/,uU=/^0x/i,cU=/^[0-7]+$/,lU=/^\d+$/,Jg=/^[\da-f]+$/i,fU=/[\0\t\n\r #%/:<>?@[\\\]^|]/,hU=/[\0\t\n\r #/:<>?@[\\\]^|]/,dU=/^[\u0000-\u0020]+/,pU=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,vU=/[\t\n\r]/g,Rr,mU=function(f){var v=iU(f,"."),m,g,I,x,D,G,H;if(v.length&&v[v.length-1]===""&&v.length--,m=v.length,m>4)return f;for(g=[],I=0;I<m;I++){if(x=v[I],x==="")return f;if(D=10,x.length>1&&Ar(x,0)==="0"&&(D=Vr(uU,x)?16:8,x=Da(x,D===8?1:2)),x==="")G=0;else{if(!Vr(D===10?lU:D===8?cU:Jg,x))return f;G=Au(x,D)}Ao(g,G)}for(I=0;I<m;I++)if(G=g[I],I===m-1){if(G>=zg(256,5-m))return null}else if(G>255)return null;for(H=rU(g),I=0;I<g.length;I++)H+=g[I]*zg(256,3-I);return H},gU=function(f){var v=[0,0,0,0,0,0,0,0],m=0,g=null,I=0,x,D,G,H,z,J,j,te=function(){return Ar(f,I)};if(te()===":"){if(Ar(f,1)!==":")return;I+=2,m++,g=m}for(;te();){if(m===8)return;if(te()===":"){if(g!==null)return;I++,m++,g=m;continue}for(x=D=0;D<4&&Vr(Jg,te());)x=x*16+Au(te(),16),I++,D++;if(te()==="."){if(D===0||(I-=D,m>6))return;for(G=0;te();){if(H=null,G>0)if(te()==="."&&G<4)I++;else return;if(!Vr(ih,te()))return;for(;Vr(ih,te());){if(z=Au(te(),10),H===null)H=z;else{if(H===0)return;H=H*10+z}if(H>255)return;I++}v[m]=v[m]*256+H,G++,(G===2||G===4)&&m++}if(G!==4)return;break}else if(te()===":"){if(I++,!te())return}else if(te())return;v[m++]=x}if(g!==null)for(J=m-g,m=7;m!==0&&J>0;)j=v[m],v[m--]=v[g+J-1],v[g+--J]=j;else if(m!==8)return;return v},yU=function(f){for(var v=null,m=1,g=null,I=0,x=0;x<8;x++)f[x]!==0?(I>m&&(v=g,m=I),g=null,I=0):(g===null&&(g=x),++I);return I>m?g:v},Ua=function(f){var v,m,g,I;if(typeof f=="number"){for(v=[],m=0;m<4;m++)oU(v,f%256),f=eU(f/256);return La(v,".")}if(typeof f=="object"){for(v="",g=yU(f),m=0;m<8;m++)I&&f[m]===0||(I&&(I=!1),g===m?(v+=m?":":"::",I=!0):(v+=tU(f[m],16),m<7&&(v+=":")));return"["+v+"]"}return f},Cu={},Qg=eh({},Cu,{" ":1,'"':1,"<":1,">":1,"`":1}),Xg=eh({},Qg,{"#":1,"?":1,"{":1,"}":1}),oh=eh({},Xg,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Zn=function(f,v){var m=zD(f,0);return m>32&&m<127&&!Zf(v,f)?f:encodeURIComponent(f)},Pu={ftp:21,file:null,http:80,https:443,ws:80,wss:443},Ba=function(f,v){var m;return f.length===2&&Vr(Yg,Ar(f,0))&&((m=Ar(f,1))===":"||!v&&m==="|")},Zg=function(f){var v;return f.length>1&&Ba(Da(f,0,2))&&(f.length===2||(v=Ar(f,2))==="/"||v==="\\"||v==="?"||v==="#")},_U=function(f){return f==="."||Ru(f)==="%2e"},wU=function(f){return f=Ru(f),f===".."||f==="%2e."||f===".%2e"||f==="%2e%2e"},ah={},ey={},sh={},ty={},ry={},uh={},ny={},iy={},xu={},Nu={},ch={},lh={},fh={},hh={},oy={},dh={},Ro={},fn={},ay={},Ai={},Bn={},ph=function(f,v,m){var g=Un(f),I,x,D;if(v){if(x=this.parse(g),x)throw new th(x);this.searchParams=null}else{if(m!==void 0&&(I=new ph(m,!0)),x=this.parse(g,null,I),x)throw new th(x);D=ZD(new XD),D.bindURL(this),this.searchParams=D}};ph.prototype={type:"URL",parse:function(f,v,m){var g=this,I=v||ah,x=0,D="",G=!1,H=!1,z=!1,J,j,te,ce;for(f=Un(f),v||(g.scheme="",g.username="",g.password="",g.host=null,g.port=null,g.path=[],g.query=null,g.fragment=null,g.cannotBeABaseURL=!1,f=rh(f,dU,""),f=rh(f,pU,"$1")),f=rh(f,vU,""),J=Oo(f);x<=J.length;){switch(j=J[x],I){case ah:if(j&&Vr(Yg,j))D+=Ru(j),I=ey;else{if(v)return nh;I=sh;continue}break;case ey:if(j&&(Vr(sU,j)||j==="+"||j==="-"||j==="."))D+=Ru(j);else if(j===":"){if(v&&(g.isSpecial()!==Zf(Pu,D)||D==="file"&&(g.includesCredentials()||g.port!==null)||g.scheme==="file"&&!g.host))return;if(g.scheme=D,v){g.isSpecial()&&Pu[g.scheme]===g.port&&(g.port=null);return}D="",g.scheme==="file"?I=hh:g.isSpecial()&&m&&m.scheme===g.scheme?I=ty:g.isSpecial()?I=iy:J[x+1]==="/"?(I=ry,x++):(g.cannotBeABaseURL=!0,Ao(g.path,""),I=ay)}else{if(v)return nh;D="",I=sh,x=0;continue}break;case sh:if(!m||m.cannotBeABaseURL&&j!=="#")return nh;if(m.cannotBeABaseURL&&j==="#"){g.scheme=m.scheme,g.path=Gr(m.path),g.query=m.query,g.fragment="",g.cannotBeABaseURL=!0,I=Bn;break}I=m.scheme==="file"?hh:uh;continue;case ty:if(j==="/"&&J[x+1]==="/")I=xu,x++;else{I=uh;continue}break;case ry:if(j==="/"){I=Nu;break}else{I=fn;continue}case uh:if(g.scheme=m.scheme,j===Rr)g.username=m.username,g.password=m.password,g.host=m.host,g.port=m.port,g.path=Gr(m.path),g.query=m.query;else if(j==="/"||j==="\\"&&g.isSpecial())I=ny;else if(j==="?")g.username=m.username,g.password=m.password,g.host=m.host,g.port=m.port,g.path=Gr(m.path),g.query="",I=Ai;else if(j==="#")g.username=m.username,g.password=m.password,g.host=m.host,g.port=m.port,g.path=Gr(m.path),g.query=m.query,g.fragment="",I=Bn;else{g.username=m.username,g.password=m.password,g.host=m.host,g.port=m.port,g.path=Gr(m.path),g.path.length--,I=fn;continue}break;case ny:if(g.isSpecial()&&(j==="/"||j==="\\"))I=xu;else if(j==="/")I=Nu;else{g.username=m.username,g.password=m.password,g.host=m.host,g.port=m.port,I=fn;continue}break;case iy:if(I=xu,j!=="/"||Ar(D,x+1)!=="/")continue;x++;break;case xu:if(j!=="/"&&j!=="\\"){I=Nu;continue}break;case Nu:if(j==="@"){G&&(D="%40"+D),G=!0,te=Oo(D);for(var oe=0;oe<te.length;oe++){var Re=te[oe];if(Re===":"&&!z){z=!0;continue}var we=Zn(Re,oh);z?g.password+=we:g.username+=we}D=""}else if(j===Rr||j==="/"||j==="?"||j==="#"||j==="\\"&&g.isSpecial()){if(G&&D==="")return aU;x-=Oo(D).length+1,D="",I=ch}else D+=j;break;case ch:case lh:if(v&&g.scheme==="file"){I=dh;continue}else if(j===":"&&!H){if(D==="")return Oi;if(ce=g.parseHost(D),ce)return ce;if(D="",I=fh,v===lh)return}else if(j===Rr||j==="/"||j==="?"||j==="#"||j==="\\"&&g.isSpecial()){if(g.isSpecial()&&D==="")return Oi;if(v&&D===""&&(g.includesCredentials()||g.port!==null))return;if(ce=g.parseHost(D),ce)return ce;if(D="",I=Ro,v)return;continue}else j==="["?H=!0:j==="]"&&(H=!1),D+=j;break;case fh:if(Vr(ih,j))D+=j;else if(j===Rr||j==="/"||j==="?"||j==="#"||j==="\\"&&g.isSpecial()||v){if(D!==""){var Oe=Au(D,10);if(Oe>65535)return Kg;g.port=g.isSpecial()&&Oe===Pu[g.scheme]?null:Oe,D=""}if(v)return;I=Ro;continue}else return Kg;break;case hh:if(g.scheme="file",j==="/"||j==="\\")I=oy;else if(m&&m.scheme==="file")switch(j){case Rr:g.host=m.host,g.path=Gr(m.path),g.query=m.query;break;case"?":g.host=m.host,g.path=Gr(m.path),g.query="",I=Ai;break;case"#":g.host=m.host,g.path=Gr(m.path),g.query=m.query,g.fragment="",I=Bn;break;default:Zg(La(Gr(J,x),""))||(g.host=m.host,g.path=Gr(m.path),g.shortenPath()),I=fn;continue}else{I=fn;continue}break;case oy:if(j==="/"||j==="\\"){I=dh;break}m&&m.scheme==="file"&&!Zg(La(Gr(J,x),""))&&(Ba(m.path[0],!0)?Ao(g.path,m.path[0]):g.host=m.host),I=fn;continue;case dh:if(j===Rr||j==="/"||j==="\\"||j==="?"||j==="#"){if(!v&&Ba(D))I=fn;else if(D===""){if(g.host="",v)return;I=Ro}else{if(ce=g.parseHost(D),ce)return ce;if(g.host==="localhost"&&(g.host=""),v)return;D="",I=Ro}continue}else D+=j;break;case Ro:if(g.isSpecial()){if(I=fn,j!=="/"&&j!=="\\")continue}else if(!v&&j==="?")g.query="",I=Ai;else if(!v&&j==="#")g.fragment="",I=Bn;else if(j!==Rr&&(I=fn,j!=="/"))continue;break;case fn:if(j===Rr||j==="/"||j==="\\"&&g.isSpecial()||!v&&(j==="?"||j==="#")){if(wU(D)?(g.shortenPath(),j!=="/"&&!(j==="\\"&&g.isSpecial())&&Ao(g.path,"")):_U(D)?j!=="/"&&!(j==="\\"&&g.isSpecial())&&Ao(g.path,""):(g.scheme==="file"&&!g.path.length&&Ba(D)&&(g.host&&(g.host=""),D=Ar(D,0)+":"),Ao(g.path,D)),D="",g.scheme==="file"&&(j===Rr||j==="?"||j==="#"))for(;g.path.length>1&&g.path[0]==="";)nU(g.path);j==="?"?(g.query="",I=Ai):j==="#"&&(g.fragment="",I=Bn)}else D+=Zn(j,Xg);break;case ay:j==="?"?(g.query="",I=Ai):j==="#"?(g.fragment="",I=Bn):j!==Rr&&(g.path[0]+=Zn(j,Cu));break;case Ai:!v&&j==="#"?(g.fragment="",I=Bn):j!==Rr&&(j==="'"&&g.isSpecial()?g.query+="%27":j==="#"?g.query+="%23":g.query+=Zn(j,Cu));break;case Bn:j!==Rr&&(g.fragment+=Zn(j,Qg));break}x++}},parseHost:function(f){var v,m,g;if(Ar(f,0)==="["){if(Ar(f,f.length-1)!=="]"||(v=gU(Da(f,1,-1)),!v))return Oi;this.host=v}else if(this.isSpecial()){if(f=KD(f),Vr(fU,f)||(v=mU(f),v===null))return Oi;this.host=v}else{if(Vr(hU,f))return Oi;for(v="",m=Oo(f),g=0;g<m.length;g++)v+=Zn(m[g],Cu);this.host=v}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme==="file"},includesCredentials:function(){return this.username!==""||this.password!==""},isSpecial:function(){return Zf(Pu,this.scheme)},shortenPath:function(){var f=this.path,v=f.length;v&&(this.scheme!=="file"||v!==1||!Ba(f[0],!0))&&f.length--},serialize:function(){var f=this,v=f.scheme,m=f.username,g=f.password,I=f.host,x=f.port,D=f.path,G=f.query,H=f.fragment,z=v+":";return I!==null?(z+="//",f.includesCredentials()&&(z+=m+(g?":"+g:"")+"@"),z+=Ua(I),x!==null&&(z+=":"+x)):v==="file"&&(z+="//"),z+=f.cannotBeABaseURL?D[0]:D.length?"/"+La(D,"/"):"",G!==null&&(z+="?"+G),H!==null&&(z+="#"+H),z},setHref:function(f){var v=this.parse(f);if(v)throw new th(v);this.searchParams.update()},getOrigin:function(){var f=this.scheme,v=this.port;if(f==="blob")try{return new Co(f.path[0]).origin}catch{return"null"}return f==="file"||!this.isSpecial()?"null":f+"://"+Ua(this.host)+(v!==null?":"+v:"")},getProtocol:function(){return this.scheme+":"},setProtocol:function(f){this.parse(Un(f)+":",ah)},getUsername:function(){return this.username},setUsername:function(f){var v=Oo(Un(f));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var m=0;m<v.length;m++)this.username+=Zn(v[m],oh)}},getPassword:function(){return this.password},setPassword:function(f){var v=Oo(Un(f));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var m=0;m<v.length;m++)this.password+=Zn(v[m],oh)}},getHost:function(){var f=this.host,v=this.port;return f===null?"":v===null?Ua(f):Ua(f)+":"+v},setHost:function(f){this.cannotBeABaseURL||this.parse(f,ch)},getHostname:function(){var f=this.host;return f===null?"":Ua(f)},setHostname:function(f){this.cannotBeABaseURL||this.parse(f,lh)},getPort:function(){var f=this.port;return f===null?"":Un(f)},setPort:function(f){this.cannotHaveUsernamePasswordPort()||(f=Un(f),f===""?this.port=null:this.parse(f,fh))},getPathname:function(){var f=this.path;return this.cannotBeABaseURL?f[0]:f.length?"/"+La(f,"/"):""},setPathname:function(f){this.cannotBeABaseURL||(this.path=[],this.parse(f,Ro))},getSearch:function(){var f=this.query;return f?"?"+f:""},setSearch:function(f){f=Un(f),f===""?this.query=null:(Ar(f,0)==="?"&&(f=Da(f,1)),this.query="",this.parse(f,Ai)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var f=this.fragment;return f?"#"+f:""},setHash:function(f){if(f=Un(f),f===""){this.fragment=null;return}Ar(f,0)==="#"&&(f=Da(f,1)),this.fragment="",this.parse(f,Bn)},update:function(){this.query=this.searchParams.serialize()||null}};var Co=function(v){var m=VD(this,Ht),g=JD(arguments.length,1)>1?arguments[1]:void 0,I=QD(m,new ph(v,!1,g));Qf||(m.href=I.serialize(),m.origin=I.getOrigin(),m.protocol=I.getProtocol(),m.username=I.getUsername(),m.password=I.getPassword(),m.host=I.getHost(),m.hostname=I.getHostname(),m.port=I.getPort(),m.pathname=I.getPathname(),m.search=I.getSearch(),m.searchParams=I.getSearchParams(),m.hash=I.getHash())},Ht=Co.prototype,Cr=function(f,v){return{get:function(){return Ou(this)[f]()},set:v&&function(m){return Ou(this)[v](m)},configurable:!0,enumerable:!0}};if(Qf&&(Or(Ht,"href",Cr("serialize","setHref")),Or(Ht,"origin",Cr("getOrigin")),Or(Ht,"protocol",Cr("getProtocol","setProtocol")),Or(Ht,"username",Cr("getUsername","setUsername")),Or(Ht,"password",Cr("getPassword","setPassword")),Or(Ht,"host",Cr("getHost","setHost")),Or(Ht,"hostname",Cr("getHostname","setHostname")),Or(Ht,"port",Cr("getPort","setPort")),Or(Ht,"pathname",Cr("getPathname","setPathname")),Or(Ht,"search",Cr("getSearch","setSearch")),Or(Ht,"searchParams",Cr("getSearchParams")),Or(Ht,"hash",Cr("getHash","setHash"))),Tu(Ht,"toJSON",function(){return Ou(this).serialize()},{enumerable:!0}),Tu(Ht,"toString",function(){return Ou(this).serialize()},{enumerable:!0}),Na){var sy=Na.createObjectURL,uy=Na.revokeObjectURL;sy&&Tu(Co,"createObjectURL",Hg(sy,Na)),uy&&Tu(Co,"revokeObjectURL",Hg(uy,Na))}YD(Co,"URL"),HD({global:!0,constructor:!0,forced:!GD,sham:!Qf},{URL:Co});var bU=_o,EU=po,cy=ue,SU=_u,ly=wo,IU=yu,vh=EU("URL"),TU=IU&&cy(function(){vh.canParse()}),OU=cy(function(){return vh.canParse.length!==1});bU({target:"URL",stat:!0,forced:!TU||OU},{canParse:function(v){var m=SU(arguments.length,1),g=ly(v),I=m<2||arguments[1]===void 0?void 0:ly(arguments[1]);try{return!!new vh(g,I)}catch{return!1}}});var AU=_o,RU=po,CU=_u,fy=wo,PU=yu,xU=RU("URL");AU({target:"URL",stat:!0,forced:!PU},{parse:function(v){var m=CU(arguments.length,1),g=fy(v),I=m<2||arguments[1]===void 0?void 0:fy(arguments[1]);try{return new xU(g,I)}catch{return null}}});var NU=Jl,LU=NU.URL,DU=LU,UU=DU,BU=UU,qU=BU,FU=qU,jU=FU,MU=ie(jU),kU=(function(f){r(v,f);function v(m){var g=f.call(this,m.message)||this;return g.name="PostgrestError",g.details=m.details,g.hint=m.hint,g.code=m.code,g}return v})(Error),$U=(function(){function f(v){var m,g;this.shouldThrowOnError=!1,this.method=v.method,this.url=v.url,this.headers=new Headers(v.headers),this.schema=v.schema,this.body=v.body,this.shouldThrowOnError=(m=v.shouldThrowOnError)!==null&&m!==void 0?m:!1,this.signal=v.signal,this.isMaybeSingle=(g=v.isMaybeSingle)!==null&&g!==void 0?g:!1,v.fetch?this.fetch=v.fetch:this.fetch=fetch}return f.prototype.throwOnError=function(){return this.shouldThrowOnError=!0,this},f.prototype.setHeader=function(v,m){return this.headers=new Headers(this.headers),this.headers.set(v,m),this},f.prototype.then=function(v,m){var g=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");var I=this.fetch,x=I(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(function(D){return o(g,void 0,void 0,function(){var G,H,z,J,j,oe,te,ce,oe,Re,we,Oe,wt,zr;return i(this,function(Gt){switch(Gt.label){case 0:return G=null,H=null,z=null,J=D.status,j=D.statusText,D.ok?this.method==="HEAD"?[3,2]:[4,D.text()]:[3,3];case 1:oe=Gt.sent(),oe===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((we=this.headers.get("Accept"))===null||we===void 0)&&we.includes("application/vnd.pgrst.plan+text"))?H=oe:H=JSON.parse(oe)),Gt.label=2;case 2:return te=(Oe=this.headers.get("Prefer"))===null||Oe===void 0?void 0:Oe.match(/count=(exact|planned|estimated)/),ce=(wt=D.headers.get("content-range"))===null||wt===void 0?void 0:wt.split("/"),te&&ce&&ce.length>1&&(z=parseInt(ce[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(H)&&(H.length>1?(G={code:"PGRST116",details:"Results contain ".concat(H.length," rows, application/vnd.pgrst.object+json requires 1 row"),hint:null,message:"JSON object requested, multiple (or no) rows returned"},H=null,z=null,J=406,j="Not Acceptable"):H.length===1?H=H[0]:H=null),[3,5];case 3:return[4,D.text()];case 4:oe=Gt.sent();try{G=JSON.parse(oe),Array.isArray(G)&&D.status===404&&(H=[],G=null,J=200,j="OK")}catch{D.status===404&&oe===""?(J=204,j="No Content"):G={message:oe}}if(G&&this.isMaybeSingle&&(!((zr=G?.details)===null||zr===void 0)&&zr.includes("0 rows"))&&(G=null,J=200,j="OK"),G&&this.shouldThrowOnError)throw new kU(G);Gt.label=5;case 5:return Re={error:G,data:H,count:z,status:J,statusText:j},[2,Re]}})})});return this.shouldThrowOnError||(x=x.catch(function(D){var G,H,z;return{error:{message:"".concat((G=D?.name)!==null&&G!==void 0?G:"FetchError",": ").concat(D?.message),details:"".concat((H=D?.stack)!==null&&H!==void 0?H:""),hint:"",code:"".concat((z=D?.code)!==null&&z!==void 0?z:"")},data:null,count:null,status:0,statusText:""}})),x.then(v,m)},f.prototype.returns=function(){return this},f.prototype.overrideTypes=function(){return this},f})(),WU=(function(f){r(v,f);function v(){return f!==null&&f.apply(this,arguments)||this}return v.prototype.select=function(m){var g=!1,I=(m??"*").split("").map(function(x){return/\s/.test(x)&&!g?"":(x==='"'&&(g=!g),x)}).join("");return this.url.searchParams.set("select",I),this.headers.append("Prefer","return=representation"),this},v.prototype.order=function(m,g){var I=g===void 0?{}:g,x=I.ascending,D=x===void 0?!0:x,G=I.nullsFirst,H=I.foreignTable,z=I.referencedTable,J=z===void 0?H:z,j=J?"".concat(J,".order"):"order",te=this.url.searchParams.get(j);return this.url.searchParams.set(j,"".concat(te?"".concat(te,","):"").concat(m,".").concat(D?"asc":"desc").concat(G===void 0?"":G?".nullsfirst":".nullslast")),this},v.prototype.limit=function(m,g){var I=g===void 0?{}:g,x=I.foreignTable,D=I.referencedTable,G=D===void 0?x:D,H=typeof G>"u"?"limit":"".concat(G,".limit");return this.url.searchParams.set(H,"".concat(m)),this},v.prototype.range=function(m,g,I){var x=I===void 0?{}:I,D=x.foreignTable,G=x.referencedTable,H=G===void 0?D:G,z=typeof H>"u"?"offset":"".concat(H,".offset"),J=typeof H>"u"?"limit":"".concat(H,".limit");return this.url.searchParams.set(z,"".concat(m)),this.url.searchParams.set(J,"".concat(g-m+1)),this},v.prototype.abortSignal=function(m){return this.signal=m,this},v.prototype.single=function(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this},v.prototype.maybeSingle=function(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this},v.prototype.csv=function(){return this.headers.set("Accept","text/csv"),this},v.prototype.geojson=function(){return this.headers.set("Accept","application/geo+json"),this},v.prototype.explain=function(m){var g,I=m===void 0?{}:m,x=I.analyze,D=x===void 0?!1:x,G=I.verbose,H=G===void 0?!1:G,z=I.settings,J=z===void 0?!1:z,j=I.buffers,te=j===void 0?!1:j,ce=I.wal,oe=ce===void 0?!1:ce,Re=I.format,we=Re===void 0?"text":Re,Oe=[D?"analyze":null,H?"verbose":null,J?"settings":null,te?"buffers":null,oe?"wal":null].filter(Boolean).join("|"),wt=(g=this.headers.get("Accept"))!==null&&g!==void 0?g:"application/json";return this.headers.set("Accept","application/vnd.pgrst.plan+".concat(we,'; for="').concat(wt,'"; options=').concat(Oe,";")),we==="json"?this:this},v.prototype.rollback=function(){return this.headers.append("Prefer","tx=rollback"),this},v.prototype.returns=function(){return this},v.prototype.maxAffected=function(m){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer","max-affected=".concat(m)),this},v})($U),qa=(function(f){r(v,f);function v(){return f!==null&&f.apply(this,arguments)||this}return v.prototype.eq=function(m,g){return this.url.searchParams.append(m,"eq.".concat(g)),this},v.prototype.neq=function(m,g){return this.url.searchParams.append(m,"neq.".concat(g)),this},v.prototype.gt=function(m,g){return this.url.searchParams.append(m,"gt.".concat(g)),this},v.prototype.gte=function(m,g){return this.url.searchParams.append(m,"gte.".concat(g)),this},v.prototype.lt=function(m,g){return this.url.searchParams.append(m,"lt.".concat(g)),this},v.prototype.lte=function(m,g){return this.url.searchParams.append(m,"lte.".concat(g)),this},v.prototype.like=function(m,g){return this.url.searchParams.append(m,"like.".concat(g)),this},v.prototype.likeAllOf=function(m,g){return this.url.searchParams.append(m,"like(all).{".concat(g.join(","),"}")),this},v.prototype.likeAnyOf=function(m,g){return this.url.searchParams.append(m,"like(any).{".concat(g.join(","),"}")),this},v.prototype.ilike=function(m,g){return this.url.searchParams.append(m,"ilike.".concat(g)),this},v.prototype.ilikeAllOf=function(m,g){return this.url.searchParams.append(m,"ilike(all).{".concat(g.join(","),"}")),this},v.prototype.ilikeAnyOf=function(m,g){return this.url.searchParams.append(m,"ilike(any).{".concat(g.join(","),"}")),this},v.prototype.is=function(m,g){return this.url.searchParams.append(m,"is.".concat(g)),this},v.prototype.in=function(m,g){var I=Array.from(new Set(g)).map(function(x){return typeof x=="string"&&new RegExp("[,()]").test(x)?'"'.concat(x,'"'):"".concat(x)}).join(",");return this.url.searchParams.append(m,"in.(".concat(I,")")),this},v.prototype.contains=function(m,g){return typeof g=="string"?this.url.searchParams.append(m,"cs.".concat(g)):Array.isArray(g)?this.url.searchParams.append(m,"cs.{".concat(g.join(","),"}")):this.url.searchParams.append(m,"cs.".concat(JSON.stringify(g))),this},v.prototype.containedBy=function(m,g){return typeof g=="string"?this.url.searchParams.append(m,"cd.".concat(g)):Array.isArray(g)?this.url.searchParams.append(m,"cd.{".concat(g.join(","),"}")):this.url.searchParams.append(m,"cd.".concat(JSON.stringify(g))),this},v.prototype.rangeGt=function(m,g){return this.url.searchParams.append(m,"sr.".concat(g)),this},v.prototype.rangeGte=function(m,g){return this.url.searchParams.append(m,"nxl.".concat(g)),this},v.prototype.rangeLt=function(m,g){return this.url.searchParams.append(m,"sl.".concat(g)),this},v.prototype.rangeLte=function(m,g){return this.url.searchParams.append(m,"nxr.".concat(g)),this},v.prototype.rangeAdjacent=function(m,g){return this.url.searchParams.append(m,"adj.".concat(g)),this},v.prototype.overlaps=function(m,g){return typeof g=="string"?this.url.searchParams.append(m,"ov.".concat(g)):this.url.searchParams.append(m,"ov.{".concat(g.join(","),"}")),this},v.prototype.textSearch=function(m,g,I){var x=I===void 0?{}:I,D=x.config,G=x.type,H="";G==="plain"?H="pl":G==="phrase"?H="ph":G==="websearch"&&(H="w");var z=D===void 0?"":"(".concat(D,")");return this.url.searchParams.append(m,"".concat(H,"fts").concat(z,".").concat(g)),this},v.prototype.match=function(m){var g=this;return Object.entries(m).forEach(function(I){var x=I[0],D=I[1];g.url.searchParams.append(x,"eq.".concat(D))}),this},v.prototype.not=function(m,g,I){return this.url.searchParams.append(m,"not.".concat(g,".").concat(I)),this},v.prototype.or=function(m,g){var I=g===void 0?{}:g,x=I.foreignTable,D=I.referencedTable,G=D===void 0?x:D,H=G?"".concat(G,".or"):"or";return this.url.searchParams.append(H,"(".concat(m,")")),this},v.prototype.filter=function(m,g,I){return this.url.searchParams.append(m,"".concat(g,".").concat(I)),this},v})(WU),HU=(function(){function f(v,m){var g=m.headers,I=g===void 0?{}:g,x=m.schema,D=m.fetch;this.url=v,this.headers=new Headers(I),this.schema=x,this.fetch=D}return f.prototype.select=function(v,m){var g=m===void 0?{}:m,I=g.head,x=I===void 0?!1:I,D=g.count,G=x?"HEAD":"GET",H=!1,z=(v??"*").split("").map(function(J){return/\s/.test(J)&&!H?"":(J==='"'&&(H=!H),J)}).join("");return this.url.searchParams.set("select",z),D&&this.headers.append("Prefer","count=".concat(D)),new qa({method:G,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})},f.prototype.insert=function(v,m){var g,I=m===void 0?{}:m,x=I.count,D=I.defaultToNull,G=D===void 0?!0:D,H="POST";if(x&&this.headers.append("Prefer","count=".concat(x)),G||this.headers.append("Prefer","missing=default"),Array.isArray(v)){var z=v.reduce(function(j,te){return j.concat(Object.keys(te))},[]);if(z.length>0){var J=Array.from(new Set(z)).map(function(j){return'"'.concat(j,'"')});this.url.searchParams.set("columns",J.join(","))}}return new qa({method:H,url:this.url,headers:this.headers,schema:this.schema,body:v,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})},f.prototype.upsert=function(v,m){var g,I=m===void 0?{}:m,x=I.onConflict,D=I.ignoreDuplicates,G=D===void 0?!1:D,H=I.count,z=I.defaultToNull,J=z===void 0?!0:z,j="POST";if(this.headers.append("Prefer","resolution=".concat(G?"ignore":"merge","-duplicates")),x!==void 0&&this.url.searchParams.set("on_conflict",x),H&&this.headers.append("Prefer","count=".concat(H)),J||this.headers.append("Prefer","missing=default"),Array.isArray(v)){var te=v.reduce(function(oe,Re){return oe.concat(Object.keys(Re))},[]);if(te.length>0){var ce=Array.from(new Set(te)).map(function(oe){return'"'.concat(oe,'"')});this.url.searchParams.set("columns",ce.join(","))}}return new qa({method:j,url:this.url,headers:this.headers,schema:this.schema,body:v,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})},f.prototype.update=function(v,m){var g,I=m===void 0?{}:m,x=I.count,D="PATCH";return x&&this.headers.append("Prefer","count=".concat(x)),new qa({method:D,url:this.url,headers:this.headers,schema:this.schema,body:v,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})},f.prototype.delete=function(v){var m,g=v===void 0?{}:v,I=g.count,x="DELETE";return I&&this.headers.append("Prefer","count=".concat(I)),new qa({method:x,url:this.url,headers:this.headers,schema:this.schema,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})},f})(),GU=(function(f){r(v,f);function v(m,g){var I=g.headers,x=I===void 0?{}:I,D=g.fetch;return f.call(this,m,{headers:x,schema:void 0,fetch:D})||this}return v})(HU),VU=(function(){function f(v,m){var g=m===void 0?{}:m,I=g.headers,x=I===void 0?{}:I,D=g.fetch;this.url=v,this.headers=new Headers(x),this.fetch=D}return f.prototype.from=function(v){var m=new MU("".concat(this.url,"/").concat(v));return new GU(m,{headers:this.headers,fetch:this.fetch})},f})();function zU(f,v){var m=this;if(!f)throw new Error("cloud is required");if(!f.callFunction)throw new Error("cloud.callFunction is required");var g=f.callFunction.bind(f),I;try{var x=function(H){var z=H.url,J=H.body,j=H.method,te=H.headers;return o(m,void 0,void 0,function(){var ce,oe,Re;return i(this,function(we){switch(we.label){case 0:return[4,g({name:"httpOverCallFunction",data:{url:z,method:j?.toUpperCase(),headers:n(n({},te||{}),{"Content-Type":"application/json"}),body:J}})];case 1:return ce=we.sent(),oe=(Re=ce?.result)===null||Re===void 0?void 0:Re.body,[2,oe]}})})},D=v?.baseUrl||mh(f,v?.envId).model,G=v?.sqlBaseUrl||mh(f,v?.envId).sql;I=q(g,x,D,{sqlBaseUrl:G})}catch(H){console.error("init http orm client failed, try call function orm",H),I=Y(g)}return f.models=I,f.mysql=Fa(f,{envId:v?.envId,mysqlBaseUrl:v?.mysqlBaseUrl}),f}function hy(f,v){if(!f)throw new Error("cloud is required");if(!f.callFunction)throw new Error("cloud.callFunction is required");var m=f.callFunction.bind(f);return f.models=Y(m),f.mysql=Fa(f,{envId:v?.envId}),f.rdb=Fa(f,{envId:v?.envId}),f}function Fa(f,v){var m=v?.envId,g=v?.mysqlBaseUrl||mh(f,v?.envId).mysql,I=v?.fetch;return function(x){var D=this;return new VU(g,{fetch:I||(function(G,H){return o(D,void 0,void 0,function(){var z,J,j;return i(this,function(te){return z=x?.instance||"default",J=x?.database||m,j={},H?.headers instanceof Headers?H.headers.forEach(function(ce,oe){j[oe]=ce}):j=H?.headers||{},[2,f.callFunction({name:"httpOverCallFunction",data:{url:G.toString(),method:H?.method||"GET",headers:n(n({},j||{}),{"Content-Type":"application/json","X-Db-Instance":z,"Accept-Profile":J,"Content-Profile":J}),body:H?.body}}).then(function(ce){var oe=ce?.result,Re={ok:oe?.statusCode>=200&&oe?.statusCode<300,status:oe?.statusCode||200,statusText:oe?.statusMessage||"OK",json:function(){return Promise.resolve(oe?.body||{})},text:function(){return Promise.resolve(typeof oe?.body=="string"?oe.body:JSON.stringify(oe?.body||{}))},headers:new Headers(oe?.headers||{})};return Re})]})})})})}}function mh(f,v){var m,g,I,x,D=v||((g=(m=f?.extend)===null||m===void 0?void 0:m.AI)===null||g===void 0?void 0:g.env);if((typeof D!="string"||!D.trim())&&(D=(I=f?.config)===null||I===void 0?void 0:I.env),(typeof D!="string"||!D.trim())&&(D=(x=f?.config)===null||x===void 0?void 0:x.envName),typeof D!="string"||!D.trim())throw new Error("Generating default gateway base url failed: env not found");return D=D.trim(),{model:"https://".concat(D,".api.tcloudbasegateway.com/v1/model"),sql:"https://".concat(D,".api.tcloudbasegateway.com/v1/sql"),mysql:"https://".concat(D,".api.tcloudbasegateway.com/v1/rdb/rest")}}var KU={init:hy,generateHTTPClient:q,generateMySQLClient:Fa};t.default=KU,t.generateHTTPClient=q,t.generateMySQLClient=Fa,t.init=hy,t.initHTTPOverCallFunction=zU,Object.defineProperty(t,"__esModule",{value:!0})}))});var ht={};Pr(ht,{lazyGetEntity:()=>RO,registerModel:()=>ul});function PW(t){var e=this,r=t.callFunction.bind(t),n=t.request.fetch.bind(t.request),o=function(h){return AW(e,void 0,void 0,function(){var w;return RW(this,function(E){switch(E.label){case 0:return[4,n(no(no({},h),{headers:no({"Content-Type":"application/json"},h.headers)}))];case 1:return w=E.sent(),[4,w.data];case 2:return[2,E.sent()]}})})},i=t.getEndPointWithKey("GATEWAY"),s=i.BASE_URL,u=i.PROTOCOL,l="".concat(u).concat(s,"/model"),a="".concat(u).concat(s,"/sql"),c=(0,AO.generateHTTPClient)(r,o,l,{sqlBaseUrl:a});return c}function RO(t){return new Proxy({},{get:function(e,r){var n=t.getEndPointWithKey("GATEWAY"),o=n.BASE_URL,i=n.PROTOCOL,s=no(no({},t),{BASE_URL:o,PROTOCOL:i}),u=OO.get(s);return u||(u=PW(t),OO.set(s,u)),u[r]}})}function ul(t){try{t.registerComponent(xO)}catch(e){console.warn(e)}}var AO,no,AW,RW,CW,TO,OO,CO,PO,xO,NO=X(()=>{AO=st(Fs());Lt();Be(ht,st(Fs()));no=function(){return no=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},no.apply(this,arguments)},AW=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},RW=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},CW=$u.CloudbaseEventEmitter,TO="models";OO=new WeakMap;CO="cloudbase_init",PO=new CW;PO.on(CO,function(t){var e=t.data;Object.assign(e,{models:RO(e)})});xO={name:TO,namespace:TO,entity:new Proxy({},{get:function(t,e){console.warn("\u3010deprecated\u3011Accessing Cloudbase.prototype.models.".concat(e,"."))}}),injectEvents:{bus:PO,events:[CO]}};try{cloudbase.registerComponent(xO)}catch{}try{window.registerModel=ul}catch{}});function UO(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");fv(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}function ia(t){if(!t)throw new TypeError("Assertion failed")}function js(){}function xW(t){return typeof t=="object"&&t!==null||typeof t=="function"}function NW(t){if(typeof t!="function")return!1;var e=!1;try{new t({start:function(){e=!0}})}catch{}return e}function BO(t){return!(!xW(t)||typeof t.getReader!="function")}function LW(t){return!(!NW(t)||!BO(new t))}function qO(t){try{var e=t.getReader({mode:"byob"});return e.releaseLock(),!0}catch{return!1}}function DW(t){try{return new t({type:"bytes"}),!0}catch{return!1}}function FO(t){ia(LW(t));var e=DW(t);return function(r,n){var o=n===void 0?{}:n,i=o.type;if(i=jO(i),i==="bytes"&&!e&&(i=void 0),r.constructor===t&&(i!=="bytes"||qO(r)))return r;if(i==="bytes"){var s=LO(r,{type:i});return new t(s)}else{var s=LO(r);return new t(s)}}}function LO(t,e){var r=e===void 0?{}:e,n=r.type;ia(BO(t)),ia(t.locked===!1),n=jO(n);var o;return n==="bytes"?o=new qW(t):o=new UW(t),o}function jO(t){var e=String(t);if(e==="bytes")return e;if(t===void 0)return t;throw new RangeError("Invalid type is specified")}function DO(t){return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}function BW(t,e){var r=DO(t),n=DO(e);n.set(r,0)}var fv,MO,UW,qW,HK,GK,kO=X(()=>{fv=function(t,e){return fv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},fv(t,e)};MO=(function(){function t(e){this._underlyingReader=void 0,this._readerMode=void 0,this._readableStreamController=void 0,this._pendingRead=void 0,this._underlyingStream=e,this._attachDefaultReader()}return t.prototype.start=function(e){this._readableStreamController=e},t.prototype.cancel=function(e){return ia(this._underlyingReader!==void 0),this._underlyingReader.cancel(e)},t.prototype._attachDefaultReader=function(){if(this._readerMode!=="default"){this._detachReader();var e=this._underlyingStream.getReader();this._readerMode="default",this._attachReader(e)}},t.prototype._attachReader=function(e){var r=this;ia(this._underlyingReader===void 0),this._underlyingReader=e;var n=this._underlyingReader.closed;n&&n.then(function(){return r._finishPendingRead()}).then(function(){e===r._underlyingReader&&r._readableStreamController.close()},function(o){e===r._underlyingReader&&r._readableStreamController.error(o)}).catch(js)},t.prototype._detachReader=function(){this._underlyingReader!==void 0&&(this._underlyingReader.releaseLock(),this._underlyingReader=void 0,this._readerMode=void 0)},t.prototype._pullWithDefaultReader=function(){var e=this;this._attachDefaultReader();var r=this._underlyingReader.read().then(function(n){var o=e._readableStreamController;n.done?e._tryClose():o.enqueue(n.value)});return this._setPendingRead(r),r},t.prototype._tryClose=function(){try{this._readableStreamController.close()}catch{}},t.prototype._setPendingRead=function(e){var r=this,n,o=function(){r._pendingRead===n&&(r._pendingRead=void 0)};this._pendingRead=n=e.then(o,o)},t.prototype._finishPendingRead=function(){var e=this;if(this._pendingRead){var r=function(){return e._finishPendingRead()};return this._pendingRead.then(r,r)}},t})(),UW=(function(t){UO(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.pull=function(){return this._pullWithDefaultReader()},e})(MO);qW=(function(t){UO(e,t);function e(r){var n=this,o=qO(r);return n=t.call(this,r)||this,n._supportsByob=o,n}return Object.defineProperty(e.prototype,"type",{get:function(){return"bytes"},enumerable:!1,configurable:!0}),e.prototype._attachByobReader=function(){if(this._readerMode!=="byob"){ia(this._supportsByob),this._detachReader();var r=this._underlyingStream.getReader({mode:"byob"});this._readerMode="byob",this._attachReader(r)}},e.prototype.pull=function(){if(this._supportsByob){var r=this._readableStreamController.byobRequest;if(r)return this._pullWithByobRequest(r)}return this._pullWithDefaultReader()},e.prototype._pullWithByobRequest=function(r){var n=this;this._attachByobReader();var o=new Uint8Array(r.view.byteLength),i=this._underlyingReader.read(o).then(function(s){n._readableStreamController,s.done?(n._tryClose(),r.respond(0)):(BW(s.value,r.view),r.respond(s.value.byteLength))});return this._setPendingRead(i),i},e})(MO),HK=(function(){function t(e){var r=this;this._writableStreamController=void 0,this._pendingWrite=void 0,this._state="writable",this._storedError=void 0,this._underlyingWriter=e,this._errorPromise=new Promise(function(n,o){r._errorPromiseReject=o}),this._errorPromise.catch(js)}return t.prototype.start=function(e){var r=this;this._writableStreamController=e,this._underlyingWriter.closed.then(function(){r._state="closed"}).catch(function(n){return r._finishErroring(n)})},t.prototype.write=function(e){var r=this,n=this._underlyingWriter;if(n.desiredSize===null)return n.ready;var o=n.write(e);o.catch(function(s){return r._finishErroring(s)}),n.ready.catch(function(s){return r._startErroring(s)});var i=Promise.race([o,this._errorPromise]);return this._setPendingWrite(i),i},t.prototype.close=function(){var e=this;return this._pendingWrite===void 0?this._underlyingWriter.close():this._finishPendingWrite().then(function(){return e.close()})},t.prototype.abort=function(e){if(this._state!=="errored"){var r=this._underlyingWriter;return r.abort(e)}},t.prototype._setPendingWrite=function(e){var r=this,n,o=function(){r._pendingWrite===n&&(r._pendingWrite=void 0)};this._pendingWrite=n=e.then(o,o)},t.prototype._finishPendingWrite=function(){var e=this;if(this._pendingWrite===void 0)return Promise.resolve();var r=function(){return e._finishPendingWrite()};return this._pendingWrite.then(r,r)},t.prototype._startErroring=function(e){var r=this;if(this._state==="writable"){this._state="erroring",this._storedError=e;var n=function(){return r._finishErroring(e)};this._pendingWrite===void 0?n():this._finishPendingWrite().then(n,n),this._writableStreamController.error(e)}},t.prototype._finishErroring=function(e){this._state==="writable"&&this._startErroring(e),this._state==="erroring"&&(this._state="errored",this._errorPromiseReject(this._storedError))},t})(),GK=(function(){function t(e,r){var n=this;this._transformStreamController=void 0,this._onRead=function(o){if(!o.done)return n._transformStreamController.enqueue(o.value),n._reader.read().then(n._onRead)},this._onError=function(o){n._flushReject(o),n._transformStreamController.error(o),n._reader.cancel(o).catch(js),n._writer.abort(o).catch(js)},this._onTerminate=function(){n._flushResolve(),n._transformStreamController.terminate();var o=new TypeError("TransformStream terminated");n._writer.abort(o).catch(js)},this._reader=e,this._writer=r,this._flushPromise=new Promise(function(o,i){n._flushResolve=o,n._flushReject=i})}return t.prototype.start=function(e){this._transformStreamController=e,this._reader.read().then(this._onRead).then(this._onTerminate,this._onError);var r=this._reader.closed;r&&r.then(this._onTerminate,this._onError)},t.prototype.transform=function(e){return this._writer.write(e)},t.prototype.flush=function(){var e=this;return this._writer.close().then(function(){return e._flushPromise})},t})()});function hv(t){var e,r,n,o,i,s,u;return l(),{feed:a,reset:l};function l(){e=!0,r="",n=0,o=-1,i=void 0,s=void 0,u=""}function a(h){r=r?r+h:h,e&&FW(r)&&(r=r.slice($O.length)),e=!1;for(var w=r.length,E=0,T=!1;E<w;){T&&(r[E]===`
`&&(E+=1),T=!1);for(var A=-1,O=o,C=void 0,P=n;A<0&&P<w;P++)C=r[P],C===":"&&O<0?O=P-E:C==="\r"?(T=!0,A=P-E):C===`
`&&(A=P-E);if(A<0){n=w-E,o=O;break}else n=0,o=-1;c(r,E,O,A),E+=A+1}E===w?r="":E>0&&(r=r.slice(E))}function c(h,w,E,T){if(T===0){u.length>0&&(t({type:"event",id:i,event:s||void 0,data:u.slice(0,-1)}),u="",i=void 0),s=void 0;return}var A=E<0,O=h.slice(w,w+(A?T:E)),C=0;A?C=T:h[w+E+1]===" "?C=E+2:C=E+1;var P=w+C,q=T-C,U=h.slice(P,P+q).toString();if(O==="data")u+=U?"".concat(U,`
`):`
`;else if(O==="event")s=U;else if(O==="id"&&!U.includes("\0"))i=U;else if(O==="retry"){var k=parseInt(U,10);Number.isNaN(k)||t({type:"reconnect-interval",value:k})}}}function FW(t){return $O.every(function(e,r){return t.charCodeAt(r)===e})}var $O,WO=X(()=>{$O=[239,187,191]});var HO=X(()=>{WO()});var VO=K((dv,GO)=>{(function(t,e){if(typeof define=="function"&&define.amd)define([],e);else if(typeof dv=="object")GO.exports=e();else{var r=e();t.TextEncoder=r.TextEncoder,t.TextDecoder=r.TextDecoder}})(dv,function(){"use strict";var t=typeof global<"u"?global:self;if(typeof t.TextEncoder<"u"&&typeof t.TextDecoder<"u")return{TextEncoder:t.TextEncoder,TextDecoder:t.TextDecoder};var e=["utf8","utf-8","unicode-1-1-utf-8"],r=function(o){if(e.indexOf(o)<0&&typeof o<"u"&&o!==null)throw new RangeError("Invalid encoding type. Only utf-8 is supported");this.encoding="utf-8",this.encode=function(i){if(typeof i!="string")throw new TypeError("passed argument must be of type string");var s=unescape(encodeURIComponent(i)),u=new Uint8Array(s.length);return s.split("").forEach(function(l,a){u[a]=l.charCodeAt(0)}),u}},n=function(o,i){if(e.indexOf(o)<0&&typeof o<"u"&&o!==null)throw new RangeError("Invalid encoding type. Only utf-8 is supported");if(this.encoding="utf-8",this.ignoreBOM=!1,this.fatal=typeof i<"u"&&"fatal"in i?i.fatal:!1,typeof this.fatal!="boolean")throw new TypeError("fatal flag must be boolean");this.decode=function(s,u){if(typeof s>"u")return"";var l=typeof u<"u"&&"stream"in u?u.stream:!1;if(typeof l!="boolean")throw new TypeError("stream option must be boolean");if(ArrayBuffer.isView(s)){var a=new Uint8Array(s.buffer,s.byteOffset,s.byteLength),c=new Array(a.length);return a.forEach(function(h,w){c[w]=String.fromCharCode(h)}),decodeURIComponent(escape(c.join("")))}else throw new TypeError("passed argument must be an array buffer view")}};return{TextEncoder:r,TextDecoder:n}})});function Pe(t){var e=t;return e[Symbol.asyncIterator]=function(){var r=t.getReader();return{next:function(){return zO(this,void 0,void 0,function(){var n,o,i;return KO(this,function(s){switch(s.label){case 0:return[4,r.read()];case 1:return n=s.sent(),o=n.done,i=n.value,[2,o?{done:!0,value:void 0}:{done:!1,value:i}]}})})}}},e}function ot(t){return Pe(t.pipeThrough(new cl).pipeThrough(pv()).pipeThrough(new qe({transform:function(e,r){try{var n=JSON.parse(e.data);r.enqueue(n)}catch(o){e.data!=="[DONE]"?console.warn("Error when transforming event source data to json",o,e):r.terminate()}}})))}function kW(t){return Pe(Qe(t).pipeThrough(new cl))}function JO(t){var e,r,n,o;return zO(this,void 0,void 0,function(){var i,s,u,l,a,c,h;return KO(this,function(w){switch(w.label){case 0:i=kW(t),s="",w.label=1;case 1:w.trys.push([1,6,7,12]),u=!0,l=jW(i),w.label=2;case 2:return[4,l.next()];case 3:if(a=w.sent(),e=a.done,!!e)return[3,5];o=a.value,u=!1;try{c=o,s+=c}finally{u=!0}w.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return h=w.sent(),r={error:h},[3,12];case 7:return w.trys.push([7,,10,11]),!u&&!e&&(n=l.return)?[4,n.call(l)]:[3,9];case 8:w.sent(),w.label=9;case 9:return[3,11];case 10:if(r)throw r.error;return[7];case 11:return[7];case 12:return[2,JSON.parse(s)]}})})}function vv(){var t,e,r=new Promise(function(n,o){t=n,e=o});return{promise:r,res:t,rej:e}}function Ze(t){var e;return t.role==="assistant"&&"tool_calls"in t&&((e=t.tool_calls)===null||e===void 0?void 0:e[0])!=null}function QO(t){return{type:"function",function:{description:t.description,name:t.name,parameters:t.parameters}}}var YO,zO,KO,jW,MW,qe,pv,Qe,cl,Ft=X(()=>{Od();kO();HO();YO=st(VO()),zO=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},KO=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},jW=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=t[i]&&function(s){return new Promise(function(u,l){s=t[i](s),o(u,l,s.done,s.value)})}}function o(i,s,u,l){Promise.resolve(l).then(function(a){i({value:a,done:u})},s)}},MW=ut,qe=Wi,pv=function(){var t;return new qe({start:function(e){t=hv(function(r){r.type==="event"&&e.enqueue(r)})},transform:function(e){t.feed(e)}})},Qe=FO(MW),cl=(function(){function t(e,r){e===void 0&&(e="utf-8"),r===void 0&&(r={});var n=this;this.transform=new qe({transform:function(o,i){var s=n.handle.decode(new Uint8Array(o),{stream:!0});s&&i.enqueue(s)},flush:function(o){var i=n.handle.decode();i&&o.enqueue(i),o.terminate()}}),this.handle=new YO.TextDecoder(e,r)}return Object.defineProperty(t.prototype,"encoding",{get:function(){return this.handle.encoding},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fatal",{get:function(){return this.handle.fatal},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ignoreBOM",{get:function(){return this.handle.ignoreBOM},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"readable",{get:function(){return this.transform.readable},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"writable",{get:function(){return this.transform.writable},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,Symbol.toStringTag,{get:function(){return"TextDecoderStream"},enumerable:!1,configurable:!0}),t})()});var gi,tn,rn,ll,mv,fl,gv=X(()=>{Ft();gi=function(){return gi=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},gi.apply(this,arguments)},tn=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},rn=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},ll=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]]);return r},mv=(function(){function t(e,r){this.baseUrl=r;var n=arguments[2];typeof n=="string"?this.req=function(o){var i=o.headers,s=i===void 0?{}:i,u=ll(o,["headers"]);return e(gi(gi({},u),{headers:gi(gi({},s),{Authorization:"Bearer ".concat(n)})}))}:this.req=e}return t.prototype.list=function(e,r){return this.req({method:"get",url:this.join("bots"),data:e,timeout:r?.timeout})},t.prototype.create=function(e,r){var n=e.botInfo;return this.req({method:"post",url:this.join("bots"),data:n,timeout:r?.timeout})},t.prototype.get=function(e,r){var n=e.botId;return this.req({method:"get",url:this.join("bots/".concat(n)),timeout:r?.timeout})},t.prototype.update=function(e,r){var n=e.botId,o=e.botInfo;return this.req({method:"PATCH",url:this.join("bots/".concat(n)),data:o,timeout:r?.timeout})},t.prototype.delete=function(e,r){var n=e.botId;return this.req({method:"delete",url:this.join("bots/".concat(n)),timeout:r?.timeout})},t.prototype.getChatRecords=function(e,r){return this.req({method:"get",url:this.join("bots/".concat(e.botId,"/records")),data:e,timeout:r?.timeout})},t.prototype.sendFeedback=function(e,r){var n=e.userFeedback;return this.req({method:"post",url:this.join("bots/".concat(n.botId,"/feedback")),data:n,timeout:r?.timeout})},t.prototype.getFeedback=function(e,r){return this.req({method:"get",url:this.join("bots/".concat(e.botId,"/feedback")),data:e,timeout:r?.timeout})},t.prototype.uploadFiles=function(e,r){return tn(this,void 0,void 0,function(){return rn(this,function(n){return[2,this.req({method:"post",url:this.join("bots/".concat(e.botId,"/files")),data:e,timeout:r?.timeout})]})})},t.prototype.createConversation=function(e,r){var n=e.botId,o=ll(e,["botId"]);return tn(this,void 0,void 0,function(){return rn(this,function(i){return[2,this.req({method:"post",url:this.join("bots/".concat(n,"/conversation")),data:o,timeout:r?.timeout})]})})},t.prototype.getConversation=function(e,r){var n=e.pageSize,o=n===void 0?10:n,i=e.pageNumber,s=i===void 0?1:i,u=e.botId,l=ll(e,["pageSize","pageNumber","botId"]);return tn(this,void 0,void 0,function(){var a,c;return rn(this,function(h){if(s<1)throw new Error("pageNumber must be greater than 0");return a=o*(s-1),c=o,[2,this.req({method:"get",url:this.join("bots/".concat(u,"/conversation")),data:gi(gi({},l),{offset:a,limit:c}),timeout:r?.timeout})]})})},t.prototype.deleteConversation=function(e,r){var n=e.botId,o=e.conversationId,i=ll(e,["botId","conversationId"]);return tn(this,void 0,void 0,function(){return rn(this,function(s){return[2,this.req({method:"delete",url:this.join("bots/".concat(n,"/conversation/").concat(o)),data:i,timeout:r?.timeout})]})})},t.prototype.speechToText=function(e,r){return tn(this,void 0,void 0,function(){return rn(this,function(n){return[2,this.req({method:"post",url:this.join("bots/".concat(e.botId,"/speech-to-text")),data:e,timeout:r?.timeout})]})})},t.prototype.textToSpeech=function(e,r){return tn(this,void 0,void 0,function(){return rn(this,function(n){return[2,this.req({method:"post",url:this.join("bots/".concat(e.botId,"/text-to-speech")),data:e,timeout:r?.timeout})]})})},t.prototype.getTextToSpeechResult=function(e,r){return tn(this,void 0,void 0,function(){return rn(this,function(n){return[2,this.req({method:"get",url:this.join("bots/".concat(e.botId,"/text-to-speech")),data:e,timeout:r?.timeout})]})})},t.prototype.getRecommendQuestions=function(e,r){return tn(this,void 0,void 0,function(){var n;return rn(this,function(o){switch(o.label){case 0:return[4,this.req({method:"post",url:this.join("bots/".concat(e.botId,"/recommend-questions")),data:e,stream:!0,timeout:r?.timeout})];case 1:return n=o.sent(),[2,new fl(n)]}})})},t.prototype.generateBot=function(e,r){return tn(this,void 0,void 0,function(){var n;return rn(this,function(o){switch(o.label){case 0:return[4,this.req({method:"post",url:this.join("generate-bot"),data:e,stream:!0,timeout:r?.timeout})];case 1:return n=o.sent(),[2,new fl(n)]}})})},t.prototype.getPreview=function(e,r){return tn(this,void 0,void 0,function(){var n;return rn(this,function(o){switch(o.label){case 0:return[4,this.req({method:"post",url:this.join("preview"),data:e,stream:!0,timeout:r?.timeout})];case 1:return n=o.sent(),[2,new fl(n)]}})})},t.prototype.generateImage=function(e,r){return this.req({method:"post",url:this.join("generate-image"),data:e,timeout:r?.timeout})},t.prototype.sendMessage=function(e,r){return tn(this,void 0,void 0,function(){var n;return rn(this,function(o){switch(o.label){case 0:return[4,this.req({method:"post",url:this.join("bots/".concat(e.botId,"/send-message")),data:e,stream:!0,timeout:r?.timeout})];case 1:return n=o.sent(),[2,new fl(n)]}})})},t.prototype.join=function(e){return"".concat(this.baseUrl,"/").concat(e)},t})(),fl=(function(){function t(e){var r=Qe(e);this._eventSourceStream=r.pipeThrough(new cl).pipeThrough(pv())}return Object.defineProperty(t.prototype,"teeedStream",{get:function(){var e=this._eventSourceStream.tee(),r=e[0],n=e[1];return this._eventSourceStream=n,r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"eventSourceStream",{get:function(){return Pe(this.teeedStream)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataStream",{get:function(){return Pe(this.eventSourceStream.pipeThrough(new qe({transform:function(e,r){try{var n=JSON.parse(e.data);r.enqueue(n)}catch(o){e.data!=="[DONE]"?console.warn("Error when transforming event source data to json",o,e):r.terminate()}}})))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textStream",{get:function(){return Pe(this.dataStream.pipeThrough(new qe({transform:function(e,r){var n;r.enqueue((n=e?.content)!==null&&n!==void 0?n:"")}})))},enumerable:!1,configurable:!0}),t})()});function eA(t){var e=t.messages,r=t.model,n=t.temperature,o=t.tool_choice,i=t.tools,s=t.top_p,u=function(){return o&&o!=="auto"&&console.warn("`tool_choice` is not 'auto'"),o};return jt(jt({},t),{messages:e,model:r,temperature:n,tool_choice:u(),tools:i,top_p:s})}var jt,XO,ZO,yv,tA=X(()=>{Ft();jt=function(){return jt=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},jt.apply(this,arguments)},XO=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},ZO=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};yv=(function(){function t(e,r,n){this.req=e,this.baseUrl=r,this.subUrl="zhipu/api/paas/v4/chat/completions",n!=null&&(this.subUrl=n)}return Object.defineProperty(t.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),t.prototype.doGenerate=function(e,r){return XO(this,void 0,void 0,function(){var n,o;return ZO(this,function(i){switch(i.label){case 0:return n=eA(e),[4,this.req({url:this.url,data:jt(jt({},n),{stream:!1}),stream:!1,timeout:r?.timeout})];case 1:return o=i.sent(),[2,jt(jt({},o),{rawResponse:o})]}})})},t.prototype.doStream=function(e,r){return XO(this,void 0,void 0,function(){var n,o,i,s,u,l;return ZO(this,function(a){switch(a.label){case 0:return n=eA(e),o=null,[4,this.req({url:this.url,data:jt(jt({},n),{stream:!0}),stream:!0,timeout:r?.timeout})];case 1:return i=a.sent(),s=Qe(i),u=ot(s),l=u.pipeThrough(new qe({transform:function(c,h){var w=c.choices.map(function(T){var A=T.delta;return o==null&&(o=Ze(A)),o?jt(jt({},T),{finish_reason:"tool_calls",delta:A}):T}),E=jt(jt({},c),{choices:w});h.enqueue(jt(jt({},E),{rawResponse:c}))}})),[2,Pe(l)]}})})},t})()});function nn(t){var e=t.messages,r=t.model,n=t.temperature,o=t.tool_choice,i=t.tools,s=t.top_p,u=function(){if(i)return i.forEach(function(a){a.type!=="function"&&console.warn("`type` in tool is not 'function'",a)}),i},l=function(){return e.forEach(function(a){"tool_calls"in a&&a.tool_calls.filter(function(c){return c.type!=="function"}).forEach(function(c){return console.warn("`type` in tool_call is not 'function'",c,a)})}),e};return hl(hl({},t),{messages:l(),model:r,tools:u(),top_p:s,tool_choice:o,temperature:n})}function Ms(t){if(typeof t!="object"||t==null)return t;if(Array.isArray(t))return t.map(function(r){return Ms(r)});return Object.entries(t).reduce(function(r,n){var o=n[0],i=n[1],s=e(o);return r[s]=typeof i=="object"?Ms(i):i,r},{});function e(r){var n=r.replace(/[A-Z]/g,function(o){return"_".concat(o.toLowerCase())});return n.charAt(0)==="_"?n.slice(1):n}}var hl,ks=X(()=>{hl=function(){return hl=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},hl.apply(this,arguments)}});var ar,rA,nA,_v,iA=X(()=>{Ft();ks();ar=function(){return ar=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},ar.apply(this,arguments)},rA=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},nA=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},_v=(function(){function t(e,r,n){this.req=e,this.baseUrl=r,this.subUrl="hunyuan-beta/openapi/v1/chat/completions",n!=null&&(this.subUrl=n)}return Object.defineProperty(t.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),t.prototype.doGenerate=function(e,r){return rA(this,void 0,void 0,function(){var n;return nA(this,function(o){switch(o.label){case 0:return[4,this.req({url:this.url,data:ar(ar({},nn(e)),{stream:!1}),stream:!1,timeout:r?.timeout})];case 1:return n=o.sent(),[2,ar(ar({},n),{rawResponse:n})]}})})},t.prototype.doStream=function(e,r){return rA(this,void 0,void 0,function(){var n,o,i,s,u;return nA(this,function(l){switch(l.label){case 0:return n=null,[4,this.req({url:this.url,data:ar(ar({},nn(e)),{stream:!0}),stream:!0,timeout:r?.timeout})];case 1:return o=l.sent(),i=Qe(o),s=ot(i),u=s.pipeThrough(new qe({transform:function(a,c){var h=a.choices.map(function(E){var T=E.delta;return n==null&&(n=Ze(T)),n?ar(ar({},E),{finish_reason:"tool_calls",delta:T}):E}),w=ar(ar({},a),{choices:h});c.enqueue(ar(ar({},w),{rawResponse:a}))}})),[2,Pe(u)]}})})},t})()});var sr,oA,aA,wv,sA=X(()=>{Ft();ks();sr=function(){return sr=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},sr.apply(this,arguments)},oA=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},aA=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},wv=(function(){function t(e,r,n){this.req=e,this.baseUrl=r,this.subUrl="hunyuan",n!=null&&(this.subUrl=n)}return Object.defineProperty(t.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),t.prototype.doGenerate=function(e,r){return oA(this,void 0,void 0,function(){var n,o;return aA(this,function(i){switch(i.label){case 0:return[4,this.req({url:this.url,headers:{"X-Tc-Action":"ChatCompletions"},data:sr(sr({},nn(e)),{stream:!1}),stream:!1,timeout:r?.timeout})];case 1:return n=i.sent(),o=Ms(n.Response),[2,sr(sr({},o),{rawResponse:n})]}})})},t.prototype.doStream=function(e,r){return oA(this,void 0,void 0,function(){var n,o,i,s,u;return aA(this,function(l){switch(l.label){case 0:return n=null,[4,this.req({url:this.url,headers:{"X-Tc-Action":"ChatCompletions"},data:sr(sr({},e),{stream:!0}),stream:!0,timeout:r?.timeout})];case 1:return o=l.sent(),i=Qe(o),s=ot(i),u=s.pipeThrough(new qe({transform:function(a,c){var h=Ms(a),w=h.choices.map(function(T){var A=T.delta;return n==null&&(n=Ze(A)),n?sr(sr({},T),{finish_reason:"tool_calls",delta:A}):T}),E=sr(sr({},h),{choices:w});c.enqueue(sr(sr({},E),{rawResponse:a}))}})),[2,Pe(u)]}})})},t})()});function lA(t){var e=t.messages,r=t.model,n=t.temperature,o=t.tools,i=t.top_p;return Mt(Mt({},t),{messages:e,model:r,tools:o,top_p:i,temperature:n})}var Mt,uA,cA,bv,fA=X(()=>{Ft();Mt=function(){return Mt=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Mt.apply(this,arguments)},uA=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},cA=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};bv=(function(){function t(e,r,n){this.req=e,this.baseUrl=r,this.subUrl="ark/api/v3/chat/completions",n!=null&&(this.subUrl=n)}return Object.defineProperty(t.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),t.prototype.doGenerate=function(e,r){return uA(this,void 0,void 0,function(){var n;return cA(this,function(o){switch(o.label){case 0:return[4,this.req({url:this.url,data:Mt(Mt({},lA(e)),{stream:!1}),stream:!1,timeout:r?.timeout})];case 1:return n=o.sent(),[2,Mt(Mt({},n),{rawResponse:n})]}})})},t.prototype.doStream=function(e,r){return uA(this,void 0,void 0,function(){var n,o,i,s,u;return cA(this,function(l){switch(l.label){case 0:return n=null,[4,this.req({url:this.url,data:Mt(Mt({},lA(e)),{stream:!0}),stream:!0,timeout:r?.timeout})];case 1:return o=l.sent(),i=Qe(o),s=ot(i),u=s.pipeThrough(new qe({transform:function(a,c){var h=a.choices.map(function(E){var T=E.delta;return n==null&&(n=Ze(T)),n?Mt(Mt({},E),{finish_reason:"tool_calls",delta:T}):E}),w=Mt(Mt({},a),{choices:h});c.enqueue(Mt(Mt({},w),{rawResponse:a}))}})),[2,Pe(u)]}})})},t})()});function pA(t){var e=t.messages,r=t.model,n=t.temperature,o=t.tools,i=t.top_p;return It(It({},t),{messages:e,model:r,tools:o,top_p:i,temperature:n})}var It,hA,dA,Ev,vA=X(()=>{Ft();It=function(){return It=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},It.apply(this,arguments)},hA=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},dA=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Ev=(function(){function t(e,r,n){this.req=e,this.baseUrl=r,this.subUrl="dashscope/compatible-mode/v1/chat/completions",n!=null&&(this.subUrl=n)}return Object.defineProperty(t.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),t.prototype.doGenerate=function(e,r){return hA(this,void 0,void 0,function(){var n;return dA(this,function(o){switch(o.label){case 0:return[4,this.req({url:this.url,data:It(It({},pA(e)),{stream:!1}),stream:!1,timeout:r?.timeout})];case 1:return n=o.sent(),[2,It(It({},n),{rawResponse:n})]}})})},t.prototype.doStream=function(e,r){return hA(this,void 0,void 0,function(){var n,o,i,s,u;return dA(this,function(l){switch(l.label){case 0:return n=null,[4,this.req({url:this.url,data:It(It({},pA(e)),{stream:!0}),stream:!0,timeout:r?.timeout})];case 1:return o=l.sent(),i=Qe(o),s=ot(i),u=s.pipeThrough(new qe({transform:function(a,c){var h=a.choices.map(function(E){var T=Object.assign(E.delta,{role:"assistant"});return n==null&&(n=Ze(T)),n?It(It({},E),{finish_reason:"tool_calls",delta:T}):It(It({},E),{delta:T})}),w=It(It({},a),{choices:h});c.enqueue(It(It({},w),{rawResponse:a}))}})),[2,Pe(u)]}})})},t})()});function yA(t){var e=t.messages,r=t.model,n=t.temperature,o=t.tools,i=t.top_p;return Tt(Tt({},t),{messages:e,model:r,tools:o,top_p:i,temperature:n})}var Tt,mA,gA,Sv,_A=X(()=>{Ft();Tt=function(){return Tt=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Tt.apply(this,arguments)},mA=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},gA=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Sv=(function(){function t(e,r,n){this.req=e,this.baseUrl=r,this.subUrl="01-ai/v1/chat/completions",n!=null&&(this.subUrl=n)}return Object.defineProperty(t.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),t.prototype.doGenerate=function(e,r){return mA(this,void 0,void 0,function(){var n;return gA(this,function(o){switch(o.label){case 0:return[4,this.req({url:this.url,data:Tt(Tt({},yA(e)),{stream:!1}),stream:!1,timeout:r?.timeout})];case 1:return n=o.sent(),[2,Tt(Tt({},n),{rawResponse:n})]}})})},t.prototype.doStream=function(e,r){return mA(this,void 0,void 0,function(){var n,o,i,s,u;return gA(this,function(l){switch(l.label){case 0:return n=null,[4,this.req({url:this.url,data:Tt(Tt({},yA(e)),{stream:!0}),stream:!0,timeout:r?.timeout})];case 1:return o=l.sent(),i=Qe(o),s=ot(i),u=s.pipeThrough(new qe({transform:function(a,c){var h,w,E,T,A,O;if(!((E=(w=(h=a?.choices)===null||h===void 0?void 0:h[0])===null||w===void 0?void 0:w.delta)===null||E===void 0)&&E.content||!((O=(A=(T=a?.choices)===null||T===void 0?void 0:T[0])===null||A===void 0?void 0:A.delta)===null||O===void 0)&&O.tool_calls){var C=a.choices.map(function(q){var U=Object.assign(q.delta,{role:"assistant"});return n==null&&(n=Ze(U)),n?Tt(Tt({},q),{finish_reason:"tool_calls",delta:U}):Tt(Tt({},q),{delta:U})}),P=Tt(Tt({},a),{choices:C});c.enqueue(Tt(Tt({},P),{rawResponse:a}))}}})),[2,Pe(u)]}})})},t})()});function EA(t){var e=t.messages,r=t.model,n=t.temperature,o=t.tools,i=t.top_p;return kt(kt({},t),{messages:e,model:r,tools:o,top_p:i,temperature:n})}var kt,wA,bA,Iv,SA=X(()=>{Ft();kt=function(){return kt=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},kt.apply(this,arguments)},wA=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},bA=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Iv=(function(){function t(e,r,n){this.req=e,this.baseUrl=r,this.subUrl="moonshot/v1/chat/completions",n!=null&&(this.subUrl=n)}return Object.defineProperty(t.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),t.prototype.doGenerate=function(e,r){return wA(this,void 0,void 0,function(){var n;return bA(this,function(o){switch(o.label){case 0:return[4,this.req({url:this.url,data:kt(kt({},EA(e)),{stream:!1}),stream:!1,timeout:r?.timeout})];case 1:return n=o.sent(),[2,kt(kt({},n),{rawResponse:n})]}})})},t.prototype.doStream=function(e,r){return wA(this,void 0,void 0,function(){var n,o,i,s,u;return bA(this,function(l){switch(l.label){case 0:return n=null,[4,this.req({url:this.url,data:kt(kt({},EA(e)),{stream:!0}),stream:!0,timeout:r?.timeout})];case 1:return o=l.sent(),i=Qe(o),s=ot(i),u=s.pipeThrough(new qe({transform:function(a,c){var h=a.choices.map(function(E){var T=E.delta;return n==null&&(n=Ze(T)),n?kt(kt({},E),{finish_reason:"tool_calls",delta:T}):E}),w=kt(kt({},a),{choices:h});c.enqueue(kt(kt({},w),{rawResponse:a}))}})),[2,Pe(u)]}})})},t})()});var ur,IA,TA,Tv,OA=X(()=>{Ft();ks();ur=function(){return ur=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},ur.apply(this,arguments)},IA=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},TA=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Tv=(function(){function t(e,r,n){this.req=e,this.baseUrl=r,this.subUrl="hunyuan-exp/chat/completions",n!=null&&(this.subUrl=n)}return Object.defineProperty(t.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),t.prototype.doGenerate=function(e){return IA(this,void 0,void 0,function(){var r;return TA(this,function(n){switch(n.label){case 0:return[4,this.req({url:this.url,data:ur(ur({},nn(e)),{stream:!1}),stream:!1})];case 1:return r=n.sent(),[2,ur(ur({},r),{rawResponse:r})]}})})},t.prototype.doStream=function(e){return IA(this,void 0,void 0,function(){var r,n,o,i,s;return TA(this,function(u){switch(u.label){case 0:return r=null,[4,this.req({url:this.url,data:ur(ur({},nn(e)),{stream:!0}),stream:!0})];case 1:return n=u.sent(),o=Qe(n),i=ot(o),s=i.pipeThrough(new qe({transform:function(l,a){var c=l.choices.map(function(w){var E=w.delta;return r==null&&(r=Ze(E)),r?ur(ur({},w),{finish_reason:"tool_calls",delta:E}):w}),h=ur(ur({},l),{choices:c});a.enqueue(ur(ur({},h),{rawResponse:l}))}})),[2,Pe(s)]}})})},t})()});var cr,AA,RA,Ov,CA=X(()=>{Ft();ks();cr=function(){return cr=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},cr.apply(this,arguments)},AA=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},RA=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Ov=(function(){function t(e,r,n){this.req=e,this.baseUrl=r,this.subUrl="hunyuan-open/v1/chat/completions",n!=null&&(this.subUrl=n)}return Object.defineProperty(t.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),t.prototype.doGenerate=function(e,r){return AA(this,void 0,void 0,function(){var n;return RA(this,function(o){switch(o.label){case 0:return[4,this.req({url:this.url,data:cr(cr({},nn(e)),{stream:!1}),stream:!1,timeout:r?.timeout})];case 1:return n=o.sent(),[2,cr(cr({},n),{rawResponse:n})]}})})},t.prototype.doStream=function(e,r){return AA(this,void 0,void 0,function(){var n,o,i,s,u;return RA(this,function(l){switch(l.label){case 0:return n=null,[4,this.req({url:this.url,data:cr(cr({},nn(e)),{stream:!0}),stream:!0,timeout:r?.timeout})];case 1:return o=l.sent(),i=Qe(o),s=ot(i),u=s.pipeThrough(new qe({transform:function(a,c){var h=a.choices.map(function(E){var T=E.delta;return n==null&&(n=Ze(T)),n?cr(cr({},E),{finish_reason:"tool_calls",delta:T}):E}),w=cr(cr({},a),{choices:h});c.enqueue(cr(cr({},w),{rawResponse:a}))}})),[2,Pe(u)]}})})},t})()});var lr,PA,xA,NA,LA=X(()=>{Ft();lr=function(){return lr=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},lr.apply(this,arguments)},PA=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},xA=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},NA=(function(){function t(e,r,n){this.req=e,this.baseUrl=r,this.subUrl="deepseek/chat/completions",n!=null&&(this.subUrl=n)}return Object.defineProperty(t.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),t.prototype.doGenerate=function(e,r){return PA(this,void 0,void 0,function(){var n;return xA(this,function(o){switch(o.label){case 0:return[4,this.req({url:this.url,data:lr(lr({},e),{stream:!1}),stream:!1,timeout:r?.timeout})];case 1:return n=o.sent(),[2,lr(lr({},n),{rawResponse:n})]}})})},t.prototype.doStream=function(e,r){return PA(this,void 0,void 0,function(){var n,o,i,s,u;return xA(this,function(l){switch(l.label){case 0:return n=null,[4,this.req({url:this.url,data:lr(lr({},e),{stream:!0}),stream:!0,timeout:r?.timeout})];case 1:return o=l.sent(),i=Qe(o),s=ot(i),u=s.pipeThrough(new qe({transform:function(a,c){var h=a.choices.map(function(E){var T=E.delta;return n==null&&(n=Ze(T)),n?lr(lr({},E),{finish_reason:"tool_calls",delta:T}):E}),w=lr(lr({},a),{choices:h});c.enqueue(lr(lr({},w),{rawResponse:a}))}})),[2,Pe(u)]}})})},t})()});var fr,DA,UA,dl,BA=X(()=>{Ft();fr=function(){return fr=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},fr.apply(this,arguments)},DA=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},UA=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},dl=(function(){function t(e,r,n){n===void 0&&(n=""),this.req=e,this.baseUrl=r,this.subUrl=n}return Object.defineProperty(t.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),t.prototype.doGenerate=function(e){return DA(this,void 0,void 0,function(){var r;return UA(this,function(n){switch(n.label){case 0:return[4,this.req({url:this.url,data:fr(fr({},e),{stream:!1}),stream:!1})];case 1:return r=n.sent(),[2,fr(fr({},r),{rawResponse:r})]}})})},t.prototype.doStream=function(e){return DA(this,void 0,void 0,function(){var r,n,o,i,s;return UA(this,function(u){switch(u.label){case 0:return r=null,[4,this.req({url:this.url,data:fr(fr({},e),{stream:!0}),stream:!0})];case 1:return n=u.sent(),o=Qe(n),i=ot(o),s=i.pipeThrough(new qe({transform:function(l,a){var c=l.choices.map(function(w){var E=w.delta;return r==null&&(r=Ze(E)),r?fr(fr({},w),{finish_reason:"tool_calls",delta:E}):w}),h=fr(fr({},l),{choices:c});a.enqueue(fr(fr({},h),{rawResponse:l}))}})),[2,Pe(s)]}})})},t})()});var WW,HW,pl,qA=X(()=>{WW=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},HW=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},pl=(function(){function t(e,r,n){this.req=e,this.baseUrl=r,this.provider=n,this.defaultGenerateImageSubUrl="images/generations",this.generateImageSubUrlConfig={"hunyuan-image":{"hunyuan-image-v3.0-v1.0.4":"images/ar/generations","hunyuan-image-v3.0-v1.0.1":"images/ar/generations"}},this.generateImage=this.generateImageImpl.bind(this)}return t.prototype.generateImageImpl=function(e){var r;return WW(this,void 0,void 0,function(){var n,o,i;return HW(this,function(s){switch(s.label){case 0:return n=this.defaultGenerateImageSubUrl,typeof e=="object"&&e&&"model"in e&&typeof e.model=="string"&&(o=(r=this.generateImageSubUrlConfig[this.provider])===null||r===void 0?void 0:r[e.model],o&&(n=o)),[4,this.req({url:this.getGenerateUrl(n),data:e,stream:!1})];case 1:return i=s.sent(),[2,i]}})})},t.prototype.getGenerateUrl=function(e){return"".concat(this.baseUrl,"/").concat(this.provider,"/").concat(e)},t})()});function FA(t){var e,r=t.onStepFinish,n=t.abortSignal,o=t.maxSteps,i=t.topP,s=t.toolChoice,u=GW(t,["onStepFinish","abortSignal","maxSteps","topP","toolChoice"]);if(o!=null&&o<1)throw new Error("`maxSteps` muse be greater than 0.");return[{onStepFinish:r,abortSignal:n,maxSteps:o},vl(vl({},u),{tools:(e=u.tools)===null||e===void 0?void 0:e.map(function(l){return"fn"in l?QO(l):l}),top_p:i??u.top_p,tool_choice:s??u.tool_choice})]}function jA(t){var e,r=(e=t?.choices)===null||e===void 0?void 0:e[0];if(!r)return null;var n=r.finish_reason,o=r.message;return n!=="tool_calls"||!o||!Ze(o)?null:o.tool_calls[0]}function MA(t,e,r){t.push(e,{role:"tool",tool_call_id:e.tool_calls[0].id,content:JSON.stringify(r)})}function zW(t){var e,r,n,o,i,s,u,l,a,c;return Av(this,void 0,void 0,function(){var h,w,E,T,A,O,C,P,q,U,k,W,V;return Rv(this,function(Y){switch(Y.label){case 0:h={completion_tokens:0,prompt_tokens:0,total_tokens:0},w=Pe(t),E={id:"",function:{name:"",arguments:""},type:""},T={role:"assistant",content:"",tool_calls:[E]},Y.label=1;case 1:Y.trys.push([1,6,7,12]),A=!0,O=VW(w),Y.label=2;case 2:return[4,O.next()];case 3:if(C=Y.sent(),e=C.done,!!e)return[3,5];o=C.value,A=!1;try{if(P=o,q=P?.choices[0],!q)return[2,null];if(U=q.finish_reason,k=q.delta,U!=="tool_calls")return[2,null];if(!k)return[3,4];if(k.content&&(T.content+=k.content),!("tool_calls"in k))return[3,4];W=(i=k?.tool_calls)===null||i===void 0?void 0:i[0],W?.id&&(E.id=W.id),W?.type&&(E.type=W.type),!((s=W?.function)===null||s===void 0)&&s.name&&(E.function.name=W.function.name),!((u=W?.function)===null||u===void 0)&&u.arguments&&(E.function.arguments+=W.function.arguments),!((l=P?.usage)===null||l===void 0)&&l.completion_tokens&&(h.completion_tokens=P.usage.completion_tokens),!((a=P?.usage)===null||a===void 0)&&a.prompt_tokens&&(h.prompt_tokens=P.usage.prompt_tokens),!((c=P?.usage)===null||c===void 0)&&c.total_tokens&&(h.total_tokens=P.usage.total_tokens)}finally{A=!0}Y.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return V=Y.sent(),r={error:V},[3,12];case 7:return Y.trys.push([7,,10,11]),!A&&!e&&(n=O.return)?[4,n.call(O)]:[3,9];case 8:Y.sent(),Y.label=9;case 9:return[3,11];case 10:if(r)throw r.error;return[7];case 11:return[7];case 12:return[2,{message:T,usage:h}]}})})}function kA(t){return oa.get(t.function.name)(JSON.parse(t.function.arguments))}function $A(t){var e,r,n;return{completion_tokens:(e=t?.completion_tokens)!==null&&e!==void 0?e:0,prompt_tokens:(r=t?.prompt_tokens)!==null&&r!==void 0?r:0,total_tokens:(n=t?.total_tokens)!==null&&n!==void 0?n:0}}function $s(t,e){t.completion_tokens+=e.completion_tokens,t.prompt_tokens+=e.prompt_tokens,t.total_tokens+=e.total_tokens}var vl,Av,Rv,GW,VW,Tn,ml,oa,WA=X(()=>{Ft();vl=function(){return vl=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},vl.apply(this,arguments)},Av=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},Rv=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},GW=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]]);return r},VW=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=t[i]&&function(s){return new Promise(function(u,l){s=t[i](s),o(u,l,s.done,s.value)})}}function o(i,s,u,l){Promise.resolve(l).then(function(a){i({value:a,done:u})},s)}},Tn=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,i;n<o;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))};ml=(function(){function t(e){this.model=e}return t.prototype.generateText=function(e,r){var n,o;return Av(this,void 0,void 0,function(){var i,s,u,l,a,c,h,w,E,T,A,O,C,P,q,U,k,W,V,Y,Z,ae=this;return Rv(this,function(ie){switch(ie.label){case 0:return i=[],s={completion_tokens:0,prompt_tokens:0,total_tokens:0},u=FA(e),l=u[0],a=l.onStepFinish,c=l.maxSteps,h=c===void 0?10:c,w=u[1],E=function(){return ae.model.doGenerate(w,r)},[4,E()];case 1:T=ie.sent(),A=1,T.rawResponse&&i.push(T.rawResponse),O=null,ie.label=2;case 2:if(!(A<h&&(O=jA(T))!=null))return[3,9];C=$A(T.usage),$s(s,C),ie.label=3;case 3:return ie.trys.push([3,7,,8]),[4,kA(O)];case 4:return P=ie.sent(),q=T.choices[0],[4,a?.({finishReason:q.finish_reason,messages:w.messages.slice(),text:q.message.content,toolCall:O,toolResult:P,stepUsage:C,totalUsage:Object.assign({},s)})];case 5:return ie.sent(),MA(w.messages,q.message,P),[4,E()];case 6:return T=ie.sent(),T.rawResponse&&i.push(T.rawResponse),A+=1,[3,8];case 7:return U=ie.sent(),[2,{text:"",messages:w.messages,usage:s,error:U,rawResponses:i}];case 8:return[3,2];case 9:return k=(n=T?.choices)===null||n===void 0?void 0:n[0],W=k?.message,V=(o=W?.content)!==null&&o!==void 0?o:"",Y=W?Tn(Tn([],w.messages,!0),[W],!1):w.messages,Z=$A(T.usage),$s(s,Z),[4,a?.({finishReason:k.finish_reason,messages:Y.slice(),text:V,toolCall:jA(T),toolResult:null,stepUsage:Z,totalUsage:Object.assign({},s)})];case 10:return ie.sent(),[2,{text:V,messages:Y,usage:s,rawResponses:i}]}})})},t.prototype.streamText=function(e,r){var n;return Av(this,void 0,void 0,function(){var o,i,s,u,l,a,c,h,w,E,T,A,O,C,P,q,U,k,W,V,Y,Z,ae,ie,ue,be,me,Ot,Pt,F,d,p,y,S,L,B,$=this;return Rv(this,function(Q){switch(Q.label){case 0:return o={completion_tokens:0,prompt_tokens:0,total_tokens:0},i=FA(e),s=i[0],u=s.onStepFinish,l=s.maxSteps,a=l===void 0?10:l,c=i[1],h=function(){return $.model.doStream(c,r)},[4,h()];case 1:w=Q.sent(),E=1,T=null,A=function(){var se=w.tee(),Ie=se[0],Ae=se[1];return w=Pe(Ie),zW(Ae)},Q.label=2;case 2:return O=E<a,O?[4,A()]:[3,4];case 3:O=(T=Q.sent())!=null,Q.label=4;case 4:if(!O)return[3,11];C=T.message,P=T.usage,$s(o,P),q=(n=C.tool_calls)===null||n===void 0?void 0:n[0],Q.label=5;case 5:return Q.trys.push([5,9,,10]),[4,kA(q)];case 6:return U=Q.sent(),[4,u?.({finishReason:"tool_calls",messages:c.messages.slice(),text:C.content,toolCall:q,toolResult:U,stepUsage:P,totalUsage:Object.assign({},o)})];case 7:return Q.sent(),MA(c.messages,C,U),[4,h()];case 8:return w=Q.sent(),[3,10];case 9:return k=Q.sent(),W=w.tee(),V=W[0],Y=W[1],[2,{messages:Promise.resolve(c.messages),dataStream:Pe(V),textStream:Pe(Y.pipeThrough(new qe({transform:function(se,Ie){var Ae,Te,Ce,Fe=(Ce=(Te=(Ae=se?.choices)===null||Ae===void 0?void 0:Ae[0])===null||Te===void 0?void 0:Te.delta)===null||Ce===void 0?void 0:Ce.content;typeof Fe=="string"&&Ie.enqueue(Fe)}}))),usage:Promise.resolve(o),error:k}];case 10:return[3,2];case 11:return[4,A()];case 12:return T=Q.sent(),T?(Z=T.message,ae=T.usage,$s(o,ae),ie=Tn(Tn([],c.messages,!0),[Z],!1),u({messages:ie.slice(),finishReason:"tool_call",stepUsage:ae,text:Z.content,toolCall:Z.tool_calls[0],totalUsage:Object.assign({},o)}),ue=w.tee(),be=ue[0],me=ue[1],[2,{messages:Promise.resolve(Tn(Tn([],c.messages,!0),[Z],!1)),dataStream:Pe(be),textStream:Pe(me.pipeThrough(new qe({transform:function(se,Ie){var Ae,Te,Ce,Fe=(Ce=(Te=(Ae=se?.choices)===null||Ae===void 0?void 0:Ae[0])===null||Te===void 0?void 0:Te.delta)===null||Ce===void 0?void 0:Ce.content;typeof Fe=="string"&&Ie.enqueue(Fe)}}))),usage:Promise.resolve(o)}]):(Ot=vv(),Pt=vv(),F={role:"assistant",content:""},d="",p={completion_tokens:0,prompt_tokens:0,total_tokens:0},y=w.pipeThrough(new qe({transform:function(se,Ie){var Ae,Te,Ce,Fe,je,et,Er,R,_=(Ce=(Te=(Ae=se?.choices)===null||Ae===void 0?void 0:Ae[0])===null||Te===void 0?void 0:Te.delta)===null||Ce===void 0?void 0:Ce.content;typeof _=="string"&&(F.content+=_);var b=(je=(Fe=se?.choices)===null||Fe===void 0?void 0:Fe[0])===null||je===void 0?void 0:je.finish_reason;b&&(d=b),!((et=se?.usage)===null||et===void 0)&&et.completion_tokens&&(p.completion_tokens=se.usage.completion_tokens),!((Er=se?.usage)===null||Er===void 0)&&Er.prompt_tokens&&(p.prompt_tokens=se.usage.prompt_tokens),!((R=se?.usage)===null||R===void 0)&&R.total_tokens&&(p.total_tokens=se.usage.total_tokens),Ie.enqueue(se)},flush:function(){Ot.res(Tn(Tn([],c.messages,!0),[F],!1)),$s(o,p),Pt.res(Object.assign({},o)),u?.({messages:Tn(Tn([],c.messages,!0),[F],!1),finishReason:d,text:F.content,stepUsage:p,totalUsage:Object.assign({},o)})}})),S=y.tee(),L=S[0],B=S[1],[2,{messages:Ot.promise,dataStream:Pe(L),textStream:Pe(B.pipeThrough(new qe({transform:function(se,Ie){var Ae,Te,Ce,Fe=(Ce=(Te=(Ae=se?.choices)===null||Ae===void 0?void 0:Ae[0])===null||Te===void 0?void 0:Te.delta)===null||Ce===void 0?void 0:Ce.content;typeof Fe=="string"&&Ie.enqueue(Fe)}}))),usage:Pt.promise}])}})})},t})();oa=new Map});var yl={};Pr(yl,{ArkSimpleModel:()=>bv,DSSimpleModel:()=>Ev,DefaultImageModel:()=>pl,DefaultSimpleModel:()=>dl,HunYuanBetaSimpleModel:()=>_v,HunYuanExpSimpleModel:()=>Tv,HunYuanOpenSimpleModel:()=>Ov,HunYuanSimpleModel:()=>wv,MODELS:()=>gl,MoonshotSimpleModel:()=>Iv,ReactModel:()=>ml,YiSimpleModel:()=>Sv,ZhiPuSimpleModel:()=>yv,toolMap:()=>oa});var gl,Cv=X(()=>{tA();iA();sA();fA();vA();_A();SA();OA();CA();LA();BA();qA();WA();gl={hunyuan:wv,"hunyuan-beta":_v,ark:bv,dashscope:Ev,"01-ai":Sv,moonshot:Iv,zhipu:yv,"hunyuan-exp":Tv,"hunyuan-open":Ov,deepseek:NA}});var aa,Pv,xv,Nv,HA,GA=X(()=>{gv();Cv();Ft();Lt();aa=function(){return aa=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},aa.apply(this,arguments)},Pv=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},xv=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Nv=gl,HA=(function(){function t(e,r,n){var o=this;this.req=e,this.baseUrl=r,this.modelRequest=function(i){var s=i.url,u=i.data,l=i.headers,a=i.stream,c=i.timeout;return Pv(o,void 0,void 0,function(){var h,w,E,T,A,O,C;return xv(this,function(P){switch(P.label){case 0:return h={"Content-Type":"application/json"},a&&Object.assign(h,{Accept:"text/event-stream"}),[4,this.req.fetch({method:"post",headers:aa(aa((A={},A[(O=this.i18n)===null||O===void 0?void 0:O.LANG_HEADER_KEY]=(C=this.i18n)===null||C===void 0?void 0:C.lang,A),h),l),body:JSON.stringify(u),url:s,stream:a,timeout:c})];case 1:return w=P.sent(),E=w.data,T=w.header,[2,this.handleResponseData(E,T)]}})})},this.botRequest=function(i){var s=i.method,u=i.url,l=i.data,a=l===void 0?{}:l,c=i.headers,h=i.stream,w=i.timeout;return Pv(o,void 0,void 0,function(){function E(W){return Object.entries(W).map(function(V){var Y=V[0],Z=V[1];return"".concat(Y,"=").concat(Z)}).join("&")}var T,A,O,C,P,q,U,k;return xv(this,function(W){switch(W.label){case 0:return s!=="get"?[3,2]:(T=this.handleResponseData,[4,this.req.fetch({url:"".concat(u,"?").concat(E(a)),method:s,headers:c,stream:h,timeout:w})]);case 1:return[2,T.apply(this,[W.sent().data])];case 2:return A={"Content-Type":"application/json"},h&&Object.assign(A,{Accept:"text/event-stream"}),[4,this.req.fetch({url:u,body:JSON.stringify(a),headers:aa(aa((q={},q[(U=this.i18n)===null||U===void 0?void 0:U.LANG_HEADER_KEY]=(k=this.i18n)===null||k===void 0?void 0:k.lang,q),A),c),stream:h,method:s,timeout:w})];case 3:return O=W.sent(),C=O.data,P=O.header,[2,this.handleResponseData(C,P)]}})})},this.aiBaseUrl="".concat(r,"/ai"),this.aiBotBaseUrl="".concat(r,"/aibot"),this.bot=new mv(this.botRequest,this.aiBotBaseUrl),this.i18n=n,Zt.bus.on(Zt.LANG_CHANGE_EVENT,function(i){var s;o.i18n=((s=i.data)===null||s===void 0?void 0:s.i18n)||o.i18n})}return t.prototype.handleResponseData=function(e,r){var n,o;return Pv(this,void 0,void 0,function(){var i,s,s;return xv(this,function(u){switch(u.label){case 0:return i="".concat(this.i18n.t("\u8BF7\u68C0\u67E5\u8C03\u7528\u65B9\u5F0F\uFF0C\u6216\u524D\u5F80\u4E91\u5F00\u53D1 AI+ \u9996\u9875\u67E5\u770B\u6587\u6863"),"\uFF1Ahttps://tcb.cloud.tencent.com/dev#/ai"),typeof e=="object"&&e&&"then"in e?[4,e]:[3,2];case 1:if(s=u.sent(),typeof s=="object"&&s&&"code"in s&&s.code!=="NORMAL")throw new Error("".concat(this.i18n.t("AI+ \u8BF7\u6C42\u51FA\u9519\uFF0C\u9519\u8BEF\u7801"),"\uFF1A").concat(s.code,"\uFF0C").concat(this.i18n.t("\u9519\u8BEF\u4FE1\u606F"),"\uFF1A").concat(s.message,`
`).concat(i,`
`).concat(JSON.stringify(s,null,2)));return[2,e];case 2:return!((o=(n=r?.get)===null||n===void 0?void 0:n.call(r,"content-type"))===null||o===void 0)&&o.includes("application/json")?[4,JO(e)]:[3,4];case 3:if(s=u.sent(),typeof s=="object"&&s&&"code"in s&&s.code!=="NORMAL")throw new Error("".concat(this.i18n.t("AI+ \u8BF7\u6C42\u51FA\u9519\uFF0C\u9519\u8BEF\u7801"),"\uFF1A").concat(s.code,"\uFF0C").concat(this.i18n.t("\u9519\u8BEF\u4FE1\u606F"),"\uFF1A").concat(s.message,`
`).concat(i,`
`).concat(JSON.stringify(s,null,2)));u.label=4;case 4:return[2,e]}})})},t.prototype.createModel=function(e,r){var n,o=Nv[e];if(o)n=new o(this.modelRequest,this.aiBaseUrl);else{var i=typeof r?.defaultModelSubUrl=="string"?r.defaultModelSubUrl:"/chat/completions";n=new dl(this.modelRequest,this.aiBaseUrl,"".concat(e).concat(i))}var s=new ml(n);return s},t.prototype.registerModel=function(e,r){if(Nv[e]!=null){console.warn("AI model ".concat(e," already exists!"));return}Nv[e]=r},t.prototype.createImageModel=function(e){return new pl(this.modelRequest,this.aiBaseUrl,e)},t.prototype.registerFunctionTool=function(e){oa.has(e.name)&&console.warn("AI function tool ".concat(e.name," already exists and will be overwritten!")),oa.set(e.name,e.fn)},t})()});var VA=X(()=>{});function XW(t){var e=t.env,r=t.baseUrl,n=t.req,o=t.getAccessToken,i=t.handleReqInstance,s=t.i18n,u=function(){if(r!=null)return r;if(e==null)throw new Error("`env` is required when `baseUrl` is not provided!");return"https://".concat(e,".api.tcloudbasegateway.com/v1")},l=function(){if(i==null){if(o==null)throw new Error("`getAccessToken` is required when `handleReqInstance` is not provided!");return QW({req:n,getAccessToken:o})}return i({req:n})};return new HA(l(),u(),s)}function ZW(t){var e=this,r,n=this.request;if(n.fetch==null)throw new Error("cloudbase.request.fetch() unimplemented!");var o=function(){var s=e.getEndPointWithKey("GATEWAY"),u=s.BASE_URL,l=s.PROTOCOL;return"".concat(l).concat(u)},i=(r=t?.baseUrl)!==null&&r!==void 0?r:o();return XW({req:n,baseUrl:i,handleReqInstance:function(s){var u=s.req;return u},i18n:this.config.i18n})}function Lv(t){try{t.registerComponent(e9)}catch(e){console.warn(e)}}var _l,KW,YW,zA,JW,QY,QW,e9,KA=X(()=>{GA();gv();Cv();Ft();VA();_l=function(){return _l=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},_l.apply(this,arguments)},KW=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},YW=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},zA=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]]);return r},JW="ai",QY=zA(yl,["MODELS"]),QW=function(t){var e=t.getAccessToken,r=t.req,n=function(o){return KW(void 0,void 0,void 0,function(){var i,s,u,l,a;return YW(this,function(c){switch(c.label){case 0:if(typeof r.fetch!="function")throw new Error("req.fetch is not a function");return i=o.token,s=o.headers,u=s===void 0?{}:s,l=zA(o,["token","headers"]),i==null?[3,1]:(a=i,[3,3]);case 1:return[4,e()];case 2:a=c.sent().accessToken,c.label=3;case 3:return[2,r.fetch(_l({headers:_l({Authorization:"Bearer ".concat(a)},u)},l))]}})})};return{download:r.download,post:r.post,upload:r.upload,fetch:n}};e9={name:JW,entity:{ai:ZW}};try{window.registerAi=Lv}catch{}});var hr={};Pr(hr,{registerMySQL:()=>wl});function JA(t,e){var r=this,n=t.request.fetch.bind(t.request),o=e||{},i=o.instance,s=i===void 0?"default":i,u=o.database,l=u===void 0?t.config.env:u,a=function(A,O){return t9(r,void 0,void 0,function(){var C,P,q,U,k;return r9(this,function(W){switch(W.label){case 0:return C={},O.headers instanceof Headers?O.headers.forEach(function(V,Y){C[Y]=V}):C=O.headers||{},[4,n(Ws(Ws({url:A.toString()},O),{headers:Ws({"Content-Type":"application/json","X-Db-Instance":s,"Accept-Profile":l,"Content-Profile":l},C),shouldThrowOnError:!1}))];case 1:P=W.sent(),q={},W.label=2;case 2:return W.trys.push([2,4,,5]),[4,P.data];case 3:return q=W.sent(),[3,5];case 4:if(U=W.sent(),!U.message.includes("Unexpected end of JSON input"))throw U;return[3,5];case 5:return k={ok:P?.statusCode>=200&&P?.statusCode<300,status:P?.statusCode||200,statusText:P?.statusMessage||"OK",json:function(){return Promise.resolve(q||{})},text:function(){return Promise.resolve(typeof q=="string"?q:JSON.stringify(q||{}))},headers:P?.header},[2,k]}})})},c=t.getEndPointWithKey("GATEWAY"),h=c.BASE_URL,w=c.PROTOCOL,E="".concat(w).concat(h,"/rdb/rest"),T=(0,YA.generateMySQLClient)(t,{mysqlBaseUrl:E,fetch:a});return T}function wl(t){try{t.registerComponent(QA),t.registerComponent(XA)}catch(e){console.warn(e)}}var YA,Ws,t9,r9,QA,XA,ZA=X(()=>{YA=st(Fs());Be(hr,st(Fs()));Ws=function(){return Ws=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Ws.apply(this,arguments)},t9=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},r9=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};QA={name:"mysql",entity:{mysql:function(t){return JA(this,t)(t)}}},XA={name:"rdb",entity:{rdb:function(t){return JA(this,t)(t)}}};try{cloudbase.registerComponent(QA),cloudbase.registerComponent(XA)}catch{}try{window.registerMySQL=wl}catch{}});function n9(t,e){var r,n,o;return eR(this,void 0,void 0,function(){var i,s,u,l,a,c,h,w,E,T,A,O,C,P,q,U,k,W,V,Y,Z,ae;return tR(this,function(ie){switch(ie.label){case 0:if(i=t||{},s=i.name,u=i.body,l=i.path,a=l===void 0?"":l,c=i.method,h=c===void 0?"POST":c,w=i.headers,E=w===void 0?{}:w,T=(t||{}).token,!s)throw new Error(JSON.stringify({code:rR.ERRORS.INVALID_PARAMS,msg:"[apis] invalid api name"}));return A="",O=this,C=O.gatewayOrigin,P=O.getAccessToken,q=O.env,C?A="".concat(C,"/v1"):this.getEndPointWithKey?(U=this.getEndPointWithKey("GATEWAY"),k=U.BASE_URL,W=U.PROTOCOL,A="".concat(W).concat(k)):A="https://".concat(q,".api.tcloudbasegateway.com/v1"),V="".concat(A,"/apis/").concat(s),Y=a.startsWith("/")?a:"/".concat(a),P?[4,P()]:[3,2];case 1:Z=ie.sent().accessToken,E.Authorization="Bearer ".concat(Z),ie.label=2;case 2:return[4,this.request.fetch(Hs({url:"".concat(V).concat(Y),method:h||"POST",headers:Hs({"Content-Type":"application/json; charset=utf-8"},E),body:u,token:((r=T?.trim)===null||r===void 0?void 0:r.call(T))||((o=(n=E.Authorization)===null||n===void 0?void 0:n.replace)===null||o===void 0?void 0:o.call(n,/^Bearer /,""))||null},e))];case 3:return ae=ie.sent(),[4,ae.data];case 4:return[2,ie.sent()]}})})}function o9(t){var e=this;return new Proxy({},{get:function(r,n){if(typeof n!="string")throw new Error("[apis] method must be string");var o=n.toLocaleUpperCase();if(!i9.includes(o))throw new Error("[apis] invalid method: ".concat(n));return function(i,s){return eR(e,void 0,void 0,function(){return tR(this,function(u){switch(u.label){case 0:return[4,n9.call(this,Hs({name:t,method:(o==="REQUEST"?i.method:o)||"POST"},i),s)];case 1:return[2,u.sent()]}})})}}})}function nR(t){var e=this;return Object.keys(t||{}).forEach(function(r){t[r]!==void 0&&(e[r]=t[r])}),new Proxy({},{get:function(r,n){if(typeof n=="string")return o9.call(e,n)}})}var rR,Hs,eR,tR,i9,iR=X(()=>{rR=st(Ho()),Hs=function(){return Hs=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Hs.apply(this,arguments)},eR=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},tR=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};i9=["GET","POST","PUT","DELETE","HEAD","OPTIONS","PATCH","REQUEST"]});var oR=X(()=>{});function Dv(t){try{t.registerComponent(sR)}catch(e){console.warn(e)}}var aR,sR,uR=X(()=>{iR();oR();aR="apis",sR={name:aR,IIFE:!0,entity:function(){Object.defineProperty(this.prototype,aR,{get:function(){return nR.call(this)},configurable:!0,enumerable:!0})}};try{cloudbase.registerComponent(sR)}catch{}try{window.registerApis=Dv}catch{}});var io,on,ze,cR,lR,oo,oJ,Fr,sa=X(()=>{(function(t){t.DocIDError="\u6587\u6863ID\u4E0D\u5408\u6CD5",t.CollNameError="\u96C6\u5408\u540D\u79F0\u4E0D\u5408\u6CD5",t.OpStrError="\u64CD\u4F5C\u7B26\u4E0D\u5408\u6CD5",t.DirectionError="\u6392\u5E8F\u5B57\u7B26\u4E0D\u5408\u6CD5",t.IntergerError="must be integer",t.QueryParamTypeError="\u67E5\u8BE2\u53C2\u6570\u5FC5\u987B\u4E3A\u5BF9\u8C61",t.QueryParamValueError="\u67E5\u8BE2\u53C2\u6570\u5BF9\u8C61\u503C\u4E0D\u80FD\u5747\u4E3Aundefined"})(on||(on={}));ze={String:"String",Number:"Number",Object:"Object",Array:"Array",Boolean:"Boolean",Null:"Null",GeoPoint:"GeoPoint",GeoLineString:"GeoLineString",GeoPolygon:"GeoPolygon",GeoMultiPoint:"GeoMultiPoint",GeoMultiLineString:"GeoMultiLineString",GeoMultiPolygon:"GeoMultiPolygon",Timestamp:"Date",Command:"Command",ServerDate:"ServerDate",BsonDate:"BsonDate"},cR=["desc","asc"],lR=["<","<=","==",">=",">"];(function(t){t.lt="<",t.gt=">",t.lte="<=",t.gte=">=",t.eq="=="})(oo||(oo={}));oJ=(io={},io[oo.eq]="$eq",io[oo.lt]="$lt",io[oo.lte]="$lte",io[oo.gt]="$gt",io[oo.gte]="$gte",io);(function(t){t.WHERE="WHERE",t.DOC="DOC"})(Fr||(Fr={}))});var a9,bl,fR,s9,Uv,wr,El=X(()=>{a9=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),bl=[],fR={},s9=(function(){function t(e){Object.defineProperties(this,{target:{enumerable:!1,writable:!1,configurable:!1,value:e}})}return t})(),Uv=(function(t){a9(e,t);function e(r,n){if(n!==fR)throw new TypeError("InternalSymbol cannot be constructed with new operator");return t.call(this,r)||this}return e.for=function(r){for(var n=0,o=bl.length;n<o;n++)if(bl[n].target===r)return bl[n].instance;var i=new e(r,fR);return bl.push({target:r,instance:i}),i},e})(s9),wr=Uv});var Jn,Bv,qv,Fv,Sl,hR,dR,pR,vR,mR,Il,Tl,Qt=X(()=>{El();El();Jn=wr.for("UNSET_FIELD_NAME"),Bv=wr.for("UPDATE_COMMAND"),qv=wr.for("QUERY_COMMAND"),Fv=wr.for("LOGIC_COMMAND"),Sl=wr.for("GEO_POINT"),hR=wr.for("SYMBOL_GEO_LINE_STRING"),dR=wr.for("SYMBOL_GEO_POLYGON"),pR=wr.for("SYMBOL_GEO_MULTI_POINT"),vR=wr.for("SYMBOL_GEO_MULTI_LINE_STRING"),mR=wr.for("SYMBOL_GEO_MULTI_POLYGON"),Il=wr.for("SERVER_DATE"),Tl=wr.for("REGEXP")});function gR(t){return new jv(t)}var jv,Mv=X(()=>{Qt();jv=(function(){function t(e){var r=e===void 0?{}:e,n=r.offset,o=n===void 0?0:n;this.offset=o}return Object.defineProperty(t.prototype,"_internalType",{get:function(){return Il},enumerable:!1,configurable:!0}),t.prototype.parse=function(){return{$date:{offset:this.offset}}},t})()});var kv,yi,Gs=X(()=>{sa();Vs();Mv();kv=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,i=[],s;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(u){s={error:u}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return i},yi=(function(){function t(){}return t.formatResDocumentData=function(e){return e.map(function(r){return t.formatField(r)})},t.formatField=function(e){var r=Object.keys(e),n={};return Array.isArray(e)&&(n=[]),r.forEach(function(o){var i=e[o],s=t.whichType(i),u;switch(s){case ze.GeoPoint:u=new gt(i.coordinates[0],i.coordinates[1]);break;case ze.GeoLineString:u=new dr(i.coordinates.map(function(l){return new gt(l[0],l[1])}));break;case ze.GeoPolygon:u=new On(i.coordinates.map(function(l){return new dr(l.map(function(a){var c=kv(a,2),h=c[0],w=c[1];return new gt(h,w)}))}));break;case ze.GeoMultiPoint:u=new ua(i.coordinates.map(function(l){return new gt(l[0],l[1])}));break;case ze.GeoMultiLineString:u=new ca(i.coordinates.map(function(l){return new dr(l.map(function(a){var c=kv(a,2),h=c[0],w=c[1];return new gt(h,w)}))}));break;case ze.GeoMultiPolygon:u=new ao(i.coordinates.map(function(l){return new On(l.map(function(a){return new dr(a.map(function(c){var h=kv(c,2),w=h[0],E=h[1];return new gt(w,E)}))}))}));break;case ze.Timestamp:u=new Date(i.$timestamp*1e3);break;case ze.Object:case ze.Array:u=t.formatField(i);break;case ze.ServerDate:u=new Date(i.$date);break;default:u=i}Array.isArray(n)?n.push(u):n[o]=u}),n},t.whichType=function(e){var r=Object.prototype.toString.call(e).slice(8,-1);if(r===ze.Timestamp)return ze.BsonDate;if(r===ze.Object){if(e instanceof gt)return ze.GeoPoint;if(e instanceof Date)return ze.Timestamp;if(e instanceof jv)return ze.ServerDate;e.$timestamp?r=ze.Timestamp:e.$date?r=ze.ServerDate:gt.validate(e)?r=ze.GeoPoint:dr.validate(e)?r=ze.GeoLineString:On.validate(e)?r=ze.GeoPolygon:ua.validate(e)?r=ze.GeoMultiPoint:ca.validate(e)?r=ze.GeoMultiLineString:ao.validate(e)&&(r=ze.GeoMultiPolygon)}return r},t.generateDocId=function(){for(var e="ABCDEFabcdef0123456789",r="",n=0;n<24;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},t})()});var An,$v=X(()=>{sa();Gs();An=(function(){function t(){}return t.isGeopoint=function(e,r){if(yi.whichType(r)!==ze.Number)throw new Error("Geo Point must be number type");var n=Math.abs(r);if(e==="latitude"&&n>90)throw new Error("latitude should be a number ranges from -90 to 90");if(e==="longitude"&&n>180)throw new Error("longitude should be a number ranges from -180 to 180");return!0},t.isInteger=function(e,r){if(!Number.isInteger(r))throw new Error(e+on.IntergerError);return!0},t.isFieldOrder=function(e){if(cR.indexOf(e)===-1)throw new Error(on.DirectionError);return!0},t.isFieldPath=function(e){if(!/^[a-zA-Z0-9-_\.]/.test(e))throw new Error;return!0},t.isOperator=function(e){if(lR.indexOf(e)===-1)throw new Error(on.OpStrError);return!0},t.isCollName=function(e){if(!/^[a-zA-Z0-9]([a-zA-Z0-9-_]){1,32}$/.test(e))throw new Error(on.CollNameError);return!0},t.isDocID=function(e){if(!/^([a-fA-F0-9]){24}$/.test(e))throw new Error(on.DocIDError);return!0},t})()});var pr,jr,yR,yt,Me,Ol,la,Al,br=X(()=>{El();pr=function(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()},jr=function(t){return pr(t)==="object"},yR=function(t){return pr(t)==="string"},yt=function(t){return pr(t)==="number"},Me=function(t){return Array.isArray(t)},Ol=function(t){return pr(t)==="date"},la=function(t){return pr(t)==="regexp"},Al=function(t){return t&&t._internalType instanceof Uv}});var gt,Rl=X(()=>{$v();Qt();br();gt=(function(){function t(e,r){An.isGeopoint("longitude",e),An.isGeopoint("latitude",r),this.longitude=e,this.latitude=r}return t.prototype.parse=function(e){var r;return r={},r[e]={type:"Point",coordinates:[this.longitude,this.latitude]},r},t.prototype.toJSON=function(){return{type:"Point",coordinates:[this.longitude,this.latitude]}},t.prototype.toReadableString=function(){return"[".concat(this.longitude,",").concat(this.latitude,"]")},t.validate=function(e){return e.type==="Point"&&Me(e.coordinates)&&An.isGeopoint("longitude",e.coordinates[0])&&An.isGeopoint("latitude",e.coordinates[1])},Object.defineProperty(t.prototype,"_internalType",{get:function(){return Sl},enumerable:!1,configurable:!0}),t})()});var u9,dr,Cl=X(()=>{Qt();Rl();br();u9=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},dr=(function(){function t(e){if(!Me(e))throw new TypeError('"points" must be of type Point[]. Received type '.concat(typeof e));if(e.length<2)throw new Error('"points" must contain 2 points at least');e.forEach(function(r){if(!(r instanceof gt))throw new TypeError('"points" must be of type Point[]. Received type '.concat(typeof r,"[]"))}),this.points=e}return t.prototype.parse=function(e){var r;return r={},r[e]={type:"LineString",coordinates:this.points.map(function(n){return n.toJSON().coordinates})},r},t.prototype.toJSON=function(){return{type:"LineString",coordinates:this.points.map(function(e){return e.toJSON().coordinates})}},t.validate=function(e){var r,n;if(e.type!=="LineString"||!Me(e.coordinates))return!1;try{for(var o=u9(e.coordinates),i=o.next();!i.done;i=o.next()){var s=i.value;if(!yt(s[0])||!yt(s[1]))return!1}}catch(u){r={error:u}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return!0},t.isClosed=function(e){var r=e.points[0],n=e.points[e.points.length-1];if(r.latitude===n.latitude&&r.longitude===n.longitude)return!0},Object.defineProperty(t.prototype,"_internalType",{get:function(){return hR},enumerable:!1,configurable:!0}),t})()});var _R,On,Wv=X(()=>{Qt();br();Cl();_R=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},On=(function(){function t(e){if(!Me(e))throw new TypeError('"lines" must be of type LineString[]. Received type '.concat(typeof e));if(e.length===0)throw new Error("Polygon must contain 1 linestring at least");e.forEach(function(r){if(!(r instanceof dr))throw new TypeError('"lines" must be of type LineString[]. Received type '.concat(typeof r,"[]"));if(!dr.isClosed(r))throw new Error("LineString ".concat(r.points.map(function(n){return n.toReadableString()})," is not a closed cycle"))}),this.lines=e}return t.prototype.parse=function(e){var r;return r={},r[e]={type:"Polygon",coordinates:this.lines.map(function(n){return n.points.map(function(o){return[o.longitude,o.latitude]})})},r},t.prototype.toJSON=function(){return{type:"Polygon",coordinates:this.lines.map(function(e){return e.points.map(function(r){return[r.longitude,r.latitude]})})}},t.validate=function(e){var r,n,o,i;if(e.type!=="Polygon"||!Me(e.coordinates))return!1;try{for(var s=_R(e.coordinates),u=s.next();!u.done;u=s.next()){var l=u.value;if(!this.isCloseLineString(l))return!1;try{for(var a=(o=void 0,_R(l)),c=a.next();!c.done;c=a.next()){var h=c.value;if(!yt(h[0])||!yt(h[1]))return!1}}catch(w){o={error:w}}finally{try{c&&!c.done&&(i=a.return)&&i.call(a)}finally{if(o)throw o.error}}}}catch(w){r={error:w}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return!0},t.isCloseLineString=function(e){var r=e[0],n=e[e.length-1];return!(r[0]!==n[0]||r[1]!==n[1])},Object.defineProperty(t.prototype,"_internalType",{get:function(){return mR},enumerable:!1,configurable:!0}),t})()});var c9,ua,wR=X(()=>{Qt();Rl();br();c9=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ua=(function(){function t(e){if(!Me(e))throw new TypeError('"points" must be of type Point[]. Received type '.concat(typeof e));if(e.length===0)throw new Error('"points" must contain 1 point at least');e.forEach(function(r){if(!(r instanceof gt))throw new TypeError('"points" must be of type Point[]. Received type '.concat(typeof r,"[]"))}),this.points=e}return t.prototype.parse=function(e){var r;return r={},r[e]={type:"MultiPoint",coordinates:this.points.map(function(n){return n.toJSON().coordinates})},r},t.prototype.toJSON=function(){return{type:"MultiPoint",coordinates:this.points.map(function(e){return e.toJSON().coordinates})}},t.validate=function(e){var r,n;if(e.type!=="MultiPoint"||!Me(e.coordinates))return!1;try{for(var o=c9(e.coordinates),i=o.next();!i.done;i=o.next()){var s=i.value;if(!yt(s[0])||!yt(s[1]))return!1}}catch(u){r={error:u}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return!0},Object.defineProperty(t.prototype,"_internalType",{get:function(){return pR},enumerable:!1,configurable:!0}),t})()});var bR,ca,ER=X(()=>{Qt();br();Cl();bR=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ca=(function(){function t(e){if(!Me(e))throw new TypeError('"lines" must be of type LineString[]. Received type '.concat(typeof e));if(e.length===0)throw new Error("Polygon must contain 1 linestring at least");e.forEach(function(r){if(!(r instanceof dr))throw new TypeError('"lines" must be of type LineString[]. Received type '.concat(typeof r,"[]"))}),this.lines=e}return t.prototype.parse=function(e){var r;return r={},r[e]={type:"MultiLineString",coordinates:this.lines.map(function(n){return n.points.map(function(o){return[o.longitude,o.latitude]})})},r},t.prototype.toJSON=function(){return{type:"MultiLineString",coordinates:this.lines.map(function(e){return e.points.map(function(r){return[r.longitude,r.latitude]})})}},t.validate=function(e){var r,n,o,i;if(e.type!=="MultiLineString"||!Me(e.coordinates))return!1;try{for(var s=bR(e.coordinates),u=s.next();!u.done;u=s.next()){var l=u.value;try{for(var a=(o=void 0,bR(l)),c=a.next();!c.done;c=a.next()){var h=c.value;if(!yt(h[0])||!yt(h[1]))return!1}}catch(w){o={error:w}}finally{try{c&&!c.done&&(i=a.return)&&i.call(a)}finally{if(o)throw o.error}}}}catch(w){r={error:w}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return!0},Object.defineProperty(t.prototype,"_internalType",{get:function(){return vR},enumerable:!1,configurable:!0}),t})()});var Pl,ao,SR=X(()=>{Qt();br();Wv();Pl=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ao=(function(){function t(e){var r,n;if(!Me(e))throw new TypeError('"polygons" must be of type Polygon[]. Received type '.concat(typeof e));if(e.length===0)throw new Error("MultiPolygon must contain 1 polygon at least");try{for(var o=Pl(e),i=o.next();!i.done;i=o.next()){var s=i.value;if(!(s instanceof On))throw new TypeError('"polygon" must be of type Polygon[]. Received type '.concat(typeof s,"[]"))}}catch(u){r={error:u}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}this.polygons=e}return t.prototype.parse=function(e){var r;return r={},r[e]={type:"MultiPolygon",coordinates:this.polygons.map(function(n){return n.lines.map(function(o){return o.points.map(function(i){return[i.longitude,i.latitude]})})})},r},t.prototype.toJSON=function(){return{type:"MultiPolygon",coordinates:this.polygons.map(function(e){return e.lines.map(function(r){return r.points.map(function(n){return[n.longitude,n.latitude]})})})}},t.validate=function(e){var r,n,o,i,s,u;if(e.type!=="MultiPolygon"||!Me(e.coordinates))return!1;try{for(var l=Pl(e.coordinates),a=l.next();!a.done;a=l.next()){var c=a.value;try{for(var h=(o=void 0,Pl(c)),w=h.next();!w.done;w=h.next()){var E=w.value;try{for(var T=(s=void 0,Pl(E)),A=T.next();!A.done;A=T.next()){var O=A.value;if(!yt(O[0])||!yt(O[1]))return!1}}catch(C){s={error:C}}finally{try{A&&!A.done&&(u=T.return)&&u.call(T)}finally{if(s)throw s.error}}}}catch(C){o={error:C}}finally{try{w&&!w.done&&(i=h.return)&&i.call(h)}finally{if(o)throw o.error}}}}catch(C){r={error:C}}finally{try{a&&!a.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return!0},Object.defineProperty(t.prototype,"_internalType",{get:function(){return dR},enumerable:!1,configurable:!0}),t})()});var Hv={};Pr(Hv,{LineString:()=>dr,MultiLineString:()=>ca,MultiPoint:()=>ua,MultiPolygon:()=>ao,Point:()=>gt,Polygon:()=>On});var Vs=X(()=>{Rl();Cl();Wv();wR();ER();SR()});var an,Gv=X(()=>{an=function(){var t=function(){};if(!Promise){t.promise={};var e=function(){throw new Error('Your Node runtime does support ES6 Promises. Set "global.Promise" to your preferred implementation of promises.')};return Object.defineProperty(t.promise,"then",{get:e}),Object.defineProperty(t.promise,"catch",{get:e}),t}var r=new Promise(function(n,o){t=function(i,s){return i?o(i):n(s)}});return t.promise=r,t}});function Vv(t){return t&&t instanceof nt&&t._internalType===Bv}var xe,nt,fa=X(()=>{Qt();(function(t){t.SET="set",t.REMOVE="remove",t.INC="inc",t.MUL="mul",t.PUSH="push",t.PULL="pull",t.PULL_ALL="pullAll",t.POP="pop",t.SHIFT="shift",t.UNSHIFT="unshift",t.ADD_TO_SET="addToSet",t.BIT="bit",t.RENAME="rename",t.MAX="max",t.MIN="min"})(xe||(xe={}));nt=(function(){function t(e,r,n){this._internalType=Bv,Object.defineProperties(this,{_internalType:{enumerable:!1,configurable:!1}}),this.operator=e,this.operands=r,this.fieldName=n||Jn}return t.prototype._setFieldName=function(e){var r=new t(this.operator,this.operands,e);return r},t})()});function zs(t){return t&&t instanceof Rn&&t._internalType===Fv}var $t,Rn,da=X(()=>{Qt();pa();(function(t){t.AND="and",t.OR="or",t.NOT="not",t.NOR="nor"})($t||($t={}));Rn=(function(){function t(e,r,n){if(this._internalType=Fv,Object.defineProperties(this,{_internalType:{enumerable:!1,configurable:!1}}),this.operator=e,this.operands=r,this.fieldName=n||Jn,this.fieldName!==Jn)if(Array.isArray(r)){r=r.slice(),this.operands=r;for(var o=0,i=r.length;o<i;o++){var s=r[o];(zs(s)||ha(s))&&(r[o]=s._setFieldName(this.fieldName))}}else{var s=r;(zs(s)||ha(s))&&(r=s._setFieldName(this.fieldName))}}return t.prototype._setFieldName=function(e){var r=this.operands.map(function(o){return o instanceof t?o._setFieldName(e):o}),n=new t(this.operator,r,e);return n},t.prototype.and=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=Array.isArray(arguments[0])?arguments[0]:Array.from(arguments);return n.unshift(this),new t($t.AND,n,this.fieldName)},t.prototype.or=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=Array.isArray(arguments[0])?arguments[0]:Array.from(arguments);return n.unshift(this),new t($t.OR,n,this.fieldName)},t})()});function ha(t){return t&&t instanceof mt&&t._internalType===qv}function zv(t){return ha(t)}var l9,_e,mt,pa=X(()=>{da();Qt();Vs();br();l9=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})();(function(t){t.EQ="eq",t.NEQ="neq",t.GT="gt",t.GTE="gte",t.LT="lt",t.LTE="lte",t.IN="in",t.NIN="nin",t.ALL="all",t.ELEM_MATCH="elemMatch",t.EXISTS="exists",t.SIZE="size",t.MOD="mod",t.GEO_NEAR="geoNear",t.GEO_WITHIN="geoWithin",t.GEO_INTERSECTS="geoIntersects"})(_e||(_e={}));mt=(function(t){l9(e,t);function e(r,n,o){var i=t.call(this,r,n,o)||this;return i.operator=r,i._internalType=qv,i}return e.prototype.toJSON=function(){var r,n;switch(this.operator){case _e.IN:case _e.NIN:return r={},r["$"+this.operator]=this.operands,r;default:return n={},n["$"+this.operator]=this.operands[0],n}},e.prototype._setFieldName=function(r){var n=new e(this.operator,this.operands,r);return n},e.prototype.eq=function(r){var n=new e(_e.EQ,[r],this.fieldName);return this.and(n)},e.prototype.neq=function(r){var n=new e(_e.NEQ,[r],this.fieldName);return this.and(n)},e.prototype.gt=function(r){var n=new e(_e.GT,[r],this.fieldName);return this.and(n)},e.prototype.gte=function(r){var n=new e(_e.GTE,[r],this.fieldName);return this.and(n)},e.prototype.lt=function(r){var n=new e(_e.LT,[r],this.fieldName);return this.and(n)},e.prototype.lte=function(r){var n=new e(_e.LTE,[r],this.fieldName);return this.and(n)},e.prototype.in=function(r){var n=new e(_e.IN,r,this.fieldName);return this.and(n)},e.prototype.nin=function(r){var n=new e(_e.NIN,r,this.fieldName);return this.and(n)},e.prototype.geoNear=function(r){if(!(r.geometry instanceof gt))throw new TypeError('"geometry" must be of type Point. Received type '.concat(typeof r.geometry));if(r.maxDistance!==void 0&&!yt(r.maxDistance))throw new TypeError('"maxDistance" must be of type Number. Received type '.concat(typeof r.maxDistance));if(r.minDistance!==void 0&&!yt(r.minDistance))throw new TypeError('"minDistance" must be of type Number. Received type '.concat(typeof r.minDistance));var n=new e(_e.GEO_NEAR,[r],this.fieldName);return this.and(n)},e.prototype.geoWithin=function(r){if(!(r.geometry instanceof ao)&&!(r.geometry instanceof On))throw new TypeError('"geometry" must be of type Polygon or MultiPolygon. Received type '.concat(typeof r.geometry));var n=new e(_e.GEO_WITHIN,[r],this.fieldName);return this.and(n)},e.prototype.geoIntersects=function(r){if(!(r.geometry instanceof gt)&&!(r.geometry instanceof dr)&&!(r.geometry instanceof On)&&!(r.geometry instanceof ua)&&!(r.geometry instanceof ca)&&!(r.geometry instanceof ao))throw new TypeError('"geometry" must be of type Point, LineString, Polygon, MultiPoint, MultiLineString or MultiPolygon. Received type '.concat(typeof r.geometry));var n=new e(_e.GEO_INTERSECTS,[r],this.fieldName);return this.and(n)},e})(Rn)});function wi(t){return _i[t]||"$"+t}var _i,sn,sn,sn,Kv=X(()=>{pa();da();fa();_i={};for(sn in _e)_i[sn]="$"+sn;for(sn in $t)_i[sn]="$"+sn;for(sn in xe)_i[sn]="$"+sn;_i[_e.NEQ]="$ne";_i[xe.REMOVE]="$unset";_i[xe.SHIFT]="$pop";_i[xe.UNSHIFT]="$push"});function bi(t){return Jv(t,[t])}function Jv(t,e){if(Al(t))switch(t._internalType){case Sl:return t.toJSON();case Il:return t.parse();case Tl:return t.parse();default:return t.toJSON?t.toJSON():t}else{if(Ol(t))return{$date:+t};if(la(t))return{$regex:t.source,$options:t.flags};if(Me(t))return t.map(function(o){if(e.indexOf(o)>-1)throw new Error("Cannot convert circular structure to JSON");return Jv(o,xl(xl([],IR(e),!1),[o],!1))});if(jr(t)){var r=Yv({},t);for(var n in r){if(e.indexOf(r[n])>-1)throw new Error("Cannot convert circular structure to JSON");r[n]=Jv(r[n],xl(xl([],IR(e),!1),[r[n]],!1))}return r}else return t}}var Yv,IR,xl,Nl=X(()=>{Qt();br();Yv=function(){return Yv=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Yv.apply(this,arguments)},IR=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,i=[],s;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(u){s={error:u}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return i},xl=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,i;n<o;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))}});function OR(t,e,r,n){var o=Qv({},t);for(var i in t)if(!/^\$/.test(i)){var s=t[i];if(s&&jr(s)&&!e(s)){if(n.indexOf(s)>-1)throw new Error("Cannot convert circular structure to JSON");var u=Ll(Ll([],TR(r),!1),[i],!1),l=Ll(Ll([],TR(n),!1),[s],!1),a=OR(s,e,u,l);o[i]=a;var c=!1;for(var h in a)/^\$/.test(h)?c=!0:(o["".concat(i,".").concat(h)]=a[h],delete o[i][h]);c||delete o[i]}}return o}function Dl(t){return OR(t,Ul,[],[t])}function Xv(t,e,r){e[r]||delete t[r];for(var n in e)t[n]?Me(t[n])?t[n].push(e[n]):jr(t[n])?jr(e[n])?Object.assign(t[n],e[n]):(console.warn("unmergable condition, query is object but condition is ".concat(pr(e),", can only overwrite"),e,r),t[n]=e[n]):(console.warn("to-merge query is of type ".concat(pr(t),", can only overwrite"),t,e,r),t[n]=e[n]):t[n]=e[n]}function Ul(t){return Al(t)||Ol(t)||la(t)}function Cn(t){return bi(t)}var Qv,TR,Ll,Zv=X(()=>{br();Nl();Qv=function(){return Qv=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Qv.apply(this,arguments)},TR=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,i=[],s;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(u){s={error:u}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return i},Ll=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,i;n<o;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))}});var va,Bl=X(()=>{fa();Qt();br();Kv();Zv();va=(function(){function t(){}return t.encode=function(e){var r=new t;return r.encodeUpdate(e)},t.prototype.encodeUpdate=function(e){return Vv(e)?this.encodeUpdateCommand(e):pr(e)==="object"?this.encodeUpdateObject(e):e},t.prototype.encodeUpdateCommand=function(e){if(e.fieldName===Jn)throw new Error("Cannot encode a comparison command with unset field name");switch(e.operator){case xe.PUSH:case xe.PULL:case xe.PULL_ALL:case xe.POP:case xe.SHIFT:case xe.UNSHIFT:case xe.ADD_TO_SET:return this.encodeArrayUpdateCommand(e);default:return this.encodeFieldUpdateCommand(e)}},t.prototype.encodeFieldUpdateCommand=function(e){var r,n,o,i,s=wi(e.operator);return e.operator===xe.REMOVE?(r={},r[s]=(n={},n[e.fieldName]="",n),r):(o={},o[s]=(i={},i[e.fieldName]=e.operands[0],i),o)},t.prototype.encodeArrayUpdateCommand=function(e){var r,n,o,i,s,u,l,a,c,h,w=wi(e.operator);switch(e.operator){case xe.PUSH:{var E=void 0;return Me(e.operands)?E={$each:e.operands.map(Cn)}:E=e.operands,r={},r[w]=(n={},n[e.fieldName]=E,n),r}case xe.UNSHIFT:{var E={$each:e.operands.map(Cn),$position:0};return o={},o[w]=(i={},i[e.fieldName]=E,i),o}case xe.POP:return s={},s[w]=(u={},u[e.fieldName]=1,u),s;case xe.SHIFT:return l={},l[w]=(a={},a[e.fieldName]=-1,a),l;default:return c={},c[w]=(h={},h[e.fieldName]=Cn(e.operands),h),c}},t.prototype.encodeUpdateObject=function(e){var r=Dl(e);for(var n in r)if(!/^\$/.test(n)){var o=r[n];if(Vv(o)){r[n]=o._setFieldName(n);var i=this.encodeUpdateCommand(r[n]);Xv(r,i,n)}else{r[n]=o=Cn(o);var s=new nt(xe.SET,[o],n),i=this.encodeUpdateCommand(s);Xv(r,i,n)}}return r},t})()});function ql(t){if(!dt.wsClientClass)throw new Error("to use realtime you must import realtime module first");var e=t.config.env;return e0[e]||(e0[e]=new dt.wsClientClass({context:{appConfig:{docSizeLimit:1e3,realtimePingInterval:1e4,realtimePongWaitTimeout:5e3,request:dt.createRequest(t.config)}}})),e0[e]}var e0,t0=X(()=>{so();e0={}});var Fl,r0,AR=X(()=>{Gv();so();Gs();Bl();Nl();fa();sa();t0();Fl=function(){return Fl=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Fl.apply(this,arguments)},r0=(function(){function t(e,r,n,o){o===void 0&&(o={});var i=this;this.watch=function(s){var u=ql(i._db);return u.watch(Fl(Fl({},s),{envId:i._db.config.env,collectionName:i._coll,query:JSON.stringify({_id:i.id})}))},this._db=e,this._coll=r,this.id=n,this.request=dt.createRequest(this._db.config),this.projection=o}return t.prototype.create=function(e,r){r=r||an();var n={collectionName:this._coll,data:bi(e)};return this.id&&(n._id=this.id),this.request.send("database.addDocument",n).then(function(o){o.code?r(0,o):r(0,{id:o.data._id,requestId:o.requestId})}).catch(function(o){r(o)}),r.promise},t.prototype.set=function(e,r){if(r=r||an(),!this.id)return Promise.resolve({code:"INVALID_PARAM",message:"docId\u4E0D\u80FD\u4E3A\u7A7A"});if(!e||typeof e!="object")return Promise.resolve({code:"INVALID_PARAM",message:"\u53C2\u6570\u5FC5\u9700\u662F\u975E\u7A7A\u5BF9\u8C61"});if(e.hasOwnProperty("_id"))return Promise.resolve({code:"INVALID_PARAM",message:"\u4E0D\u80FD\u66F4\u65B0_id\u7684\u503C"});var n=!1,o=function(u){if(typeof u=="object")for(var l in u)u[l]instanceof nt?n=!0:typeof u[l]=="object"&&o(u[l])};if(o(e),n)return Promise.resolve({code:"DATABASE_REQUEST_FAILED",message:"update operator complicit"});var i=!1,s={collectionName:this._coll,queryType:Fr.DOC,data:bi(e),multi:!1,merge:i,upsert:!0};return this.id&&(s.query={_id:this.id}),this.request.send("database.updateDocument",s).then(function(u){u.code?r(0,u):r(0,{updated:u.data.updated,upsertedId:u.data.upserted_id,requestId:u.requestId})}).catch(function(u){r(u)}),r.promise},t.prototype.update=function(e,r){if(r=r||an(),!e||typeof e!="object")return Promise.resolve({code:"INVALID_PARAM",message:"\u53C2\u6570\u5FC5\u9700\u662F\u975E\u7A7A\u5BF9\u8C61"});if(e.hasOwnProperty("_id"))return Promise.resolve({code:"INVALID_PARAM",message:"\u4E0D\u80FD\u66F4\u65B0_id\u7684\u503C"});var n={_id:this.id},o=!0,i={collectionName:this._coll,data:va.encode(e),query:n,queryType:Fr.DOC,multi:!1,merge:o,upsert:!1};return this.request.send("database.updateDocument",i).then(function(s){s.code?r(0,s):r(0,{updated:s.data.updated,upsertedId:s.data.upserted_id,requestId:s.requestId})}).catch(function(s){r(s)}),r.promise},t.prototype.remove=function(e){e=e||an();var r={_id:this.id},n={collectionName:this._coll,query:r,queryType:Fr.DOC,multi:!1};return this.request.send("database.deleteDocument",n).then(function(o){o.code?e(0,o):e(0,{deleted:o.data.deleted,requestId:o.requestId})}).catch(function(o){e(o)}),e.promise},t.prototype.get=function(e){e=e||an();var r={_id:this.id},n={collectionName:this._coll,query:r,queryType:Fr.DOC,multi:!1,projection:this.projection};return this.request.send("database.queryDocument",n).then(function(o){if(o.code)e(0,o);else{var i=yi.formatResDocumentData(o.data.list);e(0,{data:i,requestId:o.requestId})}}).catch(function(o){e(o)}),e.promise},t.prototype.field=function(e){for(var r in e)e[r]?e[r]=1:e[r]=0;return new t(this._db,this._coll,this.id,e)},t})()});var ma,f9,n0=X(()=>{pa();da();Qt();br();Kv();Zv();ma=(function(){function t(){}return t.encode=function(e){var r=new f9;return r.encodeQuery(e)},t})(),f9=(function(){function t(){}return t.prototype.encodeQuery=function(e,r){var n;return Ul(e)?zs(e)?this.encodeLogicCommand(e):ha(e)?this.encodeQueryCommand(e):(n={},n[r]=this.encodeQueryObject(e),n):jr(e)?this.encodeQueryObject(e):e},t.prototype.encodeRegExp=function(e){return{$regex:e.source,$options:e.flags}},t.prototype.encodeLogicCommand=function(e){var r,n,o,i,s,u,l,a=this;switch(e.operator){case $t.NOR:case $t.AND:case $t.OR:{var c=wi(e.operator),h=e.operands.map(function(T){return a.encodeQuery(T,e.fieldName)});return r={},r[c]=h,r}case $t.NOT:{var c=wi(e.operator),w=e.operands[0];if(la(w))return n={},n[e.fieldName]=(o={},o[c]=this.encodeRegExp(w),o),n;var h=this.encodeQuery(w)[e.fieldName];return i={},i[e.fieldName]=(s={},s[c]=h,s),i}default:{var c=wi(e.operator);if(e.operands.length===1){var E=this.encodeQuery(e.operands[0]);return u={},u[c]=E,u}else{var h=e.operands.map(this.encodeQuery.bind(this));return l={},l[c]=h,l}}}},t.prototype.encodeQueryCommand=function(e){return zv(e)?this.encodeComparisonCommand(e):this.encodeComparisonCommand(e)},t.prototype.encodeComparisonCommand=function(e){var r,n,o,i,s,u,l,a,c;if(e.fieldName===Jn)throw new Error("Cannot encode a comparison command with unset field name");var h=wi(e.operator);switch(e.operator){case _e.EQ:case _e.NEQ:case _e.LT:case _e.LTE:case _e.GT:case _e.GTE:case _e.ELEM_MATCH:case _e.EXISTS:case _e.SIZE:case _e.MOD:return r={},r[e.fieldName]=(n={},n[h]=Cn(e.operands[0]),n),r;case _e.IN:case _e.NIN:case _e.ALL:return o={},o[e.fieldName]=(i={},i[h]=Cn(e.operands),i),o;case _e.GEO_NEAR:{var w=e.operands[0];return s={},s[e.fieldName]={$nearSphere:{$geometry:w.geometry.toJSON(),$maxDistance:w.maxDistance,$minDistance:w.minDistance}},s}case _e.GEO_WITHIN:{var w=e.operands[0];return u={},u[e.fieldName]={$geoWithin:{$geometry:w.geometry.toJSON()}},u}case _e.GEO_INTERSECTS:{var w=e.operands[0];return l={},l[e.fieldName]={$geoIntersects:{$geometry:w.geometry.toJSON()}},l}default:return a={},a[e.fieldName]=(c={},c[h]=Cn(e.operands[0]),c),a}},t.prototype.encodeQueryObject=function(e){var r=Dl(e);for(var n in r){var o=r[n];if(zs(o)){r[n]=o._setFieldName(n);var i=this.encodeLogicCommand(r[n]);this.mergeConditionAfterEncode(r,i,n)}else if(zv(o)){r[n]=o._setFieldName(n);var i=this.encodeComparisonCommand(r[n]);this.mergeConditionAfterEncode(r,i,n)}else Ul(o)&&(r[n]=Cn(o))}return r},t.prototype.mergeConditionAfterEncode=function(e,r,n){r[n]||delete e[n];for(var o in r)e[o]?Me(e[o])?e[o]=e[o].concat(r[o]):jr(e[o])?jr(r[o])?Object.assign(e,r):(console.warn("unmergable condition, query is object but condition is ".concat(pr(r),", can only overwrite"),r,n),e[o]=r[o]):(console.warn("to-merge query is of type ".concat(pr(e),", can only overwrite"),e,r,n),e[o]=r[o]):e[o]=r[o]},t})()});var uo,RR,CR=X(()=>{Gv();sa();so();$v();Gs();n0();Bl();sa();t0();uo=function(){return uo=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},uo.apply(this,arguments)},RR=(function(){function t(e,r,n,o,i){var s=this;this.watch=function(u){var l=ql(s._db);return l.watch(uo(uo({},u),{envId:s._db.config.env,collectionName:s._coll,query:JSON.stringify(s._fieldFilters||{}),limit:s._queryOptions.limit,orderBy:s._fieldOrders?s._fieldOrders.reduce(function(a,c){return a[c.field]=c.direction,a},{}):void 0}))},this._db=e,this._coll=r,this._fieldFilters=n,this._fieldOrders=o||[],this._queryOptions=i||{},this._request=dt.createRequest(this._db.config)}return t.prototype.get=function(e){e=e||an();var r=[];this._fieldOrders&&this._fieldOrders.forEach(function(o){r.push(o)});var n={collectionName:this._coll,queryType:Fr.WHERE};return this._fieldFilters&&(n.query=this._fieldFilters),r.length>0&&(n.order=r),this._queryOptions.offset&&(n.offset=this._queryOptions.offset),this._queryOptions.limit?n.limit=this._queryOptions.limit<1e3?this._queryOptions.limit:1e3:n.limit=100,this._queryOptions.projection&&(n.projection=this._queryOptions.projection),this._request.send("database.queryDocument",n).then(function(o){if(o.code)e(0,o);else{var i=yi.formatResDocumentData(o.data.list),s={data:i,requestId:o.requestId};o.total!==void 0&&(s.total=o.total),o.limit!==void 0&&(s.limit=o.limit),o.offset!==void 0&&(s.offset=o.offset),e(0,s)}}).catch(function(o){e(o)}),e.promise},t.prototype.count=function(e){e=e||an();var r={collectionName:this._coll,queryType:Fr.WHERE};return this._fieldFilters&&(r.query=this._fieldFilters),this._request.send("database.countDocument",r).then(function(n){n.code?e(0,n):e(0,{requestId:n.requestId,total:n.data.total})}).catch(function(n){e(n)}),e.promise},t.prototype.where=function(e){if(Object.prototype.toString.call(e).slice(8,-1)!=="Object")throw Error(on.QueryParamTypeError);var r=Object.keys(e),n=r.some(function(o){return e[o]!==void 0});if(r.length&&!n)throw Error(on.QueryParamValueError);return new t(this._db,this._coll,ma.encode(e),this._fieldOrders,this._queryOptions)},t.prototype.orderBy=function(e,r){An.isFieldPath(e),An.isFieldOrder(r);var n={field:e,direction:r},o=this._fieldOrders.concat(n);return new t(this._db,this._coll,this._fieldFilters,o,this._queryOptions)},t.prototype.limit=function(e){An.isInteger("limit",e);var r=uo({},this._queryOptions);return r.limit=e,new t(this._db,this._coll,this._fieldFilters,this._fieldOrders,r)},t.prototype.skip=function(e){An.isInteger("offset",e);var r=uo({},this._queryOptions);return r.offset=e,new t(this._db,this._coll,this._fieldFilters,this._fieldOrders,r)},t.prototype.update=function(e,r){if(r=r||an(),!e||typeof e!="object")return Promise.resolve({code:"INVALID_PARAM",message:"\u53C2\u6570\u5FC5\u9700\u662F\u975E\u7A7A\u5BF9\u8C61"});if(e.hasOwnProperty("_id"))return Promise.resolve({code:"INVALID_PARAM",message:"\u4E0D\u80FD\u66F4\u65B0_id\u7684\u503C"});var n={collectionName:this._coll,query:this._fieldFilters,queryType:Fr.WHERE,multi:!0,merge:!0,upsert:!1,data:va.encode(e)};return this._request.send("database.updateDocument",n).then(function(o){o.code?r(0,o):r(0,{requestId:o.requestId,updated:o.data.updated,upsertId:o.data.upsert_id})}).catch(function(o){r(o)}),r.promise},t.prototype.field=function(e){for(var r in e)e[r]?typeof e[r]!="object"&&(e[r]=1):e[r]=0;var n=uo({},this._queryOptions);return n.projection=e,new t(this._db,this._coll,this._fieldFilters,this._fieldOrders,n)},t.prototype.remove=function(e){e=e||an(),Object.keys(this._queryOptions).length>0&&console.warn("`offset`, `limit` and `projection` are not supported in remove() operation"),this._fieldOrders.length>0&&console.warn("`orderBy` is not supported in remove() operation");var r={collectionName:this._coll,query:ma.encode(this._fieldFilters),queryType:Fr.WHERE,multi:!0};return this._request.send("database.deleteDocument",r).then(function(n){n.code?e(0,n):e(0,{requestId:n.requestId,deleted:n.data.deleted})}).catch(function(n){e(n)}),e.promise},t})()});function h9(t,e){return e={exports:{}},t(e,e.exports),e.exports}function GR(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var n=r===e?0:4-r%4;return[r,n]}function g9(t){var e=GR(t),r=e[0],n=e[1];return(r+n)*3/4-n}function y9(t,e,r){return(e+r)*3/4-r}function _9(t){var e,r=GR(t),n=r[0],o=r[1],i=new m9(y9(t,n,o)),s=0,u=o>0?n-4:n,l;for(l=0;l<u;l+=4)e=kr[t.charCodeAt(l)]<<18|kr[t.charCodeAt(l+1)]<<12|kr[t.charCodeAt(l+2)]<<6|kr[t.charCodeAt(l+3)],i[s++]=e>>16&255,i[s++]=e>>8&255,i[s++]=e&255;return o===2&&(e=kr[t.charCodeAt(l)]<<2|kr[t.charCodeAt(l+1)]>>4,i[s++]=e&255),o===1&&(e=kr[t.charCodeAt(l)]<<10|kr[t.charCodeAt(l+1)]<<4|kr[t.charCodeAt(l+2)]>>2,i[s++]=e>>8&255,i[s++]=e&255),i}function w9(t){return xn[t>>18&63]+xn[t>>12&63]+xn[t>>6&63]+xn[t&63]}function b9(t,e,r){for(var n,o=[],i=e;i<r;i+=3)n=(t[i]<<16&16711680)+(t[i+1]<<8&65280)+(t[i+2]&255),o.push(w9(n));return o.join("")}function E9(t){for(var e,r=t.length,n=r%3,o=[],i=16383,s=0,u=r-n;s<u;s+=i)o.push(b9(t,s,s+i>u?u:s+i));return n===1?(e=t[r-1],o.push(xn[e>>2]+xn[e<<4&63]+"==")):n===2&&(e=(t[r-2]<<8)+t[r-1],o.push(xn[e>>10]+xn[e>>4&63]+xn[e<<2&63]+"=")),o.join("")}function $l(t,e){l0(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}function jl(t){return t&&t.Math==Math&&t}function VR(){return jl(typeof globalThis=="object"&&globalThis)||jl(typeof window=="object"&&window)||jl(typeof self=="object"&&self)||jl(typeof global=="object"&&global)||Function("return this")()}function T9(){var t=VR();return typeof t.navigator=="object"&&t.navigator.product==="ReactNative"}function R9(t){return["[object ArrayBuffer]","[object SharedArrayBuffer]"].includes(Object.prototype.toString.call(t))}function h0(t){return Object.prototype.toString.call(t)==="[object Uint8Array]"}function C9(t){return Object.prototype.toString.call(t)==="[object RegExp]"}function P9(t){return Qs(t)&&Object.prototype.toString.call(t)==="[object Date]"}function Qs(t){return typeof t=="object"&&t!==null}function Wl(t,e){var r=!1;function n(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return r||(console.warn(e),r=!0),t.apply(this,o)}return n}function Ml(t){if(ArrayBuffer.isView(t))return ke.from(t.buffer,t.byteOffset,t.byteLength);if(R9(t))return ke.from(t);throw new at("Must use either Buffer or TypedArray")}function D9(t){return Qs(t)&&t.$id!=null&&typeof t.$ref=="string"&&(t.$db==null||typeof t.$db=="string")}function kR(t){return!isNaN(parseInt(t,10))}function H9(t){var e=ve.fromNumber(1e9),r=ve.fromNumber(0);if(!t.parts[0]&&!t.parts[1]&&!t.parts[2]&&!t.parts[3])return{quotient:t,rem:r};for(var n=0;n<=3;n++)r=r.shiftLeft(32),r=r.add(new ve(t.parts[n],0)),t.parts[n]=r.div(e).low,r=r.modulo(e);return{quotient:t,rem:r}}function G9(t,e){if(!t&&!e)return{high:ve.fromNumber(0),low:ve.fromNumber(0)};var r=t.shiftRightUnsigned(32),n=new ve(t.getLowBits(),0),o=e.shiftRightUnsigned(32),i=new ve(e.getLowBits(),0),s=r.multiply(o),u=r.multiply(i),l=n.multiply(o),a=n.multiply(i);return s=s.add(u.shiftRightUnsigned(32)),u=new ve(u.getLowBits(),0).add(l).add(a.shiftRightUnsigned(32)),s=s.add(u.shiftRightUnsigned(32)),a=u.shiftLeft(32).add(new ve(a.getLowBits(),0)),{high:s,low:a}}function V9(t,e){var r=t.high>>>0,n=e.high>>>0;if(r<n)return!0;if(r===n){var o=t.low>>>0,i=e.low>>>0;if(o<i)return!0}return!1}function ya(t,e){throw new at('"'.concat(t,'" is not a valid Decimal128 string - ').concat(e))}function K9(t){return t.split("").sort().join("")}function J9(t){return Qs(t)&&Reflect.has(t,"_bsontype")&&typeof t._bsontype=="string"}function r2(t,e){if(e===void 0&&(e={}),typeof t=="number"){if(e.relaxed||e.legacy)return t;if(Math.floor(t)===t){if(t>=ZR&&t<=XR)return new Vl(t);if(t>=t2&&t<=e2)return ve.fromNumber(t)}return new Gl(t)}if(t==null||typeof t!="object")return t;if(t.$undefined)return null;for(var r=Object.keys(t).filter(function(h){return h.startsWith("$")&&t[h]!=null}),n=0;n<r.length;n++){var o=Q9[r[n]];if(o)return o.fromExtendedJSON(t,e)}if(t.$date!=null){var i=t.$date,s=new Date;return e.legacy?typeof i=="number"?s.setTime(i):typeof i=="string"&&s.setTime(Date.parse(i)):typeof i=="string"?s.setTime(Date.parse(i)):ve.isLong(i)?s.setTime(i.toNumber()):typeof i=="number"&&e.relaxed&&s.setTime(i),s}if(t.$code!=null){var u=Object.assign({},t);return t.$scope&&(u.$scope=r2(t.$scope)),Hl.fromExtendedJSON(t)}if(D9(t)||t.$dbPointer){var l=t.$ref?t:t.$dbPointer;if(l instanceof Ys)return l;var a=Object.keys(l).filter(function(h){return h.startsWith("$")}),c=!0;if(a.forEach(function(h){["$ref","$id","$db"].indexOf(h)===-1&&(c=!1)}),c)return Ys.fromExtendedJSON(l)}return t}function X9(t,e){return t.map(function(r,n){e.seenObjects.push({propertyName:"index ".concat(n),obj:null});try{return Ei(r,e)}finally{e.seenObjects.pop()}})}function $R(t){var e=t.toISOString();return t.getUTCMilliseconds()!==0?e:e.slice(0,-5)+"Z"}function Ei(t,e){if((typeof t=="object"||typeof t=="function")&&t!==null){var r=e.seenObjects.findIndex(function(C){return C.obj===t});if(r!==-1){var n=e.seenObjects.map(function(C){return C.propertyName}),o=n.slice(0,r).map(function(C){return"".concat(C," -> ")}).join(""),i=n[r],s=" -> "+n.slice(r+1,n.length-1).map(function(C){return"".concat(C," -> ")}).join(""),u=n[n.length-1],l=" ".repeat(o.length+i.length/2),a="-".repeat(s.length+(i.length+u.length)/2-1);throw new at(`Converting circular structure to EJSON:
`+"    ".concat(o).concat(i).concat(s).concat(u,`
`)+"    ".concat(l,"\\").concat(a,"/"))}e.seenObjects[e.seenObjects.length-1].obj=t}if(Array.isArray(t))return X9(t,e);if(t===void 0)return null;if(t instanceof Date||P9(t)){var c=t.getTime(),h=c>-1&&c<2534023188e5;return e.legacy?e.relaxed&&h?{$date:t.getTime()}:{$date:$R(t)}:e.relaxed&&h?{$date:$R(t)}:{$date:{$numberLong:t.getTime().toString()}}}if(typeof t=="number"&&(!e.relaxed||!isFinite(t))){if(Math.floor(t)===t){var w=t>=ZR&&t<=XR,E=t>=t2&&t<=e2;if(w)return{$numberInt:t.toString()};if(E)return{$numberLong:t.toString()}}return{$numberDouble:t.toString()}}if(t instanceof RegExp||C9(t)){var T=t.flags;if(T===void 0){var A=t.toString().match(/[gimuy]*$/);A&&(T=A[0])}var O=new Js(t.source,T);return O.toExtendedJSON(e)}return t!=null&&typeof t=="object"?e7(t,e):t}function e7(t,e){if(t==null||typeof t!="object")throw new fo("not an object instance");var r=t._bsontype;if(typeof r>"u"){var n={};for(var o in t){e.seenObjects.push({propertyName:o,obj:null});try{var i=Ei(t[o],e);o==="__proto__"?Object.defineProperty(n,o,{value:i,writable:!0,enumerable:!0,configurable:!0}):n[o]=i}finally{e.seenObjects.pop()}}return n}else if(J9(t)){var s=t;if(typeof s.toExtendedJSON!="function"){var u=Z9[t._bsontype];if(!u)throw new at("Unrecognized or invalid _bsontype: "+t._bsontype);s=u(s)}return r==="Code"&&s.scope?s=new Hl(s.code,Ei(s.scope,e)):r==="DBRef"&&s.oid&&(s=new Ys(Ei(s.collection,e),Ei(s.oid,e),Ei(s.db,e),Ei(s.fields,e))),s.toExtendedJSON(e)}else throw new fo("_bsontype must be a string, but was: "+typeof r)}var d9,p9,v9,xn,kr,m9,i0,co,PR,o0,S9,I9,ga,kl,ke,l0,fo,at,O9,A9,zR,x9,KR,f0,xR,eX,tX,N9,L9,YR,ho,a0,NR,Hl,Ys,Mr,LR,U9,_a,JR,DR,UR,BR,ve,B9,q9,F9,Ks,s0,qR,j9,u0,FR,jR,M9,k9,MR,$9,W9,d0,Gl,Vl,p0,v0,z9,lo,Pn,$r,Js,m0,Y9,QR,XR,ZR,e2,t2,Q9,Z9,Xt,WR,HR,rX,nX,c0,iX,t7,oX,g0=X(()=>{d9=g9,p9=_9,v9=E9,xn=[],kr=[],m9=typeof Uint8Array<"u"?Uint8Array:Array,i0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(co=0,PR=i0.length;co<PR;++co)xn[co]=i0[co],kr[i0.charCodeAt(co)]=co;kr[45]=62;kr[95]=63;o0={byteLength:d9,toByteArray:p9,fromByteArray:v9};S9=function(e,r,n,o,i){var s,u,l=i*8-o-1,a=(1<<l)-1,c=a>>1,h=-7,w=n?i-1:0,E=n?-1:1,T=e[r+w];for(w+=E,s=T&(1<<-h)-1,T>>=-h,h+=l;h>0;s=s*256+e[r+w],w+=E,h-=8);for(u=s&(1<<-h)-1,s>>=-h,h+=o;h>0;u=u*256+e[r+w],w+=E,h-=8);if(s===0)s=1-c;else{if(s===a)return u?NaN:(T?-1:1)*(1/0);u=u+Math.pow(2,o),s=s-c}return(T?-1:1)*u*Math.pow(2,s-o)},I9=function(e,r,n,o,i,s){var u,l,a,c=s*8-i-1,h=(1<<c)-1,w=h>>1,E=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,T=o?0:s-1,A=o?1:-1,O=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(l=isNaN(r)?1:0,u=h):(u=Math.floor(Math.log(r)/Math.LN2),r*(a=Math.pow(2,-u))<1&&(u--,a*=2),u+w>=1?r+=E/a:r+=E*Math.pow(2,1-w),r*a>=2&&(u++,a/=2),u+w>=h?(l=0,u=h):u+w>=1?(l=(r*a-1)*Math.pow(2,i),u=u+w):(l=r*Math.pow(2,w-1)*Math.pow(2,i),u=0));i>=8;e[n+T]=l&255,T+=A,l/=256,i-=8);for(u=u<<i|l,c+=i;c>0;e[n+T]=u&255,T+=A,u/=256,c-=8);e[n+T-A]|=O*128},ga={read:S9,write:I9},kl=h9(function(t,e){var r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=s,e.SlowBuffer=C,e.INSPECT_MAX_BYTES=50;var n=2147483647;e.kMaxLength=n,s.TYPED_ARRAY_SUPPORT=o(),!s.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{var R=new Uint8Array(1),_={foo:function(){return 42}};return Object.setPrototypeOf(_,Uint8Array.prototype),Object.setPrototypeOf(R,_),R.foo()===42}catch{return!1}}Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}});function i(R){if(R>n)throw new RangeError('The value "'+R+'" is invalid for option "size"');var _=new Uint8Array(R);return Object.setPrototypeOf(_,s.prototype),_}function s(R,_,b){if(typeof R=="number"){if(typeof _=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return c(R)}return u(R,_,b)}s.poolSize=8192;function u(R,_,b){if(typeof R=="string")return h(R,_);if(ArrayBuffer.isView(R))return E(R);if(R==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+babelHelpers.typeof(R));if(je(R,ArrayBuffer)||R&&je(R.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(je(R,SharedArrayBuffer)||R&&je(R.buffer,SharedArrayBuffer)))return T(R,_,b);if(typeof R=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var N=R.valueOf&&R.valueOf();if(N!=null&&N!==R)return s.from(N,_,b);var M=A(R);if(M)return M;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof R[Symbol.toPrimitive]=="function")return s.from(R[Symbol.toPrimitive]("string"),_,b);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+babelHelpers.typeof(R))}s.from=function(R,_,b){return u(R,_,b)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array);function l(R){if(typeof R!="number")throw new TypeError('"size" argument must be of type number');if(R<0)throw new RangeError('The value "'+R+'" is invalid for option "size"')}function a(R,_,b){return l(R),R<=0?i(R):_!==void 0?typeof b=="string"?i(R).fill(_,b):i(R).fill(_):i(R)}s.alloc=function(R,_,b){return a(R,_,b)};function c(R){return l(R),i(R<0?0:O(R)|0)}s.allocUnsafe=function(R){return c(R)},s.allocUnsafeSlow=function(R){return c(R)};function h(R,_){if((typeof _!="string"||_==="")&&(_="utf8"),!s.isEncoding(_))throw new TypeError("Unknown encoding: "+_);var b=P(R,_)|0,N=i(b),M=N.write(R,_);return M!==b&&(N=N.slice(0,M)),N}function w(R){for(var _=R.length<0?0:O(R.length)|0,b=i(_),N=0;N<_;N+=1)b[N]=R[N]&255;return b}function E(R){if(je(R,Uint8Array)){var _=new Uint8Array(R);return T(_.buffer,_.byteOffset,_.byteLength)}return w(R)}function T(R,_,b){if(_<0||R.byteLength<_)throw new RangeError('"offset" is outside of buffer bounds');if(R.byteLength<_+(b||0))throw new RangeError('"length" is outside of buffer bounds');var N;return _===void 0&&b===void 0?N=new Uint8Array(R):b===void 0?N=new Uint8Array(R,_):N=new Uint8Array(R,_,b),Object.setPrototypeOf(N,s.prototype),N}function A(R){if(s.isBuffer(R)){var _=O(R.length)|0,b=i(_);return b.length===0||R.copy(b,0,0,_),b}if(R.length!==void 0)return typeof R.length!="number"||et(R.length)?i(0):w(R);if(R.type==="Buffer"&&Array.isArray(R.data))return w(R.data)}function O(R){if(R>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return R|0}function C(R){return+R!=R&&(R=0),s.alloc(+R)}s.isBuffer=function(_){return _!=null&&_._isBuffer===!0&&_!==s.prototype},s.compare=function(_,b){if(je(_,Uint8Array)&&(_=s.from(_,_.offset,_.byteLength)),je(b,Uint8Array)&&(b=s.from(b,b.offset,b.byteLength)),!s.isBuffer(_)||!s.isBuffer(b))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(_===b)return 0;for(var N=_.length,M=b.length,re=0,ee=Math.min(N,M);re<ee;++re)if(_[re]!==b[re]){N=_[re],M=b[re];break}return N<M?-1:M<N?1:0},s.isEncoding=function(_){switch(String(_).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(_,b){if(!Array.isArray(_))throw new TypeError('"list" argument must be an Array of Buffers');if(_.length===0)return s.alloc(0);var N;if(b===void 0)for(b=0,N=0;N<_.length;++N)b+=_[N].length;var M=s.allocUnsafe(b),re=0;for(N=0;N<_.length;++N){var ee=_[N];if(je(ee,Uint8Array))re+ee.length>M.length?s.from(ee).copy(M,re):Uint8Array.prototype.set.call(M,ee,re);else if(s.isBuffer(ee))ee.copy(M,re);else throw new TypeError('"list" argument must be an Array of Buffers');re+=ee.length}return M};function P(R,_){if(s.isBuffer(R))return R.length;if(ArrayBuffer.isView(R)||je(R,ArrayBuffer))return R.byteLength;if(typeof R!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+babelHelpers.typeof(R));var b=R.length,N=arguments.length>2&&arguments[2]===!0;if(!N&&b===0)return 0;for(var M=!1;;)switch(_){case"ascii":case"latin1":case"binary":return b;case"utf8":case"utf-8":return Ie(R).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return b*2;case"hex":return b>>>1;case"base64":return Ce(R).length;default:if(M)return N?-1:Ie(R).length;_=(""+_).toLowerCase(),M=!0}}s.byteLength=P;function q(R,_,b){var N=!1;if((_===void 0||_<0)&&(_=0),_>this.length||((b===void 0||b>this.length)&&(b=this.length),b<=0)||(b>>>=0,_>>>=0,b<=_))return"";for(R||(R="utf8");;)switch(R){case"hex":return d(this,_,b);case"utf8":case"utf-8":return be(this,_,b);case"ascii":return Pt(this,_,b);case"latin1":case"binary":return F(this,_,b);case"base64":return ue(this,_,b);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return p(this,_,b);default:if(N)throw new TypeError("Unknown encoding: "+R);R=(R+"").toLowerCase(),N=!0}}s.prototype._isBuffer=!0;function U(R,_,b){var N=R[_];R[_]=R[b],R[b]=N}s.prototype.swap16=function(){var _=this.length;if(_%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var b=0;b<_;b+=2)U(this,b,b+1);return this},s.prototype.swap32=function(){var _=this.length;if(_%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var b=0;b<_;b+=4)U(this,b,b+3),U(this,b+1,b+2);return this},s.prototype.swap64=function(){var _=this.length;if(_%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var b=0;b<_;b+=8)U(this,b,b+7),U(this,b+1,b+6),U(this,b+2,b+5),U(this,b+3,b+4);return this},s.prototype.toString=function(){var _=this.length;return _===0?"":arguments.length===0?be(this,0,_):q.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(_){if(!s.isBuffer(_))throw new TypeError("Argument must be a Buffer");return this===_?!0:s.compare(this,_)===0},s.prototype.inspect=function(){var _="",b=e.INSPECT_MAX_BYTES;return _=this.toString("hex",0,b).replace(/(.{2})/g,"$1 ").trim(),this.length>b&&(_+=" ... "),"<Buffer "+_+">"},r&&(s.prototype[r]=s.prototype.inspect),s.prototype.compare=function(_,b,N,M,re){if(je(_,Uint8Array)&&(_=s.from(_,_.offset,_.byteLength)),!s.isBuffer(_))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+babelHelpers.typeof(_));if(b===void 0&&(b=0),N===void 0&&(N=_?_.length:0),M===void 0&&(M=0),re===void 0&&(re=this.length),b<0||N>_.length||M<0||re>this.length)throw new RangeError("out of range index");if(M>=re&&b>=N)return 0;if(M>=re)return-1;if(b>=N)return 1;if(b>>>=0,N>>>=0,M>>>=0,re>>>=0,this===_)return 0;for(var ee=re-M,Le=N-b,We=Math.min(ee,Le),He=this.slice(M,re),_t=_.slice(b,N),Xe=0;Xe<We;++Xe)if(He[Xe]!==_t[Xe]){ee=He[Xe],Le=_t[Xe];break}return ee<Le?-1:Le<ee?1:0};function k(R,_,b,N,M){if(R.length===0)return-1;if(typeof b=="string"?(N=b,b=0):b>2147483647?b=2147483647:b<-2147483648&&(b=-2147483648),b=+b,et(b)&&(b=M?0:R.length-1),b<0&&(b=R.length+b),b>=R.length){if(M)return-1;b=R.length-1}else if(b<0)if(M)b=0;else return-1;if(typeof _=="string"&&(_=s.from(_,N)),s.isBuffer(_))return _.length===0?-1:W(R,_,b,N,M);if(typeof _=="number")return _=_&255,typeof Uint8Array.prototype.indexOf=="function"?M?Uint8Array.prototype.indexOf.call(R,_,b):Uint8Array.prototype.lastIndexOf.call(R,_,b):W(R,[_],b,N,M);throw new TypeError("val must be string, number or Buffer")}function W(R,_,b,N,M){var re=1,ee=R.length,Le=_.length;if(N!==void 0&&(N=String(N).toLowerCase(),N==="ucs2"||N==="ucs-2"||N==="utf16le"||N==="utf-16le")){if(R.length<2||_.length<2)return-1;re=2,ee/=2,Le/=2,b/=2}function We(tu,xt){return re===1?tu[xt]:tu.readUInt16BE(xt*re)}var He;if(M){var _t=-1;for(He=b;He<ee;He++)if(We(R,He)===We(_,_t===-1?0:He-_t)){if(_t===-1&&(_t=He),He-_t+1===Le)return _t*re}else _t!==-1&&(He-=He-_t),_t=-1}else for(b+Le>ee&&(b=ee-Le),He=b;He>=0;He--){for(var Xe=!0,Sr=0;Sr<Le;Sr++)if(We(R,He+Sr)!==We(_,Sr)){Xe=!1;break}if(Xe)return He}return-1}s.prototype.includes=function(_,b,N){return this.indexOf(_,b,N)!==-1},s.prototype.indexOf=function(_,b,N){return k(this,_,b,N,!0)},s.prototype.lastIndexOf=function(_,b,N){return k(this,_,b,N,!1)};function V(R,_,b,N){b=Number(b)||0;var M=R.length-b;N?(N=Number(N),N>M&&(N=M)):N=M;var re=_.length;N>re/2&&(N=re/2);for(var ee=0;ee<N;++ee){var Le=parseInt(_.substr(ee*2,2),16);if(et(Le))return ee;R[b+ee]=Le}return ee}function Y(R,_,b,N){return Fe(Ie(_,R.length-b),R,b,N)}function Z(R,_,b,N){return Fe(Ae(_),R,b,N)}function ae(R,_,b,N){return Fe(Ce(_),R,b,N)}function ie(R,_,b,N){return Fe(Te(_,R.length-b),R,b,N)}s.prototype.write=function(_,b,N,M){if(b===void 0)M="utf8",N=this.length,b=0;else if(N===void 0&&typeof b=="string")M=b,N=this.length,b=0;else if(isFinite(b))b=b>>>0,isFinite(N)?(N=N>>>0,M===void 0&&(M="utf8")):(M=N,N=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var re=this.length-b;if((N===void 0||N>re)&&(N=re),_.length>0&&(N<0||b<0)||b>this.length)throw new RangeError("Attempt to write outside buffer bounds");M||(M="utf8");for(var ee=!1;;)switch(M){case"hex":return V(this,_,b,N);case"utf8":case"utf-8":return Y(this,_,b,N);case"ascii":case"latin1":case"binary":return Z(this,_,b,N);case"base64":return ae(this,_,b,N);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ie(this,_,b,N);default:if(ee)throw new TypeError("Unknown encoding: "+M);M=(""+M).toLowerCase(),ee=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ue(R,_,b){return _===0&&b===R.length?o0.fromByteArray(R):o0.fromByteArray(R.slice(_,b))}function be(R,_,b){b=Math.min(R.length,b);for(var N=[],M=_;M<b;){var re=R[M],ee=null,Le=re>239?4:re>223?3:re>191?2:1;if(M+Le<=b){var We,He,_t,Xe;switch(Le){case 1:re<128&&(ee=re);break;case 2:We=R[M+1],(We&192)===128&&(Xe=(re&31)<<6|We&63,Xe>127&&(ee=Xe));break;case 3:We=R[M+1],He=R[M+2],(We&192)===128&&(He&192)===128&&(Xe=(re&15)<<12|(We&63)<<6|He&63,Xe>2047&&(Xe<55296||Xe>57343)&&(ee=Xe));break;case 4:We=R[M+1],He=R[M+2],_t=R[M+3],(We&192)===128&&(He&192)===128&&(_t&192)===128&&(Xe=(re&15)<<18|(We&63)<<12|(He&63)<<6|_t&63,Xe>65535&&Xe<1114112&&(ee=Xe))}}ee===null?(ee=65533,Le=1):ee>65535&&(ee-=65536,N.push(ee>>>10&1023|55296),ee=56320|ee&1023),N.push(ee),M+=Le}return Ot(N)}var me=4096;function Ot(R){var _=R.length;if(_<=me)return String.fromCharCode.apply(String,R);for(var b="",N=0;N<_;)b+=String.fromCharCode.apply(String,R.slice(N,N+=me));return b}function Pt(R,_,b){var N="";b=Math.min(R.length,b);for(var M=_;M<b;++M)N+=String.fromCharCode(R[M]&127);return N}function F(R,_,b){var N="";b=Math.min(R.length,b);for(var M=_;M<b;++M)N+=String.fromCharCode(R[M]);return N}function d(R,_,b){var N=R.length;(!_||_<0)&&(_=0),(!b||b<0||b>N)&&(b=N);for(var M="",re=_;re<b;++re)M+=Er[R[re]];return M}function p(R,_,b){for(var N=R.slice(_,b),M="",re=0;re<N.length-1;re+=2)M+=String.fromCharCode(N[re]+N[re+1]*256);return M}s.prototype.slice=function(_,b){var N=this.length;_=~~_,b=b===void 0?N:~~b,_<0?(_+=N,_<0&&(_=0)):_>N&&(_=N),b<0?(b+=N,b<0&&(b=0)):b>N&&(b=N),b<_&&(b=_);var M=this.subarray(_,b);return Object.setPrototypeOf(M,s.prototype),M};function y(R,_,b){if(R%1!==0||R<0)throw new RangeError("offset is not uint");if(R+_>b)throw new RangeError("Trying to access beyond buffer length")}s.prototype.readUintLE=s.prototype.readUIntLE=function(_,b,N){_=_>>>0,b=b>>>0,N||y(_,b,this.length);for(var M=this[_],re=1,ee=0;++ee<b&&(re*=256);)M+=this[_+ee]*re;return M},s.prototype.readUintBE=s.prototype.readUIntBE=function(_,b,N){_=_>>>0,b=b>>>0,N||y(_,b,this.length);for(var M=this[_+--b],re=1;b>0&&(re*=256);)M+=this[_+--b]*re;return M},s.prototype.readUint8=s.prototype.readUInt8=function(_,b){return _=_>>>0,b||y(_,1,this.length),this[_]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(_,b){return _=_>>>0,b||y(_,2,this.length),this[_]|this[_+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(_,b){return _=_>>>0,b||y(_,2,this.length),this[_]<<8|this[_+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(_,b){return _=_>>>0,b||y(_,4,this.length),(this[_]|this[_+1]<<8|this[_+2]<<16)+this[_+3]*16777216},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(_,b){return _=_>>>0,b||y(_,4,this.length),this[_]*16777216+(this[_+1]<<16|this[_+2]<<8|this[_+3])},s.prototype.readIntLE=function(_,b,N){_=_>>>0,b=b>>>0,N||y(_,b,this.length);for(var M=this[_],re=1,ee=0;++ee<b&&(re*=256);)M+=this[_+ee]*re;return re*=128,M>=re&&(M-=Math.pow(2,8*b)),M},s.prototype.readIntBE=function(_,b,N){_=_>>>0,b=b>>>0,N||y(_,b,this.length);for(var M=b,re=1,ee=this[_+--M];M>0&&(re*=256);)ee+=this[_+--M]*re;return re*=128,ee>=re&&(ee-=Math.pow(2,8*b)),ee},s.prototype.readInt8=function(_,b){return _=_>>>0,b||y(_,1,this.length),this[_]&128?(255-this[_]+1)*-1:this[_]},s.prototype.readInt16LE=function(_,b){_=_>>>0,b||y(_,2,this.length);var N=this[_]|this[_+1]<<8;return N&32768?N|4294901760:N},s.prototype.readInt16BE=function(_,b){_=_>>>0,b||y(_,2,this.length);var N=this[_+1]|this[_]<<8;return N&32768?N|4294901760:N},s.prototype.readInt32LE=function(_,b){return _=_>>>0,b||y(_,4,this.length),this[_]|this[_+1]<<8|this[_+2]<<16|this[_+3]<<24},s.prototype.readInt32BE=function(_,b){return _=_>>>0,b||y(_,4,this.length),this[_]<<24|this[_+1]<<16|this[_+2]<<8|this[_+3]},s.prototype.readFloatLE=function(_,b){return _=_>>>0,b||y(_,4,this.length),ga.read(this,_,!0,23,4)},s.prototype.readFloatBE=function(_,b){return _=_>>>0,b||y(_,4,this.length),ga.read(this,_,!1,23,4)},s.prototype.readDoubleLE=function(_,b){return _=_>>>0,b||y(_,8,this.length),ga.read(this,_,!0,52,8)},s.prototype.readDoubleBE=function(_,b){return _=_>>>0,b||y(_,8,this.length),ga.read(this,_,!1,52,8)};function S(R,_,b,N,M,re){if(!s.isBuffer(R))throw new TypeError('"buffer" argument must be a Buffer instance');if(_>M||_<re)throw new RangeError('"value" argument is out of bounds');if(b+N>R.length)throw new RangeError("Index out of range")}s.prototype.writeUintLE=s.prototype.writeUIntLE=function(_,b,N,M){if(_=+_,b=b>>>0,N=N>>>0,!M){var re=Math.pow(2,8*N)-1;S(this,_,b,N,re,0)}var ee=1,Le=0;for(this[b]=_&255;++Le<N&&(ee*=256);)this[b+Le]=_/ee&255;return b+N},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(_,b,N,M){if(_=+_,b=b>>>0,N=N>>>0,!M){var re=Math.pow(2,8*N)-1;S(this,_,b,N,re,0)}var ee=N-1,Le=1;for(this[b+ee]=_&255;--ee>=0&&(Le*=256);)this[b+ee]=_/Le&255;return b+N},s.prototype.writeUint8=s.prototype.writeUInt8=function(_,b,N){return _=+_,b=b>>>0,N||S(this,_,b,1,255,0),this[b]=_&255,b+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(_,b,N){return _=+_,b=b>>>0,N||S(this,_,b,2,65535,0),this[b]=_&255,this[b+1]=_>>>8,b+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(_,b,N){return _=+_,b=b>>>0,N||S(this,_,b,2,65535,0),this[b]=_>>>8,this[b+1]=_&255,b+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(_,b,N){return _=+_,b=b>>>0,N||S(this,_,b,4,4294967295,0),this[b+3]=_>>>24,this[b+2]=_>>>16,this[b+1]=_>>>8,this[b]=_&255,b+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(_,b,N){return _=+_,b=b>>>0,N||S(this,_,b,4,4294967295,0),this[b]=_>>>24,this[b+1]=_>>>16,this[b+2]=_>>>8,this[b+3]=_&255,b+4},s.prototype.writeIntLE=function(_,b,N,M){if(_=+_,b=b>>>0,!M){var re=Math.pow(2,8*N-1);S(this,_,b,N,re-1,-re)}var ee=0,Le=1,We=0;for(this[b]=_&255;++ee<N&&(Le*=256);)_<0&&We===0&&this[b+ee-1]!==0&&(We=1),this[b+ee]=(_/Le>>0)-We&255;return b+N},s.prototype.writeIntBE=function(_,b,N,M){if(_=+_,b=b>>>0,!M){var re=Math.pow(2,8*N-1);S(this,_,b,N,re-1,-re)}var ee=N-1,Le=1,We=0;for(this[b+ee]=_&255;--ee>=0&&(Le*=256);)_<0&&We===0&&this[b+ee+1]!==0&&(We=1),this[b+ee]=(_/Le>>0)-We&255;return b+N},s.prototype.writeInt8=function(_,b,N){return _=+_,b=b>>>0,N||S(this,_,b,1,127,-128),_<0&&(_=255+_+1),this[b]=_&255,b+1},s.prototype.writeInt16LE=function(_,b,N){return _=+_,b=b>>>0,N||S(this,_,b,2,32767,-32768),this[b]=_&255,this[b+1]=_>>>8,b+2},s.prototype.writeInt16BE=function(_,b,N){return _=+_,b=b>>>0,N||S(this,_,b,2,32767,-32768),this[b]=_>>>8,this[b+1]=_&255,b+2},s.prototype.writeInt32LE=function(_,b,N){return _=+_,b=b>>>0,N||S(this,_,b,4,2147483647,-2147483648),this[b]=_&255,this[b+1]=_>>>8,this[b+2]=_>>>16,this[b+3]=_>>>24,b+4},s.prototype.writeInt32BE=function(_,b,N){return _=+_,b=b>>>0,N||S(this,_,b,4,2147483647,-2147483648),_<0&&(_=4294967295+_+1),this[b]=_>>>24,this[b+1]=_>>>16,this[b+2]=_>>>8,this[b+3]=_&255,b+4};function L(R,_,b,N,M,re){if(b+N>R.length)throw new RangeError("Index out of range");if(b<0)throw new RangeError("Index out of range")}function B(R,_,b,N,M){return _=+_,b=b>>>0,M||L(R,_,b,4),ga.write(R,_,b,N,23,4),b+4}s.prototype.writeFloatLE=function(_,b,N){return B(this,_,b,!0,N)},s.prototype.writeFloatBE=function(_,b,N){return B(this,_,b,!1,N)};function $(R,_,b,N,M){return _=+_,b=b>>>0,M||L(R,_,b,8),ga.write(R,_,b,N,52,8),b+8}s.prototype.writeDoubleLE=function(_,b,N){return $(this,_,b,!0,N)},s.prototype.writeDoubleBE=function(_,b,N){return $(this,_,b,!1,N)},s.prototype.copy=function(_,b,N,M){if(!s.isBuffer(_))throw new TypeError("argument should be a Buffer");if(N||(N=0),!M&&M!==0&&(M=this.length),b>=_.length&&(b=_.length),b||(b=0),M>0&&M<N&&(M=N),M===N||_.length===0||this.length===0)return 0;if(b<0)throw new RangeError("targetStart out of bounds");if(N<0||N>=this.length)throw new RangeError("Index out of range");if(M<0)throw new RangeError("sourceEnd out of bounds");M>this.length&&(M=this.length),_.length-b<M-N&&(M=_.length-b+N);var re=M-N;return this===_&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(b,N,M):Uint8Array.prototype.set.call(_,this.subarray(N,M),b),re},s.prototype.fill=function(_,b,N,M){if(typeof _=="string"){if(typeof b=="string"?(M=b,b=0,N=this.length):typeof N=="string"&&(M=N,N=this.length),M!==void 0&&typeof M!="string")throw new TypeError("encoding must be a string");if(typeof M=="string"&&!s.isEncoding(M))throw new TypeError("Unknown encoding: "+M);if(_.length===1){var re=_.charCodeAt(0);(M==="utf8"&&re<128||M==="latin1")&&(_=re)}}else typeof _=="number"?_=_&255:typeof _=="boolean"&&(_=Number(_));if(b<0||this.length<b||this.length<N)throw new RangeError("Out of range index");if(N<=b)return this;b=b>>>0,N=N===void 0?this.length:N>>>0,_||(_=0);var ee;if(typeof _=="number")for(ee=b;ee<N;++ee)this[ee]=_;else{var Le=s.isBuffer(_)?_:s.from(_,M),We=Le.length;if(We===0)throw new TypeError('The value "'+_+'" is invalid for argument "value"');for(ee=0;ee<N-b;++ee)this[ee+b]=Le[ee%We]}return this};var Q=/[^+/0-9A-Za-z-_]/g;function se(R){if(R=R.split("=")[0],R=R.trim().replace(Q,""),R.length<2)return"";for(;R.length%4!==0;)R=R+"=";return R}function Ie(R,_){_=_||1/0;for(var b,N=R.length,M=null,re=[],ee=0;ee<N;++ee){if(b=R.charCodeAt(ee),b>55295&&b<57344){if(!M){if(b>56319){(_-=3)>-1&&re.push(239,191,189);continue}else if(ee+1===N){(_-=3)>-1&&re.push(239,191,189);continue}M=b;continue}if(b<56320){(_-=3)>-1&&re.push(239,191,189),M=b;continue}b=(M-55296<<10|b-56320)+65536}else M&&(_-=3)>-1&&re.push(239,191,189);if(M=null,b<128){if((_-=1)<0)break;re.push(b)}else if(b<2048){if((_-=2)<0)break;re.push(b>>6|192,b&63|128)}else if(b<65536){if((_-=3)<0)break;re.push(b>>12|224,b>>6&63|128,b&63|128)}else if(b<1114112){if((_-=4)<0)break;re.push(b>>18|240,b>>12&63|128,b>>6&63|128,b&63|128)}else throw new Error("Invalid code point")}return re}function Ae(R){for(var _=[],b=0;b<R.length;++b)_.push(R.charCodeAt(b)&255);return _}function Te(R,_){for(var b,N,M,re=[],ee=0;ee<R.length&&!((_-=2)<0);++ee)b=R.charCodeAt(ee),N=b>>8,M=b%256,re.push(M),re.push(N);return re}function Ce(R){return o0.toByteArray(se(R))}function Fe(R,_,b,N){for(var M=0;M<N&&!(M+b>=_.length||M>=R.length);++M)_[M+b]=R[M];return M}function je(R,_){return R instanceof _||R!=null&&R.constructor!=null&&R.constructor.name!=null&&R.constructor.name===_.name}function et(R){return R!==R}var Er=(function(){for(var R="0123456789abcdef",_=new Array(256),b=0;b<16;++b)for(var N=b*16,M=0;M<16;++M)_[N+M]=R[b]+R[M];return _})()}),ke=kl.Buffer;kl.SlowBuffer;kl.INSPECT_MAX_BYTES;kl.kMaxLength;l0=function(e,r){return l0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)o.hasOwnProperty(i)&&(n[i]=o[i])},l0(e,r)};fo=(function(t){$l(e,t);function e(r){var n=t.call(this,r)||this;return Object.setPrototypeOf(n,e.prototype),n}return Object.defineProperty(e.prototype,"name",{get:function(){return"BSONError"},enumerable:!1,configurable:!0}),e})(Error),at=(function(t){$l(e,t);function e(r){var n=t.call(this,r)||this;return Object.setPrototypeOf(n,e.prototype),n}return Object.defineProperty(e.prototype,"name",{get:function(){return"BSONTypeError"},enumerable:!1,configurable:!0}),e})(TypeError);O9=function(e){var r=T9()?"BSON: For React Native please polyfill crypto.getRandomValues, e.g. using: https://www.npmjs.com/package/react-native-get-random-values.":"BSON: No cryptographic implementation for random bytes present, falling back to a less secure implementation.";console.warn(r);for(var n=ke.alloc(e),o=0;o<e;++o)n[o]=Math.floor(Math.random()*256);return n},A9=function(){{if(typeof window<"u"){var t=window.crypto||window.msCrypto;if(t&&t.getRandomValues)return function(e){return t.getRandomValues(ke.alloc(e))}}return typeof global<"u"&&global.crypto&&global.crypto.getRandomValues?function(e){return global.crypto.getRandomValues(ke.alloc(e))}:O9}},zR=A9();x9=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|[0-9a-f]{12}4[0-9a-f]{3}[89ab][0-9a-f]{15})$/i,KR=function(t){return typeof t=="string"&&x9.test(t)},f0=function(t){if(!KR(t))throw new at('UUID string representations must be a 32 or 36 character hex string (dashes excluded/included). Format: "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" or "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx".');var e=t.replace(/-/g,"");return ke.from(e,"hex")},xR=function(t,e){return e===void 0&&(e=!0),e?t.toString("hex",0,4)+"-"+t.toString("hex",4,6)+"-"+t.toString("hex",6,8)+"-"+t.toString("hex",8,10)+"-"+t.toString("hex",10,16):t.toString("hex")},eX=Math.pow(2,63)-1,tX=-Math.pow(2,63),N9=Math.pow(2,53),L9=-Math.pow(2,53),YR=4,ho=(function(){function t(e,r){if(!(this instanceof t))return new t(e,r);if(e!=null&&typeof e!="string"&&!ArrayBuffer.isView(e)&&!(e instanceof ArrayBuffer)&&!Array.isArray(e))throw new at("Binary can only be constructed from string, Buffer, TypedArray, or Array<number>");this.sub_type=r??t.BSON_BINARY_SUBTYPE_DEFAULT,e==null?(this.buffer=ke.alloc(t.BUFFER_SIZE),this.position=0):(typeof e=="string"?this.buffer=ke.from(e,"binary"):Array.isArray(e)?this.buffer=ke.from(e):this.buffer=Ml(e),this.position=this.buffer.byteLength)}return t.prototype.put=function(e){if(typeof e=="string"&&e.length!==1)throw new at("only accepts single character String");if(typeof e!="number"&&e.length!==1)throw new at("only accepts single character Uint8Array or Array");var r;if(typeof e=="string"?r=e.charCodeAt(0):typeof e=="number"?r=e:r=e[0],r<0||r>255)throw new at("only accepts number in a valid unsigned byte range 0-255");if(this.buffer.length>this.position)this.buffer[this.position++]=r;else{var n=ke.alloc(t.BUFFER_SIZE+this.buffer.length);this.buffer.copy(n,0,0,this.buffer.length),this.buffer=n,this.buffer[this.position++]=r}},t.prototype.write=function(e,r){if(r=typeof r=="number"?r:this.position,this.buffer.length<r+e.length){var n=ke.alloc(this.buffer.length+e.length);this.buffer.copy(n,0,0,this.buffer.length),this.buffer=n}ArrayBuffer.isView(e)?(this.buffer.set(Ml(e),r),this.position=r+e.byteLength>this.position?r+e.length:this.position):typeof e=="string"&&(this.buffer.write(e,r,e.length,"binary"),this.position=r+e.length>this.position?r+e.length:this.position)},t.prototype.read=function(e,r){return r=r&&r>0?r:this.position,this.buffer.slice(e,e+r)},t.prototype.value=function(e){return e=!!e,e&&this.buffer.length===this.position?this.buffer:e?this.buffer.slice(0,this.position):this.buffer.toString("binary",0,this.position)},t.prototype.length=function(){return this.position},t.prototype.toJSON=function(){return this.buffer.toString("base64")},t.prototype.toString=function(e){return this.buffer.toString(e)},t.prototype.toExtendedJSON=function(e){e=e||{};var r=this.buffer.toString("base64"),n=Number(this.sub_type).toString(16);return e.legacy?{$binary:r,$type:n.length===1?"0"+n:n}:{$binary:{base64:r,subType:n.length===1?"0"+n:n}}},t.prototype.toUUID=function(){if(this.sub_type===t.SUBTYPE_UUID)return new NR(this.buffer.slice(0,this.position));throw new fo('Binary sub_type "'.concat(this.sub_type,'" is not supported for converting to UUID. Only "').concat(t.SUBTYPE_UUID,'" is currently supported.'))},t.fromExtendedJSON=function(e,r){r=r||{};var n,o;if("$binary"in e?r.legacy&&typeof e.$binary=="string"&&"$type"in e?(o=e.$type?parseInt(e.$type,16):0,n=ke.from(e.$binary,"base64")):typeof e.$binary!="string"&&(o=e.$binary.subType?parseInt(e.$binary.subType,16):0,n=ke.from(e.$binary.base64,"base64")):"$uuid"in e&&(o=4,n=f0(e.$uuid)),!n)throw new at("Unexpected Binary Extended JSON format ".concat(JSON.stringify(e)));return o===YR?new NR(n):new t(n,o)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){var e=this.value(!0);return'new Binary(Buffer.from("'.concat(e.toString("hex"),'", "hex"), ').concat(this.sub_type,")")},t.BSON_BINARY_SUBTYPE_DEFAULT=0,t.BUFFER_SIZE=256,t.SUBTYPE_DEFAULT=0,t.SUBTYPE_FUNCTION=1,t.SUBTYPE_BYTE_ARRAY=2,t.SUBTYPE_UUID_OLD=3,t.SUBTYPE_UUID=4,t.SUBTYPE_MD5=5,t.SUBTYPE_ENCRYPTED=6,t.SUBTYPE_COLUMN=7,t.SUBTYPE_USER_DEFINED=128,t})();Object.defineProperty(ho.prototype,"_bsontype",{value:"Binary"});a0=16,NR=(function(t){$l(e,t);function e(r){var n=this,o,i;if(r==null)o=e.generate();else if(r instanceof e)o=ke.from(r.buffer),i=r.__id;else if(ArrayBuffer.isView(r)&&r.byteLength===a0)o=Ml(r);else if(typeof r=="string")o=f0(r);else throw new at("Argument passed in UUID constructor must be a UUID, a 16 byte Buffer or a 32/36 character hex string (dashes excluded/included, format: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx).");return n=t.call(this,o,YR)||this,n.__id=i,n}return Object.defineProperty(e.prototype,"id",{get:function(){return this.buffer},set:function(r){this.buffer=r,e.cacheHexString&&(this.__id=xR(r))},enumerable:!1,configurable:!0}),e.prototype.toHexString=function(r){if(r===void 0&&(r=!0),e.cacheHexString&&this.__id)return this.__id;var n=xR(this.id,r);return e.cacheHexString&&(this.__id=n),n},e.prototype.toString=function(r){return r?this.id.toString(r):this.toHexString()},e.prototype.toJSON=function(){return this.toHexString()},e.prototype.equals=function(r){if(!r)return!1;if(r instanceof e)return r.id.equals(this.id);try{return new e(r).id.equals(this.id)}catch{return!1}},e.prototype.toBinary=function(){return new ho(this.id,ho.SUBTYPE_UUID)},e.generate=function(){var r=zR(a0);return r[6]=r[6]&15|64,r[8]=r[8]&63|128,ke.from(r)},e.isValid=function(r){return r?r instanceof e?!0:typeof r=="string"?KR(r):h0(r)?r.length!==a0?!1:(r[6]&240)===64&&(r[8]&128)===128:!1:!1},e.createFromHexString=function(r){var n=f0(r);return new e(n)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return'new UUID("'.concat(this.toHexString(),'")')},e})(ho),Hl=(function(){function t(e,r){if(!(this instanceof t))return new t(e,r);this.code=e,this.scope=r}return t.prototype.toJSON=function(){return{code:this.code,scope:this.scope}},t.prototype.toExtendedJSON=function(){return this.scope?{$code:this.code,$scope:this.scope}:{$code:this.code}},t.fromExtendedJSON=function(e){return new t(e.$code,e.$scope)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){var e=this.toJSON();return'new Code("'.concat(String(e.code),'"').concat(e.scope?", ".concat(JSON.stringify(e.scope)):"",")")},t})();Object.defineProperty(Hl.prototype,"_bsontype",{value:"Code"});Ys=(function(){function t(e,r,n,o){if(!(this instanceof t))return new t(e,r,n,o);var i=e.split(".");i.length===2&&(n=i.shift(),e=i.shift()),this.collection=e,this.oid=r,this.db=n,this.fields=o||{}}return Object.defineProperty(t.prototype,"namespace",{get:function(){return this.collection},set:function(e){this.collection=e},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){var e=Object.assign({$ref:this.collection,$id:this.oid},this.fields);return this.db!=null&&(e.$db=this.db),e},t.prototype.toExtendedJSON=function(e){e=e||{};var r={$ref:this.collection,$id:this.oid};return e.legacy||(this.db&&(r.$db=this.db),r=Object.assign(r,this.fields)),r},t.fromExtendedJSON=function(e){var r=Object.assign({},e);return delete r.$ref,delete r.$id,delete r.$db,new t(e.$ref,e.$id,e.$db,r)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){var e=this.oid===void 0||this.oid.toString===void 0?this.oid:this.oid.toString();return'new DBRef("'.concat(this.namespace,'", new ObjectId("').concat(String(e),'")').concat(this.db?', "'.concat(this.db,'"'):"",")")},t})();Object.defineProperty(Ys.prototype,"_bsontype",{value:"DBRef"});Mr=void 0;try{Mr=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}LR=65536,U9=1<<24,_a=LR*LR,JR=_a*_a,DR=JR/2,UR={},BR={},ve=(function(){function t(e,r,n){if(e===void 0&&(e=0),!(this instanceof t))return new t(e,r,n);typeof e=="bigint"?Object.assign(this,t.fromBigInt(e,!!r)):typeof e=="string"?Object.assign(this,t.fromString(e,!!r)):(this.low=e|0,this.high=r|0,this.unsigned=!!n),Object.defineProperty(this,"__isLong__",{value:!0,configurable:!1,writable:!1,enumerable:!1})}return t.fromBits=function(e,r,n){return new t(e,r,n)},t.fromInt=function(e,r){var n,o,i;return r?(e>>>=0,(i=0<=e&&e<256)&&(o=BR[e],o)?o:(n=t.fromBits(e,(e|0)<0?-1:0,!0),i&&(BR[e]=n),n)):(e|=0,(i=-128<=e&&e<128)&&(o=UR[e],o)?o:(n=t.fromBits(e,e<0?-1:0,!1),i&&(UR[e]=n),n))},t.fromNumber=function(e,r){if(isNaN(e))return r?t.UZERO:t.ZERO;if(r){if(e<0)return t.UZERO;if(e>=JR)return t.MAX_UNSIGNED_VALUE}else{if(e<=-DR)return t.MIN_VALUE;if(e+1>=DR)return t.MAX_VALUE}return e<0?t.fromNumber(-e,r).neg():t.fromBits(e%_a|0,e/_a|0,r)},t.fromBigInt=function(e,r){return t.fromString(e.toString(),r)},t.fromString=function(e,r,n){if(e.length===0)throw Error("empty string");if(e==="NaN"||e==="Infinity"||e==="+Infinity"||e==="-Infinity")return t.ZERO;if(typeof r=="number"?(n=r,r=!1):r=!!r,n=n||10,n<2||36<n)throw RangeError("radix");var o;if((o=e.indexOf("-"))>0)throw Error("interior hyphen");if(o===0)return t.fromString(e.substring(1),r,n).neg();for(var i=t.fromNumber(Math.pow(n,8)),s=t.ZERO,u=0;u<e.length;u+=8){var l=Math.min(8,e.length-u),a=parseInt(e.substring(u,u+l),n);if(l<8){var c=t.fromNumber(Math.pow(n,l));s=s.mul(c).add(t.fromNumber(a))}else s=s.mul(i),s=s.add(t.fromNumber(a))}return s.unsigned=r,s},t.fromBytes=function(e,r,n){return n?t.fromBytesLE(e,r):t.fromBytesBE(e,r)},t.fromBytesLE=function(e,r){return new t(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,r)},t.fromBytesBE=function(e,r){return new t(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],r)},t.isLong=function(e){return Qs(e)&&e.__isLong__===!0},t.fromValue=function(e,r){return typeof e=="number"?t.fromNumber(e,r):typeof e=="string"?t.fromString(e,r):t.fromBits(e.low,e.high,typeof r=="boolean"?r:e.unsigned)},t.prototype.add=function(e){t.isLong(e)||(e=t.fromValue(e));var r=this.high>>>16,n=this.high&65535,o=this.low>>>16,i=this.low&65535,s=e.high>>>16,u=e.high&65535,l=e.low>>>16,a=e.low&65535,c=0,h=0,w=0,E=0;return E+=i+a,w+=E>>>16,E&=65535,w+=o+l,h+=w>>>16,w&=65535,h+=n+u,c+=h>>>16,h&=65535,c+=r+s,c&=65535,t.fromBits(w<<16|E,c<<16|h,this.unsigned)},t.prototype.and=function(e){return t.isLong(e)||(e=t.fromValue(e)),t.fromBits(this.low&e.low,this.high&e.high,this.unsigned)},t.prototype.compare=function(e){if(t.isLong(e)||(e=t.fromValue(e)),this.eq(e))return 0;var r=this.isNegative(),n=e.isNegative();return r&&!n?-1:!r&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},t.prototype.comp=function(e){return this.compare(e)},t.prototype.divide=function(e){if(t.isLong(e)||(e=t.fromValue(e)),e.isZero())throw Error("division by zero");if(Mr){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var r=(this.unsigned?Mr.div_u:Mr.div_s)(this.low,this.high,e.low,e.high);return t.fromBits(r,Mr.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?t.UZERO:t.ZERO;var n,o,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return t.UZERO;if(e.gt(this.shru(1)))return t.UONE;i=t.UZERO}else{if(this.eq(t.MIN_VALUE)){if(e.eq(t.ONE)||e.eq(t.NEG_ONE))return t.MIN_VALUE;if(e.eq(t.MIN_VALUE))return t.ONE;var s=this.shr(1);return n=s.div(e).shl(1),n.eq(t.ZERO)?e.isNegative()?t.ONE:t.NEG_ONE:(o=this.sub(e.mul(n)),i=n.add(o.div(e)),i)}else if(e.eq(t.MIN_VALUE))return this.unsigned?t.UZERO:t.ZERO;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=t.ZERO}for(o=this;o.gte(e);){n=Math.max(1,Math.floor(o.toNumber()/e.toNumber()));for(var u=Math.ceil(Math.log(n)/Math.LN2),l=u<=48?1:Math.pow(2,u-48),a=t.fromNumber(n),c=a.mul(e);c.isNegative()||c.gt(o);)n-=l,a=t.fromNumber(n,this.unsigned),c=a.mul(e);a.isZero()&&(a=t.ONE),i=i.add(a),o=o.sub(c)}return i},t.prototype.div=function(e){return this.divide(e)},t.prototype.equals=function(e){return t.isLong(e)||(e=t.fromValue(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low},t.prototype.eq=function(e){return this.equals(e)},t.prototype.getHighBits=function(){return this.high},t.prototype.getHighBitsUnsigned=function(){return this.high>>>0},t.prototype.getLowBits=function(){return this.low},t.prototype.getLowBitsUnsigned=function(){return this.low>>>0},t.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.eq(t.MIN_VALUE)?64:this.neg().getNumBitsAbs();var e=this.high!==0?this.high:this.low,r;for(r=31;r>0&&(e&1<<r)===0;r--);return this.high!==0?r+33:r+1},t.prototype.greaterThan=function(e){return this.comp(e)>0},t.prototype.gt=function(e){return this.greaterThan(e)},t.prototype.greaterThanOrEqual=function(e){return this.comp(e)>=0},t.prototype.gte=function(e){return this.greaterThanOrEqual(e)},t.prototype.ge=function(e){return this.greaterThanOrEqual(e)},t.prototype.isEven=function(){return(this.low&1)===0},t.prototype.isNegative=function(){return!this.unsigned&&this.high<0},t.prototype.isOdd=function(){return(this.low&1)===1},t.prototype.isPositive=function(){return this.unsigned||this.high>=0},t.prototype.isZero=function(){return this.high===0&&this.low===0},t.prototype.lessThan=function(e){return this.comp(e)<0},t.prototype.lt=function(e){return this.lessThan(e)},t.prototype.lessThanOrEqual=function(e){return this.comp(e)<=0},t.prototype.lte=function(e){return this.lessThanOrEqual(e)},t.prototype.modulo=function(e){if(t.isLong(e)||(e=t.fromValue(e)),Mr){var r=(this.unsigned?Mr.rem_u:Mr.rem_s)(this.low,this.high,e.low,e.high);return t.fromBits(r,Mr.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))},t.prototype.mod=function(e){return this.modulo(e)},t.prototype.rem=function(e){return this.modulo(e)},t.prototype.multiply=function(e){if(this.isZero())return t.ZERO;if(t.isLong(e)||(e=t.fromValue(e)),Mr){var r=Mr.mul(this.low,this.high,e.low,e.high);return t.fromBits(r,Mr.get_high(),this.unsigned)}if(e.isZero())return t.ZERO;if(this.eq(t.MIN_VALUE))return e.isOdd()?t.MIN_VALUE:t.ZERO;if(e.eq(t.MIN_VALUE))return this.isOdd()?t.MIN_VALUE:t.ZERO;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(t.TWO_PWR_24)&&e.lt(t.TWO_PWR_24))return t.fromNumber(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,o=this.high&65535,i=this.low>>>16,s=this.low&65535,u=e.high>>>16,l=e.high&65535,a=e.low>>>16,c=e.low&65535,h=0,w=0,E=0,T=0;return T+=s*c,E+=T>>>16,T&=65535,E+=i*c,w+=E>>>16,E&=65535,E+=s*a,w+=E>>>16,E&=65535,w+=o*c,h+=w>>>16,w&=65535,w+=i*a,h+=w>>>16,w&=65535,w+=s*l,h+=w>>>16,w&=65535,h+=n*c+o*a+i*l+s*u,h&=65535,t.fromBits(E<<16|T,h<<16|w,this.unsigned)},t.prototype.mul=function(e){return this.multiply(e)},t.prototype.negate=function(){return!this.unsigned&&this.eq(t.MIN_VALUE)?t.MIN_VALUE:this.not().add(t.ONE)},t.prototype.neg=function(){return this.negate()},t.prototype.not=function(){return t.fromBits(~this.low,~this.high,this.unsigned)},t.prototype.notEquals=function(e){return!this.equals(e)},t.prototype.neq=function(e){return this.notEquals(e)},t.prototype.ne=function(e){return this.notEquals(e)},t.prototype.or=function(e){return t.isLong(e)||(e=t.fromValue(e)),t.fromBits(this.low|e.low,this.high|e.high,this.unsigned)},t.prototype.shiftLeft=function(e){return t.isLong(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?t.fromBits(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):t.fromBits(0,this.low<<e-32,this.unsigned)},t.prototype.shl=function(e){return this.shiftLeft(e)},t.prototype.shiftRight=function(e){return t.isLong(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?t.fromBits(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):t.fromBits(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},t.prototype.shr=function(e){return this.shiftRight(e)},t.prototype.shiftRightUnsigned=function(e){if(t.isLong(e)&&(e=e.toInt()),e&=63,e===0)return this;var r=this.high;if(e<32){var n=this.low;return t.fromBits(n>>>e|r<<32-e,r>>>e,this.unsigned)}else return e===32?t.fromBits(r,0,this.unsigned):t.fromBits(r>>>e-32,0,this.unsigned)},t.prototype.shr_u=function(e){return this.shiftRightUnsigned(e)},t.prototype.shru=function(e){return this.shiftRightUnsigned(e)},t.prototype.subtract=function(e){return t.isLong(e)||(e=t.fromValue(e)),this.add(e.neg())},t.prototype.sub=function(e){return this.subtract(e)},t.prototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},t.prototype.toNumber=function(){return this.unsigned?(this.high>>>0)*_a+(this.low>>>0):this.high*_a+(this.low>>>0)},t.prototype.toBigInt=function(){return BigInt(this.toString())},t.prototype.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},t.prototype.toBytesLE=function(){var e=this.high,r=this.low;return[r&255,r>>>8&255,r>>>16&255,r>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]},t.prototype.toBytesBE=function(){var e=this.high,r=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,r>>>24,r>>>16&255,r>>>8&255,r&255]},t.prototype.toSigned=function(){return this.unsigned?t.fromBits(this.low,this.high,!1):this},t.prototype.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(t.MIN_VALUE)){var r=t.fromNumber(e),n=this.div(r),o=n.mul(r).sub(this);return n.toString(e)+o.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var i=t.fromNumber(Math.pow(e,6),this.unsigned),s=this,u="";;){var l=s.div(i),a=s.sub(l.mul(i)).toInt()>>>0,c=a.toString(e);if(s=l,s.isZero())return c+u;for(;c.length<6;)c="0"+c;u=""+c+u}},t.prototype.toUnsigned=function(){return this.unsigned?this:t.fromBits(this.low,this.high,!0)},t.prototype.xor=function(e){return t.isLong(e)||(e=t.fromValue(e)),t.fromBits(this.low^e.low,this.high^e.high,this.unsigned)},t.prototype.eqz=function(){return this.isZero()},t.prototype.le=function(e){return this.lessThanOrEqual(e)},t.prototype.toExtendedJSON=function(e){return e&&e.relaxed?this.toNumber():{$numberLong:this.toString()}},t.fromExtendedJSON=function(e,r){var n=t.fromString(e.$numberLong);return r&&r.relaxed?n.toNumber():n},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return'new Long("'.concat(this.toString(),'"').concat(this.unsigned?", true":"",")")},t.TWO_PWR_24=t.fromInt(U9),t.MAX_UNSIGNED_VALUE=t.fromBits(-1,-1,!0),t.ZERO=t.fromInt(0),t.UZERO=t.fromInt(0,!0),t.ONE=t.fromInt(1),t.UONE=t.fromInt(1,!0),t.NEG_ONE=t.fromInt(-1),t.MAX_VALUE=t.fromBits(-1,2147483647,!1),t.MIN_VALUE=t.fromBits(0,-2147483648,!1),t})();Object.defineProperty(ve.prototype,"__isLong__",{value:!0});Object.defineProperty(ve.prototype,"_bsontype",{value:"Long"});B9=/^(\+|-)?(\d+|(\d*\.\d*))?(E|e)?([-+])?(\d+)?$/,q9=/^(\+|-)?(Infinity|inf)$/i,F9=/^(\+|-)?NaN$/i,Ks=6111,s0=-6176,qR=6176,j9=34,u0=[124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),FR=[248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),jR=[120,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),M9=/^([-+])?(\d+)?$/,k9=31,MR=16383,$9=30,W9=31;d0=(function(){function t(e){if(!(this instanceof t))return new t(e);if(typeof e=="string")this.bytes=t.fromString(e).bytes;else if(h0(e)){if(e.byteLength!==16)throw new at("Decimal128 must take a Buffer of 16 bytes");this.bytes=e}else throw new at("Decimal128 must take a Buffer or string")}return t.fromString=function(e){var r=!1,n=!1,o=!1,i=0,s=0,u=0,l=0,a=0,c=[0],h=0,w=0,E=0,T=0,A=0,O=0,C=new ve(0,0),P=new ve(0,0),q=0,U=0;if(e.length>=7e3)throw new at(""+e+" not a valid Decimal128 string");var k=e.match(B9),W=e.match(q9),V=e.match(F9);if(!k&&!W&&!V||e.length===0)throw new at(""+e+" not a valid Decimal128 string");if(k){var Y=k[2],Z=k[4],ae=k[5],ie=k[6];Z&&ie===void 0&&ya(e,"missing exponent power"),Z&&Y===void 0&&ya(e,"missing exponent base"),Z===void 0&&(ae||ie)&&ya(e,"missing e before exponent")}if((e[U]==="+"||e[U]==="-")&&(r=e[U++]==="-"),!kR(e[U])&&e[U]!=="."){if(e[U]==="i"||e[U]==="I")return new t(ke.from(r?FR:jR));if(e[U]==="N")return new t(ke.from(u0))}for(;kR(e[U])||e[U]===".";){if(e[U]==="."){n&&ya(e,"contains multiple periods"),n=!0,U=U+1;continue}h<34&&(e[U]!=="0"||o)&&(o||(a=s),o=!0,c[w++]=parseInt(e[U],10),h=h+1),o&&(u=u+1),n&&(l=l+1),s=s+1,U=U+1}if(n&&!s)throw new at(""+e+" not a valid Decimal128 string");if(e[U]==="e"||e[U]==="E"){var ue=e.substr(++U).match(M9);if(!ue||!ue[2])return new t(ke.from(u0));A=parseInt(ue[0],10),U=U+ue[0].length}if(e[U])return new t(ke.from(u0));if(E=0,!h)E=0,T=0,c[0]=0,u=1,h=1,i=0;else if(T=h-1,i=u,i!==1)for(;c[a+i-1]===0;)i=i-1;for(A<=l&&l-A>16384?A=s0:A=A-l;A>Ks;){if(T=T+1,T-E>j9){var be=c.join("");if(be.match(/^0+$/)){A=Ks;break}ya(e,"overflow")}A=A-1}for(;A<s0||h<u;){if(T===0&&i<h){A=s0,i=0;break}if(h<u?u=u-1:T=T-1,A<Ks)A=A+1;else{var be=c.join("");if(be.match(/^0+$/)){A=Ks;break}ya(e,"overflow")}}if(T-E+1<i){var me=s;n&&(a=a+1,me=me+1),r&&(a=a+1,me=me+1);var Ot=parseInt(e[a+T+1],10),Pt=0;if(Ot>=5&&(Pt=1,Ot===5)){for(Pt=c[T]%2===1?1:0,O=a+T+2;O<me;O++)if(parseInt(e[O],10)){Pt=1;break}}if(Pt){for(var F=T;F>=0;F--)if(++c[F]>9&&(c[F]=0,F===0))if(A<Ks)A=A+1,c[F]=1;else return new t(ke.from(r?FR:jR))}}if(C=ve.fromNumber(0),P=ve.fromNumber(0),i===0)C=ve.fromNumber(0),P=ve.fromNumber(0);else if(T-E<17){var F=E;for(P=ve.fromNumber(c[F++]),C=new ve(0,0);F<=T;F++)P=P.multiply(ve.fromNumber(10)),P=P.add(ve.fromNumber(c[F]))}else{var F=E;for(C=ve.fromNumber(c[F++]);F<=T-17;F++)C=C.multiply(ve.fromNumber(10)),C=C.add(ve.fromNumber(c[F]));for(P=ve.fromNumber(c[F++]);F<=T;F++)P=P.multiply(ve.fromNumber(10)),P=P.add(ve.fromNumber(c[F]))}var d=G9(C,ve.fromString("100000000000000000"));d.low=d.low.add(P),V9(d.low,P)&&(d.high=d.high.add(ve.fromNumber(1))),q=A+qR;var p={low:ve.fromNumber(0),high:ve.fromNumber(0)};d.high.shiftRightUnsigned(49).and(ve.fromNumber(1)).equals(ve.fromNumber(1))?(p.high=p.high.or(ve.fromNumber(3).shiftLeft(61)),p.high=p.high.or(ve.fromNumber(q).and(ve.fromNumber(16383).shiftLeft(47))),p.high=p.high.or(d.high.and(ve.fromNumber(0x7fffffffffff)))):(p.high=p.high.or(ve.fromNumber(q&16383).shiftLeft(49)),p.high=p.high.or(d.high.and(ve.fromNumber(562949953421311)))),p.low=d.low,r&&(p.high=p.high.or(ve.fromString("9223372036854775808")));var y=ke.alloc(16);return U=0,y[U++]=p.low.low&255,y[U++]=p.low.low>>8&255,y[U++]=p.low.low>>16&255,y[U++]=p.low.low>>24&255,y[U++]=p.low.high&255,y[U++]=p.low.high>>8&255,y[U++]=p.low.high>>16&255,y[U++]=p.low.high>>24&255,y[U++]=p.high.low&255,y[U++]=p.high.low>>8&255,y[U++]=p.high.low>>16&255,y[U++]=p.high.low>>24&255,y[U++]=p.high.high&255,y[U++]=p.high.high>>8&255,y[U++]=p.high.high>>16&255,y[U++]=p.high.high>>24&255,new t(y)},t.prototype.toString=function(){for(var e,r=0,n=new Array(36),o=0;o<n.length;o++)n[o]=0;var i=0,s=!1,u,l={parts:[0,0,0,0]},a,c,h=[];i=0;var w=this.bytes,E=w[i++]|w[i++]<<8|w[i++]<<16|w[i++]<<24,T=w[i++]|w[i++]<<8|w[i++]<<16|w[i++]<<24,A=w[i++]|w[i++]<<8|w[i++]<<16|w[i++]<<24,O=w[i++]|w[i++]<<8|w[i++]<<16|w[i++]<<24;i=0;var C={low:new ve(E,T),high:new ve(A,O)};C.high.lessThan(ve.ZERO)&&h.push("-");var P=O>>26&k9;if(P>>3===3){if(P===$9)return h.join("")+"Infinity";if(P===W9)return"NaN";e=O>>15&MR,u=8+(O>>14&1)}else u=O>>14&7,e=O>>17&MR;var q=e-qR;if(l.parts[0]=(O&16383)+((u&15)<<14),l.parts[1]=A,l.parts[2]=T,l.parts[3]=E,l.parts[0]===0&&l.parts[1]===0&&l.parts[2]===0&&l.parts[3]===0)s=!0;else for(c=3;c>=0;c--){var U=0,k=H9(l);if(l=k.quotient,U=k.rem.low,!!U)for(a=8;a>=0;a--)n[c*9+a]=U%10,U=Math.floor(U/10)}if(s)r=1,n[i]=0;else for(r=36;!n[i];)r=r-1,i=i+1;var W=r-1+q;if(W>=34||W<=-7||q>0){if(r>34)return h.push("".concat(0)),q>0?h.push("E+".concat(q)):q<0&&h.push("E".concat(q)),h.join("");h.push("".concat(n[i++])),r=r-1,r&&h.push(".");for(var o=0;o<r;o++)h.push("".concat(n[i++]));h.push("E"),W>0?h.push("+".concat(W)):h.push("".concat(W))}else if(q>=0)for(var o=0;o<r;o++)h.push("".concat(n[i++]));else{var V=r+q;if(V>0)for(var o=0;o<V;o++)h.push("".concat(n[i++]));else h.push("0");for(h.push(".");V++<0;)h.push("0");for(var o=0;o<r-Math.max(V-1,0);o++)h.push("".concat(n[i++]))}return h.join("")},t.prototype.toJSON=function(){return{$numberDecimal:this.toString()}},t.prototype.toExtendedJSON=function(){return{$numberDecimal:this.toString()}},t.fromExtendedJSON=function(e){return t.fromString(e.$numberDecimal)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return'new Decimal128("'.concat(this.toString(),'")')},t})();Object.defineProperty(d0.prototype,"_bsontype",{value:"Decimal128"});Gl=(function(){function t(e){if(!(this instanceof t))return new t(e);e instanceof Number&&(e=e.valueOf()),this.value=+e}return t.prototype.valueOf=function(){return this.value},t.prototype.toJSON=function(){return this.value},t.prototype.toString=function(e){return this.value.toString(e)},t.prototype.toExtendedJSON=function(e){return e&&(e.legacy||e.relaxed&&isFinite(this.value))?this.value:Object.is(Math.sign(this.value),-0)?{$numberDouble:"-".concat(this.value.toFixed(1))}:{$numberDouble:Number.isInteger(this.value)?this.value.toFixed(1):this.value.toString()}},t.fromExtendedJSON=function(e,r){var n=parseFloat(e.$numberDouble);return r&&r.relaxed?n:new t(n)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){var e=this.toExtendedJSON();return"new Double(".concat(e.$numberDouble,")")},t})();Object.defineProperty(Gl.prototype,"_bsontype",{value:"Double"});Vl=(function(){function t(e){if(!(this instanceof t))return new t(e);e instanceof Number&&(e=e.valueOf()),this.value=+e|0}return t.prototype.valueOf=function(){return this.value},t.prototype.toString=function(e){return this.value.toString(e)},t.prototype.toJSON=function(){return this.value},t.prototype.toExtendedJSON=function(e){return e&&(e.relaxed||e.legacy)?this.value:{$numberInt:this.value.toString()}},t.fromExtendedJSON=function(e,r){return r&&r.relaxed?parseInt(e.$numberInt,10):new t(e.$numberInt)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return"new Int32(".concat(this.valueOf(),")")},t})();Object.defineProperty(Vl.prototype,"_bsontype",{value:"Int32"});p0=(function(){function t(){if(!(this instanceof t))return new t}return t.prototype.toExtendedJSON=function(){return{$maxKey:1}},t.fromExtendedJSON=function(){return new t},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return"new MaxKey()"},t})();Object.defineProperty(p0.prototype,"_bsontype",{value:"MaxKey"});v0=(function(){function t(){if(!(this instanceof t))return new t}return t.prototype.toExtendedJSON=function(){return{$minKey:1}},t.fromExtendedJSON=function(){return new t},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return"new MinKey()"},t})();Object.defineProperty(v0.prototype,"_bsontype",{value:"MinKey"});z9=new RegExp("^[0-9a-fA-F]{24}$"),lo=null,Pn=Symbol("id"),$r=(function(){function t(e){if(!(this instanceof t))return new t(e);var r;if(typeof e=="object"&&e&&"id"in e){if(typeof e.id!="string"&&!ArrayBuffer.isView(e.id))throw new at("Argument passed in must have an id that is of type string or Buffer");"toHexString"in e&&typeof e.toHexString=="function"?r=ke.from(e.toHexString(),"hex"):r=e.id}else r=e;if(r==null||typeof r=="number")this[Pn]=t.generate(typeof r=="number"?r:void 0);else if(ArrayBuffer.isView(r)&&r.byteLength===12)this[Pn]=r instanceof ke?r:Ml(r);else if(typeof r=="string")if(r.length===12){var n=ke.from(r);if(n.byteLength===12)this[Pn]=n;else throw new at("Argument passed in must be a string of 12 bytes")}else if(r.length===24&&z9.test(r))this[Pn]=ke.from(r,"hex");else throw new at("Argument passed in must be a string of 12 bytes or a string of 24 hex characters or an integer");else throw new at("Argument passed in does not match the accepted types");t.cacheHexString&&(this.__id=this.id.toString("hex"))}return Object.defineProperty(t.prototype,"id",{get:function(){return this[Pn]},set:function(e){this[Pn]=e,t.cacheHexString&&(this.__id=e.toString("hex"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"generationTime",{get:function(){return this.id.readInt32BE(0)},set:function(e){this.id.writeUInt32BE(e,0)},enumerable:!1,configurable:!0}),t.prototype.toHexString=function(){if(t.cacheHexString&&this.__id)return this.__id;var e=this.id.toString("hex");return t.cacheHexString&&!this.__id&&(this.__id=e),e},t.getInc=function(){return t.index=(t.index+1)%16777215},t.generate=function(e){typeof e!="number"&&(e=Math.floor(Date.now()/1e3));var r=t.getInc(),n=ke.alloc(12);return n.writeUInt32BE(e,0),lo===null&&(lo=zR(5)),n[4]=lo[0],n[5]=lo[1],n[6]=lo[2],n[7]=lo[3],n[8]=lo[4],n[11]=r&255,n[10]=r>>8&255,n[9]=r>>16&255,n},t.prototype.toString=function(e){return e?this.id.toString(e):this.toHexString()},t.prototype.toJSON=function(){return this.toHexString()},t.prototype.equals=function(e){if(e==null)return!1;if(e instanceof t)return this[Pn][11]===e[Pn][11]&&this[Pn].equals(e[Pn]);if(typeof e=="string"&&t.isValid(e)&&e.length===12&&h0(this.id))return e===ke.prototype.toString.call(this.id,"latin1");if(typeof e=="string"&&t.isValid(e)&&e.length===24)return e.toLowerCase()===this.toHexString();if(typeof e=="string"&&t.isValid(e)&&e.length===12)return ke.from(e).equals(this.id);if(typeof e=="object"&&"toHexString"in e&&typeof e.toHexString=="function"){var r=e.toHexString(),n=this.toHexString().toLowerCase();return typeof r=="string"&&r.toLowerCase()===n}return!1},t.prototype.getTimestamp=function(){var e=new Date,r=this.id.readUInt32BE(0);return e.setTime(Math.floor(r)*1e3),e},t.createPk=function(){return new t},t.createFromTime=function(e){var r=ke.from([0,0,0,0,0,0,0,0,0,0,0,0]);return r.writeUInt32BE(e,0),new t(r)},t.createFromHexString=function(e){if(typeof e>"u"||e!=null&&e.length!==24)throw new at("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");return new t(ke.from(e,"hex"))},t.isValid=function(e){if(e==null)return!1;try{return new t(e),!0}catch{return!1}},t.prototype.toExtendedJSON=function(){return this.toHexString?{$oid:this.toHexString()}:{$oid:this.toString("hex")}},t.fromExtendedJSON=function(e){return new t(e.$oid)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return'new ObjectId("'.concat(this.toHexString(),'")')},t.index=Math.floor(Math.random()*16777215),t})();Object.defineProperty($r.prototype,"generate",{value:Wl(function(t){return $r.generate(t)},"Please use the static `ObjectId.generate(time)` instead")});Object.defineProperty($r.prototype,"getInc",{value:Wl(function(){return $r.getInc()},"Please use the static `ObjectId.getInc()` instead")});Object.defineProperty($r.prototype,"get_inc",{value:Wl(function(){return $r.getInc()},"Please use the static `ObjectId.getInc()` instead")});Object.defineProperty($r,"get_inc",{value:Wl(function(){return $r.getInc()},"Please use the static `ObjectId.getInc()` instead")});Object.defineProperty($r.prototype,"_bsontype",{value:"ObjectID"});Js=(function(){function t(e,r){if(!(this instanceof t))return new t(e,r);if(this.pattern=e,this.options=K9(r??""),this.pattern.indexOf("\0")!==-1)throw new fo("BSON Regex patterns cannot contain null bytes, found: ".concat(JSON.stringify(this.pattern)));if(this.options.indexOf("\0")!==-1)throw new fo("BSON Regex options cannot contain null bytes, found: ".concat(JSON.stringify(this.options)));for(var n=0;n<this.options.length;n++)if(!(this.options[n]==="i"||this.options[n]==="m"||this.options[n]==="x"||this.options[n]==="l"||this.options[n]==="s"||this.options[n]==="u"))throw new fo("The regular expression option [".concat(this.options[n],"] is not supported"))}return t.parseOptions=function(e){return e?e.split("").sort().join(""):""},t.prototype.toExtendedJSON=function(e){return e=e||{},e.legacy?{$regex:this.pattern,$options:this.options}:{$regularExpression:{pattern:this.pattern,options:this.options}}},t.fromExtendedJSON=function(e){if("$regex"in e)if(typeof e.$regex!="string"){if(e.$regex._bsontype==="BSONRegExp")return e}else return new t(e.$regex,t.parseOptions(e.$options));if("$regularExpression"in e)return new t(e.$regularExpression.pattern,t.parseOptions(e.$regularExpression.options));throw new at("Unexpected BSONRegExp EJSON object form: ".concat(JSON.stringify(e)))},t})();Object.defineProperty(Js.prototype,"_bsontype",{value:"BSONRegExp"});m0=(function(){function t(e){if(!(this instanceof t))return new t(e);this.value=e}return t.prototype.valueOf=function(){return this.value},t.prototype.toString=function(){return this.value},t.prototype.inspect=function(){return'new BSONSymbol("'.concat(this.value,'")')},t.prototype.toJSON=function(){return this.value},t.prototype.toExtendedJSON=function(){return{$symbol:this.value}},t.fromExtendedJSON=function(e){return new t(e.$symbol)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t})();Object.defineProperty(m0.prototype,"_bsontype",{value:"Symbol"});Y9=ve,QR=(function(t){$l(e,t);function e(r,n){var o=this;return o instanceof e?(ve.isLong(r)?o=t.call(this,r.low,r.high,!0)||this:Qs(r)&&typeof r.t<"u"&&typeof r.i<"u"?o=t.call(this,r.i,r.t,!0)||this:o=t.call(this,r,n,!0)||this,Object.defineProperty(o,"_bsontype",{value:"Timestamp",writable:!1,configurable:!1,enumerable:!1}),o):new e(r,n)}return e.prototype.toJSON=function(){return{$timestamp:this.toString()}},e.fromInt=function(r){return new e(ve.fromInt(r,!0))},e.fromNumber=function(r){return new e(ve.fromNumber(r,!0))},e.fromBits=function(r,n){return new e(r,n)},e.fromString=function(r,n){return new e(ve.fromString(r,!0,n))},e.prototype.toExtendedJSON=function(){return{$timestamp:{t:this.high>>>0,i:this.low>>>0}}},e.fromExtendedJSON=function(r){return new e(r.$timestamp)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return"new Timestamp({ t: ".concat(this.getHighBits(),", i: ").concat(this.getLowBits()," })")},e.MAX_VALUE=ve.MAX_UNSIGNED_VALUE,e})(Y9);XR=2147483647,ZR=-2147483648,e2=9223372036854776e3,t2=-9223372036854776e3,Q9={$oid:$r,$binary:ho,$uuid:ho,$symbol:m0,$numberInt:Vl,$numberDecimal:d0,$numberDouble:Gl,$numberLong:ve,$minKey:v0,$maxKey:p0,$regex:Js,$regularExpression:Js,$timestamp:QR};Z9={Binary:function(t){return new ho(t.value(),t.sub_type)},Code:function(t){return new Hl(t.code,t.scope)},DBRef:function(t){return new Ys(t.collection||t.namespace,t.oid,t.db,t.fields)},Decimal128:function(t){return new d0(t.bytes)},Double:function(t){return new Gl(t.value)},Int32:function(t){return new Vl(t.value)},Long:function(t){return ve.fromBits(t.low!=null?t.low:t.low_,t.low!=null?t.high:t.high_,t.low!=null?t.unsigned:t.unsigned_)},MaxKey:function(){return new p0},MinKey:function(){return new v0},ObjectID:function(t){return new $r(t)},ObjectId:function(t){return new $r(t)},BSONRegExp:function(t){return new Js(t.pattern,t.options)},Symbol:function(t){return new m0(t.value)},Timestamp:function(t){return QR.fromBits(t.low,t.high)}};(function(t){function e(i,s){var u=Object.assign({},{relaxed:!0,legacy:!1},s);return typeof u.relaxed=="boolean"&&(u.strict=!u.relaxed),typeof u.strict=="boolean"&&(u.relaxed=!u.strict),JSON.parse(i,function(l,a){if(l.indexOf("\0")!==-1)throw new fo("BSON Document field names cannot contain null bytes, found: ".concat(JSON.stringify(l)));return r2(a,u)})}t.parse=e;function r(i,s,u,l){u!=null&&typeof u=="object"&&(l=u,u=0),s!=null&&typeof s=="object"&&!Array.isArray(s)&&(l=s,s=void 0,u=0);var a=Object.assign({relaxed:!0,legacy:!1},l,{seenObjects:[{propertyName:"(root)",obj:null}]}),c=Ei(i,a);return JSON.stringify(c,s,u)}t.stringify=r;function n(i,s){return s=s||{},JSON.parse(r(i,s))}t.serialize=n;function o(i,s){return s=s||{},e(JSON.stringify(i),s)}t.deserialize=o})(Xt||(Xt={}));HR=VR();HR.Map?WR=HR.Map:WR=(function(){function t(e){e===void 0&&(e=[]),this._keys=[],this._values={};for(var r=0;r<e.length;r++)if(e[r]!=null){var n=e[r],o=n[0],i=n[1];this._keys.push(o),this._values[o]={v:i,i:this._keys.length-1}}}return t.prototype.clear=function(){this._keys=[],this._values={}},t.prototype.delete=function(e){var r=this._values[e];return r==null?!1:(delete this._values[e],this._keys.splice(r.i,1),!0)},t.prototype.entries=function(){var e=this,r=0;return{next:function(){var n=e._keys[r++];return{value:n!==void 0?[n,e._values[n].v]:void 0,done:n===void 0}}}},t.prototype.forEach=function(e,r){r=r||this;for(var n=0;n<this._keys.length;n++){var o=this._keys[n];e.call(r,this._values[o].v,o,r)}},t.prototype.get=function(e){return this._values[e]?this._values[e].v:void 0},t.prototype.has=function(e){return this._values[e]!=null},t.prototype.keys=function(){var e=this,r=0;return{next:function(){var n=e._keys[r++];return{value:n!==void 0?n:void 0,done:n===void 0}}}},t.prototype.set=function(e,r){return this._values[e]?(this._values[e].v=r,this):(this._keys.push(e),this._values[e]={v:r,i:this._keys.length-1},this)},t.prototype.values=function(){var e=this,r=0;return{next:function(){var n=e._keys[r++];return{value:n!==void 0?e._values[n].v:void 0,done:n===void 0}}}},Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!1,configurable:!0}),t})();rX=ve.fromNumber(N9),nX=ve.fromNumber(L9),c0=new Uint8Array(8),iX=new DataView(c0.buffer,c0.byteOffset,c0.byteLength),t7=1024*1024*17,oX=ke.alloc(t7)});var r7,n7,i7,zl,y0=X(()=>{so();g0();n0();Vs();r7=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},n7=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},i7=(function(){function t(e,r){this._stages=[],e&&r&&(this._db=e,this._request=dt.createRequest(this._db.config),this._collectionName=r)}return t.prototype.end=function(){return r7(this,void 0,void 0,function(){var e;return n7(this,function(r){switch(r.label){case 0:if(!this._collectionName||!this._db)throw new Error("Aggregation pipeline cannot send request");return[4,this._request.send("database.aggregate",{collectionName:this._collectionName,stages:this._stages})];case 1:return e=r.sent(),e&&e.data&&e.data.list?[2,{requestId:e.requestId,data:JSON.parse(e.data.list).map(Xt.parse)}]:[2,e]}})})},t.prototype.unwrap=function(){return this._stages},t.prototype.done=function(){return this._stages.map(function(e){var r,n=e.stageKey,o=e.stageValue;return r={},r[n]=JSON.parse(o),r})},t.prototype._pipe=function(e,r){return this._stages.push({stageKey:"$".concat(e),stageValue:JSON.stringify(r)}),this},t.prototype.addFields=function(e){return this._pipe("addFields",e)},t.prototype.bucket=function(e){return this._pipe("bucket",e)},t.prototype.bucketAuto=function(e){return this._pipe("bucketAuto",e)},t.prototype.count=function(e){return this._pipe("count",e)},t.prototype.geoNear=function(e){return e.query&&(e.query=ma.encode(e.query)),e.distanceMultiplier&&typeof e.distanceMultiplier=="number"&&(e.distanceMultiplier=e.distanceMultiplier),e.near&&(e.near=new gt(e.near.longitude,e.near.latitude).toJSON()),this._pipe("geoNear",e)},t.prototype.group=function(e){return this._pipe("group",e)},t.prototype.limit=function(e){return this._pipe("limit",e)},t.prototype.match=function(e){return this._pipe("match",ma.encode(e))},t.prototype.project=function(e){return this._pipe("project",e)},t.prototype.lookup=function(e){return this._pipe("lookup",e)},t.prototype.replaceRoot=function(e){return this._pipe("replaceRoot",e)},t.prototype.sample=function(e){return this._pipe("sample",e)},t.prototype.skip=function(e){return this._pipe("skip",e)},t.prototype.sort=function(e){return this._pipe("sort",e)},t.prototype.sortByCount=function(e){return this._pipe("sortByCount",e)},t.prototype.unwind=function(e){return this._pipe("unwind",e)},t})(),zl=i7});var o7,n2,i2=X(()=>{AR();CR();y0();o7=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),n2=(function(t){o7(e,t);function e(r,n){return t.call(this,r,n)||this}return Object.defineProperty(e.prototype,"name",{get:function(){return this._coll},enumerable:!1,configurable:!0}),e.prototype.doc=function(r){if(typeof r!="string"&&typeof r!="number")throw new Error("docId\u5FC5\u987B\u4E3A\u5B57\u7B26\u4E32\u6216\u6570\u5B57");return new r0(this._db,this._coll,r)},e.prototype.add=function(r,n){var o=new r0(this._db,this._coll,void 0);return o.create(r,n)},e.prototype.aggregate=function(){return new zl(this._db,this._coll)},e})(RR)});var a2,ne,o2,s2=X(()=>{pa();da();fa();br();y0();a2={eq:function(t){return new mt(_e.EQ,[t])},neq:function(t){return new mt(_e.NEQ,[t])},lt:function(t){return new mt(_e.LT,[t])},lte:function(t){return new mt(_e.LTE,[t])},gt:function(t){return new mt(_e.GT,[t])},gte:function(t){return new mt(_e.GTE,[t])},in:function(t){return new mt(_e.IN,t)},nin:function(t){return new mt(_e.NIN,t)},all:function(t){return new mt(_e.ALL,t)},elemMatch:function(t){return new mt(_e.ELEM_MATCH,[t])},exists:function(t){return new mt(_e.EXISTS,[t])},size:function(t){return new mt(_e.SIZE,[t])},mod:function(t){return new mt(_e.MOD,[t])},geoNear:function(t){return new mt(_e.GEO_NEAR,[t])},geoWithin:function(t){return new mt(_e.GEO_WITHIN,[t])},geoIntersects:function(t){return new mt(_e.GEO_INTERSECTS,[t])},and:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=Me(arguments[0])?arguments[0]:Array.from(arguments);return new Rn($t.AND,r)},nor:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=Me(arguments[0])?arguments[0]:Array.from(arguments);return new Rn($t.NOR,r)},or:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=Me(arguments[0])?arguments[0]:Array.from(arguments);return new Rn($t.OR,r)},not:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=Me(arguments[0])?arguments[0]:Array.from(arguments);return new Rn($t.NOT,r)},set:function(t){return new nt(xe.SET,[t])},remove:function(){return new nt(xe.REMOVE,[])},inc:function(t){return new nt(xe.INC,[t])},mul:function(t){return new nt(xe.MUL,[t])},push:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r;if(jr(t[0])&&t[0].hasOwnProperty("each")){var n=t[0];r={$each:n.each,$position:n.position,$sort:n.sort,$slice:n.slice}}else Me(t[0])?r=t[0]:r=Array.from(t);return new nt(xe.PUSH,r)},pull:function(t){return new nt(xe.PULL,t)},pullAll:function(t){return new nt(xe.PULL_ALL,t)},pop:function(){return new nt(xe.POP,[])},shift:function(){return new nt(xe.SHIFT,[])},unshift:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=Me(arguments[0])?arguments[0]:Array.from(arguments);return new nt(xe.UNSHIFT,r)},addToSet:function(t){return new nt(xe.ADD_TO_SET,t)},rename:function(t){return new nt(xe.RENAME,[t])},bit:function(t){return new nt(xe.BIT,[t])},max:function(t){return new nt(xe.MAX,[t])},min:function(t){return new nt(xe.MIN,[t])},expr:function(t){return{$expr:t}},jsonSchema:function(t){return{$jsonSchema:t}},text:function(t){return yR(t)?{$search:t.search}:{$search:t.search,$language:t.language,$caseSensitive:t.caseSensitive,$diacriticSensitive:t.diacriticSensitive}},aggregate:{pipeline:function(){return new zl},abs:function(t){return new ne("abs",t)},add:function(t){return new ne("add",t)},ceil:function(t){return new ne("ceil",t)},divide:function(t){return new ne("divide",t)},exp:function(t){return new ne("exp",t)},floor:function(t){return new ne("floor",t)},ln:function(t){return new ne("ln",t)},log:function(t){return new ne("log",t)},log10:function(t){return new ne("log10",t)},mod:function(t){return new ne("mod",t)},multiply:function(t){return new ne("multiply",t)},pow:function(t){return new ne("pow",t)},sqrt:function(t){return new ne("sqrt",t)},subtract:function(t){return new ne("subtract",t)},trunc:function(t){return new ne("trunc",t)},arrayElemAt:function(t){return new ne("arrayElemAt",t)},arrayToObject:function(t){return new ne("arrayToObject",t)},concatArrays:function(t){return new ne("concatArrays",t)},filter:function(t){return new ne("filter",t)},in:function(t){return new ne("in",t)},indexOfArray:function(t){return new ne("indexOfArray",t)},isArray:function(t){return new ne("isArray",t)},map:function(t){return new ne("map",t)},range:function(t){return new ne("range",t)},reduce:function(t){return new ne("reduce",t)},reverseArray:function(t){return new ne("reverseArray",t)},size:function(t){return new ne("size",t)},slice:function(t){return new ne("slice",t)},zip:function(t){return new ne("zip",t)},and:function(t){return new ne("and",t)},not:function(t){return new ne("not",t)},or:function(t){return new ne("or",t)},cmp:function(t){return new ne("cmp",t)},eq:function(t){return new ne("eq",t)},gt:function(t){return new ne("gt",t)},gte:function(t){return new ne("gte",t)},lt:function(t){return new ne("lt",t)},lte:function(t){return new ne("lte",t)},neq:function(t){return new ne("ne",t)},cond:function(t){return new ne("cond",t)},ifNull:function(t){return new ne("ifNull",t)},switch:function(t){return new ne("switch",t)},dateFromParts:function(t){return new ne("dateFromParts",t)},dateFromString:function(t){return new ne("dateFromString",t)},dayOfMonth:function(t){return new ne("dayOfMonth",t)},dayOfWeek:function(t){return new ne("dayOfWeek",t)},dayOfYear:function(t){return new ne("dayOfYear",t)},isoDayOfWeek:function(t){return new ne("isoDayOfWeek",t)},isoWeek:function(t){return new ne("isoWeek",t)},isoWeekYear:function(t){return new ne("isoWeekYear",t)},millisecond:function(t){return new ne("millisecond",t)},minute:function(t){return new ne("minute",t)},month:function(t){return new ne("month",t)},second:function(t){return new ne("second",t)},hour:function(t){return new ne("hour",t)},week:function(t){return new ne("week",t)},year:function(t){return new ne("year",t)},literal:function(t){return new ne("literal",t)},mergeObjects:function(t){return new ne("mergeObjects",t)},objectToArray:function(t){return new ne("objectToArray",t)},allElementsTrue:function(t){return new ne("allElementsTrue",t)},anyElementTrue:function(t){return new ne("anyElementTrue",t)},setDifference:function(t){return new ne("setDifference",t)},setEquals:function(t){return new ne("setEquals",t)},setIntersection:function(t){return new ne("setIntersection",t)},setIsSubset:function(t){return new ne("setIsSubset",t)},setUnion:function(t){return new ne("setUnion",t)},concat:function(t){return new ne("concat",t)},dateToString:function(t){return new ne("dateToString",t)},indexOfBytes:function(t){return new ne("indexOfBytes",t)},indexOfCP:function(t){return new ne("indexOfCP",t)},split:function(t){return new ne("split",t)},strLenBytes:function(t){return new ne("strLenBytes",t)},strLenCP:function(t){return new ne("strLenCP",t)},strcasecmp:function(t){return new ne("strcasecmp",t)},substr:function(t){return new ne("substr",t)},substrBytes:function(t){return new ne("substrBytes",t)},substrCP:function(t){return new ne("substrCP",t)},toLower:function(t){return new ne("toLower",t)},toUpper:function(t){return new ne("toUpper",t)},meta:function(t){return new ne("meta",t)},addToSet:function(t){return new ne("addToSet",t)},avg:function(t){return new ne("avg",t)},first:function(t){return new ne("first",t)},last:function(t){return new ne("last",t)},max:function(t){return new ne("max",t)},min:function(t){return new ne("min",t)},push:function(t){return new ne("push",t)},stdDevPop:function(t){return new ne("stdDevPop",t)},stdDevSamp:function(t){return new ne("stdDevSamp",t)},sum:function(t){return new ne("sum",t)},let:function(t){return new ne("let",t)}},project:{slice:function(t){return new o2("slice",t)},elemMatch:function(t){return new o2("elemMatch",t)}}},ne=(function(){function t(e,r){this["$"+e]=r}return t})(),o2=(function(){function t(e,r){this["$"+e]=r}return t})()});function u2(t){return new a7(t)}var a7,c2=X(()=>{Qt();a7=(function(){function t(e){var r=e.regexp,n=e.options;if(!r)throw new TypeError("regexp must be a string");this.$regex=r,this.$options=n}return t.prototype.parse=function(){return{$regex:this.$regex,$options:this.$options}},Object.defineProperty(t.prototype,"_internalType",{get:function(){return Tl},enumerable:!1,configurable:!0}),t})()});var Kl,_0=X(()=>{Kl={CREATE_WATCH_NET_ERROR:{code:"CREATE_WATCH_NET_ERROR",message:"create watch network error"},CREATE_WACTH_EXCEED_ERROR:{code:"CREATE_WACTH_EXCEED_ERROR",message:"maximum connections exceed"},CREATE_WATCH_SERVER_ERROR:{code:"CREATE_WATCH_SERVER_ERROR",message:"create watch server error"},CONN_ERROR:{code:"CONN_ERROR",message:"connection error"},INVALID_PARAM:{code:"INVALID_PARAM",message:"Invalid request param"},INSERT_DOC_FAIL:{code:"INSERT_DOC_FAIL",message:"insert document failed"},DATABASE_TRANSACTION_CONFLICT:{code:"DATABASE_TRANSACTION_CONFLICT",message:"database transaction conflict"}}});var Nn,Xs,Zs,s7,l2,u7,c7,w0,f2=X(()=>{g0();_0();Bl();Nl();Gs();Nn=function(){return Nn=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Nn.apply(this,arguments)},Xs=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},Zs=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},s7="database.getInTransaction",l2="database.updateDocInTransaction",u7="database.deleteDocInTransaction",c7="database.insertDocInTransaction",w0=(function(){function t(e,r,n){this._coll=r,this.id=n,this._transaction=e,this._request=this._transaction.getRequestMethod(),this._transactionId=this._transaction.getTransactionId()}return t.prototype.create=function(e){return Xs(this,void 0,void 0,function(){var r,n,o,i;return Zs(this,function(s){switch(s.label){case 0:return r={collectionName:this._coll,transactionId:this._transactionId,data:Xt.stringify(bi(e),{relaxed:!1})},this.id&&(r._id=this.id),[4,this._request.send(c7,r)];case 1:if(n=s.sent(),n.code)throw n;if(o=Xt.parse(n.inserted),i=Xt.parse(n.ok),i==1&&o==1)return[2,Nn(Nn({},n),{ok:i,inserted:o})];throw new Error(Kl.INSERT_DOC_FAIL.message)}})})},t.prototype.get=function(){return Xs(this,void 0,void 0,function(){var e,r;return Zs(this,function(n){switch(n.label){case 0:return e={collectionName:this._coll,transactionId:this._transactionId,query:{_id:{$eq:this.id}}},[4,this._request.send(s7,e)];case 1:if(r=n.sent(),r.code)throw r;return[2,{data:r.data!=="null"?yi.formatField(Xt.parse(r.data)):Xt.parse(r.data),requestId:r.requestId}]}})})},t.prototype.set=function(e){return Xs(this,void 0,void 0,function(){var r,n;return Zs(this,function(o){switch(o.label){case 0:return r={collectionName:this._coll,transactionId:this._transactionId,query:{_id:{$eq:this.id}},data:Xt.stringify(bi(e),{relaxed:!1}),upsert:!0},[4,this._request.send(l2,r)];case 1:if(n=o.sent(),n.code)throw n;return[2,Nn(Nn({},n),{updated:Xt.parse(n.updated),upserted:n.upserted?JSON.parse(n.upserted):null})]}})})},t.prototype.update=function(e){return Xs(this,void 0,void 0,function(){var r,n;return Zs(this,function(o){switch(o.label){case 0:return r={collectionName:this._coll,transactionId:this._transactionId,query:{_id:{$eq:this.id}},data:Xt.stringify(va.encode(e),{relaxed:!1})},[4,this._request.send(l2,r)];case 1:if(n=o.sent(),n.code)throw n;return[2,Nn(Nn({},n),{updated:Xt.parse(n.updated)})]}})})},t.prototype.delete=function(){return Xs(this,void 0,void 0,function(){var e,r;return Zs(this,function(n){switch(n.label){case 0:return e={collectionName:this._coll,transactionId:this._transactionId,query:{_id:{$eq:this.id}}},[4,this._request.send(u7,e)];case 1:if(r=n.sent(),r.code)throw r;return[2,Nn(Nn({},r),{deleted:Xt.parse(r.deleted)})]}})})},t})()});var h2,d2=X(()=>{h2=(function(){function t(e,r){this._coll=r,this._transaction=e}return t})()});var l7,p2,v2=X(()=>{f2();d2();l7=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),p2=(function(t){l7(e,t);function e(r,n){return t.call(this,r,n)||this}return Object.defineProperty(e.prototype,"name",{get:function(){return this._coll},enumerable:!1,configurable:!0}),e.prototype.doc=function(r){if(typeof r!="string"&&typeof r!="number")throw new Error("docId\u5FC5\u987B\u4E3A\u5B57\u7B26\u4E32\u6216\u6570\u5B57");return new w0(this._transaction,this._coll,r)},e.prototype.add=function(r){var n;r._id!==void 0&&(n=r._id);var o=new w0(this._transaction,this._coll,n);return o.create(r)},e})(h2)});function g2(){return wa(this,void 0,void 0,function(){var t;return ba(this,function(e){switch(e.label){case 0:return t=new m2(this),[4,t.init()];case 1:return e.sent(),[2,t]}})})}function b0(t,e){return e===void 0&&(e=3),wa(this,void 0,void 0,function(){var r,n,o,i,s=this;return ba(this,function(u){switch(u.label){case 0:return u.trys.push([0,4,,10]),r=new m2(this),[4,r.init()];case 1:return u.sent(),[4,t(r)];case 2:if(n=u.sent(),r.aborted===!0)throw r.abortReason;return[4,r.commit()];case 3:return u.sent(),[2,n];case 4:if(o=u.sent(),r.inited===!1)throw o;return i=function(l){return wa(s,void 0,void 0,function(){var a;return ba(this,function(c){switch(c.label){case 0:if(!(!r.aborted&&!r.commited))return[3,5];c.label=1;case 1:return c.trys.push([1,3,,4]),[4,r.rollback()];case 2:return c.sent(),[3,4];case 3:return a=c.sent(),[3,4];case 4:throw l;case 5:throw r.aborted===!0?r.abortReason:l}})})},e<=0?[4,i(o)]:[3,6];case 5:u.sent(),u.label=6;case 6:return o&&o.code===Kl.DATABASE_TRANSACTION_CONFLICT.code?[4,b0.bind(this)(t,--e)]:[3,8];case 7:return[2,u.sent()];case 8:return[4,i(o)];case 9:return u.sent(),[3,10];case 10:return[2]}})})}var wa,ba,f7,h7,d7,m2,y2=X(()=>{so();v2();_0();wa=function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function l(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?i(c.value):o(c.value).then(u,l)}a((n=n.apply(t,e||[])).next())})},ba=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},f7="database.startTransaction",h7="database.commitTransaction",d7="database.abortTransaction",m2=(function(){function t(e){this._db=e,this._request=dt.createRequest(this._db.config),this.aborted=!1,this.commited=!1,this.inited=!1}return t.prototype.init=function(){return wa(this,void 0,void 0,function(){var e;return ba(this,function(r){switch(r.label){case 0:return[4,this._request.send(f7)];case 1:if(e=r.sent(),e.code)throw e;return this.inited=!0,this._id=e.transactionId,[2]}})})},t.prototype.collection=function(e){if(!e)throw new Error("Collection name is required");return new p2(this,e)},t.prototype.getTransactionId=function(){return this._id},t.prototype.getRequestMethod=function(){return this._request},t.prototype.commit=function(){return wa(this,void 0,void 0,function(){var e,r;return ba(this,function(n){switch(n.label){case 0:return e={transactionId:this._id},[4,this._request.send(h7,e)];case 1:if(r=n.sent(),r.code)throw r;return this.commited=!0,[2,r]}})})},t.prototype.rollback=function(e){return wa(this,void 0,void 0,function(){var r,n;return ba(this,function(o){switch(o.label){case 0:return r={transactionId:this._id},[4,this._request.send(d7,r)];case 1:if(n=o.sent(),n.code)throw n;return this.aborted=!0,this.abortReason=e,[2,n]}})})},t})()});var dt,so=X(()=>{Vs();i2();s2();Mv();c2();y2();da();pa();fa();dt=(function(){function t(e){this.config=e,this.Geo=Hv,this.serverDate=gR,this.command=a2,this.RegExp=u2,this.startTransaction=g2,this.runTransaction=b0,this.logicCommand=Rn,this.updateCommand=nt,this.queryCommand=mt}return t.createRequest=function(e){var r=new t.reqClass(e),n=r.send;return r.send=function(o,i){return e.instance&&(i.instance=e.instance),e.database&&(i.database=e.database),n.call(this,o,i)},r},t.prototype.collection=function(e){if(!e)throw new Error("Collection name is required");return new n2(this,e)},t.prototype.createCollection=function(e){var r=t.createRequest(this.config),n={collectionName:e};return r.send("database.addCollection",n)},t})()});function v7(t){var e=this.platform,r=e.adapter,n=e.runtime;return dt.reqClass=this.request.constructor,dt.getAccessToken=this.authInstance?this.authInstance.getAccessToken.bind(this.authInstance):function(){return""},dt.runtime=n,this.wsClientClass&&(dt.wsClass=r.wsClass,dt.wsClientClass=this.wsClientClass),dt.ws||(dt.ws=null),new dt(eu(eu(eu({},this.config),{_fromApp:this}),t))}function E0(t){try{t.registerComponent(_2)}catch(e){console.warn(e)}}var eu,p7,_2,w2=X(()=>{so();eu=function(){return eu=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},eu.apply(this,arguments)},p7="database";_2={name:p7,entity:{database:v7}};try{cloudbase.registerComponent(_2)}catch{}try{window.registerDatabase=E0}catch{}});var E2,b2=X(()=>{E2={name:"@cloudbase/js-sdk",version:"2.24.10",description:"cloudbase javascript sdk",main:"dist/index.cjs.js",module:"dist/index.esm.js",miniprogram:"miniprogram_dist",typings:"./index.d.ts",scripts:{lint:'eslint --fix "./src/**/*.ts"',build:"rm -rf dist/ && gulp build","build:cdn":"gulp cdn","build:e2e":"rm -rf dist/ && NODE_ENV=e2e gulp e2e",precommit:"npm run lint"},publishConfig:{access:"public"},repository:{type:"git",url:"https://github.com/TencentCloudBase/cloudbase-js-sdk"},keywords:["tcb","cloudbase","Cloudbase","serverless","Serverless","javascript","JavaScript"],files:["miniprogram_dist","**/dist/","/index.d.ts","**/package.json"],components:["app","auth","database","functions","storage"],author:"",license:"Apache-2.0",dependencies:{"@cloudbase/adapter-interface":"^0.7.1","@cloudbase/ai":"2.24.10","@cloudbase/analytics":"2.24.10","@cloudbase/apis":"2.24.10","@cloudbase/app":"2.24.10","@cloudbase/auth":"2.24.10","@cloudbase/cloudrun":"2.24.10","@cloudbase/database":"0.10.0","@cloudbase/functions":"2.24.10","@cloudbase/model":"2.24.10","@cloudbase/mysql":"2.24.10","@cloudbase/realtime":"2.24.10","@cloudbase/storage":"2.24.10","@cloudbase/types":"2.24.10","@cloudbase/utilities":"2.24.10"},browserslist:["last 2 version","> 1%","chrome 53"],gitHead:"1295166f18177e01052fb4c058483a8cd0f2f969"}});var g7,S2,I2=X(()=>{jw();Qb();iE();lE();_O();SO();NO();KA();Ip();ZA();uR();w2();b2();g7=E2.version;zt.registerVersion(g7);try{Jb(zt),nE(zt),Pp(zt),E0(zt),yO(zt),EO(zt),ul(zt),Lv(zt),Sp(zt),wl(zt),Dv(zt)}catch{}try{window.cloudbase=zt}catch{}S2=zt});var y7=K(()=>{I2();window.cloudbase=S2;console.log("[CloudBase] SDK v2 loaded")});return y7();})();
/*! Bundled license information:

web-streams-polyfill/dist/ponyfill.mjs:
  (**
   * @license
   * web-streams-polyfill v4.2.0
   * Copyright 2025 Mattias Buelens, Diwank Singh Tomer and other contributors.
   * This code is released under the MIT license.
   * SPDX-License-Identifier: MIT
   *)

@mattiasbuelens/web-streams-adapter/dist/web-streams-adapter.mjs:
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)

bson/dist/bson.browser.esm.js:
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)
*/
